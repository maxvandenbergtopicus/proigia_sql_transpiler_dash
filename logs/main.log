
--- Run started at 2025-11-20T11:35:55.526608 ---

Searching for PRY files in: C:\Users\Max\Github\proigia_definition
[SKIPPED] aandachtspunten_copd_aggregate.pry (contains ignored keyword)
[SKIPPED] aandachtspunten_copd_column_properties.pry (contains ignored keyword)
[SKIPPED] aandachtspunten_cvrm_aggregate.pry (contains ignored keyword)
[SKIPPED] aandachtspunten_cvrm_column_properties.pry (contains ignored keyword)
[SKIPPED] aandachtspunten_dm_aggregate.pry (contains ignored keyword)
[SKIPPED] aandachtspunten_dm_column_properties.pry (contains ignored keyword)
[SKIPPED] ab_stewardship_aggregate.pry (contains ignored keyword)
[SKIPPED] ab_stewardship_column_properties.pry (contains ignored keyword)
[SKIPPED] af_53530556_aggregate.pry (contains ignored keyword)
[SKIPPED] af_53530556_column_properties.pry (contains ignored keyword)
[SKIPPED] amc_selectierapport_cvrm_medzzo_column_properties.pry (contains ignored keyword)
[SKIPPED] analyse_medicatie_vvr_aggregate.pry (contains ignored keyword)
[SKIPPED] analyse_medicatie_vvr_column_properties.pry (contains ignored keyword)
[SKIPPED] artrose_53533295_aggregate.pry (contains ignored keyword)
[SKIPPED] atriumfibrilleren_aggregate.pry (contains ignored keyword)
[SKIPPED] atriumfibrilleren_column_properties.pry (contains ignored keyword)
[SKIPPED] berekende_risicoscore_hvz_53530008_aggregate.pry (contains ignored keyword)
[SKIPPED] berekende_risicoscore_hvz_53530008_column_properties.pry (contains ignored keyword)
[SKIPPED] bewegingsapparaat_53533295_aggregate.pry (contains ignored keyword)
[SKIPPED] bewegingsapparaat_53533295_column_properties.pry (contains ignored keyword)
[SKIPPED] bloedverdunners_aggregate.pry (contains ignored keyword)
[SKIPPED] bloedverdunners_column_properties.pry (contains ignored keyword)
[SKIPPED] cns_2018_aggregate.pry (contains ignored keyword)
[SKIPPED] cns_2018_column_properties.pry (contains ignored keyword)
[SKIPPED] contacten_per_icpc_column_properties.pry (contains ignored keyword)
[SKIPPED] controlelijst_cvrm_vvr_53530279_0492_0551_column_properties.pry (contains ignored keyword)
[SKIPPED] covid_19_vaccinatie_column_properties.pry (contains ignored keyword)
[SKIPPED] covid_19_versie_2021_aggregate.pry (contains ignored keyword)
[SKIPPED] covid_19_versie_2021_column_properties.pry (contains ignored keyword)
[SKIPPED] cvrm_2019_aggregate.pry (contains ignored keyword)
[SKIPPED] cvrm_2019_column_properties.pry (contains ignored keyword)
[SKIPPED] declaratierapport-53530467_column_properties.pry (contains ignored keyword)
[SKIPPED] dm_populatiemanagement_column_properties.pry (contains ignored keyword)
[SKIPPED] doelmatig_voorschrijven_aggregate.pry (contains ignored keyword)
[SKIPPED] doelmatig_voorschrijven_column_properties.pry (contains ignored keyword)
[SKIPPED] filter_v2_0_column_properties.pry (contains ignored keyword)
[SKIPPED] ggz_53530495_aggregate.pry (contains ignored keyword)
[SKIPPED] ggz_53530495_column_properties.pry (contains ignored keyword)
[SKIPPED] ggz_angst_depressie_indic_53533295_aggregate.pry (contains ignored keyword)
[SKIPPED] ggz_angst_depressie_indic_53533295_column_properties.pry (contains ignored keyword)
[SKIPPED] ggz_basis_jeugd_aggregate.pry (contains ignored keyword)
[SKIPPED] ggz_basis_jeugd_column_properties.pry (contains ignored keyword)
[SKIPPED] ggz_basis_volw_aggregate.pry (contains ignored keyword)
[SKIPPED] ggz_basis_volw_column_properties.pry (contains ignored keyword)
[SKIPPED] ggz_indicatoren_53533104_aggregate.pry (contains ignored keyword)
[SKIPPED] ggz_indicatoren_jeugd_53533104_aggregate.pry (contains ignored keyword)
[SKIPPED] ggz_indicatoren_jeugd_53533104_column_properties.pry (contains ignored keyword)
[SKIPPED] ggz_indigo_aggregate.pry (contains ignored keyword)
[SKIPPED] ggz_indigo_column_properties.pry (contains ignored keyword)
[SKIPPED] gpri_aero_column_properties.pry (contains ignored keyword)
[SKIPPED] gpri_copd_comorbidities_column_properties.pry (contains ignored keyword)
[SKIPPED] gpri_copd_tracker_column_properties.pry (contains ignored keyword)
[SKIPPED] gpri_covid19_vaccin_onderzoek_column_properties.pry (contains ignored keyword)
[SKIPPED] gpri_crescendo_column_properties.pry (contains ignored keyword)
[SKIPPED] gpri_ezef_column_properties.pry (contains ignored keyword)
[SKIPPED] gpri_surmount_column_properties.pry (contains ignored keyword)
[SKIPPED] gpri_verborgen_nierschade_column_properties.pry (contains ignored keyword)
[SKIPPED] hartfalen_aggregate.pry (contains ignored keyword)
[SKIPPED] hartfalen_column_properties.pry (contains ignored keyword)
[SKIPPED] hartfalen_53533295_aggregate.pry (contains ignored keyword)
[SKIPPED] hartfalen_53533295_column_properties.pry (contains ignored keyword)
[SKIPPED] incontinentie_53533295_aggregate.pry (contains ignored keyword)
[SKIPPED] incontinentie_53533295_column_properties.pry (contains ignored keyword)
[SKIPPED] indicatie_maagbescherming_column_properties.pry (contains ignored keyword)
[SKIPPED] ineen_ketenzorg_astma_2023_indic_aggregate.pry (contains ignored keyword)
[SKIPPED] ineen_ketenzorg_astma_2023_pl_column_properties.pry (contains ignored keyword)
[SKIPPED] ineen_ketenzorg_astma_2024_indic_aggregate.pry (contains ignored keyword)
[SKIPPED] ineen_ketenzorg_astma_2024_pl_column_properties.pry (contains ignored keyword)
[SKIPPED] ineen_ketenzorg_copd_2023_indic_aggregate.pry (contains ignored keyword)
[SKIPPED] ineen_ketenzorg_copd_2023_pl_column_properties.pry (contains ignored keyword)
[SKIPPED] ineen_ketenzorg_copd_2024_indic_aggregate.pry (contains ignored keyword)
[SKIPPED] ineen_ketenzorg_copd_2024_pl_column_properties.pry (contains ignored keyword)
[SKIPPED] ineen_ketenzorg_dm_2023_indic_aggregate.pry (contains ignored keyword)
[SKIPPED] ineen_ketenzorg_dm_2023_pl_column_properties.pry (contains ignored keyword)
[SKIPPED] ineen_ketenzorg_dm_2024_indic_aggregate.pry (contains ignored keyword)
[SKIPPED] ineen_ketenzorg_dm_2024_pl_column_properties.pry (contains ignored keyword)
[SKIPPED] ineen_ketenzorg_hvz_2023_indic_aggregate.pry (contains ignored keyword)
[SKIPPED] ineen_ketenzorg_hvz_2023_pl_column_properties.pry (contains ignored keyword)
[SKIPPED] ineen_ketenzorg_hvz_2024_indic_aggregate.pry (contains ignored keyword)
[SKIPPED] ineen_ketenzorg_hvz_2024_pl_column_properties.pry (contains ignored keyword)
[SKIPPED] ineen_ketenzorg_oz_2023_indic_aggregate.pry (contains ignored keyword)
[SKIPPED] ineen_ketenzorg_oz_2023_indic_column_properties.pry (contains ignored keyword)
[SKIPPED] ineen_ketenzorg_oz_2023_pl_column_properties.pry (contains ignored keyword)
[SKIPPED] ineen_ketenzorg_oz_2024_indic_aggregate.pry (contains ignored keyword)
[SKIPPED] ineen_ketenzorg_oz_2024_indic_column_properties.pry (contains ignored keyword)
[SKIPPED] ineen_ketenzorg_oz_2024_pl_column_properties.pry (contains ignored keyword)
[SKIPPED] ineen_ketenzorg_vvr_2023_indic_aggregate.pry (contains ignored keyword)
[SKIPPED] ineen_ketenzorg_vvr_2023_pl_column_properties.pry (contains ignored keyword)
[SKIPPED] ineen_ketenzorg_vvr_2024_indic_aggregate.pry (contains ignored keyword)
[SKIPPED] ineen_ketenzorg_vvr_2024_pl_column_properties.pry (contains ignored keyword)
[SKIPPED] inkaarten_astma_patientenlijst_53530098_column_properties.pry (contains ignored keyword)
[SKIPPED] inkaarten_copd_pl_53530047_column_properties.pry (contains ignored keyword)
[SKIPPED] inkaarten_coronair_lijden_pl_column_properties_53530098.pry (contains ignored keyword)
[SKIPPED] inkaarten_dementie_pl_53530098_column_properties.pry (contains ignored keyword)
[SKIPPED] inkaarten_epa_pl_cvrm_53530047_column_properties.pry (contains ignored keyword)
[SKIPPED] inkaarten_epa_pl_dm_53530047_column_properties.pry (contains ignored keyword)
[SKIPPED] inkaarten_pl_af_v1_0_column_properties.pry (contains ignored keyword)
[SKIPPED] inkaarten_pl_astma_v1_0_column_properties.pry (contains ignored keyword)
[SKIPPED] inkaarten_pl_copd_v1_0_column_properties.pry (contains ignored keyword)
[SKIPPED] inkaarten_pl_dm_v1_0_column_properties.pry (contains ignored keyword)
[SKIPPED] inkaarten_pl_ggz_v1_0_column_properties.pry (contains ignored keyword)
[SKIPPED] inkaarten_pl_hf_v1_0_column_properties.pry (contains ignored keyword)
[SKIPPED] inkaarten_pl_hvz_v1_0_column_properties.pry (contains ignored keyword)
[SKIPPED] inkaarten_pl_os_v1_0_column_properties.pry (contains ignored keyword)
[SKIPPED] inkaarten_pl_oz_menzis_column_properties.pry (contains ignored keyword)
[SKIPPED] inkaarten_pl_oz_v1_0_column_properties.pry (contains ignored keyword)
[SKIPPED] inkaarten_pl_vvr_53530312_column_properties.pry (contains ignored keyword)
[SKIPPED] inkaarten_pl_vvr_overweeg_risico_53530312_column_properties.pry (contains ignored keyword)
[SKIPPED] inkaarten_pl_vvr_risicoschatting_53530312_column_properties.pry (contains ignored keyword)
[SKIPPED] inkaarten_pl_vvr_v1_0_column_properties.pry (contains ignored keyword)
[SKIPPED] inkaarten_vvr_risicoscore_53533075_aggregate.pry (contains ignored keyword)
[SKIPPED] innovatieset_ineen_af_aggregate.pry (contains ignored keyword)
[SKIPPED] innovatieset_ineen_af_column_properties.pry (contains ignored keyword)
[SKIPPED] innovatieset_ineen_cns_aggregate.pry (contains ignored keyword)
[SKIPPED] innovatieset_ineen_cns_column_properties.pry (contains ignored keyword)
[SKIPPED] innovatieset_ineen_copd_aggregate.pry (contains ignored keyword)
[SKIPPED] innovatieset_ineen_copd_column_properties.pry (contains ignored keyword)
[SKIPPED] innovatieset_ineen_dm_aggregate.pry (contains ignored keyword)
[SKIPPED] innovatieset_ineen_dm_column_properties.pry (contains ignored keyword)
[SKIPPED] innovatieset_ineen_hf_aggregate.pry (contains ignored keyword)
[SKIPPED] innovatieset_ineen_hf_column_properties.pry (contains ignored keyword)
[SKIPPED] innovatieset_ineen_hvz_aggregate.pry (contains ignored keyword)
[SKIPPED] innovatieset_ineen_hvz_column_properties.pry (contains ignored keyword)
[SKIPPED] innovatieset_ineen_vvr_aggregate.pry (contains ignored keyword)
[SKIPPED] innovatieset_ineen_vvr_column_properties.pry (contains ignored keyword)
[SKIPPED] inzicht_chronische_zorg_aggregate.pry (contains ignored keyword)
[SKIPPED] inzicht_chronische_zorg_column_properties.pry (contains ignored keyword)
[SKIPPED] inzicht_cvrm_epa_53530047_aggregate.pry (contains ignored keyword)
[SKIPPED] inzicht_cvrm_k91_53530047_aggregate.pry (contains ignored keyword)
[SKIPPED] inzicht_cvrm_k91_53530047_column_properties.pry (contains ignored keyword)
[SKIPPED] inzicht_declaratie_hartfalen_53530556_aggregate.pry (contains ignored keyword)
[SKIPPED] inzicht_declaratie_hartfalen_53530556_column_properties.pry (contains ignored keyword)
[SKIPPED] inzicht_declaratie_verdeling_v_1_0_aggregate.pry (contains ignored keyword)
[SKIPPED] inzicht_declaratie_verdeling_v_1_0_column_properties.pry (contains ignored keyword)
[SKIPPED] inzicht_doelgroep_dbc_zonder_mw_aggregate.pry (contains ignored keyword)
[SKIPPED] inzicht_doelgroep_dbc_zonder_mw_column_properties.pry (contains ignored keyword)
[SKIPPED] inzicht_epa_patienten_aggregate.pry (contains ignored keyword)
[SKIPPED] inzicht_epa_patienten_column_properties.pry (contains ignored keyword)
[SKIPPED] inzicht_extractie_pko_column_properties.pry (contains ignored keyword)
[SKIPPED] inzicht_izp_en_controlebeleid_53530240_aggregate.pry (contains ignored keyword)
[SKIPPED] inzicht_izp_en_controlebeleid_53530240_column_properties.pry (contains ignored keyword)
[SKIPPED] inzicht_ketenzorg_patienten_per_verzekeraar_2022_aggregate.pry (contains ignored keyword)
[SKIPPED] inzicht_ketenzorg_patienten_per_verzekeraar_2022_column_properties.pry (contains ignored keyword)
[SKIPPED] inzicht_ketenzorg_patienten_per_verzekeraar_2023_aggregate.pry (contains ignored keyword)
[SKIPPED] inzicht_ketenzorg_patienten_per_verzekeraar_2023_column_properties.pry (contains ignored keyword)
[SKIPPED] inzicht_lege_dossiers_53533096_aggregate.pry (contains ignored keyword)
[SKIPPED] inzicht_lege_dossiers_53533096_column_properties.pry (contains ignored keyword)
[SKIPPED] inzicht_lege_dossiers_53530004_aggregate.pry (contains ignored keyword)
[SKIPPED] inzicht_lege_dossiers_53530004_column_properties.pry (contains ignored keyword)
[SKIPPED] inzicht_lege_dossiers_v1_0_aggregate.pry (contains ignored keyword)
[SKIPPED] inzicht_lege_dossiers_v1_0_column_properties.pry (contains ignored keyword)
[SKIPPED] inzicht_nultarief_verrichtingen_53530172_aggregate.pry (contains ignored keyword)
[SKIPPED] inzicht_nultarief_verrichtingen_53530172_column_properties.pry (contains ignored keyword)
[SKIPPED] inzicht_patienten_75plus_per_verzekeraar_2022_aggregate.pry (contains ignored keyword)
[SKIPPED] inzicht_patienten_75plus_per_verzekeraar_2023_aggregate.pry (contains ignored keyword)
[SKIPPED] inzicht_patienten_75plus_per_verzekeraar_2024_aggregate.pry (contains ignored keyword)
[SKIPPED] inzicht_patienten_75plus_per_verzekeraar_2025_aggregate.pry (contains ignored keyword)
[SKIPPED] inzicht_poh_ggz_aggregate.pry (contains ignored keyword)
[SKIPPED] inzicht_poh_ggz_column_properties.pry (contains ignored keyword)
[SKIPPED] inzicht_registratie_af_53530098_aggregate.pry (contains ignored keyword)
[SKIPPED] inzicht_registratie_af_53530098_column_properties.pry (contains ignored keyword)
[SKIPPED] inzicht_registratie_astma_53530098_aggregate.pry (contains ignored keyword)
[SKIPPED] inzicht_registratie_astma_53530098_column_properties.pry (contains ignored keyword)
[SKIPPED] inzicht_registratie_coronair_lijden_53530098_aggregate.pry (contains ignored keyword)
[SKIPPED] inzicht_registratie_coronair_lijden_53530098_column_properties.pry (contains ignored keyword)
[SKIPPED] inzicht_registratie_dementie_53530098_aggregate.pry (contains ignored keyword)
[SKIPPED] inzicht_registratie_dementie_53530098_column_properties.pry (contains ignored keyword)
[SKIPPED] inzicht_verrichtingen_53533085_aggregate.pry (contains ignored keyword)
[SKIPPED] inzicht_verrichtingen_53533085_column_properties.pry (contains ignored keyword)
[SKIPPED] kinderen_met_adhd_aggregate.pry (contains ignored keyword)
[SKIPPED] kinderen_met_adhd_column_properties.pry (contains ignored keyword)
[SKIPPED] kind_adhd_medicatie-53530047_column_properties.pry (contains ignored keyword)
[SKIPPED] kwartaal_ind_af_v3_0_aggregate.pry (contains ignored keyword)
[SKIPPED] kwartaal_ind_af_v3_0_column_properties.pry (contains ignored keyword)
[SKIPPED] kwartaal_ind_af_v3_0_gez_aggregate.pry (contains ignored keyword)
[SKIPPED] kwartaal_ind_af_v3_0_gez_column_properties.pry (contains ignored keyword)
[SKIPPED] kwartaal_ind_astma_v3_0_aggregate.pry (contains ignored keyword)
[SKIPPED] kwartaal_ind_astma_v3_0_column_properties.pry (contains ignored keyword)
[SKIPPED] kwartaal_ind_astma_v3_0_gez_aggregate.pry (contains ignored keyword)
[SKIPPED] kwartaal_ind_astma_v3_0_gez_column_properties.pry (contains ignored keyword)
[SKIPPED] kwartaal_ind_bbr_v3_0_aggregate.pry (contains ignored keyword)
[SKIPPED] kwartaal_ind_bbr_v3_0_column_properties.pry (contains ignored keyword)
[SKIPPED] kwartaal_ind_cl_v3_0_aggregate.pry (contains ignored keyword)
[SKIPPED] kwartaal_ind_cl_v3_0_column_properties.pry (contains ignored keyword)
[SKIPPED] kwartaal_ind_cns_v3_0_aggregate.pry (contains ignored keyword)
[SKIPPED] kwartaal_ind_cns_v3_0_column_properties.pry (contains ignored keyword)
[SKIPPED] kwartaal_ind_copdastma_v3_0_aggregate.pry (contains ignored keyword)
[SKIPPED] kwartaal_ind_copdastma_v3_0_column_properties.pry (contains ignored keyword)
[SKIPPED] kwartaal_ind_copd_v3_0_aggregate.pry (contains ignored keyword)
[SKIPPED] kwartaal_ind_copd_v3_0_column_properties.pry (contains ignored keyword)
[SKIPPED] kwartaal_ind_copd_v3_0_gez_aggregate.pry (contains ignored keyword)
[SKIPPED] kwartaal_ind_copd_v3_0_gez_column_properties.pry (contains ignored keyword)
[SKIPPED] kwartaal_ind_cvrm_v3_0_aggregate.pry (contains ignored keyword)
[SKIPPED] kwartaal_ind_cvrm_v3_0_column_properties.pry (contains ignored keyword)
[SKIPPED] kwartaal_ind_cvrm_v3_0_gez_aggregate.pry (contains ignored keyword)
[SKIPPED] kwartaal_ind_cvrm_v3_0_gez_column_properties.pry (contains ignored keyword)
[SKIPPED] kwartaal_ind_dementie_v3_0_aggregate.pry (contains ignored keyword)
[SKIPPED] kwartaal_ind_dementie_v3_0_column_properties.pry (contains ignored keyword)
[SKIPPED] kwartaal_ind_dm_v3_0_aggregate.pry (contains ignored keyword)
[SKIPPED] kwartaal_ind_dm_v3_0_column_properties.pry (contains ignored keyword)
[SKIPPED] kwartaal_ind_dm_v3_0_gez_aggregate.pry (contains ignored keyword)
[SKIPPED] kwartaal_ind_dm_v3_0_gez_column_properties.pry (contains ignored keyword)
[SKIPPED] kwartaal_ind_epa_v3_0_aggregate.pry (contains ignored keyword)
[SKIPPED] kwartaal_ind_epa_v3_0_column_properties.pry (contains ignored keyword)
[SKIPPED] kwartaal_ind_epa_v3_0_gez_aggregate.pry (contains ignored keyword)
[SKIPPED] kwartaal_ind_epa_v3_0_gez_column_properties.pry (contains ignored keyword)
[SKIPPED] kwartaalrapport_ind_ggz_jeugd_v3_0_aggregate.pry (contains ignored keyword)
[SKIPPED] kwartaalrapport_ind_ggz_jeugd_v3_0_column_properties.pry (contains ignored keyword)
[SKIPPED] kwartaalrapport_ind_ggz_v3_0_aggregate.pry (contains ignored keyword)
[SKIPPED] kwartaalrapport_ind_ggz_v3_0_column_properties.pry (contains ignored keyword)
[SKIPPED] kwartaal_ind_hartfalen_v3_0_aggregate.pry (contains ignored keyword)
[SKIPPED] kwartaal_ind_hartfalen_v3_0_column_properties.pry (contains ignored keyword)
[SKIPPED] kwartaal_ind_hvz_v3_0_aggregate.pry (contains ignored keyword)
[SKIPPED] kwartaal_ind_hvz_v3_0_column_properties.pry (contains ignored keyword)
[SKIPPED] kwartaal_ind_hvz_v3_0_gez_aggregate.pry (contains ignored keyword)
[SKIPPED] kwartaal_ind_hvz_v3_0_gez_column_properties.pry (contains ignored keyword)
[SKIPPED] kwartaalrapport_ind_osteoporose_v3_0_aggregate.pry (contains ignored keyword)
[SKIPPED] kwartaalrapport_ind_osteoporose_v3_0_column_properties.pry (contains ignored keyword)
[SKIPPED] Kwartaalrapport_ind_oz_v3_0_aggregate.pry (contains ignored keyword)
[SKIPPED] kwartaalrapport_ind_oz_v3_0_column_properties.pry (contains ignored keyword)
[SKIPPED] Kwartaalrapport_ind_oz_v3_0_gez_aggregate.pry (contains ignored keyword)
[SKIPPED] kwartaalrapport_ind_oz_v3_0_gez_column_properties.pry (contains ignored keyword)
[SKIPPED] kwartaal_ind_vvr_v3_0_aggregate.pry (contains ignored keyword)
[SKIPPED] kwartaal_ind_vvr_v3_0_column_properties.pry (contains ignored keyword)
[SKIPPED] kwartaal_ind_vvr_v3_0_gez_aggregate.pry (contains ignored keyword)
[SKIPPED] kwartaal_ind_vvr_v3_0_gez_column_properties.pry (contains ignored keyword)
[SKIPPED] kwartaalrapport_pl_af_v3_0_column_properties.pry (contains ignored keyword)
[SKIPPED] kwartaalrapport_pl_astma_v3_0_column_properties.pry (contains ignored keyword)
[SKIPPED] kwartaalrapport_pl_bbr_v3_0_column_properties.pry (contains ignored keyword)
[SKIPPED] kwartaalrapport_pl_cl_v3_0_column_properties.pry (contains ignored keyword)
[SKIPPED] kwartaalrapport_pl_cns_v3_0_column_properties.pry (contains ignored keyword)
[SKIPPED] kwartaalrapport_pl_copdastma_v3_0_column_properties.pry (contains ignored keyword)
[SKIPPED] kwartaalrapport_pl_copd_v3_0_column_properties.pry (contains ignored keyword)
[SKIPPED] kwartaalrapport_pl_cvrm_v3_0_column_properties.pry (contains ignored keyword)
[SKIPPED] kwartaal_pl_dementie_v3_0_column_properties.pry (contains ignored keyword)
[SKIPPED] kwartaalrapport_pl_dm_v3_0_column_properties.pry (contains ignored keyword)
[SKIPPED] kwartaalrapport_pl_epa_v3_0_column_properties.pry (contains ignored keyword)
[SKIPPED] kwartaalrapport_pl_ggz_v3_0_column_properties.pry (contains ignored keyword)
[SKIPPED] kwartaalrapport_pl_hartfalen_v3_0_column_properties.pry (contains ignored keyword)
[SKIPPED] kwartaalrapport_pl_hvz_v3_0_column_properties.pry (contains ignored keyword)
[SKIPPED] kwartaalrapport_pl_osteoporose_v3_0_column_properties.pry (contains ignored keyword)
[SKIPPED] kwartaalrapport_pl_oz_v3_0_column_properties.pry (contains ignored keyword)
[SKIPPED] kwartaalrapport_pl_vvr_v3_0_column_properties.pry (contains ignored keyword)
[SKIPPED] uprim_aggregate.pry (contains ignored keyword)
[SKIPPED] uprim_column_properties.pry (contains ignored keyword)
[SKIPPED] mtvdp_53530025_aggregate.pry (contains ignored keyword)
[SKIPPED] mtvdp_53530025_column_properties.pry (contains ignored keyword)
[SKIPPED] nhg_astma_v1_2_kind_aggregate.pry (contains ignored keyword)
[SKIPPED] nhg_astma_v1_2_kind_pl_column_properties.pry (contains ignored keyword)
[SKIPPED] nhg_astma_v3_2_aggregate.pry (contains ignored keyword)
[SKIPPED] nhg_astma_v3_2_patientenlijst_column_properties.pry (contains ignored keyword)
[SKIPPED] nhg_astma_v3_3_aggregate.pry (contains ignored keyword)
[SKIPPED] nhg_astma_v3_3_patientenlijst_column_properties.pry (contains ignored keyword)
[SKIPPED] nhg_cns_v1_2_aggregate.pry (contains ignored keyword)
[SKIPPED] nhg_cns_v1_2_patientenlijst_column_properties.pry (contains ignored keyword)
[SKIPPED] nhg_copd_v3_2_aggregate.pry (contains ignored keyword)
[SKIPPED] ngh_copd_v3_2_patientenlijst_column_properties.pry (contains ignored keyword)
[SKIPPED] nhg_cvrm_hr_v1_10_indic_aggregate.pry (contains ignored keyword)
[SKIPPED] nhg_cvrm_hr_v1_10_pl_column_properties.pry (contains ignored keyword)
[SKIPPED] nhg_cvrm_hr_v1_9_indic_aggregate.pry (contains ignored keyword)
[SKIPPED] nhg_cvrm_hr_v1_9_pl_column_properties.pry (contains ignored keyword)
[SKIPPED] nhg_cvrm_hvz_v1_15_aggregate.pry (contains ignored keyword)
[SKIPPED] nhg_cvrm_hvz_v1_15_patientenlijst_column_properties.pry (contains ignored keyword)
[SKIPPED] nhg_cvrm_standaard_2024_column_properties.pry (contains ignored keyword)
[SKIPPED] nhg_dm_v1_16_aggregate.pry (contains ignored keyword)
[SKIPPED] nhg_dm_v1_16_patientenlijst_column_properties.pry (contains ignored keyword)
[SKIPPED] nhg_jaarverslag_v2_0_aggregate.pry (contains ignored keyword)
[SKIPPED] nhg_jaarverslag_v2_0_53530025_aggregate.pry (contains ignored keyword)
[SKIPPED] nhg_stoppen_met_roken_v1_1_aggregate.pry (contains ignored keyword)
[SKIPPED] nhg_stoppen_met_roken_v1_1_patientenlijst_column_properties.pry (contains ignored keyword)
[SKIPPED] npa_thema_audit_lab_column_properties.pry (contains ignored keyword)
[SKIPPED] npa_thema_audit_vv_aggregate.pry (contains ignored keyword)
[SKIPPED] npa_thema_audit_vv_column_properties.pry (contains ignored keyword)
[SKIPPED] ondersteuning_labaanvragen_column_properties.pry (contains ignored keyword)
[SKIPPED] oproepagenda_53530047_column_properties.pry (contains ignored keyword)
[SKIPPED] oproepagenda_53530083_column_properties.pry (contains ignored keyword)
[SKIPPED] oproepagenda_53530098_column_properties.pry (contains ignored keyword)
[SKIPPED] oproepagenda_53530099_column_properties.pry (contains ignored keyword)
[SKIPPED] oproepagenda_53530277_column_properties.pry (contains ignored keyword)
[SKIPPED] oproepagenda_53530329_column_properties.pry (contains ignored keyword)
[SKIPPED] oproepagenda_53533096_column_properties.pry (contains ignored keyword)
[SKIPPED] oproepagenda_53533156_column_properties.pry (contains ignored keyword)
[SKIPPED] oproepagenda_ggz_53530007_0151_0210_column_properties.pry (contains ignored keyword)
[SKIPPED] oproepagenda_integrale_ketenzorg_aggregate.pry (contains ignored keyword)
[SKIPPED] oproepagenda_integrale_ketenzorg_column_properties.pry (contains ignored keyword)
[SKIPPED] oproepagenda_poh_ggz_covid_19_column_properties.pry (contains ignored keyword)
[SKIPPED] oproepagenda_v1_0_aggregate.pry (contains ignored keyword)
[SKIPPED] oproepagenda_v1_0_column_properties.pry (contains ignored keyword)
[SKIPPED] osteoporose_rapport_column_properties.pry (contains ignored keyword)
[SKIPPED] osteoporose_53530008_aggregate.pry (contains ignored keyword)
[SKIPPED] osteoporose_53530008_column_properties.pry (contains ignored keyword)
[SKIPPED] ouderenzorg_aggregate.pry (contains ignored keyword)
[SKIPPED] ouderenzorg_column_properties.pry (contains ignored keyword)
[SKIPPED] ouderenzorg_53530073_aggregate.pry (contains ignored keyword)
[SKIPPED] ouderenzorg_53530073_column_properties.pry (contains ignored keyword)
[SKIPPED] ouderenzorg_53533295_aggregate.pry (contains ignored keyword)
[SKIPPED] ouderenzorg_53533295_column_properties.pry (contains ignored keyword)
[SKIPPED] ouderenzorg_indicatoren_53530098_aggregate.pry (contains ignored keyword)
[SKIPPED] ouderenzorg_patientenlijst_53530098_column_properties.pry (contains ignored keyword)
[SKIPPED] overzicht_keten_kwartaaluitkomsten_aggregate.pry (contains ignored keyword)
[SKIPPED] overzicht_keten_kwartaaluitkomsten_column_properties.pry (contains ignored keyword)
[SKIPPED] patientenlijst_acp_column_properties.pry (contains ignored keyword)
[SKIPPED] patientenlijst_oz_en_andere_ketens_column_properties.pry (contains ignored keyword)
[SKIPPED] ps_declaratie_v2_1_dbc_aggregate.pry (contains ignored keyword)
[SKIPPED] ps_declaratie_v2_1_dbc_column_properties.pry (contains ignored keyword)
[SKIPPED] poh_ggz_consulten_per_mw_column_properties.pry (contains ignored keyword)
[SKIPPED] poh_ggz_kpi_ind_53533162_aggregate.pry (contains ignored keyword)
[SKIPPED] poh_ggz_kpi_ind_53533162_column_properties.pry (contains ignored keyword)
[SKIPPED] poh_ggz_kpi_ind_jeugd_53533162_aggregate.pry (contains ignored keyword)
[SKIPPED] poh_ggz_kpi_ind_jeugd_53533162_column_properties.pry (contains ignored keyword)
[SKIPPED] poh_ggz_kpi_pl_53533162_column_properties.pry (contains ignored keyword)
[SKIPPED] poh_ggz_kpi_pl_jeugd_53533162_column_properties.pry (contains ignored keyword)
[SKIPPED] ps_dbc_ouderen_inzicht_bepaal_aggregate.pry (contains ignored keyword)
[SKIPPED] registratiescan_chron_basiszorg_column_properties.pry (contains ignored keyword)
[SKIPPED] registratie_cvrm_bloeddrukmetingen_53530008_aggregate.pry (contains ignored keyword)
[SKIPPED] registratie_triglyceriden_epa_53530047_aggregate.pry (contains ignored keyword)
[SKIPPED] relatie_copd_hb_gold_53530008_aggregate.pry (contains ignored keyword)
[SKIPPED] rezisto_antibiotica_column_properties.pry (contains ignored keyword)
[SKIPPED] schildklierproblemen_column_properties.pry (contains ignored keyword)
[SKIPPED] smr_indicatoren_aggregate_53533295.pry (contains ignored keyword)
[SKIPPED] smr_indicatoren_column_properties_53533295.pry (contains ignored keyword)
[SKIPPED] tactic_follow_up_53530047_column_properties.pry (contains ignored keyword)
[SKIPPED] tactic_inkaarten_voor_mdo_53530047_aggregate.pry (contains ignored keyword)
[SKIPPED] tactic_inkaarten_voor_mdo_53530047_column_properties.pry (contains ignored keyword)
[SKIPPED] tactic_voorbereiden_op_mdo_53530047_column_properties.pry (contains ignored keyword)
[SKIPPED] top_25_ketenzorgpatienten_meeste_contacten_column_properties.pry (contains ignored keyword)
[SKIPPED] top_400_column_properties.pry (contains ignored keyword)
[SKIPPED] validatie_aggregate.pry (contains ignored keyword)
[SKIPPED] verrichtingen_medewerker_omzet_column_properties.pry (contains ignored keyword)
[SKIPPED] vumc_coc_column_properties.pry (contains ignored keyword)
[SKIPPED] vumc_fh_column_properties.pry (contains ignored keyword)
[SKIPPED] vumc_imithot_column_properties.pry (contains ignored keyword)
[SKIPPED] vumc_omed2_column_properties.pry (contains ignored keyword)
[SKIPPED] vumc_snowdrop_column_properties.pry (contains ignored keyword)
[SKIPPED] vumc_spiegelaar_2_0_column_properties.pry (contains ignored keyword)
[SKIPPED] vumc_verminderde_nierfunctie_column_properties.pry (contains ignored keyword)
[SKIPPED] welzijn_op_recept_column_properties.pry (contains ignored keyword)
[SKIPPED] pohs_21_aggregate.pry (contains ignored keyword)
[SKIPPED] pohs_21_column_properties.pry (contains ignored keyword)
[SKIPPED] zorgzwaarte_53530004_aggregate.pry (contains ignored keyword)
[SKIPPED] zorgzwaarte_53530004_column_properties.pry (contains ignored keyword)
[SKIPPED] zorgzwaarte_project_53530556_um_column_properties.pry (contains ignored keyword)
[SKIPPED] zorg_op_de_juiste_plek_53533085_aggregate.pry (contains ignored keyword)
[SKIPPED] zorg_op_de_juiste_plek_53533085_column_properties.pry (contains ignored keyword)

Found 803 PRY files to process


=== Processing 115 block files ===
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\af_praktijken_53530082.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\astma_praktijken_53530098.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\bbr_praktijken_53533085.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\doac_en_grenswaarde_nierfunctie.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\episode_filter_peildatum.sql (creates: pre_episode, episode_filter_pre)
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\gpri_copd_comorbidities_patientenlijst.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\gpri_copd_comorbidities_verzamel_doelgroepen.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\gpri_copd_comorbidities_verzamel_vertaling.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\hf_praktijken_53530099.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\hf_praktijken_53530356.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\indicatoren_template.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\inzicht_ld_meetwaarden_medicatie.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\inz_decl_verdeling_med_indic.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\kwartaalrapport_pl_algemene_kolommen.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\medewerker_koppeling_medewerkerbeheer.sql (creates: medewerker_nieuw)
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\medicatie_combinatiepreparaten.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\medicatie_einddatum_berekenen.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\medicatie_epa.sql (creates: med_epa_chronisch, med_filter)
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\medicatie_filter_ooit_peildatum.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\medicatie_filter_peildatum.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\medicatie_polyfarmacy_peildatum.sql (creates: chronische_medicatie, polyfarmacie_atc3, chron_atc_code, med_filter_2, med_filter_1, polyfarmacie_atc4, chron_atc2, polyfarmacie_atc2, chron_atc4, chron_atc3, polyfarmacie_atc_code)
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\meetwaarden_filter_deel1_peildatum.sql (creates: meetwaarden, nhgnr_verrijking)
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\meetwaarden_spiro_std_3jr.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\meetwaarden_spiro_std_jr.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\meetwaarden_verzameltabel_seg2.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\nhg_cvrm_standaard_2024_dm_hoog_risico.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\nhg_cvrm_standaard_2024_dm_matig_verhoogd_risico.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\nhg_cvrm_standaard_2024_dm_microvasculaire_aandoeningen.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\nhg_cvrm_standaard_2024_dm_zeer_hoog_risico.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\ongewenst_gewichtsverlies.sql (creates: laatste_1maand, laatste_6maand, gewicht_pre, gewicht_verschil)
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\oproepagenda_covid_oproeplijst_pzg3.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\oproepagenda_covid_verzameltabel_pzg3.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\oproepagenda_medische_urgentie_oproeplijst.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\oproepagenda_medische_urgentie_verzameltabel.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\osteoporose_53530008_ind.sql (creates: ind_pre)
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\patientgegevens_peildatum.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\patient_aanschrijfgegevens_patientenlijst.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\patient_patientgegevens_verzameltabel.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\patient_patientinformatie_patientenlijst.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\proigia_basis_contact_3mt_externals.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\proigia_basis_contact_externals.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\proigia_basis_episode_3mt_externals.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\proigia_basis_episode_externals.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\proigia_basis_episode_seg2_externals.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\proigia_basis_externals.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\proigia_basis_externals_pzg4.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\proigia_basis_fi_score_3mt_externals.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\proigia_basis_fi_score_3mt_seg2_externals.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\proigia_basis_fi_score_externals.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\proigia_basis_fundus_externals.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\proigia_basis_hb_zw_zorgtype_externals.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\proigia_basis_hb_zw_zorgtype_seg2_externals.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\proigia_basis_medicatie_2jr_externals.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\proigia_basis_medicatie_3mt_externals.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\proigia_basis_medicatie_3mt_seg2_externals.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\proigia_basis_medicatie_externals.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\proigia_basis_medicatie_seg2_externals.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\proigia_basis_meetwaarden_3mt_externals.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\proigia_basis_meetwaarden_afw_externals.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\proigia_basis_meetwaarden_afw_seg2_externals.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\proigia_basis_meetwaarden_cns.sql (creates: cns, cns_pre)
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\proigia_basis_meetwaarden_externals.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\proigia_basis_meetwaarden_seg2_externals.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\proigia_basis_override_externals.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\proigia_basis_seg2_externals.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\proigia_contact_aanvulling.sql (creates: contacten_nummering, contacten_dubbel, contacten_filter, contacten_elimineren)
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\proigia_fi_score_filter_3mt_aanvulling.sql
Crosstab function detected, converting to dbt-compatible SQL.
    SELECT * FROM crosstab(
    $$
    WITH ouderenpopulatie AS
    (
    
        SELECT patient_id FROM proigia_patienten_gegevens_alle
        WHERE leeftijd >= 60
    ),
    ficat_series AS
    (
        SELECT 
            patient_id, 
            generate_series(1,50)::varchar AS fi_cat
        FROM ouderenpopulatie
        UNION
        SELECT
            patient_id, 
            'tot'::varchar AS fi_cat
        FROM ouderenpopulatie
    )
    SELECT
        patient_id,
        fi_cat,
        CASE 
            WHEN fi_cat = 'tot' 
            THEN
                CASE WHEN nrs IS NULL 
                THEN 0
                ELSE array_length(nrs,1)
                END
            WHEN get_number(fi_cat) = ANY(nrs) 
            THEN 1 
            ELSE 0
            END AS fi_cat_ind
        FROM ficat_series
Converted crosstab SQL:

[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\proigia_fi_verzameltabel_aanvulling.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\proigia_fi_verzameltabel_ct.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\proigia_icpc_ct.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\proigia_icpc_ct_seg2.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\proigia_journaal_filter.sql (creates: jr_clean)
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\proigia_medicatie_ct.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\proigia_medicatie_ct_seg2.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\proigia_medicatie_polyfarmacy.sql (creates: polyfarmacie_atc3, chron_atc_code, polyfarmacie_atc4, chron_atc2, polyfarmacie_atc2, chron_atc4, chron_atc3, polyfarmacie_atc_code)
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\proigia_medicatie_polyfarmacy_3mt.sql (creates: polyfarmacie_atc3, chron_atc_code, polyfarmacie_atc4, chron_atc2, polyfarmacie_atc2, chron_atc4, chron_atc3, polyfarmacie_atc_code)
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\proigia_meetwaarden_ct.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\proigia_meetwaarden_ct_seg2.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\proigia_meetwaarden_filter_deel1.sql (creates: nhgnr_verrijking)
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\proigia_meetwaarden_filter_deel2.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\proigia_zg_criteria_v3_cns.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\proigia_zg_criteria_v3_pl_algemeen.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\proigia_zg_criteria_v3_vertaling_peildatum.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\proigia_zg_v3_externals.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\proigia_zg_v3_std_externals.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\proigia_zg_v4_externals.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\proigia_zg_verz_def_af_block.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\proigia_zg_verz_def_astma_block.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\proigia_zg_verz_def_copd_block.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\proigia_zg_verz_def_cvrm_block.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\proigia_zg_verz_def_dm_block.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\proigia_zg_verz_def_ggz_block.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\proigia_zg_verz_def_hf_block.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\proigia_zg_verz_def_os_block.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\ps_doelgroep_astma_0007_0210.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\ps_doelgroep_copd_0007_0210.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\ps_doelgroep_dm_0007_0210.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\ps_doelgroep_hr_0007_0210.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\ps_doelgroep_zhr_0007_0210.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\qrisk3.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\qrisk3_meetwaarden_pre.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\qrisk3_pre.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\qrisk3_score.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\qrisk3_score_meetwaarden.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\qrisk3_score_verzamel.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\risicoscore_ziektelast.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\ruiter_poh_seg2.sql (creates: poh_informatie_opmerkingveld, ruiter_informatie)
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\verrichting_huisarts_deel1.sql (creates: vektis_type)
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\verrichting_huisarts_deel2.sql (creates: huisarts)
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\verrichting_huisarts_pre_deel1.sql (creates: medewerker, contact_nr)
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\verrichting_huisarts_pre_deel2.sql (creates: soort_contact, verrichting_poh_ggz)
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\verrichting_poh_ggz.sql (creates: vektis_type)
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\verrichting_poh_ggz_pre.sql (creates: verrichting_poh_ggz, soort_contact_poh_ggz)
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\zorggroepen_met_gescheiden_declaratie_cvrm.sql
[OK] Block macro generated: C:\Users\Max\Github\proigia_dbt\macros\dm_dash_new\zorggroepen_met_gezamenlijke_declaratie_copdastma.sql

=== Processing 688 regular files ===
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\aandachtspunten_copd\aandachtspunten_copd_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\aandachtspunten_copd\aandachtspunten_copd_indicatoren_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\aandachtspunten_copd\aandachtspunten_copd_indicatoren.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\aandachtspunten_copd\aandachtspunten_copd_patientenlijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\aandachtspunten_copd\aandachtspunten_copd_pl_indic1.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\aandachtspunten_copd\aandachtspunten_copd_pl_indic2.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\aandachtspunten_copd\aandachtspunten_copd_pl_indic3.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\aandachtspunten_copd\aandachtspunten_copd_pl_indic4.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\aandachtspunten_copd\aandachtspunten_copd_pl_indic5.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\aandachtspunten_copd\aandachtspunten_copd_pl_indic6.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\aandachtspunten_copd\aandachtspunten_copd_pl_indic7.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\aandachtspunten_copd\aandachtspunten_copd_pl_indic8.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\aandachtspunten_copd\aandachtspunten_copd_pl_indic9.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\aandachtspunten_copd\aandachtspunten_copd_pl_indic10.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\aandachtspunten_copd\aandachtspunten_copd_pl_indic11.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\aandachtspunten_copd\aandachtspunten_copd_pl_indic12.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\aandachtspunten_copd\aandachtspunten_copd_pl_indic13.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\aandachtspunten_copd\aandachtspunten_copd_pl_indic14.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Let op: deze view levert meerdere regels op per patiÃ«nt #}
SELECT
  patient_id,
  datum
FROM {{ r
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\aandachtspunten_copd\aandachtspunten_copd_contact.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\aandachtspunten_copd\aandachtspunten_copd_exacerbaties_vorig_jr.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\aandachtspunten_copd\aandachtspunten_copd_fev1.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {{ ruiter_poh_seg2() }} {# KOPIE VAN proigia_zg_criteria_v3_std_ruiter_poh. Uitzondering proigia mee
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\aandachtspunten_copd\aandachtspunten_copd_ruiter_poh.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\aandachtspunten_cvrm\aandachtspunten_cvrm_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\aandachtspunten_cvrm\aandachtspunten_cvrm_indicatoren_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\aandachtspunten_cvrm\aandachtspunten_cvrm_indicatoren.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\aandachtspunten_cvrm\aandachtspunten_cvrm_patientenlijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\aandachtspunten_cvrm\aandachtspunten_cvrm_pl_indic0_1.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\aandachtspunten_cvrm\aandachtspunten_cvrm_pl_indic1.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\aandachtspunten_cvrm\aandachtspunten_cvrm_pl_indic2.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\aandachtspunten_cvrm\aandachtspunten_cvrm_pl_indic3.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\aandachtspunten_cvrm\aandachtspunten_cvrm_pl_indic4.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\aandachtspunten_cvrm\aandachtspunten_cvrm_pl_indic5.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\aandachtspunten_cvrm\aandachtspunten_cvrm_pl_indic6.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\aandachtspunten_cvrm\aandachtspunten_cvrm_pl_indic7.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\aandachtspunten_cvrm\aandachtspunten_cvrm_pl_indic8.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\aandachtspunten_cvrm\aandachtspunten_cvrm_pl_indic9.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\aandachtspunten_cvrm\aandachtspunten_cvrm_pl_indic10.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\aandachtspunten_cvrm\aandachtspunten_cvrm_intensivering.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\aandachtspunten_cvrm\aandachtspunten_cvrm_medicatie_ldl_chol.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\aandachtspunten_cvrm\aandachtspunten_cvrm_ldl_correctiefactor.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\aandachtspunten_cvrm\aandachtspunten_cvrm_ldl_chol_ooit.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\aandachtspunten_cvrm\aandachtspunten_cvrm_b01_3mnd.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\aandachtspunten_cvrm\aandachtspunten_cvrm_rrsy_alle.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\aandachtspunten_cvrm\aandachtspunten_cvrm_laatste_ldl_c10.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {{ ruiter_poh_seg2() }} {# KOPIE VAN proigia_zg_criteria_v3_std_ruiter_poh. Uitzondering proigia mee
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\aandachtspunten_cvrm\aandachtspunten_cvrm_ruiter_poh.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\aandachtspunten_dm\aandachtspunten_dm_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\aandachtspunten_dm\aandachtspunten_dm_indicatoren_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\aandachtspunten_dm\aandachtspunten_dm_indicatoren.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\aandachtspunten_dm\aandachtspunten_dm_patientenlijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\aandachtspunten_dm\aandachtspunten_dm_pl_tussen.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\aandachtspunten_dm\aandachtspunten_dm_pl_indic1.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\aandachtspunten_dm\aandachtspunten_dm_pl_indic2.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\aandachtspunten_dm\aandachtspunten_dm_pl_indic3.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\aandachtspunten_dm\aandachtspunten_dm_pl_indic4.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\aandachtspunten_dm\aandachtspunten_dm_pl_indic5.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\aandachtspunten_dm\aandachtspunten_dm_pl_indic6.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\aandachtspunten_dm\aandachtspunten_dm_pl_indic7.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\aandachtspunten_dm\aandachtspunten_dm_pl_indic8.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\aandachtspunten_dm\aandachtspunten_dm_pl_indic9.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\aandachtspunten_dm\aandachtspunten_dm_pl_indic10.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\aandachtspunten_dm\aandachtspunten_dm_pl_indic11.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\aandachtspunten_dm\aandachtspunten_dm_pl_indic12.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\aandachtspunten_dm\aandachtspunten_dm_pl_indic13.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\aandachtspunten_dm\aandachtspunten_dm_pl_indic14.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\aandachtspunten_dm\aandachtspunten_dm_medicatie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\aandachtspunten_dm\aandachtspunten_dm_hypertensie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\aandachtspunten_dm\aandachtspunten_dm_intensivering.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\aandachtspunten_dm\aandachtspunten_dm_glucoseverlagend.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\aandachtspunten_dm\aandachtspunten_dm_alb_kreat.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {{ ruiter_poh_seg2() }} {# KOPIE VAN proigia_zg_criteria_v3_std_ruiter_poh. Uitzondering proigia mee
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\aandachtspunten_dm\aandachtspunten_dm_ruiter_poh.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ab_stewardship\ab_stewardship_indicatoren_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ab_stewardship\ab_stewardship_indicatoren.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ab_stewardship\ab_stewardship_patientenlijst_ind_1_3.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ab_stewardship\ab_stewardship_patientenlijst_ind_4_8.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# kopie proigia_patienten_gegevens #}
SELECT
  patient_id,
  patientnummer,
  bsn,
  categorie,
  g
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ab_stewardship\ab_stewardship_pat_gegevens_alle_ingeschreven.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# kopie proigia_patienten_gegevens (ongeacht inschrijving) #}
SELECT
  *
FROM {{ ref('ab_stewardshi
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ab_stewardship\ab_stewardship_patienten_gegevens_vast.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Als fix clean_icpc door PCO (ticket nog aanmaken) op productie staat, dan de volgende subviews ve
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ab_stewardship\ab_stewardship_icpc_selectie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ab_stewardship\ab_stewardship_startdata_mandje_r.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ab_stewardship\ab_stewardship_mandje_r_gevuld.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ab_stewardship\ab_stewardship_mandje_r_naam.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ab_stewardship\ab_stewardship_startdata_mandje_u.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ab_stewardship\ab_stewardship_mandje_u_gevuld.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ab_stewardship\ab_stewardship_mandje_u_naam.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ab_stewardship\ab_stewardship_startdata_mandje_h.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ab_stewardship\ab_stewardship_mandje_h_gevuld.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ab_stewardship\ab_stewardship_mandje_h_naam.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ab_stewardship\ab_stewardship_startdata_mandje_s.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ab_stewardship\ab_stewardship_mandje_s_gevuld.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ab_stewardship\ab_stewardship_mandje_s_naam.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# kopie van proigia_medicatie_filter_ineen #}
SELECT
  patient_id,
  medicatie_id,
  voorschrijfdat
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ab_stewardship\ab_stewardship_medicatie_filter_j01.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ab_stewardship\ab_stewardship_einddatum.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ab_stewardship\ab_stewardship_chronisch_pre.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ab_stewardship\ab_stewardship_chronisch_einddata.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# In deze view wordt de fictieve kleinste einddatum van het gebruik bepaald, #} {# door alle startd
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ab_stewardship\ab_stewardship_chronisch_startdata.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Als het verschil (eerste datum gebruik - laatste datum gebruik) > 28, #} {# dan is het een chroni
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ab_stewardship\ab_stewardship_chronisch.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ab_stewardship\ab_stewardship_alle_ab_voorschriften.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ab_stewardship\ab_stewardship_ab_voorschriften_excl_chronisch.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ab_stewardship\ab_stewardship_mandjes_medicatie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\af_-_dokter_drenthe\af_53530556_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\af_-_dokter_drenthe\af_53530556_indic_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\af_-_dokter_drenthe\af_53530556_indic.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\af_-_dokter_drenthe\af_53530556_patientenlijst.sql

[ERROR] Failed to process af_53530556_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\selectierapport_cvrm_met_medzzo\amc_cvrm_medzzo_cvrm_patienten.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\selectierapport_cvrm_met_medzzo\amc_cvrm_meddzo_cvrm_bepaling.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\selectierapport_cvrm_met_medzzo\amc_cvrm_meddzo_cvrm_bepalingdatummax.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# opzoeken hoofdbehandelaar CVRM #}
SELECT
  b.patient_id,
  b.Geslacht,
  b.Leeftijd,
  b.Huisarts
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\selectierapport_cvrm_met_medzzo\amc_cvrm_meddzo_cvrm_behandelaar.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\selectierapport_cvrm_met_medzzo\amc_cvrm_medzzo_episode_icpcs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\selectierapport_cvrm_met_medzzo\amc_cvrm_medzzo_episodeinclusie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\selectierapport_cvrm_met_medzzo\amc_cvrm_medzzo_medicatie.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# maken tabel met icpc datums achter elkaar inclusie episodes #}
SELECT
  patient_id,
  icpc,
  oms
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\selectierapport_cvrm_met_medzzo\amc_cvrm_medzzo_episodelaatstedatum.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# aantal mensen die medicatie voorgeschreven krijgen #}
SELECT
  M.patient_id,
  CASE
    WHEN ATC_
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\selectierapport_cvrm_met_medzzo\amc_cvrm_medzzo_aantalmedicatie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\selectierapport_cvrm_met_medzzo\amc_cvrm_medzzo_episodemed.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\selectierapport_cvrm_met_medzzo\amc_cvrm_medzzo_cvrm_resultaat.sql

[ERROR] Failed to process analyse_medicatie_vvr_0_zorggroep_bepalen.pry: Invalid PRY format: 'queries:' section not found
[ERROR] Failed to process analyse_medicatie_vvr_1_periode.pry: Invalid PRY format: 'queries:' section not found
[ERROR] Failed to process analyse_medicatie_vvr_2_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\analyse_medicatie_vvr\analyse_medicatie_vvr_patient.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# vertaling zorggroepspecifieke wensen #}
SELECT
  zorggroep,
  CASE
    WHEN 53533096 = zorggroep

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\analyse_medicatie_vvr\analyse_medicatie_vvr_episode_vertaling.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\analyse_medicatie_vvr\analyse_medicatie_vvr_episode_keten.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# verzameling vertaalde episodes + vertaling ruwe episodes uit standaard #}
SELECT
  patient_id,
  
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\analyse_medicatie_vvr\analyse_medicatie_vvr_episode_verzamel.sql

[ERROR] Failed to process analyse_medicatie_vvr_53530004.pry: Invalid PRY format: 'queries:' section not found
[ERROR] Failed to process analyse_medicatie_vvr_53530007.pry: Invalid PRY format: 'queries:' section not found
[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# vertaling zorggroepspecifieke wensen #}
SELECT
  zorggroep,
  CASE
    WHEN 53530250 = zorggroep

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\analyse_medicatie_vvr\analyse_medicatie_vvr_meetwaarde_vertaling.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\analyse_medicatie_vvr\analyse_medicatie_vvr_meetwaarde_keten.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# verzameling vertaalde meetwaarden + vertaling ruwe meetwaarden uit standaard #}
SELECT
  patient_
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\analyse_medicatie_vvr\analyse_medicatie_vvr_meetwaarde_verzamel.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# vertaling zorggroepspecifieke wensen #}
SELECT
  zorggroep,
  ARRAY_CONSTRUCT('A10A%', 'A10B%') A
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\analyse_medicatie_vvr\analyse_medicatie_vvr_medicatie_vertaling.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\analyse_medicatie_vvr\analyse_medicatie_vvr_medicatie_filter_vertaling.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\analyse_medicatie_vvr\analyse_medicatie_vvr_medicatie_filter_keten.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\analyse_medicatie_vvr\analyse_medicatie_vvr_medicatie_keten.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW analyse_medicatie_vvr_medicatie_jaar AS

SELECT * FROM crosstab($$
    SELECT
        CONCAT(patient_id,zorggroep) AS unique_id,
        patient_id,
        zorggroep,
        categorie,
        ARRAY[
            count(*)::varchar,
            max(voorschrijfdatum)::varchar,
            min(voorschrijfdatum)::varchar,
            array_agg(distinct atc_code)::varchar,
            max(actueel)::varchar] as resultaat
    FROM analyse_medicatie_vvr_medicatie_filter_vertaling
    WHERE actief_jaar=1
    GROUP BY patient_id, zorggroep, categorie
    ORDER BY patient_id, zorggroep, categorie
$$,$$
    SELECT atc FROM proigia_atc_codes ORDER BY atc
$$) as
(
    unique_id varchar,
    patient_id bigint,
    zorggroep integer,
Converted crosstab SQL:

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\analyse_medicatie_vvr\analyse_medicatie_vvr_medicatie_jaar.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW analyse_medicatie_vvr_medicatie_jaar_ind_3_6 AS


SELECT * FROM crosstab($$
    SELECT
        CONCAT(patient_id,zorggroep) AS unique_id,
        patient_id,
        zorggroep,
        categorie,
        ARRAY[
            count(*)::varchar,
            max(voorschrijfdatum)::varchar,
            min(voorschrijfdatum)::varchar,
            array_agg(distinct atc_code)::varchar,
            max(actueel)::varchar] as resultaat
    FROM analyse_medicatie_vvr_medicatie_filter_vertaling
    WHERE actief_jaar_ind_3_6=1
    GROUP BY patient_id, zorggroep, categorie
    ORDER BY patient_id, zorggroep, categorie
$$,$$
    SELECT atc FROM proigia_atc_codes ORDER BY atc
$$) as
(
    unique_id varchar,
    patient_id bigint,
    zorggroep integer,
Converted crosstab SQL:

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\analyse_medicatie_vvr\analyse_medicatie_vvr_medicatie_jaar_ind_3_6.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW analyse_medicatie_vvr_medicatie_jaar_ind_4_7 AS


SELECT * FROM crosstab($$
    SELECT
        CONCAT(patient_id,zorggroep) AS unique_id,
        patient_id,
        zorggroep,
        categorie,
        ARRAY[
            count(*)::varchar,
            max(voorschrijfdatum)::varchar,
            min(voorschrijfdatum)::varchar,
            array_agg(distinct atc_code)::varchar,
            max(actueel)::varchar] as resultaat
    FROM analyse_medicatie_vvr_medicatie_filter_vertaling
    WHERE actief_jaar_ind_4_7=1
    GROUP BY patient_id, zorggroep, categorie
    ORDER BY patient_id, zorggroep, categorie
$$,$$
    SELECT atc FROM proigia_atc_codes ORDER BY atc
$$) as
(
    unique_id varchar,
    patient_id bigint,
    zorggroep integer,
Converted crosstab SQL:

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\analyse_medicatie_vvr\analyse_medicatie_vvr_medicatie_jaar_ind_4_7.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# verzameling vertaalde medicatie + vertaling ruwe medicatie uit standaard #}
SELECT
  patient_id,

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\analyse_medicatie_vvr\analyse_medicatie_vvr_medicatie_verzamel.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# ANALYSE MEDICATIE VVR IND 3, 6 #} {# verzameling vertaalde medicatie + vertaling ruwe medicatie u
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\analyse_medicatie_vvr\analyse_medicatie_vvr_medicatie_verzamel_ind_3_6.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# ANALYSE MEDICATIE VVR IND 4, 7 #} {# verzameling vertaalde medicatie + vertaling ruwe medicatie u
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\analyse_medicatie_vvr\analyse_medicatie_vvr_medicatie_verzamel_ind_4_7.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# View die als basis dient voor de keten_definitie views hierna #}
SELECT
  agb,
  zg_agb,
  zg_agb
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\analyse_medicatie_vvr\analyse_medicatie_vvr_keten_verzameltabel.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# ANALYSE MEDICATIE VVR IND 3, 6 #} {# View die als basis dient voor de keten_definitie views hiern
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\analyse_medicatie_vvr\analyse_medicatie_vvr_keten_verzameltabel_ind_3_6.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# ANALYSE MEDICATIE VVR IND 4, 7 #} {# View die als basis dient voor de keten_definitie views hiern
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\analyse_medicatie_vvr\analyse_medicatie_vvr_keten_verzameltabel_ind_4_7.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\analyse_medicatie_vvr\analyse_medicatie_vvr_keten_indicatie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\analyse_medicatie_vvr\analyse_medicatie_vvr_keten_patient.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\analyse_medicatie_vvr\analyse_medicatie_vvr_ketenzorg.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\analyse_medicatie_vvr\analyse_medicatie_vvr_doelgroep_dbc.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\analyse_medicatie_vvr\analyse_medicatie_vvr_keten_indicatie_ind_3_6.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\analyse_medicatie_vvr\analyse_medicatie_vvr_keten_patient_ind_3_6.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\analyse_medicatie_vvr\analyse_medicatie_vvr_ketenzorg_ind_3_6.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\analyse_medicatie_vvr\analyse_medicatie_vvr_doelgroep_dbc_ind_3_6.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\analyse_medicatie_vvr\analyse_medicatie_vvr_keten_indicatie_ind_4_7.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\analyse_medicatie_vvr\analyse_medicatie_vvr_keten_patient_ind_4_7.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\analyse_medicatie_vvr\analyse_medicatie_vvr_ketenzorg_ind_4_7.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\analyse_medicatie_vvr\analyse_medicatie_vvr_doelgroep_dbc_ind_4_7.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\analyse_medicatie_vvr\analyse_medicatie_vvr_vertaling.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\analyse_medicatie_vvr\analyse_medicatie_vvr_indicatoren_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\analyse_medicatie_vvr\analyse_medicatie_vvr_indicatoren.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\analyse_medicatie_vvr\analyse_medicatie_vvr_patientenlijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\artrose_-_rijn_en_duin\artrose_indicatoren_53530250_verzamel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\artrose_-_rijn_en_duin\artrose_indicatoren_53530250_ind_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\artrose_-_rijn_en_duin\artrose_indicatoren_53530250_ind.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\artrose_-_rijn_en_duin\artrose_indic_53530250_verwijzing.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\artrose_-_rijn_en_duin\artrose_indic_53530250_last_cont_pp.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\atriumfibrilleren\af_onderdelen_chadsvasc.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\atriumfibrilleren\af_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\atriumfibrilleren\af_patientenlijst_uitgebreid.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\atriumfibrilleren\af_patientenlijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\atriumfibrilleren\af_indicatoren_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\atriumfibrilleren\af_indicatoren.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\atriumfibrilleren\af_journaal_echocardio.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\berekende_risicoscore_op_hvz_-_hzw\berekende_risicoscore_hvz_53530008_verzamel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\berekende_risicoscore_op_hvz_-_hzw\berekende_risicoscore_hvz_53530008_ind_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\berekende_risicoscore_op_hvz_-_hzw\berekende_risicoscore_hvz_53530008_ind.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\berekende_risicoscore_op_hvz_-_hzw\berekende_risicoscore_hvz_53530008_pl_tussen.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\berekende_risicoscore_op_hvz_-_hzw\berekende_risicoscore_hvz_53530008_pl_ind.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\berekende_risicoscore_op_hvz_-_hzw\berekende_risicoscore_hvz_53530008_pl_rh24_berekend.sql

[ERROR] Failed to process berekende_risicoscore_hvz_53530008_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\bewegen_op_recept_indicatoren\bewegen_op_recept_verzameltabel_contacten.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\bewegen_op_recept_indicatoren\bewegen_op_recept_verzameltabel_meetwaarden.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\bewegen_op_recept_indicatoren\bewegen_op_recept_indicatoren_support.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\bewegen_op_recept_indicatoren\bewegen_op_recept_indicatoren_report.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\bewegen_op_recept_indicatoren\bewegen_op_recept_indicatoren_template.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\bewegen_op_recept_indicatoren\bewegen_op_recept_patienten_praktijk.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\bewegen_op_recept_indicatoren\bewegen_op_recept_meetwaarden.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\bewegen_op_recept_indicatoren\bewegen_op_recept_start.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\bewegen_op_recept_indicatoren\bewegen_op_recept_contacten.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\bewegen_op_recept_patientenlijst\bewegen_op_recept_pl_verzameltabel_contacten.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\bewegen_op_recept_patientenlijst\bewegen_op_recept_pl_verzameltabel_meetwaarden.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\bewegen_op_recept_patientenlijst\bewegen_op_recept_patientenlijst_patientenlijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\bewegen_op_recept_patientenlijst\bewegen_op_recept_pl_gegevens_bmi_labwaarden.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\bewegen_op_recept_patientenlijst\bewegen_op_recept_patientenlijst_gegevens_bewegen.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\bewegen_op_recept_patientenlijst\bewegen_op_recept_pl_gegevens_contacten.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\bewegen_op_recept_patientenlijst\bewegen_op_recept_pl_patienten_praktijk.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\bewegen_op_recept_patientenlijst\bewegen_op_recept_patientenlijst_meetwaarden.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\bewegen_op_recept_patientenlijst\bewegen_op_recept_patientenlijst_start.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\bewegen_op_recept_patientenlijst\bewegen_op_recept_patientenlijst_contacten.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\bewegingsapparaat_-_rijn_en_duin\bewegingsapparaat_indic_53530250_verzamel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\bewegingsapparaat_-_rijn_en_duin\bewegingsapparaat_indic_53530250_indic_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\bewegingsapparaat_-_rijn_en_duin\bewegingsapparaat_indic_53530250_indicatoren.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\bewegingsapparaat_-_rijn_en_duin\bewegingsapparaat_indic_53530250_patientenlijst.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# kopie van proigia_episode_filter #}
WITH pre_episode AS (
  SELECT
    episode_id,
    patient_id
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\bewegingsapparaat_-_rijn_en_duin\bewegingsapparaat_indic_53530250_episode_filter.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# kopie van proigia_icpc_codes #}
WITH icpc_codes AS (
  SELECT
    icpc
  FROM (VALUES
    ('L02%'
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\bewegingsapparaat_-_rijn_en_duin\bewegingsapparaat_indic_53530250_icpc_codes.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW bewegingsapparaat_indic_53530250_episode AS

SELECT * FROM crosstab($$
SELECT
    patient_id,
    name,
    ARRAY[min(begindatum)::varchar,
            max(einddatum)::varchar,
            max(status_datum)::varchar,
            max(status_vlag)::varchar,
            array_agg(distinct icpc)::varchar,
            max(begindatum)::varchar,
            min(einddatum)::varchar,
            min(begindatum_nonactief)::varchar,
            max(einddatum_nonactief)::varchar,
            max(begindatum_nonactief)::varchar,
            min(einddatum_nonactief)::varchar] as waardes
FROM bewegingsapparaat_indic_53530250_episode_filter
JOIN bewegingsapparaat_indic_53530250_icpc_codes ON icpc ILIKE searchstring
GROUP BY patient_id, name
ORDER BY patient_id, name
$$,$$
    SELECT name FROM bewegingsapparaat_indic_53530250_icpc_codes ORDER BY name;
$$) as ct(
    patient_id bigint,
    l02_ varchar[],
    l03_ varchar[]
);
Converted crosstab SQL:
WITH cte1 AS (

SELECT
    patient_id,
    name,
    ARRAY[min(begindatum)::varchar,
            max(einddatum)::varchar,
            max(status_datum)::varchar,
            max(status_vlag)::varchar,
            array_agg(distinct icpc)::varchar,
            max(begindatum)::varchar,
            min(einddatum)::varchar,
            min(begindatum_nonactief)::varchar,
            max(einddatum_nonactief)::varchar,
            max(begindatum_nonactief)::varchar,
            min(einddatum_nonactief)::varchar] as waardes
FROM {{ ref('bewegingsapparaat_indic_53530250_episode_filter') }}
JOIN {{ ref('bewegingsapparaat_indic_53530250_icpc_codes') }} ON icpc ILIKE searchstring
GROUP BY patient_id, name
ORDER BY patient_id, name

)
SELECT patient_id
, {{ dbt_utils.pivot('name',        dbt_utils.get_column_values(ref('bewegingsapparaat_indic_53530250_icpc_codes'),'categorie',default=[]),        agg='',        then_value='name',        else_value="ARRAY_CONSTRUCT()",        quote_identifiers=False)}} 
FROM cte1
GROUP BY patient_id
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\bewegingsapparaat_-_rijn_en_duin\bewegingsapparaat_indic_53530250_episode.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\bewegingsapparaat_-_rijn_en_duin\bewegingsapparaat_indic_53530250_verwijzing.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\bewegingsapparaat_-_rijn_en_duin\bewegingsapparaat_indic_53530250_retourinfo.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\bloedverdunners\bloedverdunners_onderdelen_chadsvasc.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\bloedverdunners\bloedverdunners_pf.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\bloedverdunners\bloedverdunners_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\bloedverdunners\bloedverdunners_patientenlijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\bloedverdunners\bloedverdunners_tussen.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\bloedverdunners\bloedverdunners_af_chadsvasc.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\bloedverdunners\bloedverdunners_hvz_geen_med.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\bloedverdunners\bloedverdunners_cva_tia.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\bloedverdunners\bloedverdunners_dubbele.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\bloedverdunners\bloedverdunners_geen_hvz_wel_med.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\bloedverdunners\bloedverdunners_nsaid.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\bloedverdunners\bloedverdunners_doac_egfr.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\bloedverdunners\bloedverdunners_maagbescherm.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\bloedverdunners\bloedverdunners_stollingspas_filter.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\bloedverdunners\bloedverdunners_indic_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\bloedverdunners\bloedverdunners_indic.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\bloedverdunners\bloedverdunners_medicaties.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\bloedverdunners\bloedverdunners_b01a.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\bloedverdunners\bloedverdunners_voorschrijver.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\bsn_en_stable_patient_id\bsn_stable_patient_id_verwijzen.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\chronische_nierschade_nhg_standaard_(2018)\cns_2018_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\chronische_nierschade_nhg_standaard_(2018)\cns_2018_indicatoren_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\chronische_nierschade_nhg_standaard_(2018)\cns_2018_indicatoren.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\chronische_nierschade_nhg_standaard_(2018)\cns_2018_pl_ruw.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\chronische_nierschade_nhg_standaard_(2018)\cns_2018_pl_cn.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\chronische_nierschade_nhg_standaard_(2018)\cns_2018_pl_geen_cns.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\chronische_nierschade_nhg_standaard_(2018)\cns_2018_pl_mild_verhoogd_risico.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\chronische_nierschade_nhg_standaard_(2018)\cns_2018_pl_matig_verhoogd_risico.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\chronische_nierschade_nhg_standaard_(2018)\cns_2018_pl_sterk_verhoogd_risico.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\chronische_nierschade_nhg_standaard_(2018)\cns_2018_pl_egfr_60.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\chronische_nierschade_nhg_standaard_(2018)\cns_2018_pl_egfr_60_nieuw.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\chronische_nierschade_nhg_standaard_(2018)\cns_2018_pl_progressie_nierfunctieverlies.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\chronische_nierschade_nhg_standaard_(2018)\cns_2018_pl_alb_zonder_ace_arb.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\chronische_nierschade_nhg_standaard_(2018)\cns_2018_pl_risico_hvz_z_ketenzorg.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\chronische_nierschade_nhg_standaard_(2018)\cns_2018_pl_cystatine_c_relevant.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\chronische_nierschade_nhg_standaard_(2018)\cns_2018_pl_screenen_nierfunctie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\chronische_nierschade_nhg_standaard_(2018)\cns_2018_pl_missende_icpc.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\chronische_nierschade_nhg_standaard_(2018)\cns_2018_pl_geen_controle.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\chronische_nierschade_nhg_standaard_(2018)\cns_2018_pl_geen_hb.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\chronische_nierschade_nhg_standaard_(2018)\cns_2018_pl_ci_ontbreekt.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\chronische_nierschade_nhg_standaard_(2018)\cns_2018_pl_rcns.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\chronische_nierschade_nhg_standaard_(2018)\cns_2018_pl_bloeddruk_niet_gereguleerd.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\chronische_nierschade_nhg_standaard_(2018)\cns_2018_pl_ldl_niet_gereguleerd.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\chronische_nierschade_nhg_standaard_(2018)\cns_2018_verzameltabel_3mt.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\chronische_nierschade_nhg_standaard_(2018)\cns_2018_meetwaarden_egfr_pre.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\chronische_nierschade_nhg_standaard_(2018)\cns_2018_meetwaarden_egfr.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\chronische_nierschade_nhg_standaard_(2018)\cns_2018_meetwaarden_egfr_eerste.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\chronische_nierschade_nhg_standaard_(2018)\cns_2018_meetwaarden_albk_u_mi_eerste.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\chronische_nierschade_nhg_standaard_(2018)\cns_2018_meetwaarden_egfr_daling_jaar.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\chronische_nierschade_nhg_standaard_(2018)\cns_2018_ci.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\chronische_nierschade_nhg_standaard_(2018)\cns_2018_apotheek.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\chronische_nierschade_nhg_standaard_(2018)\cns_2018_overgevoelig_ace.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# kopie van proigia_atc_codes #}
WITH atc_codes AS (
  SELECT
    atc
  FROM (VALUES
    ('A02BA'),
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\chronische_nierschade_nhg_standaard_(2018)\cns_2018_atc_codes_screening.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\chronische_nierschade_nhg_standaard_(2018)\cns_2018_medicatie_screening.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# kopie van proigia_atc_codes #}
WITH atc_codes AS (
  SELECT
    atc
  FROM (VALUES
    ('A10BA02'
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\chronische_nierschade_nhg_standaard_(2018)\cns_2018_atc_codes_oorzaak.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\chronische_nierschade_nhg_standaard_(2018)\cns_2018_medicatie_oorzaak.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\chronische_nierschade_nhg_standaard_(2018)\cns_2018_albuminurie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\chronische_nierschade_nhg_standaard_(2018)\cns_2018_albuminurie_matig.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\chronische_nierschade_nhg_standaard_(2018)\cns_2018_albuminurie_ernstig.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\chronische_nierschade_nhg_standaard_(2018)\cns_2018_verlaagd_egfr.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\chronische_nierschade_nhg_standaard_(2018)\cns_2018_normaal_egfr.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\chronische_nierschade_nhg_standaard_(2018)\cns_2018_mw_rh12_eerste.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# kopie van cvrm_2019_rrsy_alle #}
WITH meetwaarden_pre AS (
  SELECT
    patient_id,
    uitslag_w
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\chronische_nierschade_nhg_standaard_(2018)\cns_2018_rrsy_alle.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# kopie van cvrm_2019_rrsy_ka #}
WITH meetwaarden_pre AS (
  SELECT
    patient_id,
    CAST(uitsla
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\chronische_nierschade_nhg_standaard_(2018)\cns_2018_rrsy_ka.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# kopie van cvrm_2019_rrsy_gem #}
WITH meetwaarden_pre AS (
  SELECT
    patient_id,
    CAST(uitsl
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\chronische_nierschade_nhg_standaard_(2018)\cns_2018_rrsy_gem.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# kopie van cvrm_2019_ldl #}
WITH meetwaarden_pre AS (
  SELECT
    patient_id,
    CAST(uitslag_wa
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\chronische_nierschade_nhg_standaard_(2018)\cns_2018_ldl.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\chronische_nierschade_nhg_standaard_(2018)\cns_2018_patienten_gegevens_3mt.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\chronische_zorg_indicatoren_qlik\chronische_zorg_indicatoren_qlik_pl_dm.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\chronische_zorg_indicatoren_qlik\chronische_zorg_indicatoren_qlik_pl_copd.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\chronische_zorg_indicatoren_qlik\chronische_zorg_indicatoren_qlik_pl_astma.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\chronische_zorg_indicatoren_qlik\chronische_zorg_indicatoren_qlik_pl_hr.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\chronische_zorg_indicatoren_qlik\chronische_zorg_indicatoren_qlik_pl_zhr.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\chronische_zorg_indicatoren_qlik\chronische_zorg_indicatoren_qlik_pl_ouderenzorg.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\chronische_zorg_indicatoren_qlik\chronische_zorg_indicatoren_qlik_report_metadata.sql

[ERROR] Failed to process chronische_zorg_indicatoren_qlik_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\chronische_zorg_indicatoren_qlik_gez\chronische_zorg_indicatoren_qlik_pl_dm_gez.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\chronische_zorg_indicatoren_qlik_gez\chronische_zorg_indicatoren_qlik_pl_copd_gez.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\chronische_zorg_indicatoren_qlik_gez\chronische_zorg_indicatoren_qlik_pl_astma_gez.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\chronische_zorg_indicatoren_qlik_gez\chronische_zorg_indicatoren_qlik_pl_hr_gez.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\chronische_zorg_indicatoren_qlik_gez\chronische_zorg_indicatoren_qlik_pl_zhr_gez.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\chronische_zorg_indicatoren_qlik_gez\chronische_zorg_indicatoren_qlik_pl_ouderenzorg_gez.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\chronische_zorg_indicatoren_qlik_gez\chronische_zorg_indicatoren_qlik_report_metadata_gez.sql

[ERROR] Failed to process chronische_zorg_indicatoren_qlik_gez_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\contacten_per_icpc\contacten_per_icpc_patienten_gegevens.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# kopie van proigia_journaal_filter #}
WITH jr_clean AS (
  SELECT
    patient_id,
    journaal_id,
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\contacten_per_icpc\contacten_per_icpc_journaal_filter.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# kopie van proigia_contact #}
WITH icpc_context AS (
  SELECT
    patient_id,
    CAST(datumtijd A
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\contacten_per_icpc\contacten_per_icpc_contacten.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\contacten_per_icpc\contacten_per_icpc_lijst_telling_contacten.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\contacten_per_icpc\contacten_per_icpc_lijst_contacten.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\contacten_per_icpc\contacten_per_icpc_lijst_contacten_lege_icpc.sql

[ERROR] Failed to process controlelijst_cvrm_vvr_53530279_0492_0551_algemeen.pry: while scanning for the next token
found character '\t' that cannot start any token
  in "<unicode string>", line 6, column 1:
    	Deze controlelijst betreft een  ... 
    ^
[ERROR] Failed to process controlelijst_cvrm_vvr_53530279_0492_0551_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\covid-19_vaccinatie\covid_19_vaccinatie_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\covid-19_vaccinatie\covid_19_vaccinatie_pl.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\covid-19_vaccinatie\covid_19_vaccinatie_pl_12_59.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\covid-19_vaccinatie\covid_19_vaccinatie_pl_60.sql

[ERROR] Failed to process covid_19_vaccinatie_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\covid-19_versie_2021\covid_19_v2021_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\covid-19_versie_2021\covid_19_v2021_aantal_contacten_per_week_alle.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\covid-19_versie_2021\covid_19_v2021_aantal_contacten_per_week_covid.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\covid-19_versie_2021\covid_19_v2021_indicatoren_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\covid-19_versie_2021\covid_19_v2021_indicatoren.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# LET OP: Als je een kolom toevoegt aan de patientenlijst voor of tussen de episode kolommen moeten
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\covid-19_versie_2021\covid_19_v2021_patientenlijst.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# View bevat een top 15 van de MI verrichtingen gebasseerd op de MI verrichtingen uit 2019. #} {# G
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\covid-19_versie_2021\covid_19_v2021_verrichting_mi.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\covid-19_versie_2021\covid_19_v2021_verrichting_alg.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Hardcoded jaren moeten blijven staan. #}
WITH icpc_hoofdstukken AS (
  SELECT
    icpc_hoofdstuk 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\covid-19_versie_2021\covid_19_v2021_contacten_per_icpc.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\covid-19_versie_2021\covid_19_periode.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Hardcoded data moeten blijven staan. #} {# We kijken naar contacten in 2021. #}
SELECT
  *,
  CAS
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\covid-19_versie_2021\covid_19_v2021_contacten.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Hardcoded data moeten blijven staan. #}
SELECT
  CAST(a AS DATE) AS eind_periode,
  DATE(CAST(a A
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\covid-19_versie_2021\covid_19_v2021_weken.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\covid-19_versie_2021\covid_19_v2021_covid_alle_contacten_periode.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Kan niet op PB vanwege icpc_omschrijving #} {# Wel afgeleide van proigia_episode_filter voor opsc
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\covid-19_versie_2021\covid_19_v2021_episode_omschrijving_covid.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\covid-19_versie_2021\covid_19_v2021_covid_contacten_periode.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Hardcoded jaren moeten blijven staan. #}
WITH verrichting_pre AS (
  SELECT
    patient_id,
    C
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\covid-19_versie_2021\covid_19_v2021_verrichting_cat.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\covid-19_versie_2021\covid_19_v2021_meetwaarden.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\cvrm_nhg_standaard_(2019)\cvrm_2019_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\cvrm_nhg_standaard_(2019)\cvrm_2019_indicatoren_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\cvrm_nhg_standaard_(2019)\cvrm_2019_indicatoren.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\cvrm_nhg_standaard_(2019)\cvrm_2019_pl_ruw.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\cvrm_nhg_standaard_(2019)\cvrm_2019_pl_zeer_hoog_risico.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\cvrm_nhg_standaard_(2019)\cvrm_2019_pl_hoog_risico.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\cvrm_nhg_standaard_(2019)\cvrm_2019_pl_ldl_niet_gereguleerd_hvz.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\cvrm_nhg_standaard_(2019)\cvrm_2019_pl_stop_lipidenverlager.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\cvrm_nhg_standaard_(2019)\cvrm_2019_pl_kwets_ouderen_diast_70.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\cvrm_nhg_standaard_(2019)\cvrm_2019_pl_streefwaarde_bloeddruk.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\cvrm_nhg_standaard_(2019)\cvrm_2019_pl_ldl_niet_gereguleerd.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\cvrm_nhg_standaard_(2019)\cvrm_2019_pl_sec_hypertensie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\cvrm_nhg_standaard_(2019)\cvrm_2019_pl_n_gescreend_copd_jicht_reuma.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\cvrm_nhg_standaard_(2019)\cvrm_2019_pl_n_gescreend_ap_kanker.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\cvrm_nhg_standaard_(2019)\cvrm_2019_pl_n_gescreend_risicoprofiel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\cvrm_nhg_standaard_(2019)\cvrm_2019_pl_lijst_voor_apotheek.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\cvrm_nhg_standaard_(2019)\cvrm_2019_pl_ongewenste_medicatie_combi.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\cvrm_nhg_standaard_(2019)\cvrm_2019_pl_medicatie_optimalisatie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\cvrm_nhg_standaard_(2019)\cvrm_2019_chron_atc2.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\cvrm_nhg_standaard_(2019)\cvrm_2019_chron_atc3.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\cvrm_nhg_standaard_(2019)\cvrm_2019_chron_atc4.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\cvrm_nhg_standaard_(2019)\cvrm_2019_chron_atc.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\cvrm_nhg_standaard_(2019)\cvrm_2019_chron_recent_atc2.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\cvrm_nhg_standaard_(2019)\cvrm_2019_chron_recent_atc3.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\cvrm_nhg_standaard_(2019)\cvrm_2019_chron_recent_atc4.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\cvrm_nhg_standaard_(2019)\cvrm_2019_chron_recent_atc.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\cvrm_nhg_standaard_(2019)\cvrm_2019_atc_c03.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\cvrm_nhg_standaard_(2019)\cvrm_2019_atc_g03f.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\cvrm_nhg_standaard_(2019)\cvrm_2019_atc_m01.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\cvrm_nhg_standaard_(2019)\cvrm_2019_radiotherapie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\cvrm_nhg_standaard_(2019)\cvrm_2019_ldl.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\cvrm_nhg_standaard_(2019)\cvrm_2019_rrsy_alle.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\cvrm_nhg_standaard_(2019)\cvrm_2019_rrsy_ka.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\cvrm_nhg_standaard_(2019)\cvrm_2019_rrsy_gem.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\cvrm_nhg_standaard_(2019)\cvrm_2019_rrdi_ka.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\cvrm_nhg_standaard_(2019)\cvrm_2019_mw_ooit.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\cvrm_nhg_standaard_(2019)\cvrm_2019_contact_p19.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\declaratierapport_-_akelei\declaratierapport_53530467_pl.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\declaratierapport_-_akelei\declaratierapport_53530467_perc.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Uitleg bij de selectie: #} {# =============================================================== #} 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\declaratierapport_-_akelei\declaratierapport_53530467_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\dm_populatiemanagement\dm_popman_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\dm_populatiemanagement\dm_popman_indicatoren_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\dm_populatiemanagement\dm_popman_indicatoren.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\dm_populatiemanagement\dm_popman_pl_ruw.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\dm_populatiemanagement\dm_popman_pl_groen.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\dm_populatiemanagement\dm_popman_pl_oranje.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\dm_populatiemanagement\dm_popman_pl_rood.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\dm_populatiemanagement\dm_popman_verzamel_3mt.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\dm_populatiemanagement\dm_popman_rrsy_meetwaarden.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\dm_populatiemanagement\dm_popman_albuminurie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\dm_populatiemanagement\dm_popman_albuminurie_stijging.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\dm_populatiemanagement\dm_popman_retinopathie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\dm_populatiemanagement\dm_popman_retinopathie_epi.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\dm_populatiemanagement\dm_popman_contacten_1jr.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\dm_populatiemanagement\dm_popman_meetwaarden_egfr_daling_jaar.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\dm_populatiemanagement\dm_popman_patienten_gegevens_3mt.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# kopie van proigia_episode_filter #}
WITH pre_episode AS (
  SELECT
    episode_id,
    patient_id
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\dm_populatiemanagement\dm_popman_episode_filter_3mt.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# kopie van proigia_icpc_codes #}
WITH icpc_codes AS (
  SELECT
    icpc
  FROM (VALUES
    ('F83.0
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\dm_populatiemanagement\dm_popman_icpc_codes_3mt.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW dm_popman_episode_3mt AS

SELECT * FROM crosstab($$
    SELECT
        patient_id,
        name,
        ARRAY[min(begindatum)::varchar,
                max(einddatum)::varchar,
                max(status_datum)::varchar,
                max(status_vlag)::varchar,
                array_agg(distinct icpc)::varchar,
                max(begindatum)::varchar,
                min(einddatum)::varchar,
                min(begindatum_nonactief)::varchar,
                max(einddatum_nonactief)::varchar,
                max(begindatum_nonactief)::varchar,
                min(einddatum_nonactief)::varchar] as waardes
    FROM dm_popman_episode_filter_3mt
    JOIN dm_popman_icpc_codes_3mt ON icpc ilike searchstring
    GROUP BY patient_id, name
    ORDER BY patient_id, name
$$,$$
    SELECT name FROM dm_popman_icpc_codes_3mt ORDER BY name;
$$) as ct(
    patient_id bigint,
    t90_02 varchar[],
    t90_ varchar[],
    f83_01 varchar[]);
Converted crosstab SQL:
WITH cte1 AS (

    SELECT
        patient_id,
        name,
        ARRAY[min(begindatum)::varchar,
                max(einddatum)::varchar,
                max(status_datum)::varchar,
                max(status_vlag)::varchar,
                array_agg(distinct icpc)::varchar,
                max(begindatum)::varchar,
                min(einddatum)::varchar,
                min(begindatum_nonactief)::varchar,
                max(einddatum_nonactief)::varchar,
                max(begindatum_nonactief)::varchar,
                min(einddatum_nonactief)::varchar] as waardes
    FROM {{ ref('dm_popman_episode_filter_3mt') }}
    JOIN {{ ref('dm_popman_icpc_codes_3mt') }} ON icpc ilike searchstring
    GROUP BY patient_id, name
    ORDER BY patient_id, name

)
SELECT patient_id
, {{ dbt_utils.pivot('name',        dbt_utils.get_column_values(ref('dm_popman_icpc_codes_3mt'),'categorie',default=[]),        agg='',        then_value='name',        else_value="ARRAY_CONSTRUCT()",        quote_identifiers=False)}} 
FROM cte1
GROUP BY patient_id
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\dm_populatiemanagement\dm_popman_episode_3mt.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\dm_populatiemanagement\dm_popman_labcodes_3mt.sql

[WARNING] SQL was not modified during conversion
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\dm_populatiemanagement\dm_popman_meetwaarden_filter_3mt.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW dm_popman_meetwaarden_3mt AS
SELECT * FROM crosstab(
$$
    SELECT DISTINCT ON (patient_id, nhgnr)
        patient_id,
        nhgnr,
        ARRAY[  uitslag_raw,
                datum::varchar,
                uitslag_waarde] as waarde_datum
    FROM dm_popman_meetwaarden_filter_3mt
    JOIN dm_popman_labcodes_3mt USING (nhgnr)
    ORDER BY patient_id, nhgnr, datum DESC, uitslag_num DESC nulls last,
            uitslag_raw nulls last, uitslag_waarde nulls last
$$,$$
    SELECT nhgnr
    FROM indelingen.nhg_labcodes
    JOIN dm_popman_labcodes_3mt USING (nhgnr)
    ORDER BY nhgnr
$$
) as ct(
patient_id bigint,
alb_u varchar[],
alb_ue_mt varchar[],
albk_u_mi varchar[],
hbap_b varchar[],
hbac_b varchar[],
hbap_b_po varchar[],
ldl_b varchar[],
ldld_b varchar[],
krea_o_mk varchar[],
krec_o_fb varchar[],
krem_o_fb varchar[],
rrsy_ka varchar[],
rrsy_ka_mh varchar[],
egfc_o_fb varchar[],
egcc_o_fb varchar[]);
Unsupported JOIN found in pivot_statement.
Converted crosstab SQL:

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\dm_populatiemanagement\dm_popman_meetwaarden_3mt.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\dm_populatiemanagement\dm_popman_atc_codes_3mt.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\dm_populatiemanagement\dm_popman_medicatie_filter_3mt.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW dm_popman_medicatie_3mt AS
SELECT * FROM crosstab($$
    SELECT
        patient_id,
        categorie,
        ARRAY[
            count(*)::varchar,
            max(voorschrijfdatum)::varchar,
            min(voorschrijfdatum)::varchar,
            array_agg(distinct atc_code)::varchar
            ] as resultaat
    FROM dm_popman_medicatie_filter_3mt
    GROUP BY patient_id, categorie
    ORDER BY patient_id, categorie
$$,$$
    SELECT atc FROM dm_popman_atc_codes_3mt ORDER BY atc
$$) as
(
    patient_id bigint,
    a10a varchar[],
    c10 varchar[]);
Converted crosstab SQL:
WITH cte1 AS (

    SELECT
        patient_id,
        categorie,
        ARRAY[
            count(*)::varchar,
            max(voorschrijfdatum)::varchar,
            min(voorschrijfdatum)::varchar,
            array_agg(distinct atc_code)::varchar
            ] as resultaat
    FROM {{ ref('dm_popman_medicatie_filter_3mt') }}
    GROUP BY patient_id, categorie
    ORDER BY patient_id, categorie

)
SELECT patient_id
, {{ dbt_utils.pivot('atc',        dbt_utils.get_column_values(ref('dm_popman_atc_codes_3mt'),'categorie',default=[]),        agg='',        then_value='categorie',        else_value="ARRAY_CONSTRUCT()",        quote_identifiers=False)}} 
FROM cte1
GROUP BY patient_id
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\dm_populatiemanagement\dm_popman_medicatie_3mt.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\dm_populatiemanagement\dm_popman_rrsy_meetwaarden_3mt.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\dm_populatiemanagement\dm_popman_albuminurie_3mt.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\dm_populatiemanagement\dm_popman_albuminurie_stijging_3mt.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\dm_populatiemanagement\dm_popman_retinopathie_3mt.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\dm_populatiemanagement\dm_popman_retinopathie_epi_3mt.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\dm_populatiemanagement\dm_popman_contacten_1jr_3mt.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\dm_populatiemanagement\dm_popman_meetwaarden_egfr_daling_jaar_3mt.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\doelmatig_voorschrijven\doelmatig_voorschrijven_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\doelmatig_voorschrijven\doelmatig_voorschrijven_dm_indic.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\doelmatig_voorschrijven\doelmatig_voorschrijven_dm_indicatoren.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\doelmatig_voorschrijven\doelmatig_voorschrijven_copd_indic.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\doelmatig_voorschrijven\doelmatig_voorschrijven_copd_indicatoren.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\doelmatig_voorschrijven\doelmatig_voorschrijven_dm_indic_vgz_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\doelmatig_voorschrijven\doelmatig_voorschrijven_dm_indic_vgz.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\doelmatig_voorschrijven\doelmatig_voorschrijven_copd_indic_vgz_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\doelmatig_voorschrijven\doelmatig_voorschrijven_copd_indic_vgz.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\doelmatig_voorschrijven\doelmatig_voorschrijven_pl_dm.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\doelmatig_voorschrijven\doelmatig_voorschrijven_pl_copd.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\doelmatig_voorschrijven\doelm_voorschr_insuline.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\doelmatig_voorschrijven\doelm_voorschr_medicatie_huidig.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\doelmatig_voorschrijven\doelm_voorschr_medicatie_oud.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\doelmatig_voorschrijven\doelm_voorschr_medicatie_nieuw.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# In onderstaande view tonen we in een ARRAY ieder uniek voorschrift o.b.c. de ATC code + omschrijv
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\doelmatig_voorschrijven\doelm_voorschr_medicatie_array.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\doelmatig_voorschrijven\doelm_voorschr_medicatie_huidig_12mnd.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\doelmatig_voorschrijven\doelm_voorschr_medicatie_oud_12mnd.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\doelmatig_voorschrijven\doelm_voorschr_medicatie_nieuw_12mnd.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\doorleveren_data_giantt_project\doorleveren_data_giantt_project_patient.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\doorleveren_data_giantt_project\doorleveren_data_giantt_project_metadata.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\doorleveren_data_giantt_project\doorleveren_data_giantt_project_bepaling.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\doorleveren_data_giantt_project\doorleveren_data_giantt_project_episode.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\doorleveren_data_giantt_project\doorleveren_data_giantt_project_medicatie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\doorleveren_data_giantt_project\doorleveren_data_giantt_project_praktijk.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {#  LET OP: bij aanpassingen ook het rapport "GPRI: COPD comorbidities" aanpassen #}
WITH vertaling 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\doorleveren_data_gpri_copd_comorbidities\doorleveren_data_gpri_cc_verzamel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\doorleveren_data_gpri_copd_comorbidities\doorleveren_data_gpri_cc_pl.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\doorleveren_data_gpri_copd_comorbidities\doorleveren_data_gpri_cc_pl_astma.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\doorleveren_data_gpri_copd_comorbidities\doorleveren_data_gpri_cc_pl_pneumonie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\doorleveren_data_gpri_copd_comorbidities\doorleveren_data_gpri_cc_pl_osteoporose.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\doorleveren_data_gpri_copd_comorbidities\doorleveren_data_gpri_cc_pl_dm.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\doorleveren_data_gpri_copd_comorbidities\doorleveren_data_gpri_cc_pl_bronchiectasieen.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\doorleveren_data_gpri_copd_comorbidities\doorleveren_data_gpri_cc_pl_tuberculose.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\doorleveren_data_gpri_copd_comorbidities\doorleveren_data_gpri_cc_pl_vermind_nierfunctie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\doorleveren_data_gpri_copd_comorbidities\doorleveren_data_gpri_cc_pl_prostaat.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\doorleveren_data_gpri_copd_comorbidities\doorleveren_data_gpri_cc_pl_ritmestoornissen.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\doorleveren_data_gpri_copd_comorbidities\doorleveren_data_gpri_cc_pl_glaucoom_ics.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\doorleveren_data_gpri_copd_comorbidities\doorleveren_data_gpri_cc_pl_glaucoom_lama.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\doorleveren_data_gpri_copd_comorbidities\doorleveren_data_gpri_cc_ind.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Kopie van proigia_patienten_gegevens #} {# Afwijking: extractiedatum ipv peildatum #}
CREATE VIEW
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\doorleveren_data_gpri_copd_comorbidities\doorleveren_data_gpri_cc_patienten_gegevens.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Kopie van proigia_episode_filter #} {# Afwijking: extractiedatum ipv peildatum #}
CREATE VIEW doo
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\doorleveren_data_gpri_copd_comorbidities\doorleveren_data_gpri_cc_episode_filter.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Kopie van proigia_icpc_codes #} {# Afwijking: extractiedatum ipv peildatum #}
WITH icpc_codes AS 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\doorleveren_data_gpri_copd_comorbidities\doorleveren_data_gpri_cc_icpc_codes.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW doorleveren_data_gpri_cc_episode AS


SELECT * FROM crosstab($$
    SELECT
        patient_id,
        name,
        ARRAY[min(begindatum)::varchar,
                max(einddatum)::varchar,
                max(status_datum)::varchar,
                max(status_vlag)::varchar,
                array_agg(distinct icpc)::varchar,
                max(begindatum)::varchar,
                min(einddatum)::varchar,
                min(begindatum_nonactief)::varchar,
                max(einddatum_nonactief)::varchar,
                max(begindatum_nonactief)::varchar,
                min(einddatum_nonactief)::varchar] AS waardes
    FROM doorleveren_data_gpri_cc_episode_filter
    JOIN doorleveren_data_gpri_cc_icpc_codes ON icpc ilike searchstring
    GROUP BY patient_id, name
    ORDER BY patient_id, name
$$,$$
    SELECT name FROM doorleveren_data_gpri_cc_icpc_codes ORDER BY name;
$$) AS ct(
    patient_id bigint,
    a70_ varchar[],
    a91_05 varchar[],
    f93_ varchar[],
    k04_ varchar[],
    k05_ varchar[],
    k78_ varchar[],
    k79_ varchar[],
    k80_ varchar[],
    k84_02 varchar[],
    l95 varchar[],
    l95_01 varchar[],
    l95_02 varchar[],
    r70_ varchar[],
    r81_ varchar[],
    r91 varchar[],
    r91_02 varchar[],
    r95_ varchar[],
    r96 varchar[],
    r96_02 varchar[],
    t90_ varchar[],
    u05_02 varchar[],
    u99_01 varchar[],
    y06_ varchar[]);
Converted crosstab SQL:
WITH cte1 AS (

    SELECT
        patient_id,
        name,
        ARRAY[min(begindatum)::varchar,
                max(einddatum)::varchar,
                max(status_datum)::varchar,
                max(status_vlag)::varchar,
                array_agg(distinct icpc)::varchar,
                max(begindatum)::varchar,
                min(einddatum)::varchar,
                min(begindatum_nonactief)::varchar,
                max(einddatum_nonactief)::varchar,
                max(begindatum_nonactief)::varchar,
                min(einddatum_nonactief)::varchar] AS waardes
    FROM {{ ref('doorleveren_data_gpri_cc_episode_filter') }}
    JOIN {{ ref('doorleveren_data_gpri_cc_icpc_codes') }} ON icpc ilike searchstring
    GROUP BY patient_id, name
    ORDER BY patient_id, name

)
SELECT patient_id
, {{ dbt_utils.pivot('name',        dbt_utils.get_column_values(ref('doorleveren_data_gpri_cc_icpc_codes'),'categorie',default=[]),        agg='',        then_value='name',        else_value="ARRAY_CONSTRUCT()",        quote_identifiers=False)}} 
FROM cte1
GROUP BY patient_id
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\doorleveren_data_gpri_copd_comorbidities\doorleveren_data_gpri_cc_episode.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {#  Kopie van proigia_labcodes #}
{#  Afwijking: extractiedatum ipv peildatum #}
SELECT
    AS
  FRO
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\doorleveren_data_gpri_copd_comorbidities\doorleveren_data_gpri_cc_labcodes.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {#  Kopie van proigia_meetwaarden_filter #}
{#  Afwijking: extractiedatum ipv peildatum #}
WITH nhgn
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\doorleveren_data_gpri_copd_comorbidities\doorleveren_data_gpri_cc_meetwaarden_filter.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW doorleveren_data_gpri_cc_meetwaarden AS


SELECT * FROM crosstab(
$$
    SELECT DISTINCT ON (patient_id, nhgnr)
        patient_id,
        nhgnr,
        ARRAY[  uitslag_raw,
                datum::varchar,
                uitslag_waarde] AS waarde_datum
    FROM doorleveren_data_gpri_cc_meetwaarden_filter
    JOIN doorleveren_data_gpri_cc_labcodes USING (nhgnr)
    ORDER BY patient_id, nhgnr, datum DESC, uitslag_num DESC nulls last,
            uitslag_raw nulls last, uitslag_waarde nulls last
$$,$$
    SELECT nhgnr
    FROM indelingen.nhg_labcodes
    JOIN doorleveren_data_gpri_cc_labcodes USING (nhgnr)
    ORDER BY nhgnr
$$
) AS ct(
patient_id bigint,
eo_b_mt varchar[],
cohb_rz varchar[],
glup_bc_nu varchar[],
glup_bc_nn varchar[],
hbap_b_po varchar[],
eo_b_po varchar[]);
Unsupported JOIN found in pivot_statement.
Converted crosstab SQL:

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\doorleveren_data_gpri_copd_comorbidities\doorleveren_data_gpri_cc_meetwaarden.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\doorleveren_data_gpri_copd_comorbidities\doorleveren_data_gpri_cc_bepalingen.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Kopie van proigia_medicatie_filter #} {# Afwijking 1: toevoeging atc_omschrijving #} {# Afwijking
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\doorleveren_data_gpri_copd_comorbidities\doorleveren_data_gpri_cc_medicatie_filter.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW doorleveren_data_gpri_cc_medicatie AS



SELECT * FROM crosstab($$
    SELECT
        patient_id,
        categorie,
        ARRAY[
            COUNT(*)::varchar,
            MAX(voorschrijfdatum)::varchar,
            MIN(voorschrijfdatum)::varchar,
            array_agg(DISTINCT atc_code)::varchar,
            array_agg(DISTINCT atc_omschrijving)::varchar
            ] AS resultaat
    FROM doorleveren_data_gpri_cc_medicatie_filter
    GROUP BY patient_id, categorie
    ORDER BY patient_id, categorie
$$,$$
    SELECT atc FROM gpri_copd_comorbidities_atc_codes ORDER BY atc
$$) AS
(
    patient_id bigint,
    r03a varchar[],
    r03ac02 varchar[],
    r03ac03 varchar[],
    r03ac12 varchar[],
    r03ac13 varchar[],
    r03ac18 varchar[],
    r03ac19 varchar[],
    r03ak varchar[],
    r03ak06 varchar[],
    r03ak07 varchar[],
    r03ak08 varchar[],
    r03ak10 varchar[],
    r03ak11 varchar[],
    r03ak12 varchar[],
    r03al varchar[],
    r03al01 varchar[],
    r03al02 varchar[],
    r03al03 varchar[],
    r03al04 varchar[],
    r03al05 varchar[],
    r03al06 varchar[],
    r03al08 varchar[],
    r03al09 varchar[],
    r03al10 varchar[],
    r03al11 varchar[],
    r03al12 varchar[],
    r03ba varchar[],
    r03ba01 varchar[],
    r03ba02 varchar[],
    r03ba05 varchar[],
    r03ba08 varchar[],
    r03bb varchar[],
    r03bb01 varchar[],
    r03bb02 varchar[],
    r03bb04 varchar[],
    r03bb05 varchar[],
    r03bb06 varchar[],
    r03bb07 varchar[],
    r03bb09 varchar[]
    );
Converted crosstab SQL:
WITH cte1 AS (

    SELECT
        patient_id,
        categorie,
        ARRAY[
            COUNT(*)::varchar,
            MAX(voorschrijfdatum)::varchar,
            MIN(voorschrijfdatum)::varchar,
            array_agg(DISTINCT atc_code)::varchar,
            array_agg(DISTINCT atc_omschrijving)::varchar
            ] AS resultaat
    FROM {{ ref('doorleveren_data_gpri_cc_medicatie_filter') }}
    GROUP BY patient_id, categorie
    ORDER BY patient_id, categorie

)
SELECT patient_id
, {{ dbt_utils.pivot('atc',        dbt_utils.get_column_values(ref('gpri_copd_comorbidities_atc_codes'),'categorie',default=[]),        agg='',        then_value='categorie',        else_value="ARRAY_CONSTRUCT()",        quote_identifiers=False)}} 
FROM cte1
GROUP BY patient_id
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\doorleveren_data_gpri_copd_comorbidities\doorleveren_data_gpri_cc_medicatie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\doorleveren_data_gpri_copd_comorbidities\doorleveren_data_gpri_cc_medicatie_s01e.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW doorleveren_data_gpri_cc_dubbele_hb AS



SELECT * FROM crosstab($$
WITH alle_hb AS
(
    SELECT
        patient_id,
        memo,
        datum,
        uitslag_waarde
    FROM doorleveren_data_gpri_cc_meetwaarden_filter
    WHERE nhgnr IN (2407)
    ORDER BY patient_id, memo, uitslag_waarde, datum desc
),
grouping_uitslagen AS
(
    SELECT
        patient_id,
        memo,
        datum,
        array_agg(distinct uitslag_waarde) FILTER (WHERE uitslag_waarde IS NOT NULL) as uitslagen
    FROM alle_hb
    GROUP BY patient_id, memo, datum
)
SELECT distinct on (patient_id, memo)
    patient_id,
    memo||'_db',
    ARRAY[CASE WHEN array_length(uitslagen, 1) > 1 THEN 1 ELSE 0 END::varchar,
            datum::varchar, uitslagen::varchar] as dubbel
FROM grouping_uitslagen
ORDER BY patient_id, memo, datum desc
$$,$$
SELECT
    memo||'_db'
FROM indelingen.nhg_labcodes
JOIN doorleveren_data_gpri_cc_labcodes USING (nhgnr)
WHERE omschrijving ilike '%hoofdbehandelaar%'
ORDER BY memo
$$) as ct(
    patient_id bigint,
    cohb_db varchar[]
);
Unsupported JOIN found in pivot_statement.
Converted crosstab SQL:

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\doorleveren_data_gpri_copd_comorbidities\doorleveren_data_gpri_cc_dubbele_hb.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\doorleveren_data_intercity_1.1\intercity_1_1_metadata.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\doorleveren_data_intercity_1.1\intercity_1_1_praktijk.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\doorleveren_data_intercity_1.1\intercity_1_1_patient.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\doorleveren_data_intercity_1.1\intercity_1_1_contraindicatie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\doorleveren_data_intercity_1.1\intercity_1_1_allergie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\doorleveren_data_intercity_1.1\intercity_1_1_medewerker.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\doorleveren_data_intercity_1.1\intercity_1_1_episode.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\doorleveren_data_intercity_1.1\intercity_1_1_ruiter.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\doorleveren_data_intercity_1.1\intercity_1_1_verwijzing.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\doorleveren_data_intercity_1.1\intercity_1_1_verrichting.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\doorleveren_data_intercity_1.1\intercity_1_1_bepaling.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\doorleveren_data_intercity_1.1\intercity_1_1_contact.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\doorleveren_data_intercity_1.1\intercity_1_1_journaal.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\doorleveren_data_intercity_1.1\intercity_1_1_journaalregel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\doorleveren_data_intercity_1.1\intercity_1_1_medicatie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\doorleveren_data_intercity_1.1\intercity_1_1_weigeraars.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\doorleveren_data_intercity_2.0\intercity_2_metadata.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\doorleveren_data_intercity_2.0\intercity_2_patient.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\doorleveren_data_intercity_2.0\intercity_2_praktijk.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\doorleveren_data_intercity_2.0\intercity_2_medewerker.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\doorleveren_data_intercity_2.0\intercity_2_allergie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\doorleveren_data_intercity_2.0\intercity_2_bepaling.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\doorleveren_data_intercity_2.0\intercity_2_contact.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\doorleveren_data_intercity_2.0\intercity_2_contraindicatie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\doorleveren_data_intercity_2.0\intercity_2_episode.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\doorleveren_data_intercity_2.0\intercity_2_journaal.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\doorleveren_data_intercity_2.0\intercity_2_journaalregel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\doorleveren_data_intercity_2.0\intercity_2_medicatie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\doorleveren_data_intercity_2.0\intercity_2_ruiter.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\doorleveren_data_intercity_2.0\intercity_2_verrichting.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\doorleveren_data_intercity_2.0\intercity_2_verwijzing.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\doorleveren_data_intercity_2.0\intercity_2_weigeraars.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\doorleveren_data_intercity_2.0\intercity_2_declaratie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\doorleveren_ipci_pseudoniemen_1.0\erasmusmc_ipci_zorgttp.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\rapportage_doorgeleverde_patienten_intercity\doorleveren_intercity_patienten.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\rapportage_doorgeleverde_patienten_intercity\doorleveren_intercity_weigeraars.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\rapportage_doorgeleverde_patienten_intercity\doorleveren_intercity_metadata.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\filtertool_v2.0\filter_v2_0_last_cont_pp.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\filtertool_v2.0\filter_v2_0_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\filtertool_v2.0\filter_v2_0_patientenlijst.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# kopie van proigia_atc_codes #}
WITH atc_codes AS (
  SELECT
    atc
  FROM (VALUES
    ('A10A'),

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\filtertool_v2.0\filter_v2_0_atc_codes.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# kopie van proigia_medicatie_filter #}
SELECT
  patient_id,
  atc AS categorie,
  voorschrijfdatum
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\filtertool_v2.0\filter_v2_0_medicatie_filter_ooit.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW filter_v2_0_medicatie_ooit AS

SELECT * FROM crosstab($$
    SELECT
        patient_id,
        categorie,
        ARRAY[
            count(*)::varchar,
            max(voorschrijfdatum)::varchar,
            min(voorschrijfdatum)::varchar,
            array_agg(distinct atc_code)::varchar
            ] as resultaat
    FROM filter_v2_0_medicatie_filter_ooit
    GROUP BY patient_id, categorie
    ORDER BY patient_id, categorie
$$,$$
    SELECT atc FROM filter_v2_0_atc_codes ORDER BY atc
$$) as
(
    patient_id  bigint,
    a10a        varchar[],
    a10b        varchar[],
    b01         varchar[],
    c02         varchar[],
    c03         varchar[],
    c03aa03     varchar[],
    c03ea01     varchar[],
    c04         varchar[],
    c05         varchar[],
    c07         varchar[],
    c07bb02     varchar[],
    c07bb07     varchar[],
    c07bb52     varchar[],
    c08         varchar[],
    c08ga02     varchar[],
    c09         varchar[],
    c09ba01     varchar[],
    c09ba02     varchar[],
    c09ba03     varchar[],
    c09ba05     varchar[],
    c09ba06     varchar[],
    c09ba09     varchar[],
    c09bx03     varchar[],
    c09da01     varchar[],
    c09da02     varchar[],
    c09da03     varchar[],
    c09da04     varchar[],
    c09da06     varchar[],
    c09da07     varchar[],
    c09da08     varchar[],
    c09dx01     varchar[],
    c09dx03     varchar[],
    c09xa52     varchar[],
    c09xa54     varchar[],
    c10         varchar[],
    c10aa       varchar[],
    n06a        varchar[],
    r03a        varchar[],
    r03ak06     varchar[],
    r03ak07     varchar[],
    r03ak08     varchar[],
    r03ak09     varchar[],
    r03ak10     varchar[],
    r03ak11     varchar[],
    r03ak12     varchar[],
    r03ba       varchar[],
    r03bb       varchar[]);
Converted crosstab SQL:
WITH cte1 AS (

    SELECT
        patient_id,
        categorie,
        ARRAY[
            count(*)::varchar,
            max(voorschrijfdatum)::varchar,
            min(voorschrijfdatum)::varchar,
            array_agg(distinct atc_code)::varchar
            ] as resultaat
    FROM {{ ref('filter_v2_0_medicatie_filter_ooit') }}
    GROUP BY patient_id, categorie
    ORDER BY patient_id, categorie

)
SELECT patient_id
, {{ dbt_utils.pivot('atc',        dbt_utils.get_column_values(ref('filter_v2_0_atc_codes'),'categorie',default=[]),        agg='',        then_value='categorie',        else_value="ARRAY_CONSTRUCT()",        quote_identifiers=False)}} 
FROM cte1
GROUP BY patient_id
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\filtertool_v2.0\filter_v2_0_medicatie_ooit.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\filtertool_v2.0\filter_v2_0_rookmeetwaarden.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\filtertool_v2.0\filter_v2_0_achterstandswijk.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\filtertool_v2.0\filter_v2_0_contact.sql

[ERROR] Failed to process ggz_53530495_algemeen.pry: while scanning for the next token
found character '\t' that cannot start any token
  in "<unicode string>", line 3, column 86:
     ...  voor gegevens over het beleid."			
                                         ^
[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Kopie van proigia_patienten_gegevens. #} {# Rapport gebruikt een eigen patient view vanwege de st
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz_-_marne\ggz_53530495_patient.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# LET OP ER STAAT EEN VASTE DATUM IN VAN 1-1-2017. DEZE LATEN STAAN IVM STARTEN ZORGPROGRAMMA #}
WI
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz_-_marne\ggz_53530495_episodes_e_regel_soep.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# LET OP ER STAAT EEN VASTE DATUM IN VAN 1-1-2017. DEZE LATEN STAAN IVM STARTEN ZORGPROGRAMMA. #} {
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz_-_marne\ggz_53530495_episodes_o_p_regel_soep.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# LET OP ER STAAT EEN VASTE DATUM IN VAN 1-1-2017. DEZE LATEN STAAN IVM STARTEN ZORGPROGRAMMA. #} {
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz_-_marne\ggz_53530495_medicatie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz_-_marne\ggz_53530495_episode_filter.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz_-_marne\ggz_53530495_icpc_codes.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW ggz_53530495_episode AS
SELECT * FROM crosstab($$
    SELECT
        patient_id,
        name,
        ARRAY[min(begindatum)::varchar,
                max(einddatum)::varchar,
                max(status_datum)::varchar,
                max(status_vlag)::varchar,
                array_agg(distinct icpc)::varchar,
                max(begindatum)::varchar,
                min(einddatum)::varchar,
					max(actief_afgelopen_jaar)::varchar,
                max(actief_afgelopen_periode)::varchar] as waardes
    FROM ggz_53530495_episode_filter
    JOIN ggz_53530495_icpc_codes ON icpc ilike searchstring
    GROUP BY patient_id, name
    ORDER BY patient_id, name
$$,$$
    SELECT name FROM ggz_53530495_icpc_codes ORDER BY name
$$) as ct(
    patient_id bigint,
    p01_ varchar[],
    p02 varchar[],
    p02_01 varchar[],
    p03_ varchar[],
    p29_ varchar[],
    p74 varchar[],
    p74_01 varchar[],
    p74_02 varchar[],
		p76_ varchar[],
		p78_ varchar[],
		p99_ varchar[],
		z29_01 varchar[]
);
Converted crosstab SQL:
WITH cte1 AS (

    SELECT
        patient_id,
        name,
        ARRAY[min(begindatum)::varchar,
                max(einddatum)::varchar,
                max(status_datum)::varchar,
                max(status_vlag)::varchar,
                array_agg(distinct icpc)::varchar,
                max(begindatum)::varchar,
                min(einddatum)::varchar,
					max(actief_afgelopen_jaar)::varchar,
                max(actief_afgelopen_periode)::varchar] as waardes
    FROM {{ ref('ggz_53530495_episode_filter') }}
    JOIN {{ ref('ggz_53530495_icpc_codes') }} ON icpc ilike searchstring
    GROUP BY patient_id, name
    ORDER BY patient_id, name

)
SELECT patient_id
, {{ dbt_utils.pivot('name',        dbt_utils.get_column_values(ref('ggz_53530495_icpc_codes'),'categorie',default=[]),        agg='',        then_value='name',        else_value="ARRAY_CONSTRUCT()",        quote_identifiers=False)}} 
FROM cte1
GROUP BY patient_id
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz_-_marne\ggz_53530495_episode.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz_angst_en_depressie_-_rijn_en_duin\ggz_angst_depressie_indic_verzamel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz_angst_en_depressie_-_rijn_en_duin\ggz_angst_depressie_indic_depressie_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz_angst_en_depressie_-_rijn_en_duin\ggz_angst_depressie_indic_depressie_indicatoren.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz_angst_en_depressie_-_rijn_en_duin\ggz_angst_depressie_indic_angst_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz_angst_en_depressie_-_rijn_en_duin\ggz_angst_depressie_indic_angst_indicatoren.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz_angst_en_depressie_-_rijn_en_duin\ggz_angst_depressie_indic_depressie_pl.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz_angst_en_depressie_-_rijn_en_duin\ggz_angst_depressie_indic_angst_pl.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: CREATE VIEW ggz_angst_depressie_indic_journaal_filter
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz_angst_en_depressie_-_rijn_en_duin\ggz_angst_depressie_indic_journaal_filter.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {#  kopie van proigia_contact #}
WITH icpc_context AS
(
    SELECT
        patient_id,
        datum
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz_angst_en_depressie_-_rijn_en_duin\ggz_angst_depressie_indic_contact.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz_angst_en_depressie_-_rijn_en_duin\ggz_angst_depressie_indic_contact_icpc.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz_angst_en_depressie_-_rijn_en_duin\ggz_angst_depressie_indic_jp_episode.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz_angst_en_depressie_-_rijn_en_duin\ggz_angst_depressie_indic_verrichting.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz_angst_en_depressie_-_rijn_en_duin\ggz_angst_depressie_indic_verwijzing.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_jeugd\ggz_basis_jeugd_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_jeugd\ggz_basis_jeugd_indic_start.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_jeugd\ggz_basis_jeugd_pl_pre.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_jeugd\ggz_basis_jeugd_pl_verdachten.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_jeugd\ggz_basis_jeugd_pl_pp.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_jeugd\ggz_basis_jeugd_pl_jp.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_jeugd\ggz_basis_jeugd_pl_ji.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_jeugd\ggz_basis_jeugd_aantal_p.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_jeugd\ggz_basis_jeugd_combinaties_p.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_jeugd\ggz_basis_jeugd_categorie_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_jeugd\ggz_basis_jeugd_categorie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_jeugd\ggz_basis_jeugd_categorie_ruw.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_jeugd\ggz_basis_jeugd_p_contact_per_mw.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_jeugd\ggz_basis_jeugd_ritalin.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_jeugd\ggz_basis_jeugd_pl_gzhb_ha.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_jeugd\ggz_basis_jeugd_pl_gzhb_ha_med.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_jeugd\ggz_basis_jeugd_pl_gzhb_ha_geen_med.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_jeugd\ggz_basis_jeugd_pl_gzhb_ha_med_geen_cg.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_jeugd\ggz_basis_jeugd_pl_gzhb_ha_med_cg.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_jeugd\ggz_basis_jeugd_pl_gzhb_ha_geen_med_geen_cg.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_jeugd\ggz_basis_jeugd_pl_gzhb_ha_geen_med_cg.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_jeugd\ggz_basis_jeugd_pl_gzhb_ha_nw.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_jeugd\ggz_basis_jeugd_pl_gzhb_ha_niet_nw.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_jeugd\ggz_basis_jeugd_pl_gzhb_ha_nw_vr.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_jeugd\ggz_basis_jeugd_pl_gzhb_ha_nw_geen_vr.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_jeugd\ggz_basis_jeugd_pl_gzhb_ha_nw_vr_g.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_jeugd\ggz_basis_jeugd_pl_gzhb_ha_nw_vr_ng.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_jeugd\ggz_basis_jeugd_pl_gzhb_ha_nw_vr_ng_d.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_jeugd\ggz_basis_jeugd_epi.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_jeugd\ggz_basis_jeugd_psych_epi.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_jeugd\ggz_basis_jeugd_psych_soci_epi.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_jeugd\ggz_basis_jeugd_labcodes.sql

[WARNING] SQL was not modified during conversion
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_jeugd\ggz_basis_jeugd_meetwaarden_filter.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW ggz_basis_jeugd_meetwaarden AS
SELECT * FROM crosstab(
$$
    SELECT DISTINCT ON (patient_id, nhgnr)
        patient_id,
        nhgnr,
        ARRAY[  uitslag_raw,
                datum::varchar,
                uitslag_waarde] as waarde_datum
    FROM ggz_basis_jeugd_meetwaarden_filter
    JOIN ggz_basis_jeugd_labcodes USING (nhgnr)
    ORDER BY patient_id, nhgnr, datum DESC, uitslag_num DESC nulls last,
            uitslag_raw nulls last, uitslag_waarde nulls last
$$,$$
    SELECT nhgnr
    FROM indelingen.nhg_labcodes
    JOIN ggz_basis_jeugd_labcodes USING (nhgnr)
    ORDER BY nhgnr
$$
) as ct(
patient_id bigint,
gew_ao varchar[],
lngp_ao varchar[],
quet_ao varchar[],
alco_pq	varchar[],
rrsy_ka varchar[],
rrsy_ka_mh varchar[],
fivesht_pq varchar[],
gzhb_pz	varchar[],
slpb_aq	varchar[],
smst_pq	varchar[],
vipl_pq	varchar[],
gdst_pq	varchar[],
fourdan_pq varchar[],
fourdde_pq varchar[],
fourddi_pq varchar[],
fourdso_pq varchar[],
bdi1_pq varchar[],
bdi2_pq varchar[],
bai_pq varchar[],
phq9_pq	varchar[],
audc_pq	varchar[],
dpos_pq	varchar[],
dper_pq	varchar[],
dprc_pq	varchar[],
dpsb_pq	varchar[],
ggcb_pz	varchar[],
ggrz_pz	varchar[],
ggbm_pq	varchar[],
ggad_pq	varchar[],
ansb_pq	varchar[],
agsb_pq	varchar[],
ggiz_pz	varchar[],
ggbe_pz	varchar[],
slsb_pq	varchar[]);
Unsupported JOIN found in pivot_statement.
Converted crosstab SQL:

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_jeugd\ggz_basis_jeugd_meetwaarden.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_jeugd\ggz_basis_jeugd_atc_codes.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_jeugd\ggz_basis_jeugd_medicatie_filter.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW ggz_basis_jeugd_medicatie AS
SELECT * FROM crosstab($$
    SELECT
        patient_id,
        categorie,
        ARRAY[
            count(*)::varchar,
            max(voorschrijfdatum)::varchar,
            min(voorschrijfdatum)::varchar,
            array_agg(distinct atc_code)::varchar
            ] as resultaat
    FROM ggz_basis_jeugd_medicatie_filter
    GROUP BY patient_id, categorie
    ORDER BY patient_id, categorie
$$,$$
    SELECT atc FROM ggz_basis_jeugd_atc_codes ORDER BY atc
$$) as
(
    patient_id bigint,
    n05a varchar[],
    n05ba varchar[],
    n05cd varchar[],
    n05cf varchar[],
    n06a varchar[],
    n06aa varchar[],
    n06ab varchar[],
    n06b varchar[]);
Converted crosstab SQL:
WITH cte1 AS (

    SELECT
        patient_id,
        categorie,
        ARRAY[
            count(*)::varchar,
            max(voorschrijfdatum)::varchar,
            min(voorschrijfdatum)::varchar,
            array_agg(distinct atc_code)::varchar
            ] as resultaat
    FROM {{ ref('ggz_basis_jeugd_medicatie_filter') }}
    GROUP BY patient_id, categorie
    ORDER BY patient_id, categorie

)
SELECT patient_id
, {{ dbt_utils.pivot('atc',        dbt_utils.get_column_values(ref('ggz_basis_jeugd_atc_codes'),'categorie',default=[]),        agg='',        then_value='categorie',        else_value="ARRAY_CONSTRUCT()",        quote_identifiers=False)}} 
FROM cte1
GROUP BY patient_id
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_jeugd\ggz_basis_jeugd_medicatie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_jeugd\ggz_basis_jeugd_mw_vragenlijsten.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_jeugd\ggz_basis_jeugd_mw_vragenlijsten_angst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_jeugd\ggz_basis_jeugd_mw_vragenlijsten_depressie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_jeugd\ggz_basis_jeugd_contact_per_mw.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_jeugd\ggz_basis_jeugd_indic_p01_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_jeugd\ggz_basis_jeugd_indic_p01.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_jeugd\ggz_basis_jeugd_pl_p01_ruw.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_jeugd\ggz_basis_jeugd_pl_p01.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_jeugd\ggz_basis_jeugd_indic_p03_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_jeugd\ggz_basis_jeugd_indic_p03.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_jeugd\ggz_basis_jeugd_pl_p03_ruw.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_jeugd\ggz_basis_jeugd_pl_p03.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_jeugd\ggz_basis_jeugd_indic_p06_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_jeugd\ggz_basis_jeugd_indic_p06.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_jeugd\ggz_basis_jeugd_pl_p06_ruw.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_jeugd\ggz_basis_jeugd_pl_p06.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_jeugd\ggz_basis_jeugd_indic_p15_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_jeugd\ggz_basis_jeugd_indic_p15.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_jeugd\ggz_basis_jeugd_pl_p15_ruw.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_jeugd\ggz_basis_jeugd_pl_p15.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_jeugd\ggz_basis_jeugd_indic_p19_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_jeugd\ggz_basis_jeugd_indic_p19.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_jeugd\ggz_basis_jeugd_pl_p19_ruw.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_jeugd\ggz_basis_jeugd_pl_p19.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_jeugd\ggz_basis_jeugd_indic_p74_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_jeugd\ggz_basis_jeugd_indic_p74.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_jeugd\ggz_basis_jeugd_pl_p74_ruw.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_jeugd\ggz_basis_jeugd_pl_p74.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_jeugd\ggz_basis_jeugd_indic_p76_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_jeugd\ggz_basis_jeugd_indic_p76.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_jeugd\ggz_basis_jeugd_pl_p76_ruw.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_jeugd\ggz_basis_jeugd_pl_p76.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_volwassenen\ggz_basis_volw_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_volwassenen\ggz_basis_volw_indic_start.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_volwassenen\ggz_basis_volw_pl_pre.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_volwassenen\ggz_basis_volw_pl_verdachten.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_volwassenen\ggz_basis_volw_pl_pp.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_volwassenen\ggz_basis_volw_pl_jp.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_volwassenen\ggz_basis_volw_pl_ji.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_volwassenen\ggz_basis_volw_aantal_p.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_volwassenen\ggz_basis_volw_combinaties_p.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_volwassenen\ggz_basis_volw_categorie_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_volwassenen\ggz_basis_volw_categorie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_volwassenen\ggz_basis_volw_p_contact_per_pat.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_volwassenen\ggz_basis_volw_p_contact_per_mw.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_volwassenen\ggz_basis_volw_pl_gzhb_ha.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_volwassenen\ggz_basis_volw_pl_gzhb_ha_med.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_volwassenen\ggz_basis_volw_pl_gzhb_ha_geen_med.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_volwassenen\ggz_basis_volw_pl_gzhb_ha_med_geen_cg.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_volwassenen\ggz_basis_volw_pl_gzhb_ha_med_cg.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_volwassenen\ggz_basis_volw_pl_gzhb_ha_geen_med_geen_cg.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_volwassenen\ggz_basis_volw_pl_gzhb_ha_geen_med_cg.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_volwassenen\ggz_basis_volw_pl_gzhb_ha_nw.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_volwassenen\ggz_basis_volw_pl_gzhb_ha_niet_nw.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_volwassenen\ggz_basis_volw_pl_gzhb_ha_nw_vr.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_volwassenen\ggz_basis_volw_pl_gzhb_ha_nw_geen_vr.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_volwassenen\ggz_basis_volw_pl_gzhb_ha_nw_vr_g.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_volwassenen\ggz_basis_volw_pl_gzhb_ha_nw_vr_ng.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_volwassenen\ggz_basis_volw_pl_gzhb_ha_nw_vr_ng_d.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_volwassenen\ggz_basis_volw_epi.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_volwassenen\ggz_basis_volw_psych_epi.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_volwassenen\ggz_basis_volw_psych_soci_epi.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_volwassenen\ggz_basis_volw_labcodes.sql

[WARNING] SQL was not modified during conversion
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_volwassenen\ggz_basis_volw_meetwaarden_filter.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW ggz_basis_volw_meetwaarden AS
SELECT * FROM crosstab(
$$
    SELECT DISTINCT ON (patient_id, nhgnr)
        patient_id,
        nhgnr,
        ARRAY[  uitslag_raw,
                datum::varchar,
                uitslag_waarde] as waarde_datum
    FROM ggz_basis_volw_meetwaarden_filter
    JOIN ggz_basis_volw_labcodes USING (nhgnr)
    ORDER BY patient_id, nhgnr, datum DESC, uitslag_num DESC nulls last,
            uitslag_raw nulls last, uitslag_waarde nulls last
$$,$$
    SELECT nhgnr
    FROM indelingen.nhg_labcodes
    JOIN ggz_basis_volw_labcodes USING (nhgnr)
    ORDER BY nhgnr
$$
) as ct(
patient_id bigint,
alco_pq	varchar[],
fivesht_pq varchar[],
gzhb_pz	varchar[],
slpb_aq	varchar[],
smst_pq	varchar[],
vipl_pq	varchar[],
gdst_pq	varchar[],
fourdan_pq varchar[],
fourdde_pq varchar[],
fourddi_pq varchar[],
fourdso_pq varchar[],
bdi1_pq varchar[],
bdi2_pq varchar[],
bai_pq varchar[],
phq9_pq	varchar[],
audc_pq	varchar[],
dpos_pq	varchar[],
dper_pq	varchar[],
dprc_pq	varchar[],
dpsb_pq	varchar[],
ggcb_pz	varchar[],
ggrz_pz	varchar[],
ggbm_pq	varchar[],
ggad_pq	varchar[],
ansb_pq	varchar[],
agsb_pq	varchar[],
ggiz_pz	varchar[],
ggbe_pz	varchar[],
slsb_pq	varchar[]);
Unsupported JOIN found in pivot_statement.
Converted crosstab SQL:

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_volwassenen\ggz_basis_volw_meetwaarden.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_volwassenen\ggz_basis_volw_atc_codes.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_volwassenen\ggz_basis_volw_medicatie_filter.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW ggz_basis_volw_medicatie AS
SELECT * FROM crosstab($$
    SELECT
        patient_id,
        categorie,
        ARRAY[
            count(*)::varchar,
            max(voorschrijfdatum)::varchar,
            min(voorschrijfdatum)::varchar,
            array_agg(distinct atc_code)::varchar
            ] as resultaat
    FROM ggz_basis_volw_medicatie_filter
    GROUP BY patient_id, categorie
    ORDER BY patient_id, categorie
$$,$$
    SELECT atc FROM ggz_basis_volw_atc_codes ORDER BY atc
$$) as
(
    patient_id bigint,
    n05a varchar[],
    n05ba varchar[],
    n05cd varchar[],
    n05cf varchar[],
    n06a varchar[],
    n06aa varchar[],
    n06ab varchar[]);
Converted crosstab SQL:
WITH cte1 AS (

    SELECT
        patient_id,
        categorie,
        ARRAY[
            count(*)::varchar,
            max(voorschrijfdatum)::varchar,
            min(voorschrijfdatum)::varchar,
            array_agg(distinct atc_code)::varchar
            ] as resultaat
    FROM {{ ref('ggz_basis_volw_medicatie_filter') }}
    GROUP BY patient_id, categorie
    ORDER BY patient_id, categorie

)
SELECT patient_id
, {{ dbt_utils.pivot('atc',        dbt_utils.get_column_values(ref('ggz_basis_volw_atc_codes'),'categorie',default=[]),        agg='',        then_value='categorie',        else_value="ARRAY_CONSTRUCT()",        quote_identifiers=False)}} 
FROM cte1
GROUP BY patient_id
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_volwassenen\ggz_basis_volw_medicatie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_volwassenen\ggz_basis_volw_mw_vragenlijsten.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_volwassenen\ggz_basis_volw_mw_vragenlijsten_angst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_volwassenen\ggz_basis_volw_mw_vragenlijsten_depressie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_volwassenen\ggz_basis_volw_contact_per_mw.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_volwassenen\ggz_basis_volw_contact_per_pat.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_volwassenen\ggz_basis_verwijzing.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_volwassenen\ggz_basis_volw_indic_p01_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_volwassenen\ggz_basis_volw_indic_p01.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_volwassenen\ggz_basis_volw_pl_p01_ruw.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_volwassenen\ggz_basis_volw_pl_p01.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_volwassenen\ggz_basis_volw_indic_p03_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_volwassenen\ggz_basis_volw_indic_p03.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_volwassenen\ggz_basis_volw_pl_p03_ruw.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_volwassenen\ggz_basis_volw_pl_p03.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_volwassenen\ggz_basis_volw_indic_p06_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_volwassenen\ggz_basis_volw_indic_p06.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_volwassenen\ggz_basis_volw_pl_p06_ruw.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_volwassenen\ggz_basis_volw_pl_p06.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_volwassenen\ggz_basis_volw_indic_p15_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_volwassenen\ggz_basis_volw_indic_p15.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_volwassenen\ggz_basis_volw_pl_p15_ruw.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_volwassenen\ggz_basis_volw_pl_p15.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_volwassenen\ggz_basis_volw_indic_p19_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_volwassenen\ggz_basis_volw_indic_p19.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_volwassenen\ggz_basis_volw_pl_p19_ruw.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_volwassenen\ggz_basis_volw_pl_p19.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_volwassenen\ggz_basis_volw_indic_p74_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_volwassenen\ggz_basis_volw_indic_p74.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_volwassenen\ggz_basis_volw_pl_p74_ruw.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_volwassenen\ggz_basis_volw_pl_p74.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_volwassenen\ggz_basis_volw_indic_p76_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_volwassenen\ggz_basis_volw_indic_p76.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_volwassenen\ggz_basis_volw_pl_p76_ruw.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz-basis_volwassenen\ggz_basis_volw_pl_p76.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz_indicatoren_-_primacura_ggz\ggz_53533104_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz_indicatoren_-_primacura_ggz\ggz_indicatoren_53533104_indicatoren_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz_indicatoren_-_primacura_ggz\ggz_indicatoren_53533104_indicatoren.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# kopie van proigia_episode_filter #}
WITH pre_episode AS (
  SELECT
    episode_id,
    patient_id
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz_indicatoren_-_primacura_ggz\ggz_53533140_episode_filter.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# kopie van proigia_icpc_codes #}
WITH icpc_codes AS (
  SELECT
    icpc
  FROM (VALUES
    ('A04%'
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz_indicatoren_-_primacura_ggz\ggz_53533140_icpc_codes.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW ggz_53533140_episode AS

SELECT * FROM crosstab($$
    SELECT
        patient_id,
        name,
        ARRAY[min(begindatum)::varchar,
                max(einddatum)::varchar,
                max(status_datum)::varchar,
                max(status_vlag)::varchar,
                array_agg(distinct icpc)::varchar,
                max(begindatum)::varchar,
                min(einddatum)::varchar,
                min(begindatum_nonactief)::varchar,
                max(einddatum_nonactief)::varchar,
                max(begindatum_nonactief)::varchar,
                min(einddatum_nonactief)::varchar] as waardes
    FROM ggz_53533140_episode_filter
    JOIN ggz_53533140_icpc_codes ON icpc ilike searchstring
    GROUP BY patient_id, name
    ORDER BY patient_id, name
$$,$$
    SELECT name FROM ggz_53533140_icpc_codes ORDER BY name;
$$) as ct(
    patient_id bigint,
    a04_ varchar[],
    a25_ varchar[],
    a26_ varchar[],
    a27_ varchar[],
    a28_ varchar[],
    b25_ varchar[],
    h27_ varchar[],
    k04_ varchar[],
    k24_ varchar[],
    k25_ varchar[],
    n02_ varchar[],
    n26_ varchar[],
    n87_ varchar[],
    n88_ varchar[],
    p_ varchar[],
    z_ varchar[]
);
Converted crosstab SQL:
WITH cte1 AS (

    SELECT
        patient_id,
        name,
        ARRAY[min(begindatum)::varchar,
                max(einddatum)::varchar,
                max(status_datum)::varchar,
                max(status_vlag)::varchar,
                array_agg(distinct icpc)::varchar,
                max(begindatum)::varchar,
                min(einddatum)::varchar,
                min(begindatum_nonactief)::varchar,
                max(einddatum_nonactief)::varchar,
                max(begindatum_nonactief)::varchar,
                min(einddatum_nonactief)::varchar] as waardes
    FROM {{ ref('ggz_53533140_episode_filter') }}
    JOIN {{ ref('ggz_53533140_icpc_codes') }} ON icpc ilike searchstring
    GROUP BY patient_id, name
    ORDER BY patient_id, name

)
SELECT patient_id
, {{ dbt_utils.pivot('name',        dbt_utils.get_column_values(ref('ggz_53533140_icpc_codes'),'categorie',default=[]),        agg='',        then_value='name',        else_value="ARRAY_CONSTRUCT()",        quote_identifiers=False)}} 
FROM cte1
GROUP BY patient_id
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz_indicatoren_-_primacura_ggz\ggz_53533140_episode.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# kopie van proigia_atc_codes #}
WITH atc_codes AS (
  SELECT
    atc
  FROM (VALUES
    ('N05'),
 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz_indicatoren_-_primacura_ggz\ggz_53533140_atc_codes.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# kopie van proigia_medicatie_filter #}
SELECT
  patient_id,
  atc AS categorie,
  voorschrijfdatum
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz_indicatoren_-_primacura_ggz\ggz_53533140_medicatie_filter.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW ggz_53533140_medicatie AS

SELECT * FROM crosstab($$
    SELECT
        patient_id,
        categorie,
        ARRAY[
            count(*)::varchar,
            max(voorschrijfdatum)::varchar,
            min(voorschrijfdatum)::varchar,
            array_agg(distinct atc_code)::varchar
            ] as resultaat
    FROM ggz_53533140_medicatie_filter
    GROUP BY patient_id, categorie
    ORDER BY patient_id, categorie
$$,$$
    SELECT atc FROM ggz_53533140_atc_codes ORDER BY atc
$$) as
(
    patient_id bigint,
    n05 varchar[],
    n06 varchar[]);
Converted crosstab SQL:
WITH cte1 AS (

    SELECT
        patient_id,
        categorie,
        ARRAY[
            count(*)::varchar,
            max(voorschrijfdatum)::varchar,
            min(voorschrijfdatum)::varchar,
            array_agg(distinct atc_code)::varchar
            ] as resultaat
    FROM {{ ref('ggz_53533140_medicatie_filter') }}
    GROUP BY patient_id, categorie
    ORDER BY patient_id, categorie

)
SELECT patient_id
, {{ dbt_utils.pivot('atc',        dbt_utils.get_column_values(ref('ggz_53533140_atc_codes'),'categorie',default=[]),        agg='',        then_value='categorie',        else_value="ARRAY_CONSTRUCT()",        quote_identifiers=False)}} 
FROM cte1
GROUP BY patient_id
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz_indicatoren_-_primacura_ggz\ggz_53533140_medicatie.sql

[WARNING] SQL was not modified during conversion
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz_indicatoren_-_primacura_ggz\ggz_53533104_verrichting.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz_indicatoren_-_primacura_ggz\ggz_53533104_verrichting_huisarts_pre.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz_indicatoren_-_primacura_ggz\ggz_53533104_verrichting_huisarts.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz_indicatoren_-_primacura_ggz\ggz_53533104_behandelperiodes.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz_indicatoren_-_primacura_ggz\ggz_53533104_behandelperiodes_contact.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Ter validatie koppeling journaal-verrichting #}
WITH contactmoment_ggz AS (
  SELECT
    patient_
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz_indicatoren_-_primacura_ggz\ggz_53533104_contactmoment.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz_indicatoren_jeugd_-_primacura_ggz\ggz_jeugd_53533104_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz_indicatoren_jeugd_-_primacura_ggz\ggz_jeugd_indicatoren_53533104_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz_indicatoren_jeugd_-_primacura_ggz\ggz_jeugd_indicatoren_53533104.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz_indicatoren_jeugd_-_primacura_ggz\ggz_jeugd_53533104_verrichting_kwartaal.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz_indicatoren_jeugd_-_primacura_ggz\ggz_jeugd_53533104_nieuwe_patient.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz_indicatoren_jeugd_-_primacura_ggz\ggz_jeugd_53533104_episode.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz_-_indigo\ggz_indigo_verzamel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz_-_indigo\ggz_indigo_ind_medicatie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz_-_indigo\ggz_indigo_ind_medicatie_perc.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz_-_indigo\ggz_indigo_ind_p_categorie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz_-_indigo\ggz_indigo_ind_p_categorie_perc.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz_-_indigo\ggz_indigo_ind_z_categorie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz_-_indigo\ggz_indigo_ind_z_categorie_perc.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz_-_indigo\ggz_indigo_ind_p_z_categorie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz_-_indigo\ggz_indigo_ind_p_z_categorie_perc.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz_-_indigo\ggz_indigo_patientenlijst_pre.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz_-_indigo\ggz_indigo_patientenlijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz_-_indigo\ggz_indigo_patienten_gegevens.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz_-_indigo\ggz_indigo_episode_filter.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: CREATE VIEW ggz_indigo_journaal_filter_ooit
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz_-_indigo\ggz_indigo_journaal_filter_ooit.sql

[WARNING] SQL was not modified during conversion
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz_-_indigo\ggz_indigo_contact_ooit.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz_-_indigo\ggz_indigo_periode.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz_-_indigo\ggz_indigo_icpc_bin.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz_-_indigo\ggz_indigo_leeftijd_bin.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# ikj = in kalenderjaar #} {# vkj = voor kalenderjaar #}
SELECT
  patient_id,
  MAX(
    CASE
     
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz_-_indigo\ggz_indigo_episode_ikj.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# ikj = in kalenderjaar #} {# vkj = voor kalenderjaar #}
SELECT
  patient_id,
  MAX(
    CASE
     
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz_-_indigo\ggz_indigo_episode_vkj.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz_-_indigo\ggz_indigo_medicatie_filter.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# ikj = in kalenderjaar #} {# vkj = voor kalenderjaar    #}
SELECT
  patient_id,
  MAX(CASE WHEN ac
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz_-_indigo\ggz_indigo_medicatie_ikj.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# ikj = in kalenderjaar #} {# vkj = voor kalenderjaar    #}
SELECT
  patient_id,
  MAX(
    CASE
  
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz_-_indigo\ggz_indigo_medicatie_vkj.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: CREATE VIEW ggz_indigo_medewerker
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz_-_indigo\ggz_indigo_medewerker.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz_-_indigo\ggz_indigo_contacten_filter.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz_-_indigo\ggz_indigo_contacten_poh_ggz.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz_-_indigo\ggz_indigo_contacten_huisarts.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz_-_indigo\ggz_indigo_verwijzingen_filter.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Verwijzingen die binnen 2 weken na een verwijzing zijn aangemaakt, tellen we als 1 #} {# In deze 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz_-_indigo\ggz_indigo_verwijzingen_selectie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz_-_indigo\ggz_indigo_verwijzingen.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz_patientenlijst_-_primacura_ggz\ggz_53533104_patientenlijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz_patientenlijst_-_primacura_ggz\ggz_53533104_pl_inclusie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz_patientenlijst_-_primacura_ggz\ggz_53533104_pl_exclusie_wel_consult.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz_patientenlijst_-_primacura_ggz\ggz_53533104_pl_exclusie_gzkz_nee.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz_patientenlijst_-_primacura_ggz\ggz_53533104_pl_actieve_ggz_episode.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz_patientenlijst_-_primacura_ggz\ggz_53533104_pl_psychofarma.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz_patientenlijst_-_primacura_ggz\ggz_53533104_pl_overige_exclusie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ggz_patientenlijst_-_primacura_ggz\ggz_53533104_pl_behandelperiodes_contact.sql

[ERROR] Failed to process ggz_patientenlijst_53533104_colum_properties.pry: Invalid PRY format: 'queries:' section not found
[ERROR] Failed to process ggz_patientenlijst_53533104_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_aero\gpri_aero_verzamel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_aero\gpri_aero_pl_tabblad_1.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_aero\gpri_aero_pl_tabblad_2.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_aero\gpri_aero_pl_tabblad_3.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_aero\gpri_aero_pl_tabblad_4.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_aero\gpri_aero_atc_codes.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_aero\gpri_aero_medicatie_filter_3jr.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# LET OP! Bij wijzigingen in dit rapport moet mogelijk ook GPRI: BiaB screening & GPRI: CodeX Astma
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_codex_copd\gpri_codex_verzamel.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# LET OP! Bij wijzigingen in dit rapport moet mogelijk ook GPRI: BiaB screening & GPRI: CodeX Astma
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_codex_copd\gpri_codex_indicatoren.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# LET OP! Bij wijzigingen in dit rapport moet mogelijk ook GPRI: BiaB screening & GPRI: CodeX Astma
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_codex_copd\gpri_codex_pl_patient.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# LET OP! Bij wijzigingen in dit rapport moet mogelijk ook GPRI: BiaB screening & GPRI: CodeX Astma
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_codex_copd\gpri_codex_pl_exacerbatie.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# LET OP! Bij wijzigingen in dit rapport moet mogelijk ook GPRI: BiaB screening & GPRI: CodeX Astma
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_codex_copd\gpri_codex_pl_registratie.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# LET OP! Bij wijzigingen in dit rapport moet mogelijk ook GPRI: BiaB screening & GPRI: CodeX Astma
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_codex_copd\gpri_codex_pl_opvolging.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# LET OP! Bij wijzigingen in dit rapport moet mogelijk ook GPRI: BiaB screening & GPRI: CodeX Astma
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_codex_copd\gpri_codex_pl_copd_afspraak.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# LET OP! Bij wijzigingen in dit rapport moet mogelijk ook GPRI: BiaB screening & GPRI: CodeX Astma
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_codex_copd\gpri_codex_pl_overzicht_risicopatienten.sql

[ERROR] Failed to process gpri_codex_colum_properties.pry: Invalid PRY format: 'queries:' section not found
[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Eigen contact view, zodat deze MATERIALIZED kan worden. Contact view wordt in meerdere views gebr
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_codex_copd\gpri_codex_contact_filter.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_codex_copd\gpri_codex_mw_filter.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_codex_copd\gpri_codex_medicatie_filter.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_codex_copd\gpri_codex_algoritme.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# LET OP! Bij wijzigingen in dit rapport moet mogelijk ook GPRI: BiaB aangepast worden. #} {# NB th
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_codex_copd\gpri_codex_algoritme_uniek.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# LET OP! Bij wijzigingen in dit rapport moet mogelijk ook GPRI: BiaB aangepast worden. #}
SELECT
 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_codex_copd\gpri_codex_algoritme_uniek_per_pt.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_codex_copd\gpri_codex_coex_jr.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_codex_copd\gpri_codex_inhalatiemedicatie_filter.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_codex_copd\gpri_codex_medicatie_huidig.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_codex_copd\gpri_codex_medicatie_overig.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_codex_copd\gpri_codex_contact_na_ex_uniek.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_codex_copd\gpri_codex_coae_3jr.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_codex_copd\gpri_codex_contact_filter_3jr.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_codex_copd\gpri_codex_mw_filter_3jr.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_codex_copd\gpri_codex_medicatie_filter_3jr.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_codex_copd\gpri_codex_algoritme_3jr.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# LET OP! Bij wijzigingen in dit rapport moeten mogelijk ook GPRI: BiaB en Crescendo aangepast word
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_codex_copd\gpri_codex_algoritme_uniek_3jr.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# LET OP! Bij wijzigingen in dit rapport moeten mogelijk ook GPRI: BiaB en Crescendo aangepast word
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_codex_copd\gpri_codex_algoritme_uniek_per_pt_3jr.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_codex_copd\gpri_codex_contact_na_ex.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_codex_copd\gpri_codex_mw_3jr.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# LET OP! Bij wijzigingen in dit rapport moet mogelijk ook GPRI: BiaB aangepast worden. #}
WITH med
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_codex_copd\gpri_codex_medicatie_post.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_codex_copd\gpri_codex_contact_na_ex_uniek_3jr.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# LET OP! Bij wijzigingen in dit rapport moet mogelijk ook GPRI: BiaB screening & GPRI: CodeX (COPD
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_codex_astma\gpri_codex_astma_verzamel.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# LET OP! Bij wijzigingen in dit rapport moet mogelijk ook GPRI: BiaB screening & GPRI: CodeX (COPD
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_codex_astma\gpri_codex_astma_indicatoren.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# LET OP! Bij wijzigingen in dit rapport moet mogelijk ook GPRI: BiaB screening & GPRI: CodeX (COPD
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_codex_astma\gpri_codex_astma_pl_patient.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# LET OP! Bij wijzigingen in dit rapport moet mogelijk ook GPRI: BiaB screening & GPRI: CodeX (COPD
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_codex_astma\gpri_codex_astma_pl_exacerbatie.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# LET OP! Bij wijzigingen in dit rapport moet mogelijk ook GPRI: BiaB screening & GPRI: CodeX (COPD
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_codex_astma\gpri_codex_astma_pl_registratie.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# LET OP! Bij wijzigingen in dit rapport moet mogelijk ook GPRI: BiaB screening & GPRI: CodeX (COPD
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_codex_astma\gpri_codex_astma_pl_opvolging.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# LET OP! Bij wijzigingen in dit rapport moet mogelijk ook GPRI: BiaB screening & GPRI: CodeX (COPD
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_codex_astma\gpri_codex_astma_pl_afspraak.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# LET OP! Bij wijzigingen in dit rapport moet mogelijk ook GPRI: BiaB screening & GPRI: CodeX aange
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_codex_astma\gpri_codex_pl_astma_overzicht_risicopatienten.sql

[ERROR] Failed to process gpri_codex_astma_colum_properties.pry: Invalid PRY format: 'queries:' section not found
[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Eigen contact view, zodat deze MATERIALIZED kan worden. Contact view wordt in meerdere views gebr
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_codex_astma\gpri_codex_astma_contact_filter.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_codex_astma\gpri_codex_astma_mw_filter.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_codex_astma\gpri_codex_astma_medicatie_filter.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_codex_astma\gpri_codex_astma_algoritme.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# LET OP! Bij wijzigingen in dit rapport moet mogelijk ook GPRI: BiaB aangepast worden. #} {# NB th
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_codex_astma\gpri_codex_astma_algoritme_uniek.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# LET OP! Bij wijzigingen in dit rapport moet mogelijk ook GPRI: BiaB aangepast worden. #}
SELECT
 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_codex_astma\gpri_codex_astma_algoritme_uniek_per_pt.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_codex_astma\gpri_codex_astma_coex_jr.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_codex_astma\gpri_codex_astma_inhalatiemedicatie_filter.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_codex_astma\gpri_codex_astma_medicatie_huidig.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_codex_astma\gpri_codex_astma_medicatie_overig.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_codex_astma\gpri_codex_astma_contact_na_ex_uniek.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_codex_astma\gpri_codex_astma_coae_3jr.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_codex_astma\gpri_codex_astma_contact_filter_3jr.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_codex_astma\gpri_codex_astma_mw_filter_3jr.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_codex_astma\gpri_codex_astma_medicatie_filter_3jr.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_codex_astma\gpri_codex_astma_algoritme_3jr.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# LET OP! Bij wijzigingen in dit rapport moeten mogelijk ook GPRI: BiaB en Crescendo aangepast word
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_codex_astma\gpri_codex_astma_algoritme_uniek_3jr.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# LET OP! Bij wijzigingen in dit rapport moeten mogelijk ook GPRI: BiaB en Crescendo aangepast word
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_codex_astma\gpri_codex_astma_algoritme_uniek_per_pt_3jr.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_codex_astma\gpri_codex_astma_contact_na_ex.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_codex_astma\gpri_codex_astma_mw_3jr.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# LET OP! Bij wijzigingen in dit rapport moet mogelijk ook GPRI: BiaB aangepast worden. #}
WITH med
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_codex_astma\gpri_codex_astma_medicatie_post.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_codex_astma\gpri_codex_astma_contact_na_ex_uniek_3jr.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {#  LET OP: bij aanpassingen ook het rapport "Doorleveren data GPRI: COPD comorbidities" aanpassen #
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_copd_comorbidities\gpri_copd_comorbidities_verzamel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_copd_comorbidities\gpri_copd_comorbidities_pl.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_copd_comorbidities\gpri_copd_comorbidities_pl_astma.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_copd_comorbidities\gpri_copd_comorbidities_pl_pneumonie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_copd_comorbidities\gpri_copd_comorbidities_pl_osteoporose.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_copd_comorbidities\gpri_copd_comorbidities_pl_dm.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_copd_comorbidities\gpri_copd_comorbidities_pl_bronchiectasieen.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_copd_comorbidities\gpri_copd_comorbidities_pl_tuberculose.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_copd_comorbidities\gpri_copd_comorbidities_pl_vermind_nierfunctie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_copd_comorbidities\gpri_copd_comorbidities_pl_prostaat.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_copd_comorbidities\gpri_copd_comorbidities_pl_ritmestoornissen.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_copd_comorbidities\gpri_copd_comorbidities_pl_glaucoom_ics.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_copd_comorbidities\gpri_copd_comorbidities_pl_glaucoom_lama.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_copd_comorbidities\gpri_copd_comorbidities_ind.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Kopie van proigia_atc_codes #}
WITH atc_codes AS (
  SELECT
    atc
  FROM (VALUES
    ('R03A'),

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_copd_comorbidities\gpri_copd_comorbidities_atc_codes.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Kopie van proigia_medicatie_filter #} {# Afwijking: toevoeging atc_omschrijving #} {# Afwijking 2
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_copd_comorbidities\gpri_copd_comorbidities_medicatie_filter.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW gpri_copd_comorbidities_medicatie AS


SELECT * FROM crosstab($$
    SELECT
        patient_id,
        categorie,
        ARRAY[
            COUNT(*)::varchar,
            MAX(voorschrijfdatum)::varchar,
            MIN(voorschrijfdatum)::varchar,
            array_agg(DISTINCT atc_code)::varchar,
            array_agg(DISTINCT atc_omschrijving)::varchar
            ] AS resultaat
    FROM gpri_copd_comorbidities_medicatie_filter
    GROUP BY patient_id, categorie
    ORDER BY patient_id, categorie
$$,$$
    SELECT atc FROM gpri_copd_comorbidities_atc_codes ORDER BY atc
$$) AS
(
    patient_id bigint,
    r03a varchar[],
    r03ac02 varchar[],
    r03ac03 varchar[],
    r03ac12 varchar[],
    r03ac13 varchar[],
    r03ac18 varchar[],
    r03ac19 varchar[],
    r03ak varchar[],
    r03ak06 varchar[],
    r03ak07 varchar[],
    r03ak08 varchar[],
    r03ak10 varchar[],
    r03ak11 varchar[],
    r03ak12 varchar[],
    r03al varchar[],
    r03al01 varchar[],
    r03al02 varchar[],
    r03al03 varchar[],
    r03al04 varchar[],
    r03al05 varchar[],
    r03al06 varchar[],
    r03al08 varchar[],
    r03al09 varchar[],
    r03al10 varchar[],
    r03al11 varchar[],
    r03al12 varchar[],
    r03ba varchar[],
    r03ba01 varchar[],
    r03ba02 varchar[],
    r03ba05 varchar[],
    r03ba08 varchar[],
    r03bb varchar[],
    r03bb01 varchar[],
    r03bb02 varchar[],
    r03bb04 varchar[],
    r03bb05 varchar[],
    r03bb06 varchar[],
    r03bb07 varchar[],
    r03bb09 varchar[]
    );
Converted crosstab SQL:
WITH cte1 AS (

    SELECT
        patient_id,
        categorie,
        ARRAY[
            COUNT(*)::varchar,
            MAX(voorschrijfdatum)::varchar,
            MIN(voorschrijfdatum)::varchar,
            array_agg(DISTINCT atc_code)::varchar,
            array_agg(DISTINCT atc_omschrijving)::varchar
            ] AS resultaat
    FROM {{ ref('gpri_copd_comorbidities_medicatie_filter') }}
    GROUP BY patient_id, categorie
    ORDER BY patient_id, categorie

)
SELECT patient_id
, {{ dbt_utils.pivot('atc',        dbt_utils.get_column_values(ref('gpri_copd_comorbidities_atc_codes'),'categorie',default=[]),        agg='',        then_value='categorie',        else_value="ARRAY_CONSTRUCT()",        quote_identifiers=False)}} 
FROM cte1
GROUP BY patient_id
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_copd_comorbidities\gpri_copd_comorbidities_medicatie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_copd_comorbidities\gpri_copd_comorbidities_medicatie_s01e.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_copd_comorbidities\gpri_copd_comorbidities_bepalingen.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_copd_tracker\gpri_copd_tracker_verzamel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_copd_tracker\gpri_copd_tracker_pl.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_copd_tracker\gpri_copd_tracker_pl_geen_copd.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Kopie van proigia_atc_codes #}
WITH atc_codes AS (
  SELECT
    atc
  FROM (VALUES
    ('H02AB06'
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_copd_tracker\gpri_copd_tracker_atc_codes.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Kopie van proigia_medicatie_filter #} {# Afwijking: toevoeging atc_omschrijving #}
SELECT
  patie
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_copd_tracker\gpri_copd_tracker_medicatie_filter.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW gpri_copd_tracker_medicatie AS


SELECT * FROM crosstab($$
    SELECT
        patient_id,
        categorie,
        ARRAY[
            COUNT(*)::varchar,
            MAX(voorschrijfdatum)::varchar,
            MIN(voorschrijfdatum)::varchar,
            array_agg(DISTINCT atc_code)::varchar,
            array_agg(DISTINCT atc_omschrijving)::varchar
            ] AS resultaat
    FROM gpri_copd_tracker_medicatie_filter
    GROUP BY patient_id, categorie
    ORDER BY patient_id, categorie
$$,$$
    SELECT atc FROM gpri_copd_tracker_atc_codes ORDER BY atc
$$) AS
(
    patient_id bigint,
    h02ab06 varchar[],
    h02ab07 varchar[],
    r03ac12 varchar[],
    r03ac13 varchar[],
    r03ac18 varchar[],
    r03ac19 varchar[],
    r03ak06 varchar[],
    r03ak07 varchar[],
    r03ak08 varchar[],
    r03ak10 varchar[],
    r03ak11 varchar[],
    r03ak12 varchar[],
    r03al03 varchar[],
    r03al04 varchar[],
    r03al05 varchar[],
    r03al06 varchar[],
    r03al07 varchar[],
    r03al09 varchar[],
    r03ba01 varchar[],
    r03ba02 varchar[],
    r03ba05 varchar[],
    r03ba08 varchar[],
    r03bb04 varchar[],
    r03bb05 varchar[],
    r03bb06 varchar[],
    r03bb07 varchar[]
    );
Converted crosstab SQL:
WITH cte1 AS (

    SELECT
        patient_id,
        categorie,
        ARRAY[
            COUNT(*)::varchar,
            MAX(voorschrijfdatum)::varchar,
            MIN(voorschrijfdatum)::varchar,
            array_agg(DISTINCT atc_code)::varchar,
            array_agg(DISTINCT atc_omschrijving)::varchar
            ] AS resultaat
    FROM {{ ref('gpri_copd_tracker_medicatie_filter') }}
    GROUP BY patient_id, categorie
    ORDER BY patient_id, categorie

)
SELECT patient_id
, {{ dbt_utils.pivot('atc',        dbt_utils.get_column_values(ref('gpri_copd_tracker_atc_codes'),'categorie',default=[]),        agg='',        then_value='categorie',        else_value="ARRAY_CONSTRUCT()",        quote_identifiers=False)}} 
FROM cte1
GROUP BY patient_id
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_copd_tracker\gpri_copd_tracker_medicatie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_covid-19_vaccin_onderzoek\gpri_covid_19_vaccin_onderzoek_verzamel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_covid-19_vaccin_onderzoek\gpri_covid_19_vaccin_onderzoek_pl_gr1.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_covid-19_vaccin_onderzoek\gpri_covid_19_vaccin_onderzoek_pl_gr2.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_covid-19_vaccin_onderzoek\gpri_covid_19_vaccin_onderzoek_pl_gr3.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_covid-19_vaccin_onderzoek\gpri_covid_19_vaccin_onderzoek_pl_gr4.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_covid-19_vaccin_onderzoek\gpri_covid_19_vaccin_onderzoek_pl_gr5.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_covid-19_vaccin_onderzoek\gpri_covid_19_vaccin_onderzoek_vaccin_pfi_mod.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_covid-19_vaccin_onderzoek\gpri_covid_19_vaccin_onderzoek_gevaccineerd.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_covid-19_vaccin_onderzoek\gpri_covid_19_vaccin_onderzoek_pcr_test.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_crescendo\gpri_crescendo_verzamel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_crescendo\gpri_crescendo_pl.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# LET OP: alle algoritme views zijn een kopie van CodeX 3jr. Verschil is 2jr vs. 3jr. #}
WITH RECUR
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_crescendo\gpri_crescendo_peildatum_2jr.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# LET OP: alle algoritme views zijn een kopie van CodeX 3jr. Verschil is 2jr vs. 3jr. #}
WITH pre_e
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_crescendo\gpri_crescendo_episode_filter_2jr.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {#  LET OP: alle algoritme views zijn een kopie van CodeX 3jr. Verschil is 2jr vs. 3jr. #}
WITH nhgn
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_crescendo\gpri_crescendo_meetwaarden_filter_2jr.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# LET OP: alle algoritme views zijn een kopie van CodeX 3jr. Verschil is 2jr vs. 3jr. #}
CREATE VIE
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_crescendo\gpri_crescendo_journaal_filter_2jr.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {#  LET OP: alle algoritme views zijn een kopie van CodeX 3jr. Verschil is 2jr vs. 3jr. #}
WITH icpc
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_crescendo\gpri_crescendo_contact_2jr.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# LET OP: alle algoritme views zijn een kopie van CodeX 3jr. Verschil is 2jr vs. 3jr. #}
SELECT
  p
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_crescendo\gpri_crescendo_contact_filter_2jr.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# LET OP: alle algoritme views zijn een kopie van CodeX 3jr. Verschil is 2jr vs. 3jr. #}
SELECT
  p
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_crescendo\gpri_crescendo_mw_filter_2jr.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# LET OP: alle algoritme views zijn een kopie van CodeX 3jr. Verschil is 2jr vs. 3jr. #}
SELECT
  p
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_crescendo\gpri_crescendo_medicatie_filter_2jr.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# LET OP! Bij wijzigingen in dit rapport moeten mogelijk ook GPRI: CodeX en BiaB aangepast worden. 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_crescendo\gpri_crescendo_algoritme_2jr.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# LET OP: alle algoritme views zijn een kopie van CodeX 3jr. Verschil is 2jr vs. 3jr. #} {# LET OP!
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_crescendo\gpri_crescendo_algoritme_uniek_2jr.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# LET OP: alle algoritme views zijn een kopie van CodeX 3jr. Verschil is 2jr vs. 3jr. #} {# LET OP!
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_crescendo\gpri_crescendo_algoritme_uniek_per_pt_2jr.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_crescendo\gpri_crescendo_egfr.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_ezef\gpri_ezef_verzamel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_ezef\gpri_ezef_pl_groep_1.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_ezef\gpri_ezef_pl_groep_2.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_ezef\gpri_ezef_ind_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_ezef\gpri_ezef_ind.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_ezef\gpri_ezef_icpcs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_surmount\gpri_surmount_verzamel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_surmount\gpri_surmount_pl_groep_1.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_surmount\gpri_surmount_pl_groep_2.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_surmount\gpri_surmount_ind_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_surmount\gpri_surmount_ind.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_surmount\gpri_surmount_taba_aq_muv_esigaret.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_surmount\gpri_surmount_cac_kh_ooit.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_surmount\gpri_surmount_eain_ka_ooit.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_surmount\gpri_surmount_hypt_kq_ooit.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_surmount\gpri_surmount_dper_pq_2jr.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_surmount\gpri_surmount_a10b.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_verborgen_nierschade\gpri_verborgen_nierschade_verzamel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_verborgen_nierschade\gpri_verborgen_nierschade_doorleveren_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_verborgen_nierschade\gpri_verborgen_nierschade_doorleveren_delivery.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_verborgen_nierschade\gpri_verborgen_nierschade_doorleveren_report.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_verborgen_nierschade\gpri_verborgen_nierschade_indicatoren_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_verborgen_nierschade\gpri_verborgen_nierschade_indicatoren_report.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_verborgen_nierschade\gpri_verborgen_nierschade_indicatoren_delivery.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_verborgen_nierschade\gpri_verborgen_nierschade_pl.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_verborgen_nierschade\gpri_verborgen_nierschade_pl_dm.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_verborgen_nierschade\gpri_verborgen_nierschade_pl_obesitas.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_verborgen_nierschade\gpri_verborgen_nierschade_pl_vetstofwisseling.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_verborgen_nierschade\gpri_verborgen_nierschade_pl_hypertensie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_verborgen_nierschade\gpri_verborgen_nierschade_pl_hvz.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {{ patientgegevens_peildatum() }}
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_verborgen_nierschade\gpri_verborgen_nierschade_patientengegevens.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {{ episode_filter_peildatum() }} {# Kopie van proigia_episode_filter #} {# Afwijking: peildatum #}
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_verborgen_nierschade\gpri_verborgen_nierschade_episode_filter.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW grpi_verborgen_nierschade_episode AS


SELECT * FROM crosstab($$
    SELECT
        patient_id,
        name,
        ARRAY[min(begindatum)::varchar,
                max(einddatum)::varchar,
                max(status_datum)::varchar,
                max(status_vlag)::varchar,
                array_agg(distinct icpc)::varchar,
                max(begindatum)::varchar,
                min(einddatum)::varchar,
                min(begindatum_nonactief)::varchar,
                max(einddatum_nonactief)::varchar,
                max(begindatum_nonactief)::varchar,
                min(einddatum_nonactief)::varchar] AS waardes
    FROM gpri_verborgen_nierschade_episode_filter
    JOIN proigia_icpc_codes_seg2 ON icpc ilike searchstring
    GROUP BY patient_id, name
    ORDER BY patient_id, name
$$,$$
    SELECT name FROM proigia_icpc_codes_seg2 ORDER BY name;
$$) AS ct(
    patient_id bigint,
    __DBT_MACRO_0__);
Converted crosstab SQL:
WITH cte1 AS (

    SELECT
        patient_id,
        name,
        ARRAY[min(begindatum)::varchar,
                max(einddatum)::varchar,
                max(status_datum)::varchar,
                max(status_vlag)::varchar,
                array_agg(distinct icpc)::varchar,
                max(begindatum)::varchar,
                min(einddatum)::varchar,
                min(begindatum_nonactief)::varchar,
                max(einddatum_nonactief)::varchar,
                max(begindatum_nonactief)::varchar,
                min(einddatum_nonactief)::varchar] AS waardes
    FROM {{ ref('gpri_verborgen_nierschade_episode_filter') }}
    JOIN {{ ref('proigia_icpc_codes_seg2') }} ON icpc ilike searchstring
    GROUP BY patient_id, name
    ORDER BY patient_id, name

)
SELECT patient_id
, {{ dbt_utils.pivot('name',        dbt_utils.get_column_values(ref('proigia_icpc_codes_seg2'),'categorie',default=[]),        agg='',        then_value='name',        else_value="ARRAY_CONSTRUCT()",        quote_identifiers=False)}} 
FROM cte1
GROUP BY patient_id
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_verborgen_nierschade\grpi_verborgen_nierschade_episode.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {#  Kopie van proigia_labcodes #}
{#  Afwijking: peildatum #}
SELECT
    AS
  FROM (VALUES
    (40,)
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_verborgen_nierschade\gpri_verborgen_nierschade_labcodes.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {#  Kopie van proigia_meetwaarden_filter #}
{#  Afwijking: peildatum #}
WITH nhgnr_verrijking AS
(
 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_verborgen_nierschade\gpri_verborgen_nierschade_meetwaarden_filter.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW gpri_verborgen_nierschade_meetwaarden AS


SELECT * FROM crosstab(
$$
    SELECT DISTINCT ON (patient_id, nhgnr)
        patient_id,
        nhgnr,
        ARRAY[  uitslag_raw,
                datum::varchar,
                uitslag_waarde] AS waarde_datum
    FROM gpri_verborgen_nierschade_meetwaarden_filter
    JOIN gpri_verborgen_nierschade_labcodes USING (nhgnr)
    ORDER BY patient_id, nhgnr, datum DESC, uitslag_num DESC nulls last,
            uitslag_raw nulls last, uitslag_waarde nulls last
$$,$$
    SELECT nhgnr
    FROM indelingen.nhg_labcodes
    JOIN gpri_verborgen_nierschade_labcodes USING (nhgnr)
    ORDER BY nhgnr
$$
) AS ct(
patient_id bigint, 
albk_u_mi varchar[],
chol_b_mt varchar[],
gew_ao varchar[],
gluc_b_nn varchar[],
gluc_b_nu varchar[],
hdl_b varchar[],
ldl_b varchar[],
lngp_ao varchar[],
quet_ao varchar[],
trig_b varchar[],
rook_aq varchar[],
rrsy_ka varchar[],
dmhb_tz varchar[],
rrgs_ka_mh varchar[],
cvhb_kz varchar[],
hbac_b varchar[],
rr3s_ka varchar[],
krec_o_fb varchar[],
dmkz_tz varchar[],
cvkz_kz varchar[],
rh19_kq_fb varchar[]);
Unsupported JOIN found in pivot_statement.
Converted crosstab SQL:

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_verborgen_nierschade\gpri_verborgen_nierschade_meetwaarden.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW gpri_verborgen_nierschade_dubbele_hb AS



SELECT * FROM crosstab($$
WITH alle_hb AS
(
    SELECT
        patient_id,
        memo,
        datum,
        uitslag_waarde
    FROM gpri_verborgen_nierschade_meetwaarden_filter
    WHERE omschrijving ilike '%hoofdbehandelaar%'
    ORDER BY patient_id, memo, uitslag_waarde, datum desc
),
grouping_uitslagen AS
(
    SELECT
        patient_id,
        memo,
        datum,
        array_agg(distinct uitslag_waarde) FILTER (WHERE uitslag_waarde IS NOT NULL) AS uitslagen
    FROM alle_hb
    GROUP BY patient_id, memo, datum
)
SELECT distinct on (patient_id, memo)
    patient_id,
    memo||'_db',
    ARRAY[CASE WHEN array_length(uitslagen, 1) > 1 THEN 1 ELSE 0 END::varchar,
            datum::varchar, uitslagen::varchar] AS dubbel
FROM grouping_uitslagen
ORDER BY patient_id, memo, datum desc
$$,$$
SELECT
    memo||'_db'
FROM indelingen.nhg_labcodes
JOIN gpri_verborgen_nierschade_labcodes USING (nhgnr)
WHERE omschrijving ilike '%hoofdbehandelaar%'
ORDER BY memo
$$) AS ct(
    patient_id bigint,
    cvhb_db varchar[],
    dmhb_db varchar[]);    
Unsupported JOIN found in pivot_statement.
Converted crosstab SQL:

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_verborgen_nierschade\gpri_verborgen_nierschade_dubbele_hb.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW gpri_verborgen_nierschade_dubbele_kz AS



SELECT * FROM crosstab($$
WITH alle_kz AS
(
    SELECT
        patient_id,
        memo,
        datum,
        uitslag_waarde
    FROM gpri_verborgen_nierschade_meetwaarden_filter
    WHERE omschrijving ILIKE '%deeln%keten%'
    ORDER BY patient_id, memo, uitslag_waarde, datum desc
),
grouping_uitslagen AS
(
    SELECT
        patient_id,
        memo,
        datum,
        array_agg(distinct uitslag_waarde) FILTER (WHERE uitslag_waarde IS NOT NULL) as uitslagen
    FROM alle_kz
    GROUP BY patient_id, memo, datum
)
SELECT distinct on (patient_id, memo)
    patient_id,
    memo||'_db',
    ARRAY[CASE WHEN array_length(uitslagen, 1) > 1 THEN 1 ELSE 0 END::varchar,
            datum::varchar, uitslagen::varchar] as dubbel
FROM grouping_uitslagen
ORDER BY patient_id, memo, datum desc
$$,$$
SELECT
    memo||'_db'
FROM indelingen.nhg_labcodes
JOIN gpri_verborgen_nierschade_labcodes USING (nhgnr)
WHERE omschrijving ILIKE '%deeln%keten%'
ORDER BY memo
$$) as ct(
    patient_id bigint,
    cvkz_db varchar[],
    dmkz_db varchar[]);
Unsupported JOIN found in pivot_statement.
Converted crosstab SQL:

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_verborgen_nierschade\gpri_verborgen_nierschade_dubbele_kz.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# kopie van proigia_medicatie_filter #} {# afwijking 1: voorschrijfdatum <6mnd #} {# afwijking 2: e
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_verborgen_nierschade\gpri_verborgen_nierschade_medicatie_filter.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW gpri_verborgen_nierschade_medicatie AS
SELECT * FROM crosstab($$
    SELECT
        patient_id,
        categorie,
        ARRAY[
            count(*)::varchar,
            max(voorschrijfdatum)::varchar,
            min(voorschrijfdatum)::varchar,
            array_agg(distinct atc_code)::varchar
            ] as resultaat
    FROM gpri_verborgen_nierschade_medicatie_filter
    GROUP BY patient_id, categorie
    ORDER BY patient_id, categorie
$$,$$
    SELECT atc FROM proigia_atc_codes_seg2 ORDER BY atc
$$) as
(
    patient_id bigint,
    __DBT_MACRO_0__);
Converted crosstab SQL:
WITH cte1 AS (

    SELECT
        patient_id,
        categorie,
        ARRAY[
            count(*)::varchar,
            max(voorschrijfdatum)::varchar,
            min(voorschrijfdatum)::varchar,
            array_agg(distinct atc_code)::varchar
            ] as resultaat
    FROM {{ ref('gpri_verborgen_nierschade_medicatie_filter') }}
    GROUP BY patient_id, categorie
    ORDER BY patient_id, categorie

)
SELECT patient_id
, {{ dbt_utils.pivot('atc',        dbt_utils.get_column_values(ref('proigia_atc_codes_seg2'),'categorie',default=[]),        agg='',        then_value='categorie',        else_value="ARRAY_CONSTRUCT()",        quote_identifiers=False)}} 
FROM cte1
GROUP BY patient_id
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_verborgen_nierschade\gpri_verborgen_nierschade_medicatie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_verborgen_nierschade\gpri_verborgen_nierschade_hbac.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_verborgen_nierschade\gpri_verborgen_nierschade_egfr.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_verborgen_nierschade\gpri_verborgen_nierschade_alb.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_verborgen_nierschade\gpri_verborgen_nierschade_episodelijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\gpri_verborgen_nierschade\gpri_verborgen_nierschade_medicatielijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\hartfalen\hartfalen_doorverwijzing.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\hartfalen\hartfalen_terugverwijzing.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\hartfalen\hartfalen_terug_doorverwijzing.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\hartfalen\hartfalen_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\hartfalen\hartfalen_indicatoren_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\hartfalen\hartfalen_indicatoren.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\hartfalen\hartfalen_ruwe_patientenlijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\hartfalen\hartfalen_patientenlijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\hartfalen\hartfalen_mogelijk_hf.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\hartfalen\hartfalen_atc_codes_ooit.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\hartfalen\hartfalen_medicatie_filter_ooit.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW hartfalen_medicatie_ooit AS
SELECT * FROM crosstab($$
    SELECT
        patient_id,
        categorie,
        ARRAY[
            count(*)::varchar,
            max(voorschrijfdatum)::varchar,
            min(voorschrijfdatum)::varchar,
            array_agg(distinct atc_code)::varchar
            ] as resultaat
    FROM hartfalen_medicatie_filter_ooit
    GROUP BY patient_id, categorie
    ORDER BY patient_id, categorie
$$,$$
    SELECT atc FROM hartfalen_atc_codes_ooit ORDER BY atc
$$) as
(
    patient_id bigint,
		c03ca01 varchar[],
		c03cb01 varchar[],
		c03eb01 varchar[],
		c03ca02 varchar[],
		c03cb02 varchar[],
		c03eb02 varchar[]);
Converted crosstab SQL:
WITH cte1 AS (

    SELECT
        patient_id,
        categorie,
        ARRAY[
            count(*)::varchar,
            max(voorschrijfdatum)::varchar,
            min(voorschrijfdatum)::varchar,
            array_agg(distinct atc_code)::varchar
            ] as resultaat
    FROM {{ ref('hartfalen_medicatie_filter_ooit') }}
    GROUP BY patient_id, categorie
    ORDER BY patient_id, categorie

)
SELECT patient_id
, {{ dbt_utils.pivot('atc',        dbt_utils.get_column_values(ref('hartfalen_atc_codes_ooit'),'categorie',default=[]),        agg='',        then_value='categorie',        else_value="ARRAY_CONSTRUCT()",        quote_identifiers=False)}} 
FROM cte1
GROUP BY patient_id
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\hartfalen\hartfalen_medicatie_ooit.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\hartfalen\hartfalen_exacerbaties.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\hartfalen\hartfalen_journaal_ecg.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\hartfalen\hartfalen_journaal_echocardio.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\hartfalen_-_rijn_en_duin\hartfalen_53530250_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\hartfalen_-_rijn_en_duin\hartfalen_53530250_indic_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\hartfalen_-_rijn_en_duin\hartfalen_53530250_indicatoren.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\hartfalen_-_rijn_en_duin\hartfalen_53530250_patientenlijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\hartfalen_-_rijn_en_duin\hartfalen_53530250_patientenlijst_kort.sql

[ERROR] Failed to process hartfalen_53533295_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\incontinentie_-_rijn_en_duin\incontinentie_indicatoren_53530250_verzamel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\incontinentie_-_rijn_en_duin\incontinentie_indicatoren_53530250_indic_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\incontinentie_-_rijn_en_duin\incontinentie_indicatoren_53530250_indic.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\incontinentie_-_rijn_en_duin\incontinentie_indicatoren_53530250_pl.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\incontinentie_-_rijn_en_duin\incontinentie_indic_53530250_episode.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\incontinentie_-_rijn_en_duin\incontinentie_indic_53530250_pre_medicatie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\incontinentie_-_rijn_en_duin\incontinentie_indic_53530250_mat_met_icpc.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\incontinentie_-_rijn_en_duin\incontinentie_indic_53530250_mat_zonder_icpc.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\incontinentie_-_rijn_en_duin\incontinentie_indic_53530250_verwijzing.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\indicatie_voor_maagbescherming\indicatie_maagbescherming_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\indicatie_voor_maagbescherming\indicatie_maagbescherming_patientenlijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\indicatie_voor_maagbescherming\indicatie_maagbescherming_pl_toon.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\indicatie_voor_maagbescherming\indicatie_maagbescherming_indicatoren_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\indicatie_voor_maagbescherming\indicatie_maagbescherming_indicatoren.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\indicatie_voor_maagbescherming\indicatie_maagbescherming_pl_ppi.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\indicatie_voor_maagbescherming\indicatie_maagbescherming_medicatie_2.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\indicatie_voor_maagbescherming\indicatie_maagbescherming_actuele_med.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\indicatie_voor_maagbescherming\indicatie_maagbescherming_atc_count.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\indicatie_voor_maagbescherming\indicatie_maagbescherming_episode.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\indicatie_voor_maagbescherming\indicatie_maagbescherming_med_30dg.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\indicatie_voor_maagbescherming\indicatie_maagbescherming_med_jaar.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\indicatie_voor_maagbescherming\indicatie_maagbescherming_med_dosis.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ineen_ketenzorg_astma_2023_indicatoren\ineen_ketenzorg_astma_volw_2023_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ineen_ketenzorg_astma_2023_indicatoren\ineen_ketenzorg_astma_volw_2023_indicatoren_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ineen_ketenzorg_astma_2023_indicatoren\ineen_ketenzorg_astma_volw_2023_indicatoren_perc.sql

[ERROR] Failed to process ineen_ketenzorg_astma_2023_indic_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ineen_ketenzorg_astma_2023_patientenlijst\ineen_ketenzorg_astma_volw_2023_pl_patientenlijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ineen_ketenzorg_astma_2023_patientenlijst\ineen_ketenzorg_astma_volw_2023_tussen.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ineen_ketenzorg_astma_2023_patientenlijst\ineen_ketenzorg_astma_volw_2023_inclusie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ineen_ketenzorg_astma_2023_patientenlijst\ineen_ketenzorg_astma_volw_2023_exclusie.sql

[ERROR] Failed to process ineen_ketenzorg_astma_2023_pl_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ineen_ketenzorg_astma_2024_indicatoren\ineen_ketenzorg_astma_volw_2024_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ineen_ketenzorg_astma_2024_indicatoren\ineen_ketenzorg_astma_volw_2024_indicatoren_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ineen_ketenzorg_astma_2024_indicatoren\ineen_ketenzorg_astma_volw_2024_indicatoren_perc.sql

[ERROR] Failed to process ineen_ketenzorg_astma_2024_indic_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ineen_ketenzorg_astma_2024_patientenlijst\ineen_ketenzorg_astma_volw_2024_pl_patientenlijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ineen_ketenzorg_astma_2024_patientenlijst\ineen_ketenzorg_astma_volw_2024_tussen.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ineen_ketenzorg_astma_2024_patientenlijst\ineen_ketenzorg_astma_volw_2024_inclusie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ineen_ketenzorg_astma_2024_patientenlijst\ineen_ketenzorg_astma_volw_2024_exclusie.sql

[ERROR] Failed to process ineen_ketenzorg_astma_2024_pl_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ineen_ketenzorg_copd_2023_indicatoren\ineen_ketenzorg_copd_2023_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ineen_ketenzorg_copd_2023_indicatoren\ineen_ketenzorg_copd_2023_indicatoren_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ineen_ketenzorg_copd_2023_indicatoren\ineen_ketenzorg_copd_2023_indicatoren_perc.sql

[ERROR] Failed to process ineen_ketenzorg_copd_2023_indic_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ineen_ketenzorg_copd_2023_patientenlijst\ineen_ketenzorg_copd_2023_pl_patientenlijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ineen_ketenzorg_copd_2023_patientenlijst\ineen_ketenzorg_copd_2023_tussen.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ineen_ketenzorg_copd_2023_patientenlijst\ineen_ketenzorg_copd_2023_inclusie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ineen_ketenzorg_copd_2023_patientenlijst\ineen_ketenzorg_copd_2023_exclusie.sql

[ERROR] Failed to process ineen_ketenzorg_copd_2023_pl_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ineen_ketenzorg_copd_2024_indicatoren\ineen_ketenzorg_copd_2024_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ineen_ketenzorg_copd_2024_indicatoren\ineen_ketenzorg_copd_2024_indicatoren_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ineen_ketenzorg_copd_2024_indicatoren\ineen_ketenzorg_copd_2024_indicatoren_perc.sql

[ERROR] Failed to process ineen_ketenzorg_copd_2024_indic_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ineen_ketenzorg_copd_2024_patientenlijst\ineen_ketenzorg_copd_2024_pl_patientenlijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ineen_ketenzorg_copd_2024_patientenlijst\ineen_ketenzorg_copd_2024_tussen.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ineen_ketenzorg_copd_2024_patientenlijst\ineen_ketenzorg_copd_2024_inclusie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ineen_ketenzorg_copd_2024_patientenlijst\ineen_ketenzorg_copd_2024_exclusie.sql

[ERROR] Failed to process ineen_ketenzorg_copd_2024_pl_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ineen_ketenzorg_dm_2023_indicatoren\ineen_ketenzorg_dm_2023_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ineen_ketenzorg_dm_2023_indicatoren\ineen_ketenzorg_dm_2023_indicatoren_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ineen_ketenzorg_dm_2023_indicatoren\ineen_ketenzorg_dm_2023_indicatoren_perc.sql

[ERROR] Failed to process ineen_ketenzorg_dm_2023_indic_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ineen_ketenzorg_dm_2023_patientenlijst\ineen_ketenzorg_dm_2023_pl_patientenlijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ineen_ketenzorg_dm_2023_patientenlijst\ineen_ketenzorg_dm_2023_pl_tussen.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ineen_ketenzorg_dm_2023_patientenlijst\ineen_ketenzorg_dm_2023_pl_inclusie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ineen_ketenzorg_dm_2023_patientenlijst\ineen_ketenzorg_dm_2023_pl_exclusie.sql

[ERROR] Failed to process ineen_ketenzorg_dm_2023_pl_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ineen_ketenzorg_dm_2024_indicatoren\ineen_ketenzorg_dm_2024_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ineen_ketenzorg_dm_2024_indicatoren\ineen_ketenzorg_dm_2024_indicatoren_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ineen_ketenzorg_dm_2024_indicatoren\ineen_ketenzorg_dm_2024_indicatoren_perc.sql

[ERROR] Failed to process ineen_ketenzorg_dm_2024_indic_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ineen_ketenzorg_dm_2024_patientenlijst\ineen_ketenzorg_dm_2024_pl_patientenlijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ineen_ketenzorg_dm_2024_patientenlijst\ineen_ketenzorg_dm_2024_pl_tussen.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ineen_ketenzorg_dm_2024_patientenlijst\ineen_ketenzorg_dm_2024_pl_inclusie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ineen_ketenzorg_dm_2024_patientenlijst\ineen_ketenzorg_dm_2024_pl_exclusie.sql

[ERROR] Failed to process ineen_ketenzorg_dm_2024_pl_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ineen_ketenzorg_hvz_zeer_hoog_risico_2023_indicatoren\ineen_ketenzorg_hvz_2023_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ineen_ketenzorg_hvz_zeer_hoog_risico_2023_indicatoren\ineen_ketenzorg_hvz_2023_indicatoren_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ineen_ketenzorg_hvz_zeer_hoog_risico_2023_indicatoren\ineen_ketenzorg_hvz_2023_indicatoren_perc.sql

[ERROR] Failed to process ineen_ketenzorg_hvz_2023_indic_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ineen_ketenzorg_hvz_zeer_hoog_risico_2023_patientenlijst\ineen_ketenzorg_hvz_2023_patientenlijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ineen_ketenzorg_hvz_zeer_hoog_risico_2023_patientenlijst\ineen_ketenzorg_hvz_2023_tussen.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ineen_ketenzorg_hvz_zeer_hoog_risico_2023_patientenlijst\ineen_ketenzorg_hvz_2023_inclusie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ineen_ketenzorg_hvz_zeer_hoog_risico_2023_patientenlijst\ineen_ketenzorg_hvz_2023_exclusie.sql

[ERROR] Failed to process ineen_ketenzorg_hvz_2023_pl_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ineen_ketenzorg_hvz_zeer_hoog_risico_2024_indicatoren\ineen_ketenzorg_hvz_2024_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ineen_ketenzorg_hvz_zeer_hoog_risico_2024_indicatoren\ineen_ketenzorg_hvz_2024_indicatoren_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ineen_ketenzorg_hvz_zeer_hoog_risico_2024_indicatoren\ineen_ketenzorg_hvz_2024_indicatoren_perc.sql

[ERROR] Failed to process ineen_ketenzorg_hvz_2024_indic_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ineen_ketenzorg_hvz_zeer_hoog_risico_2024_patientenlijst\ineen_ketenzorg_hvz_2024_patientenlijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ineen_ketenzorg_hvz_zeer_hoog_risico_2024_patientenlijst\ineen_ketenzorg_hvz_2024_tussen.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ineen_ketenzorg_hvz_zeer_hoog_risico_2024_patientenlijst\ineen_ketenzorg_hvz_2024_inclusie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ineen_ketenzorg_hvz_zeer_hoog_risico_2024_patientenlijst\ineen_ketenzorg_hvz_2024_exclusie.sql

[ERROR] Failed to process ineen_ketenzorg_hvz_2024_pl_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ineen_ketenzorg_ouderenzorg_2023_indicatoren\ineen_ketenzorg_oz_2023_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ineen_ketenzorg_ouderenzorg_2023_indicatoren\ineen_ketenzorg_oz_2023_indicatoren_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ineen_ketenzorg_ouderenzorg_2023_indicatoren\ineen_ketenzorg_oz_2023_indicatoren.sql

[ERROR] Failed to process ineen_ketenzorg_oz_2023_indic_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ineen_ketenzorg_ouderenzorg_2023_patientenlijst\ineen_ketenzorg_oz_2023_pl_patientenlijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ineen_ketenzorg_ouderenzorg_2023_patientenlijst\ineen_ketenzorg_oz_2023_pl_tussen.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ineen_ketenzorg_ouderenzorg_2023_patientenlijst\ineen_ketenzorg_oz_2023_pl_inclusie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ineen_ketenzorg_ouderenzorg_2023_patientenlijst\ineen_ketenzorg_oz_2023_pl_exclusie.sql

[ERROR] Failed to process ineen_ketenzorg_oz_2023_pl_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ineen_ketenzorg_ouderenzorg_2024_indicatoren\ineen_ketenzorg_oz_2024_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ineen_ketenzorg_ouderenzorg_2024_indicatoren\ineen_ketenzorg_oz_2024_indicatoren_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ineen_ketenzorg_ouderenzorg_2024_indicatoren\ineen_ketenzorg_oz_2024_indicatoren.sql

[ERROR] Failed to process ineen_ketenzorg_oz_2024_indic_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ineen_ketenzorg_ouderenzorg_2024_patientenlijst\ineen_ketenzorg_oz_2024_pl_patientenlijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ineen_ketenzorg_ouderenzorg_2024_patientenlijst\ineen_ketenzorg_oz_2024_pl_tussen.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ineen_ketenzorg_ouderenzorg_2024_patientenlijst\ineen_ketenzorg_oz_2024_pl_inclusie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ineen_ketenzorg_ouderenzorg_2024_patientenlijst\ineen_ketenzorg_oz_2024_pl_exclusie.sql

[ERROR] Failed to process ineen_ketenzorg_oz_2024_pl_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ineen_ketenzorg_vvr_hoog_risico_2023_indicatoren\ineen_ketenzorg_vvr_2023_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ineen_ketenzorg_vvr_hoog_risico_2023_indicatoren\ineen_ketenzorg_vvr_2023_indicatoren_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ineen_ketenzorg_vvr_hoog_risico_2023_indicatoren\ineen_ketenzorg_vvr_2023_indicatoren_perc.sql

[ERROR] Failed to process ineen_ketenzorg_vvr_2023_indic_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ineen_ketenzorg_vvr_hoog_risico_2023_patientenlijst\ineen_ketenzorg_vvr_2023_patientenlijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ineen_ketenzorg_vvr_hoog_risico_2023_patientenlijst\ineen_ketenzorg_vvr_2023_tussen.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ineen_ketenzorg_vvr_hoog_risico_2023_patientenlijst\ineen_ketenzorg_vvr_2023_inclusie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ineen_ketenzorg_vvr_hoog_risico_2023_patientenlijst\ineen_ketenzorg_vvr_2023_exclusie.sql

[ERROR] Failed to process ineen_ketenzorg_vvr_2023_pl_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ineen_ketenzorg_vvr_hoog_risico_2024_indicatoren\ineen_ketenzorg_vvr_2024_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ineen_ketenzorg_vvr_hoog_risico_2024_indicatoren\ineen_ketenzorg_vvr_2024_indicatoren_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ineen_ketenzorg_vvr_hoog_risico_2024_indicatoren\ineen_ketenzorg_vvr_2024_indicatoren_perc.sql

[ERROR] Failed to process ineen_ketenzorg_vvr_2024_indic_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ineen_ketenzorg_vvr_hoog_risico_2024_patientenlijst\ineen_ketenzorg_vvr_2024_patientenlijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ineen_ketenzorg_vvr_hoog_risico_2024_patientenlijst\ineen_ketenzorg_vvr_2024_tussen.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ineen_ketenzorg_vvr_hoog_risico_2024_patientenlijst\ineen_ketenzorg_vvr_2024_inclusie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ineen_ketenzorg_vvr_hoog_risico_2024_patientenlijst\ineen_ketenzorg_vvr_2024_exclusie.sql

[ERROR] Failed to process ineen_ketenzorg_vvr_2024_pl_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_astma_patientenlijst_-_ghc\inkaarten_astma_pl_53530098_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_astma_patientenlijst_-_ghc\inkaarten_astma_pl_53530098_patientenlijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_astma_patientenlijst_-_ghc\inkaarten_astma_pl_53530098_inclusie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_astma_patientenlijst_-_ghc\inkaarten_astma_pl_53530098_exclusie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_astma_patientenlijst_-_ghc\inkaarten_astma_pl_53530098_geen_medicatie.sql

[ERROR] Failed to process inkaarten_astma_patientenlijst_53530098_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_copd_patientenlijst_-_ketenzorg_arnhem\inkaarten_copd_pl_53530047_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_copd_patientenlijst_-_ketenzorg_arnhem\inkaarten_copd_pl_53530047_pl_copd.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_copd_patientenlijst_-_ketenzorg_arnhem\inkaarten_copd_pl_53530047_tussen.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_copd_patientenlijst_-_ketenzorg_arnhem\inkaarten_copd_pl_53530047_inclusie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_copd_patientenlijst_-_ketenzorg_arnhem\inkaarten_copd_pl_53530047_exclusie.sql

[ERROR] Failed to process inkaarten_copd_pl_53530047_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_coronair_lijden_patientenlijst_-_ghc\inkaarten_cl_pl_53530098_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_coronair_lijden_patientenlijst_-_ghc\inkaarten_cl_pl_53530098_patientenlijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_coronair_lijden_patientenlijst_-_ghc\inkaarten_cl_pl_53530098_tussen.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_coronair_lijden_patientenlijst_-_ghc\inkaarten_cl_pl_53530098_inclusie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_coronair_lijden_patientenlijst_-_ghc\inkaarten_cl_pl_53530098_exclusie.sql

[ERROR] Failed to process inkaarten_coronair_lijden_pl_encrypted_53530098.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_dementie_patientenlijst_-_ghc\inkaarten_dementie_pl_53530098_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_dementie_patientenlijst_-_ghc\inkaarten_dementie_pl_53530098_patientenlijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_dementie_patientenlijst_-_ghc\inkaarten_dementie_pl_53530098_tussen.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_dementie_patientenlijst_-_ghc\inkaarten_dementie_pl_53530098_inclusie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_dementie_patientenlijst_-_ghc\inkaarten_dementie_pl_53530098_exclusie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_dementie_patientenlijst_-_ghc\inkaarten_dementie_pl_53530098_incl_gn_zorgplan.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_dementie_patientenlijst_-_ghc\inkaarten_dementie_pl_53530098_verdacht.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_epa_patientenlijst_cvrm_-_ketenzorg_arnhem\inkaarten_epa_pl_cvrm_53530047_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_epa_patientenlijst_cvrm_-_ketenzorg_arnhem\inkaarten_epa_pl_cvrm_53530047_patientenlijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_epa_patientenlijst_cvrm_-_ketenzorg_arnhem\inkaarten_epa_pl_53530047_contact.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_epa_patientenlijst_cvrm_-_ketenzorg_arnhem\inkaarten_epa_pl_53530047_verwijzing.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_epa_patientenlijst_dm_-_ketenzorg_arnhem\inkaarten_epa_pl_dm_53530047_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_epa_patientenlijst_dm_-_ketenzorg_arnhem\inkaarten_epa_pl_dm_53530047_patientenlijst.sql

[ERROR] Failed to process inkaarten_epa_pl_dm_53530047_encrypted.pry: Invalid PRY format: 'queries:' section not found
[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# WHERE levert de regel met standaard criteria (53530000) en eventueel de regel met zorggroep crite
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_af_patientenlijst_v1.0\inkaarten_pl_af_v1_0_vertaling.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_af_patientenlijst_v1.0\inkaarten_pl_af_v1_0_patientenlijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_af_patientenlijst_v1.0\inkaarten_pl_af_v1_0_inclusie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_af_patientenlijst_v1.0\inkaarten_pl_af_v1_0_exclusie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_af_patientenlijst_v1.0\inkaarten_pl_af_v1_0_hb_spec.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_af_patientenlijst_v1.0\inkaarten_pl_af_v1_0_hb_onbekend.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_af_patientenlijst_v1.0\inkaarten_pl_af_v1_0_deelname_kz_onbekend.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_af_patientenlijst_v1.0\inkaarten_pl_af_v1_0_excl_deelname_kz_nee.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Voor FEA #} {# Deze patiÃ«nten worden straks op bepaal gezet, omdat HB en/of KZ lange tijd niet ge
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_af_patientenlijst_v1.0\inkaarten_pl_af_v1_0_hb_kz_18mnd.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_af_patientenlijst_v1.0\inkaarten_pl_af_v1_0_geen_episode.sql

[ERROR] Failed to process inkaarten_pl_af_v1_0_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_astma_patientenlijst_v1.0\inkaarten_pl_astma_v1_0_vertaling.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_astma_patientenlijst_v1.0\inkaarten_pl_astma_v1_0_patientenlijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_astma_patientenlijst_v1.0\inkaarten_pl_astma_v1_0_inclusie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_astma_patientenlijst_v1.0\inkaarten_pl_astma_v1_0_exclusie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_astma_patientenlijst_v1.0\inkaarten_pl_astma_v1_0_hb_spec.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_astma_patientenlijst_v1.0\inkaarten_pl_astma_v1_0_hb_onbekend.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# patientenlijst alleen tonen als deelname ketenzorg een inclusiecriterium is #}
SELECT
  *
FROM {{
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_astma_patientenlijst_v1.0\inkaarten_pl_astma_v1_0_deelname_kz_onbekend.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_astma_patientenlijst_v1.0\inkaarten_pl_astma_v1_0_deelname_kz_nee.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Voor FEA #} {# Deze patiÃ«nten worden straks op bepaal gezet, omdat HB en/of KZ lange tijd niet ge
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_astma_patientenlijst_v1.0\inkaarten_pl_astma_v1_0_hb_kz_18mnd.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Voor 53530209,FEA #}
SELECT
  *
FROM {{ ref('inkaarten_pl_astma_v1_0_patientenlijst') }}
WHERE
  
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_astma_patientenlijst_v1.0\inkaarten_pl_astma_v1_0_geen_medicatie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_astma_patientenlijst_v1.0\inkaarten_pl_astma_v1_0_geen_episode.sql

[ERROR] Failed to process inkaarten_pl_astma_v1_0_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_copd_patientenlijst_v1.0\inkaarten_pl_copd_v1_0_vertaling.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_copd_patientenlijst_v1.0\inkaarten_pl_copd_v1_0_patientenlijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_copd_patientenlijst_v1.0\inkaarten_pl_copd_v1_0_inclusie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_copd_patientenlijst_v1.0\inkaarten_pl_copd_v1_0_exclusie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_copd_patientenlijst_v1.0\inkaarten_pl_copd_v1_0_hb_spec.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_copd_patientenlijst_v1.0\inkaarten_pl_copd_v1_0_hb_onbekend.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# patientenlijst alleen tonen als deelname ketenzorg een inclusiecriterium is #}
SELECT
  *
FROM {{
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_copd_patientenlijst_v1.0\inkaarten_pl_copd_v1_0_deelname_kz_onbekend.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_copd_patientenlijst_v1.0\inkaarten_pl_copd_v1_0_deelname_kz_nee.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_copd_patientenlijst_v1.0\inkaarten_pl_copd_v1_0_geen_episode.sql

[ERROR] Failed to process inkaarten_pl_copd_v1_0_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_dm_patientenlijst_v1.0\inkaarten_pl_dm_v1_0_vertaling.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_dm_patientenlijst_v1.0\inkaarten_pl_dm_v1_0_patientenlijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_dm_patientenlijst_v1.0\inkaarten_pl_dm_v1_0_inclusie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_dm_patientenlijst_v1.0\inkaarten_pl_dm_v1_0_exclusie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_dm_patientenlijst_v1.0\inkaarten_pl_dm_v1_0_t90.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_dm_patientenlijst_v1.0\inkaarten_pl_dm_v1_0_hb_spec.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_dm_patientenlijst_v1.0\inkaarten_pl_dm_v1_0_hb_onbekend.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# patientenlijst alleen tonen als deelname ketenzorg een inclusiecriterium is #}
SELECT
  *
FROM {{
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_dm_patientenlijst_v1.0\inkaarten_pl_dm_v1_0_deelname_kz_onbekend.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_dm_patientenlijst_v1.0\inkaarten_pl_dm_v1_0_deelname_kz_nee.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_dm_patientenlijst_v1.0\inkaarten_pl_dm_v1_0_geen_episode.sql

[ERROR] Failed to process inkaarten_pl_dm_v1_0_encrypted.pry: Invalid PRY format: 'queries:' section not found
[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# WHERE levert de regel met standaard criteria (53530000) en eventueel de regel met zorggroep crite
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_ggz_patientenlijst_v1.0\inkaarten_pl_ggz_v1_0_vertaling.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_ggz_patientenlijst_v1.0\inkaarten_pl_ggz_v1_0_patientenlijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_ggz_patientenlijst_v1.0\inkaarten_pl_ggz_v1_0_inclusie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_ggz_patientenlijst_v1.0\inkaarten_pl_ggz_v1_0_exclusie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_ggz_patientenlijst_v1.0\inkaarten_pl_ggz_v1_0_hb_spec.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_ggz_patientenlijst_v1.0\inkaarten_pl_ggz_v1_0_hb_onbekend.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# patientenlijst alleen tonen als deelname ketenzorg een inclusiecriterium is #}
SELECT
  *
FROM {{
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_ggz_patientenlijst_v1.0\inkaarten_pl_ggz_v1_0_deelname_kz_onbekend.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_ggz_patientenlijst_v1.0\inkaarten_pl_ggz_v1_0_deelname_kz_nee.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_ggz_patientenlijst_v1.0\inkaarten_pl_ggz_v1_0_last_cont_pp.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_hartfalen_patientenlijst_v1.0\inkaarten_pl_hf_v1_0_vertaling.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_hartfalen_patientenlijst_v1.0\inkaarten_pl_hf_v1_0_patientenlijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_hartfalen_patientenlijst_v1.0\inkaarten_pl_hf_v1_0_inclusie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_hartfalen_patientenlijst_v1.0\inkaarten_pl_hf_v1_0_exclusie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_hartfalen_patientenlijst_v1.0\inkaarten_pl_hf_v1_0_hb_spec.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_hartfalen_patientenlijst_v1.0\inkaarten_pl_hf_v1_0_hb_onbekend.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_hartfalen_patientenlijst_v1.0\inkaarten_pl_hf_v1_0_deelname_kz_onbekend.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_hartfalen_patientenlijst_v1.0\inkaarten_pl_hf_v1_0_excl_deelname_kz_nee.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_hartfalen_patientenlijst_v1.0\inkaarten_pl_hf_v1_0_geen_episode.sql

[ERROR] Failed to process inkaarten_pl_hf_v1_0_encrypted.pry: Invalid PRY format: 'queries:' section not found
[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# LET OP! RAPPORT KOMT NIET OVEREEN MET DE NIEUWSTE DEFINITIES!!! #}
SELECT
  zorggroep,
  patient_
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_hvz_patientenlijst_v1.0\inkaarten_pl_hvz_v1_0_vertaling.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# LET OP: ptn die voldoen aan de VVR definitie of een (in)actieve VVR episode hebben, #} {# en die 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_hvz_patientenlijst_v1.0\inkaarten_pl_hvz_v1_0_patientenlijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_hvz_patientenlijst_v1.0\inkaarten_pl_hvz_v1_0_patientenlijst_cvrm.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_hvz_patientenlijst_v1.0\inkaarten_pl_hvz_v1_0_inclusie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_hvz_patientenlijst_v1.0\inkaarten_pl_hvz_v1_0_exclusie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_hvz_patientenlijst_v1.0\inkaarten_pl_hvz_v1_0_k90.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_hvz_patientenlijst_v1.0\inkaarten_pl_hvz_v1_0_hb_spec.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_hvz_patientenlijst_v1.0\inkaarten_pl_hvz_v1_0_hb_onbekend.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# patientenlijst alleen tonen als deelname ketenzorg een inclusiecriterium is #}
SELECT
  *
FROM {{
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_hvz_patientenlijst_v1.0\inkaarten_pl_hvz_v1_0_deelname_kz_onbekend.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_hvz_patientenlijst_v1.0\inkaarten_pl_hvz_v1_0_deelname_kz_nee.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Bevat de gehele CVRM lijst (HVZ +VVR). Tabblad niet langer aanwezig op VVR. #} {# Tabblad in dit 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_hvz_patientenlijst_v1.0\inkaarten_pl_hvz_v1_0_geen_episode.sql

[ERROR] Failed to process inkaarten_pl_hvz_v1_0_encrypted.pry: Invalid PRY format: 'queries:' section not found
[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# WHERE levert de regel met standaard criteria (53530000) en eventueel de regel met zorggroep crite
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_osteoporose_patientenlijst_v1.0\inkaarten_pl_os_v1_0_vertaling.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_osteoporose_patientenlijst_v1.0\inkaarten_pl_os_v1_0_patientenlijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_osteoporose_patientenlijst_v1.0\inkaarten_pl_os_v1_0_inclusie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_osteoporose_patientenlijst_v1.0\inkaarten_pl_os_v1_0_exclusie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_osteoporose_patientenlijst_v1.0\inkaarten_pl_os_v1_0_hb_spec.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_osteoporose_patientenlijst_v1.0\inkaarten_pl_os_v1_0_hb_onbekend.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# patientenlijst alleen tonen als deelname ketenzorg een inclusiecriterium is #} {# In std is DKZ g
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_osteoporose_patientenlijst_v1.0\inkaarten_pl_os_v1_0_deelname_kz_onbekend.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# In std is DKZ geen INCL. criterium, maar ELSE wel vast uitgewerkt. #}
SELECT
  *
FROM {{ ref('ink
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_osteoporose_patientenlijst_v1.0\inkaarten_pl_os_v1_0_deelname_kz_nee.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Voor FEA #} {# Deze patiÃ«nten worden straks op bepaal gezet, omdat HB en/of KZ lange tijd niet ge
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_osteoporose_patientenlijst_v1.0\inkaarten_pl_os_v1_0_hb_kz_18mnd.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Voor 53530082,FEA #}
SELECT
  *
FROM {{ ref('inkaarten_pl_os_v1_0_patientenlijst') }}
WHERE
  CAS
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_osteoporose_patientenlijst_v1.0\inkaarten_pl_os_v1_0_geen_medicatie.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# In std is DKZ geen INCL. criterium, maar wel bewust meegenomen in deze view. #}
SELECT
  *
FROM {
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_osteoporose_patientenlijst_v1.0\inkaarten_pl_os_v1_0_geen_episode.sql

[ERROR] Failed to process inkaarten_pl_os_v1_0_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_ouderenzorg_menzis_patiÃ«ntenlijst\inkaarten_pl_oz_menzis_vertaling.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_ouderenzorg_menzis_patiÃ«ntenlijst\inkaarten_pl_oz_menzis_patientenlijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_ouderenzorg_menzis_patiÃ«ntenlijst\inkaarten_pl_oz_menzis_inclusie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_ouderenzorg_menzis_patiÃ«ntenlijst\inkaarten_pl_oz_menzis_exclusie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_ouderenzorg_menzis_patiÃ«ntenlijst\inkaarten_pl_oz_menzis_hb_spec.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_ouderenzorg_menzis_patiÃ«ntenlijst\inkaarten_pl_oz_menzis_hb_onbekend.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_ouderenzorg_menzis_patiÃ«ntenlijst\inkaarten_pl_oz_menzis_deelname_kz_onbekend.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_ouderenzorg_menzis_patiÃ«ntenlijst\inkaarten_pl_oz_menzis_deelname_kz_nee.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_ouderenzorg_menzis_patiÃ«ntenlijst\inkaarten_pl_oz_menzis_geen_episode.sql

[ERROR] Failed to process inkaarten_pl_oz_menzis_encrypted.pry: Invalid PRY format: 'queries:' section not found
[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# WHERE levert de regel met standaard criteria (53530000) en eventueel de regel met zorggroep crite
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_ouderenzorg_patientenlijst_v1.0\inkaarten_pl_oz_v1_0_vertaling.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_ouderenzorg_patientenlijst_v1.0\inkaarten_pl_oz_v1_0_patientenlijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_ouderenzorg_patientenlijst_v1.0\inkaarten_pl_oz_v1_0_inclusie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_ouderenzorg_patientenlijst_v1.0\inkaarten_pl_oz_v1_0_exclusie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_ouderenzorg_patientenlijst_v1.0\inkaarten_pl_oz_v1_0_hb_spec.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_ouderenzorg_patientenlijst_v1.0\inkaarten_pl_oz_v1_0_hb_onbekend.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_ouderenzorg_patientenlijst_v1.0\inkaarten_pl_oz_v1_0_deelname_kz_onbekend.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_ouderenzorg_patientenlijst_v1.0\inkaarten_pl_oz_v1_0_deelname_kz_nee.sql

[ERROR] Failed to process inkaarten_pl_oz_v1_0_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_vvr_patientenlijst_mediis\inkaarten_pl_vvr_53530312_vertaling.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_vvr_patientenlijst_mediis\inkaarten_pl_vvr_53530312_patientenlijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_vvr_patientenlijst_mediis\inkaarten_pl_vvr_53530312_inclusie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_vvr_patientenlijst_mediis\inkaarten_pl_vvr_53530312_exclusie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_vvr_patientenlijst_mediis\inkaarten_pl_vvr_53530312_hb_spec.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_vvr_patientenlijst_mediis\inkaarten_pl_vvr_53530312_hb_onbekend.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_vvr_patientenlijst_mediis\inkaarten_pl_vvr_53530312_deelname_kz_onbekend.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_vvr_patientenlijst_mediis\inkaarten_pl_vvr_53530312_deelname_kz_nee.sql

[ERROR] Failed to process inkaarten_pl_vvr_53530312_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_vvr_patientenlijst_overweeg_risicoschatting_-_mediis\inkaarten_pl_vvr_overweeg_risico_53530312_vert.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_vvr_patientenlijst_overweeg_risicoschatting_-_mediis\inkaarten_pl_vvr_overweeg_risico_53530312_pl.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_vvr_patientenlijst_overweeg_risicoschatting_-_mediis\inkaarten_pl_vvr_overweeg_risico_53530312_incl.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_vvr_patientenlijst_overweeg_risicoschatting_-_mediis\inkaarten_pl_vvr_overweeg_risico_53530312_excl.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_vvr_patientenlijst_overweeg_risicoschatting_-_mediis\inkaarten_pl_vvr_overweeg_risico_53530312_hb_spec.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_vvr_patientenlijst_overweeg_risicoschatting_-_mediis\inkaarten_pl_vvr_overweeg_risico_53530312_hb_onb.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_vvr_patientenlijst_overweeg_risicoschatting_-_mediis\inkaarten_pl_vvr_overweeg_risico_53530312_kz_onb.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_vvr_patientenlijst_overweeg_risicoschatting_-_mediis\inkaarten_pl_vvr_overweeg_risico_53530312_kz_nee.sql

[ERROR] Failed to process inkaarten_pl_vvr_overweeg_risico_53530312_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_vvr_patientenlijst_risicoschatting_mediis\inkaarten_pl_vvr_risicoschatting_53530312_vert.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_vvr_patientenlijst_risicoschatting_mediis\inkaarten_pl_vvr_risicoschatting_53530312_pl.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_vvr_patientenlijst_risicoschatting_mediis\inkaarten_pl_vvr_risicoschatting_53530312_incl.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_vvr_patientenlijst_risicoschatting_mediis\inkaarten_pl_vvr_risicoschatting_53530312_excl.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_vvr_patientenlijst_risicoschatting_mediis\inkaarten_pl_vvr_risicoschatting_53530312_hb_spec.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_vvr_patientenlijst_risicoschatting_mediis\inkaarten_pl_vvr_risicoschatting_53530312_hb_onb.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_vvr_patientenlijst_risicoschatting_mediis\inkaarten_pl_vvr_risicoschatting_53530312_kz_onb.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_vvr_patientenlijst_risicoschatting_mediis\inkaarten_pl_vvr_risicoschatting_53530312_kz_nee.sql

[ERROR] Failed to process inkaarten_pl_vvr_risicoschatting_53530312_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_vvr_patientenlijst_v1.0\inkaarten_pl_vvr_v1_0_vertaling.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_vvr_patientenlijst_v1.0\inkaarten_pl_vvr_v1_0_patientenlijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_vvr_patientenlijst_v1.0\inkaarten_pl_vvr_v1_0_inclusie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_vvr_patientenlijst_v1.0\inkaarten_pl_vvr_v1_0_exclusie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_vvr_patientenlijst_v1.0\inkaarten_pl_vvr_v1_0_hb_spec.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_vvr_patientenlijst_v1.0\inkaarten_pl_vvr_v1_0_hb_onbekend.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_vvr_patientenlijst_v1.0\inkaarten_pl_vvr_v1_0_deelname_kz_onbekend.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_vvr_patientenlijst_v1.0\inkaarten_pl_vvr_v1_0_deelname_kz_nee.sql

[ERROR] Failed to process inkaarten_pl_vvr_v1_0_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_vvr_risicoscore_-_badhoevedorp\inkaarten_vvr_risicoscore_53533075_hb_eerste_dd.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_vvr_risicoscore_-_badhoevedorp\inkaarten_vvr_risicoscore_53533075_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_vvr_risicoscore_-_badhoevedorp\inkaarten_vvr_risicoscore_53533075_ind_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_vvr_risicoscore_-_badhoevedorp\inkaarten_vvr_risicoscore_53533075_ind_perc.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_vvr_risicoscore_-_badhoevedorp\inkaarten_vvr_risicoscore_53533075_pl.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_vvr_risicoscore_-_badhoevedorp\inkaarten_vvr_risicoscore_53533075_epi.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_vvr_risicoscore_-_badhoevedorp\inkaarten_vvr_risicoscore_53533075_vrm_epi.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW inkaarten_vvr_risicoscore_53533075_meetwaarden AS
SELECT * FROM
crosstab(
            'WITH bepalingen AS
        (
        SELECT 
            patient_id::varchar,
            nhgnummer,
            CASE LOWER(uitslag)
                WHEN ''ha'' THEN ''huisarts''
                WHEN ''spec'' THEN ''specialist''
                WHEN ''ovond'' THEN ''overig/onbekend''
                ELSE uitslag
                END as uitslag,
            COALESCE(aw.output, uitslag_num) as uitslag_num,
            datum
        FROM bepaling b
        LEFT JOIN indelingen.alfanumerieke_waarden aw
            ON b.nhgnummer=aw.nhgnr
            AND aw.input=uitslag
        WHERE nhgnummer IN (2413,2414,2815,3241,3242)
            )
            SELECT
                DISTINCT ON (patient_id,nhgnummer::integer)
                patient_id::varchar,
                nhgnummer::integer,
                ARRAY[coalesce(waarde_omschrijving,tekst_waarde)::varchar,
                    datum::varchar,
                    CASE WHEN uitslag_num is not null
                AND (rw.ineen_min is null OR rw.ineen_min <= uitslag_num)
                AND (rw.ineen_max is null OR rw.ineen_max >= uitslag_num)
                THEN uitslag_num END::varchar             
                        ] as waarde_datum_num
            FROM (
            SELECT   
                patient_id::varchar,
                nhgnummer,
                datum,
                uitslag as tekst_waarde,
                indelingen.translate_labcode_answers(nhgnummer::int, uitslag) as waarde_omschrijving,
                CASE WHEN nhgnummer=560 AND uitslag_num <3 THEN uitslag_num *100
                    ELSE COALESCE(output, uitslag_num) END as uitslag_num
            FROM bepalingen        
            LEFT JOIN indelingen.nhg_labcodes lc ON (nhgnummer=lc.nhgnr)
            LEFT JOIN indelingen.alfanumerieke_waarden aw ON (nhgnummer=aw.nhgnr and aw.input=uitslag)            
            WHERE nhgnummer=ANY(ARRAY[2413,2414,2815,3241,3242])
            AND datum < ''${peildatum}'') AS bepaling
            LEFT JOIN indelingen.nhg_labcodes_referentie_waarden rw ON (nhgnummer=rw.nhgnr)            
            ORDER BY patient_id,nhgnummer,datum DESC,tekst_waarde NULLS LAST,waarde_omschrijving NULLS LAST',
       'SELECT s.a[n] FROM generate_series(1,5) as n 
       CROSS JOIN (SELECT ARRAY[2413,2414,2815,3241,3242]
        as a) s ORDER BY n' 
       ) as ct(
    patient_id varchar,
    hvcb_kz    varchar[],
    hvrz_kz    varchar[],
    cvhb_kz    varchar[],
    rh12_kq_fb varchar[],
    rvfh_kq_fb varchar[]);
Converted crosstab SQL:

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_vvr_risicoscore_-_badhoevedorp\inkaarten_vvr_risicoscore_53533075_meetwaarden.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_vvr_risicoscore_-_badhoevedorp\inkaarten_vvr_risicoscore_53533075_pat_gegevens.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inkaarten_vvr_risicoscore_-_badhoevedorp\inkaarten_vvr_risicoscore_53533075_meetwaarden_hb.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\innovatieset_ineen_af\ineen_innovatieset_af_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\innovatieset_ineen_af\ineen_innovatieset_indicatoren_af_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\innovatieset_ineen_af\ineen_innovatieset_indicatoren_af.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\innovatieset_ineen_af\ineen_innovatieset_patientenlijst_af.sql

[ERROR] Failed to process innovatieset_ineen_af_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\innovatieset_ineen_chronische_nierschade\innovatieset_ineen_cns_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\innovatieset_ineen_chronische_nierschade\innovatieset_ineen_indicatoren_cns_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\innovatieset_ineen_chronische_nierschade\innovatieset_ineen_indicatoren_cns.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\innovatieset_ineen_chronische_nierschade\innovatieset_ineen_patientenlijst_cns.sql

[ERROR] Failed to process innovatieset_ineen_cns_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\innovatieset_ineen_copd\ineen_innovatieset_copd_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\innovatieset_ineen_copd\ineen_innovatieset_indicatoren_copd_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\innovatieset_ineen_copd\ineen_innovatieset_indicatoren_copd.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\innovatieset_ineen_copd\ineen_innovatieset_patientenlijst_copd.sql

[ERROR] Failed to process innovatieset_ineen_copd_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\innovatieset_ineen_dm\ineen_innovatieset_dm_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\innovatieset_ineen_dm\ineen_innovatieset_indicatoren_dm_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\innovatieset_ineen_dm\ineen_innovatieset_indicatoren_dm.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\innovatieset_ineen_dm\ineen_innovatieset_patientenlijst_dm.sql

[ERROR] Failed to process innovatieset_ineen_dm_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\innovatieset_ineen_hartfalen\ineen_innovatieset_hf_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\innovatieset_ineen_hartfalen\ineen_innovatieset_indicatoren_hf_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\innovatieset_ineen_hartfalen\ineen_innovatieset_indicatoren_hf.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\innovatieset_ineen_hartfalen\ineen_innovatieset_patientenlijst_hf.sql

[ERROR] Failed to process innovatieset_ineen_hf_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\innovatieset_ineen_hvz\innovatieset_ineen_hvz_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\innovatieset_ineen_hvz\innovatieset_ineen_indicatoren_hvz_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\innovatieset_ineen_hvz\innovatieset_ineen_indicatoren_hvz.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\innovatieset_ineen_hvz\innovatieset_ineen_patientenlijst_hvz.sql

[ERROR] Failed to process innovatieset_ineen_hvz_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\innovatieset_ineen_vvr\innovatieset_ineen_vvr_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\innovatieset_ineen_vvr\innovatieset_ineen_indicatoren_vvr_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\innovatieset_ineen_vvr\innovatieset_ineen_indicatoren_vvr.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\innovatieset_ineen_vvr\innovatieset_ineen_patientenlijst_vvr.sql

[ERROR] Failed to process innovatieset_ineen_vvr_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_chronische_zorg\inzicht_chronische_zorg_verzamel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_chronische_zorg\inzicht_chronische_zorg_indicatoren_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_chronische_zorg\inzicht_chronische_zorg_indicatoren.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_chronische_zorg\inzicht_chronische_zorg_pl.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_chronische_zorg\inzicht_chronische_zorg_episodelijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_cvrm_epa_-_ketenzorg_arnhem\inzicht_cvrm_epa_53530047_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_cvrm_epa_-_ketenzorg_arnhem\inzicht_cvrm_epa_53530047_indicatoren_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_cvrm_epa_-_ketenzorg_arnhem\inzicht_cvrm_epa_53530047_indicatoren.sql

[ERROR] Failed to process inzicht_cvrm_epa_53530047_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_cvrm_k91_-_53530047\inzicht_cvrm_k91_53530047_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_cvrm_k91_-_53530047\inzicht_cvrm_k91_53530047_indicatoren_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_cvrm_k91_-_53530047\inzicht_cvrm_k91_53530047_indicatoren.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_cvrm_k91_-_53530047\inzicht_cvrm_k91_53530047_pl.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_cvrm_k91_-_53530047\inzicht_cvrm_k91_53530047_pl_excl_cvrm.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_cvrm_k91_-_53530047\inzicht_cvrm_k91_53530047_pl_incl_cvrm.sql

[ERROR] Failed to process inzicht_cvrm_k91_53530047_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\hartfalen_-_dokter_drenthe\inzicht_hartfalen_53530556_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\hartfalen_-_dokter_drenthe\inzicht_hartfalen_53530556_indic_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\hartfalen_-_dokter_drenthe\inzicht_hartfalen_53530556_indic.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\hartfalen_-_dokter_drenthe\inzicht_hartfalen_53530556_patientenlijst.sql

[ERROR] Failed to process inzicht_declaratie_hartfalen_53530556_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_declaratie_verdeling\inzicht_decl_verdeling_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_declaratie_verdeling\inzicht_decl_verdeling_indic_dm_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_declaratie_verdeling\inzicht_decl_verdeling_indic_dm.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_declaratie_verdeling\inzicht_decl_verdeling_indic_copd_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_declaratie_verdeling\inzicht_decl_verdeling_indic_copd.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_declaratie_verdeling\inzicht_decl_verdeling_indic_hvz_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_declaratie_verdeling\inzicht_decl_verdeling_indic_hvz.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_declaratie_verdeling\inzicht_decl_verdeling_indic_vvr_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_declaratie_verdeling\inzicht_decl_verdeling_indic_vvr.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_declaratie_verdeling\inzicht_decl_verdeling_indic_astma_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_declaratie_verdeling\inzicht_decl_verdeling_indic_astma.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_declaratie_verdeling\inzicht_decl_verdeling_indic_hartfalen_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_declaratie_verdeling\inzicht_decl_verdeling_indic_hartfalen.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_declaratie_verdeling\inzicht_decl_verdeling_indic_bbr_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_declaratie_verdeling\inzicht_decl_verdeling_indic_bbr.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_declaratie_verdeling\inzicht_decl_verdeling_indic_oz_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_declaratie_verdeling\inzicht_decl_verdeling_indic_oz.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_declaratie_verdeling\inzicht_decl_verdeling_indic_ggz_jeugd_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_declaratie_verdeling\inzicht_decl_verdeling_indic_ggz_jeugd.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_declaratie_verdeling\inzicht_decl_verdeling_indic_ggz_volw_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_declaratie_verdeling\inzicht_decl_verdeling_indic_ggz_volw.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_declaratie_verdeling\inzicht_decl_verdeling_indic_os_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_declaratie_verdeling\inzicht_decl_verdeling_indic_os.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_declaratie_verdeling\inzicht_decl_verdeling_indic_af_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_declaratie_verdeling\inzicht_decl_verdeling_indic_af.sql

[ERROR] Failed to process inzicht_declaratie_verdeling_v_1_0_encrypted.pry: Invalid PRY format: 'queries:' section not found
[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# vvr zonder medicatie #}
SELECT 
    nummer,
    row_key,
    doelgroep,
    indicator,
    noemer
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_declaratie_verdeling\inz_decl_verdeling_indic_medic_vvr_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_declaratie_verdeling\inz_decl_verdeling_indic_medic_vvr.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# astma zonder medicatie #}
SELECT 
    nummer AS nummer,
    row_key AS row_key,
    doelgroep,
  
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_declaratie_verdeling\inz_decl_verdeling_indic_medic_astma_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_declaratie_verdeling\inz_decl_verdeling_indic_medic_astma.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_doelgroep_dbc_zonder_meetwaarden_criterium\inzicht_doelgroep_dbc_zonder_mw_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_doelgroep_dbc_zonder_meetwaarden_criterium\inzicht_doelgroep_dbc_zonder_mw_ind.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_doelgroep_dbc_zonder_meetwaarden_criterium\inzicht_doelgroep_dbc_zonder_mw_pl.sql

[ERROR] Failed to process inzicht_doelgroep_dbc_zonder_mw_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_epa_patienten\inzicht_epa_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_epa_patienten\inzicht_epa_indicatoren_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_epa_patienten\inzicht_epa_indicatoren.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_epa_patienten\inzicht_epa_patientenlijst.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {{ medicatie_epa() }}
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_epa_patienten\inzicht_epa_patienten_med_epa.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_extractie_-_pko\inzicht_extractie_pko_alle_patienten_pl.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# LET OP: Dit rapport wordt indirect gebruikt voor DBC wijzigingen, dus niet zomaar aanpassingen do
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_izp_en_controlebeleid_-_appingedam\inzicht_izp_controlebeleid_53530240_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_izp_en_controlebeleid_-_appingedam\inzicht_izp_controlebeleid_53530240_indic_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_izp_en_controlebeleid_-_appingedam\inzicht_izp_controlebeleid_53530240_indic.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_izp_en_controlebeleid_-_appingedam\inzicht_izp_controlebeleid_53530240_pl_huisarts.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_izp_en_controlebeleid_-_appingedam\inzicht_izp_controlebeleid_53530240_pl_overig.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_izp_en_controlebeleid_-_appingedam\inzicht_izp_controlebeleid_53530240_izp.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_izp_en_controlebeleid_-_appingedam\inzicht_izp_controlebeleid_53530240_ruiters.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_ketenzorgpatienten_per_zorgverzekeraar_2022\inzicht_pt_per_uzovi_2022_dm_ind_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_ketenzorgpatienten_per_zorgverzekeraar_2022\inzicht_pt_per_uzovi_2022_dm_ind.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_ketenzorgpatienten_per_zorgverzekeraar_2022\inzicht_pt_per_uzovi_2022_copd_ind_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_ketenzorgpatienten_per_zorgverzekeraar_2022\inzicht_pt_per_uzovi_2022_copd_ind.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_ketenzorgpatienten_per_zorgverzekeraar_2022\inzicht_pt_per_uzovi_2022_astma_ind_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_ketenzorgpatienten_per_zorgverzekeraar_2022\inzicht_pt_per_uzovi_2022_astma_ind.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_ketenzorgpatienten_per_zorgverzekeraar_2022\inzicht_pt_per_uzovi_2022_hvz_ind_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_ketenzorgpatienten_per_zorgverzekeraar_2022\inzicht_pt_per_uzovi_2022_hvz_ind.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_ketenzorgpatienten_per_zorgverzekeraar_2022\inzicht_pt_per_uzovi_2022_vvr_ind_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_ketenzorgpatienten_per_zorgverzekeraar_2022\inzicht_pt_per_uzovi_2022_vvr_ind.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_ketenzorgpatienten_per_zorgverzekeraar_2022\inzicht_pt_per_verzekeraar_2022_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_ketenzorgpatienten_per_zorgverzekeraar_2022\inzicht_pt_per_verzekeraar_2022_dm_ind_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_ketenzorgpatienten_per_zorgverzekeraar_2022\inzicht_pt_per_verzekeraar_2022_dm_ind.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_ketenzorgpatienten_per_zorgverzekeraar_2022\inzicht_pt_per_verzekeraar_2022_copd_ind_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_ketenzorgpatienten_per_zorgverzekeraar_2022\inzicht_pt_per_verzekeraar_2022_copd_ind.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_ketenzorgpatienten_per_zorgverzekeraar_2022\inzicht_pt_per_verzekeraar_2022_astma_ind_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_ketenzorgpatienten_per_zorgverzekeraar_2022\inzicht_pt_per_verzekeraar_2022_astma_ind.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_ketenzorgpatienten_per_zorgverzekeraar_2022\inzicht_pt_per_verzekeraar_2022_hvz_ind_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_ketenzorgpatienten_per_zorgverzekeraar_2022\inzicht_pt_per_verzekeraar_2022_hvz_ind.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_ketenzorgpatienten_per_zorgverzekeraar_2022\inzicht_pt_per_verzekeraar_2022_vvr_ind_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_ketenzorgpatienten_per_zorgverzekeraar_2022\inzicht_pt_per_verzekeraar_2022_vvr_ind.sql

[ERROR] Failed to process inzicht_ketenzorg_patienten_per_verzekeraar_2022_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_ketenzorgpatienten_per_zorgverzekeraar_2023\inzicht_pt_per_uzovi_2023_dm_ind_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_ketenzorgpatienten_per_zorgverzekeraar_2023\inzicht_pt_per_uzovi_2023_dm_ind.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_ketenzorgpatienten_per_zorgverzekeraar_2023\inzicht_pt_per_uzovi_2023_copd_ind_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_ketenzorgpatienten_per_zorgverzekeraar_2023\inzicht_pt_per_uzovi_2023_copd_ind.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_ketenzorgpatienten_per_zorgverzekeraar_2023\inzicht_pt_per_uzovi_2023_astma_ind_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_ketenzorgpatienten_per_zorgverzekeraar_2023\inzicht_pt_per_uzovi_2023_astma_ind.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_ketenzorgpatienten_per_zorgverzekeraar_2023\inzicht_pt_per_uzovi_2023_hvz_ind_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_ketenzorgpatienten_per_zorgverzekeraar_2023\inzicht_pt_per_uzovi_2023_hvz_ind.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_ketenzorgpatienten_per_zorgverzekeraar_2023\inzicht_pt_per_uzovi_2023_vvr_ind_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_ketenzorgpatienten_per_zorgverzekeraar_2023\inzicht_pt_per_uzovi_2023_vvr_ind.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_ketenzorgpatienten_per_zorgverzekeraar_2023\inzicht_pt_per_verzekeraar_2023_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_ketenzorgpatienten_per_zorgverzekeraar_2023\inzicht_pt_per_verzekeraar_2023_dm_ind_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_ketenzorgpatienten_per_zorgverzekeraar_2023\inzicht_pt_per_verzekeraar_2023_dm_ind.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_ketenzorgpatienten_per_zorgverzekeraar_2023\inzicht_pt_per_verzekeraar_2023_copd_ind_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_ketenzorgpatienten_per_zorgverzekeraar_2023\inzicht_pt_per_verzekeraar_2023_copd_ind.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_ketenzorgpatienten_per_zorgverzekeraar_2023\inzicht_pt_per_verzekeraar_2023_astma_ind_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_ketenzorgpatienten_per_zorgverzekeraar_2023\inzicht_pt_per_verzekeraar_2023_astma_ind.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_ketenzorgpatienten_per_zorgverzekeraar_2023\inzicht_pt_per_verzekeraar_2023_hvz_ind_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_ketenzorgpatienten_per_zorgverzekeraar_2023\inzicht_pt_per_verzekeraar_2023_hvz_ind.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_ketenzorgpatienten_per_zorgverzekeraar_2023\inzicht_pt_per_verzekeraar_2023_vvr_ind_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_ketenzorgpatienten_per_zorgverzekeraar_2023\inzicht_pt_per_verzekeraar_2023_vvr_ind.sql

[ERROR] Failed to process inzicht_ketenzorg_patienten_per_verzekeraar_2023_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_lege_dossiers_-_rijnmond_dokters\lege_dossiers_53533096_stable_override_pre.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_lege_dossiers_-_rijnmond_dokters\lege_dossiers_stable_override.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_lege_dossiers_-_rijnmond_dokters\lege_dossiers_53533096_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_lege_dossiers_-_rijnmond_dokters\lege_dossiers_53533096_ind_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_lege_dossiers_-_rijnmond_dokters\lege_dossiers_53533096_ind.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_lege_dossiers_-_rijnmond_dokters\lege_dossiers_53533096_patientenlijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_lege_dossiers_-_hozl\inzicht_lege_dossiers_53530004_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_lege_dossiers_-_hozl\inzicht_lege_dossiers_53530004_ind_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_lege_dossiers_-_hozl\inzicht_lege_dossiers_53530004_ind.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_lege_dossiers_-_hozl\inzicht_lege_dossiers_53530004_ind_abs_con.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_lege_dossiers_-_hozl\inzicht_lege_dossiers_53530004_ind_con.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_lege_dossiers_-_hozl\inzicht_lege_dossiers_53530004_pl_dm.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_lege_dossiers_-_hozl\inzicht_lege_dossiers_53530004_pl_copd.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_lege_dossiers_-_hozl\inzicht_lege_dossiers_53530004_pl_astma.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_lege_dossiers_-_hozl\inzicht_lege_dossiers_53530004_pl_cvrm.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_lege_dossiers_-_hozl\inzicht_lege_dossiers_53530004_pl_af.sql

[ERROR] Failed to process inzicht_lege_dossiers_53530004_encrypted.pry: Invalid PRY format: 'queries:' section not found
[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Doel: PatiÃ«nten in beeld krijgen die gedeclareerd zijn, maar die geen zorg hebben ontvangen in af
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_lege_dossiers\inzicht_lege_dossiers_v1_0_vertaling.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_lege_dossiers\inzicht_lege_dossiers_v1_0_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_lege_dossiers\inzicht_lege_dossiers_v1_0_ind_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_lege_dossiers\inzicht_lege_dossiers_v1_0_ind.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_lege_dossiers\inzicht_lege_dossiers_v1_0_patientenlijst_tussen.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_lege_dossiers\inzicht_lege_dossiers_v1_0_patientenlijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_lege_dossiers\inzicht_lege_dossiers_v1_0_pl_nieuwe_pt.sql

[ERROR] Failed to process inzicht_lege_dossiers_v1_0_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_nultarief_verrichtingen_-_hzg_breda\inzicht_nultarief_verrichtingen_53530172_ind_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_nultarief_verrichtingen_-_hzg_breda\inzicht_nultarief_verrichtingen_53530172_ind.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_nultarief_verrichtingen_-_hzg_breda\inzicht_nultarief_verrichtingen_53530172_verr.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_75+_patienten_per_zorgverzekeraar_2022\inzicht_pt_75_per_verzekeraar_2022_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_75+_patienten_per_zorgverzekeraar_2022\inzicht_pt_75_per_verzekeraar_2022_ind_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_75+_patienten_per_zorgverzekeraar_2022\inzicht_pt_75_per_verzekeraar_2022_ind.sql

[ERROR] Failed to process inzicht_patienten_75plus_per_verzekeraar_2022_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_75+_patienten_per_zorgverzekeraar_2023\inzicht_pt_75_per_verzekeraar_2023_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_75+_patienten_per_zorgverzekeraar_2023\inzicht_pt_75_per_verzekeraar_2023_ind_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_75+_patienten_per_zorgverzekeraar_2023\inzicht_pt_75_per_verzekeraar_2023_ind.sql

[ERROR] Failed to process inzicht_patienten_75plus_per_verzekeraar_2023_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_75+_patienten_per_zorgverzekeraar_2024\inzicht_pt_75_per_verzekeraar_2024_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_75+_patienten_per_zorgverzekeraar_2024\inzicht_pt_75_per_verzekeraar_2024_ind_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_75+_patienten_per_zorgverzekeraar_2024\inzicht_pt_75_per_verzekeraar_2024_ind.sql

[ERROR] Failed to process inzicht_patienten_75plus_per_verzekeraar_2024_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_75+_patienten_per_zorgverzekeraar_2025\inzicht_pt_75_per_verzekeraar_2025_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_75+_patienten_per_zorgverzekeraar_2025\inzicht_pt_75_per_verzekeraar_2025_ind_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_75+_patienten_per_zorgverzekeraar_2025\inzicht_pt_75_per_verzekeraar_2025_ind.sql

[ERROR] Failed to process inzicht_patienten_75plus_per_verzekeraar_2025_encrypted.pry: Invalid PRY format: 'queries:' section not found
[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# View toont regels per patiÃ«nt #} {# Wordt gebruikt voor ind wachttijd #}
SELECT
  CAST(patient_id
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_poh-ggz\inzicht_poh_ggz_verzameltabel_per_pt.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# View toont regels per medewerker per patiÃ«nt #} {# Wordt gebruikt voor ind/pl meetpunten #}
SELEC
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_poh-ggz\inzicht_poh_ggz_verzameltabel_per_mw_pt.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# View toont regels per huisarts per patiÃ«nt #} {# Wordt gebruikt voor ind/pl meetpunten huisarts #
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_poh-ggz\inzicht_poh_ggz_verzameltabel_per_huisarts_pt.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Deze meetpunten zijn aangeleverd en verwerkt voor de HOZL. #} {# Medewerkerbeheer is gebruikt voo
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_poh-ggz\inzicht_poh_ggz_indic_meetpunten_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_poh-ggz\inzicht_poh_ggz_indic_meetpunten.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Ervoor gekozen om dit meer gelijk te trekken aan de POH-GGZ indicatoren. #} {# D.w.z. dat we ook 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_poh-ggz\inzicht_poh_ggz_indic_meetpunten_huisarts_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_poh-ggz\inzicht_poh_ggz_indic_meetpunten_huisarts.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_poh-ggz\inzicht_poh_ggz_indic_icpc_combinaties.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_poh-ggz\inzicht_poh_ggz_pl_meetpunten_poh_ggz.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_poh-ggz\inzicht_poh_ggz_pl_meetpunten_huisarts.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_poh-ggz\inzicht_poh_ggz_indic_wachttijd_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_poh-ggz\inzicht_poh_ggz_indic_wachttijd.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_poh-ggz\inzicht_poh_ggz_indic_wachttijd_pl.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: CREATE MATERIALIZED VIEW inzicht_poh_ggz_medewerker
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_poh-ggz\inzicht_poh_ggz_medewerker.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_poh-ggz\inzicht_poh_ggz_verrichting_poh_ggz_per_mw_pt.sql

[WARNING] SQL was not modified during conversion
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_poh-ggz\inzicht_poh_ggz_verrichting_per_pt.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_poh-ggz\verrichting_huisarts_pre.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {{ verrichting_huisarts_deel1() }}
        , {#  Deze staat bewust op volgende regel, omdat hij ande
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_poh-ggz\inzicht_poh_ggz_verrichting_huisarts_per_mw_pt.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {{ verrichting_huisarts_deel1() }}
FROM {{ ref('verrichting_huisarts_pre') }}
{{ verrichting_huisart
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_poh-ggz\inzicht_poh_ggz_verrichting_huisarts.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_poh-ggz\inzicht_poh_ggz_verrichting_poh_eerste_na_contact_ha.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_poh-ggz\inzicht_verrichtingen_ggz.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_poh-ggz\inzicht_poh_ggz_koppeling_poh_patient.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# In onderstaande view wordt specifiek naar de HOZL episodes gekeken. #} {# Mochten de HOZL meetpun
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_poh-ggz\inzicht_poh_ggz_episode.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_poh-ggz\inzicht_poh_ggz_medicatie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_registratie_af_-_ghc\inzicht_registratie_af_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_registratie_af_-_ghc\inzicht_registratie_af_indic_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_registratie_af_-_ghc\inzicht_registratie_af_indic.sql

[ERROR] Failed to process inzicht_registratie_af_53530098_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_registratie_astma_-_ghc\inzicht_registratie_astma_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_registratie_astma_-_ghc\inzicht_registratie_astma_indic_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_registratie_astma_-_ghc\inzicht_registratie_astma_indic.sql

[ERROR] Failed to process inzicht_registratie_astma_53530098_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_registratie_coronair_lijden_-_ghc\inzicht_registratie_cl_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_registratie_coronair_lijden_-_ghc\inzicht_registratie_cl_indic_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_registratie_coronair_lijden_-_ghc\inzicht_registratie_cl_indic.sql

[ERROR] Failed to process inzicht_registratie_coronair_lijden_53530098_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_registratie_dementie_-_ghc\inzicht_registratie_dementie_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_registratie_dementie_-_ghc\inzicht_registratie_dementie_indic_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_registratie_dementie_-_ghc\inzicht_registratie_dementie_indic.sql

[ERROR] Failed to process inzicht_registratie_dementie_53530098_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_stoppen_met_roken_-_hozl\inzicht_smr_decl_ptn_53530004_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_stoppen_met_roken_-_hozl\inzicht_smr_decl_ptn_53530004_ind_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_stoppen_met_roken_-_hozl\inzicht_smr_decl_ptn_53530004_ind.sql

[ERROR] Failed to process inzicht_smr_declaratie_ptn_53530004_agg.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_verrichtingen_-_henz_gorinchem\inzicht_verrichtingen_53533085_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_verrichtingen_-_henz_gorinchem\inzicht_verrichtingen_53533085_ind_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_verrichtingen_-_henz_gorinchem\inzicht_verrichtingen_53533085_ind.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_verrichtingen_-_henz_gorinchem\inzicht_verrichtingen_53533085_pl.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\inzicht_verrichtingen_-_henz_gorinchem\inzicht_verrichtingen_53533085_verrichting.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ketenpartner_meetwaarden_en_medicatie\ketenpartner_mw_med_labcodes.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {#  kopie van proigia_meetwaarden_filter, andere labcodes #}
WITH nhgnr_verrijking AS
(
  SELECT
   
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ketenpartner_meetwaarden_en_medicatie\ketenpartner_mw_med_meetwaarden_filter.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ketenpartner_meetwaarden_en_medicatie\ketenpartner_mw_med_multidim.sql

Crosstab function detected, converting to dbt-compatible SQL.
  CREATE VIEW ketenpartner_mw_med_meetw_cross AS
  
  SELECT * FROM crosstab (
  $$
SELECT DISTINCT ON (patient_id, bin)
   patient_id,
   bin,
   mdarray
FROM ketenpartner_mw_med_multidim
ORDER BY patient_id, bin, mdarray::text nulls last
  $$,$$
SELECT
        '_'||nhgnr::varchar as bin
FROM ketenpartner_mw_med_labcodes
ORDER BY bin
  $$
  ) AS ct(
patient_id bigint,
_101 varchar[],
_105 varchar[],
_106 varchar[],
_111 varchar[],
_1272 varchar[],
_134 varchar[],
_1356 varchar[],
_1357 varchar[],
_1358 varchar[],
_1377 varchar[],
_1379 varchar[],
_1385 varchar[],
_1399 varchar[],
_1402 varchar[],
_1404 varchar[],
_1409 varchar[],
_1411 varchar[],
_1412 varchar[],
_1413 varchar[],
_1414 varchar[],
_1416 varchar[],
_15 varchar[],
_152 varchar[],
_1589 varchar[],
_1591 varchar[],
_1592 varchar[],
_1593 varchar[],
_1594 varchar[],
_1595 varchar[],
_1597 varchar[],
_1600 varchar[],
_1603 varchar[],
_1604 varchar[],
_1606 varchar[],
_1608 varchar[],
_1609 varchar[],
_1611 varchar[],
_1614 varchar[],
_1615 varchar[],
_1617 varchar[],
_1618 varchar[],
_162 varchar[],
_1623 varchar[],
_1624 varchar[],
_1625 varchar[],
_1627 varchar[],
_1628 varchar[],
_1632 varchar[],
_1633 varchar[],
_1634 varchar[],
_1637 varchar[],
_1638 varchar[],
_1641 varchar[],
_1642 varchar[],
_1643 varchar[],
_1644 varchar[],
_1648 varchar[],
_1649 varchar[],
_1651 varchar[],
_1652 varchar[],
_1653 varchar[],
_1654 varchar[],
_1655 varchar[],
_1656 varchar[],
_1657 varchar[],
_1658 varchar[],
_1659 varchar[],
_1660 varchar[],
_1661 varchar[],
_1662 varchar[],
_1663 varchar[],
_1666 varchar[],
_1667 varchar[],
_1668 varchar[],
_1670 varchar[],
_1671 varchar[],
_1672 varchar[],
_1675 varchar[],
_1677 varchar[],
_1678 varchar[],
_1679 varchar[],
_1681 varchar[],
_1682 varchar[],
_1685 varchar[],
_1686 varchar[],
_1687 varchar[],
_1690 varchar[],	
_1692 varchar[],	
_1694 varchar[],
_1695 varchar[],
_1696 varchar[],
_1697 varchar[],
_1698 varchar[],
_1699 varchar[],
_1700 varchar[],
_1701 varchar[],
_1704 varchar[],
_1705 varchar[],
_1706 varchar[],
_1709 varchar[],
_171 varchar[],
_1710 varchar[],
_1711 varchar[],
_1712 varchar[],
_1718 varchar[],
_1719 varchar[],
_1720 varchar[],
_1721 varchar[],
_1722 varchar[],
_1731 varchar[],
_1732 varchar[],
_1733 varchar[],
_1734 varchar[],
_1735 varchar[],
_1736 varchar[],
_1739 varchar[],
_1740 varchar[],
_1741 varchar[],
_1742 varchar[],
_1743 varchar[],
_1744 varchar[],
_1745 varchar[],
_1746 varchar[],
_1747 varchar[],
_1748 varchar[],
_1750 varchar[],
_1751 varchar[],
_1753 varchar[],
_1756 varchar[],
_1757 varchar[],
_1758 varchar[],
_1760 varchar[],
_1764 varchar[],
_1765 varchar[],
_1766 varchar[],
_1770 varchar[],
_1771 varchar[],
_1774 varchar[],
_1775 varchar[],
_1776 varchar[],
_1779 varchar[],
_1782 varchar[],
_1785 varchar[],
_1788 varchar[],
_1789 varchar[],
_1794 varchar[],
_1803 varchar[],
_1806 varchar[],
_1807 varchar[],
_181 varchar[],
_1811 varchar[],
_1812 varchar[],
_1813 varchar[],
_1814 varchar[],
_1815 varchar[],
_1816 varchar[],
_1818 varchar[],
_1819 varchar[],
_1821 varchar[],
_1822 varchar[],
_1824 varchar[],
_1825 varchar[],
_1826 varchar[],
_1830 varchar[],
_1831 varchar[],
_1832 varchar[],
_1851 varchar[],
_1854 varchar[],
_1861 varchar[],
_1862 varchar[],
_1864 varchar[],
_1866 varchar[],
_1867 varchar[],
_1868 varchar[],
_1872 varchar[],
_1875 varchar[],
_1884 varchar[],
_1893 varchar[],
_1894 varchar[],
_1895 varchar[],
_1904 varchar[],
_1918 varchar[],
_1919 varchar[],
_192 varchar[],
_1920 varchar[],
_193 varchar[],
_1939 varchar[],
_1966 varchar[],
_1968 varchar[],
_1992 varchar[],
_2002 varchar[],
_2003 varchar[],
_2025 varchar[],
_2026 varchar[],
_203 varchar[],
_2047 varchar[],
_2048 varchar[],
_2052 varchar[],
_2055 varchar[],
_2056 varchar[],
_2058 varchar[],
_2060 varchar[],
_2061 varchar[],
_2063 varchar[],
_2064 varchar[],
_2069 varchar[],
_2071 varchar[],
_2072 varchar[],
_2102 varchar[],
_2109 varchar[],
_2129 varchar[],
_2131 varchar[],
_2133 varchar[],
_2135 varchar[],
_2136 varchar[],
_2137 varchar[],
_2138 varchar[],
_2141 varchar[],
_2150 varchar[],
_2151 varchar[],
_2152 varchar[],
_2156 varchar[],
_2170 varchar[],
_2188 varchar[],
_2189 varchar[],
_2190 varchar[],
_2195 varchar[],
_2196 varchar[],
_2197 varchar[],
_2198 varchar[],
_2199 varchar[],
_2202 varchar[],
_2203 varchar[],
_2206 varchar[],
_2209 varchar[],
_2210 varchar[],
_2215 varchar[],
_2216 varchar[],
_2223 varchar[],
_226 varchar[],
_227 varchar[],
_2321 varchar[],
_2344 varchar[],
_2345 varchar[],
_2377 varchar[],
_2378 varchar[],
_2379 varchar[],
_2380 varchar[],
_2381 varchar[],
_2382 varchar[],
_2383 varchar[],
_2384 varchar[],
_2385 varchar[],
_2386 varchar[],
_2399 varchar[],
_2400 varchar[],
_2401 varchar[],
_2402 varchar[],
_2405 varchar[],
_2406 varchar[],
_2407 varchar[],
_2408 varchar[],
_241 varchar[],
_2412 varchar[],
_2413 varchar[],
_2414 varchar[],
_2418 varchar[],
_2419 varchar[],
_2420 varchar[],
_2421 varchar[],
_2422 varchar[],
_2423 varchar[],
_2424 varchar[],
_2425 varchar[],
_2426 varchar[],
_2427 varchar[],
_2428 varchar[],
_2429 varchar[],
_2430 varchar[],
_2431 varchar[],
_2432 varchar[],
_2433 varchar[],
_2434 varchar[],
_2435 varchar[],
_2436 varchar[],
_2450 varchar[],
_2451 varchar[],
_2452 varchar[],
_2453 varchar[],
_2456 varchar[],
_2457 varchar[],
_2570 varchar[],
_2612 varchar[],
_2613 varchar[],
_2648 varchar[],
_2658 varchar[],
_2659 varchar[],
_2660 varchar[],
_2661 varchar[],
_2662 varchar[],
_2663 varchar[],
_2664 varchar[],
_2666 varchar[],
_2667 varchar[],
_2668 varchar[],
_2669 varchar[],
_2673 varchar[],
_2676 varchar[],
_2678 varchar[],
_2679 varchar[],
_2680 varchar[],
_2681 varchar[],
_2683 varchar[],
_2690 varchar[],
_2691 varchar[],
_2692 varchar[],
_2693 varchar[],
_2696 varchar[],
_2714 varchar[],
_2717 varchar[],
_2718 varchar[],
_2720 varchar[],
_2721 varchar[],
_2722 varchar[],
_2762 varchar[],
_2769 varchar[],
_2771 varchar[],
_2773 varchar[],
_2774 varchar[],
_2776 varchar[],
_2777 varchar[],
_2779 varchar[],
_2780 varchar[],
_2781 varchar[],
_2783 varchar[],
_2787 varchar[],
_2788 varchar[],
_2789 varchar[],
_2792 varchar[],
_2793 varchar[],	
_2794 varchar[],
_2795 varchar[],
_2796 varchar[],
_2799 varchar[],
_280 varchar[],
_2800 varchar[],
_2802 varchar[],
_2803 varchar[],
_2804 varchar[],
_2805 varchar[],
_2807 varchar[],
_2808 varchar[],
_2810 varchar[],
_2811 varchar[],
_2812 varchar[],
_2813 varchar[],
_2814 varchar[],
_2815 varchar[],
_2816 varchar[],
_2821 varchar[],
_2822 varchar[],
_2824 varchar[],
_2837 varchar[],
_2841 varchar[],
_2842 varchar[],
_2848 varchar[],
_286 varchar[],
_2867 varchar[],
_2868 varchar[],
_2869 varchar[],
_2870 varchar[],
_2873 varchar[],
_291 varchar[],
_2910 varchar[],
_300 varchar[],
_3001 varchar[],
_3007 varchar[],
_3011 varchar[],
_3013 varchar[],
_3014 varchar[],
_3015 varchar[],
_3016 varchar[],
_3022 varchar[],
_3027 varchar[],
_3028 varchar[],
_3029 varchar[],
_3039 varchar[],
_3040 varchar[],
_3162 varchar[],
_3203 varchar[],
_3208 varchar[],
_3209 varchar[],
_3215 varchar[],
_3216 varchar[],
_3217 varchar[],
_3218 varchar[],
_3219 varchar[],
_3220 varchar[],
_3222 varchar[],
_3223 varchar[],
_3224 varchar[],
_3225 varchar[],
_3226 varchar[],
_3227 varchar[],
_3238 varchar[],
_3239 varchar[],
_3240 varchar[],
_3241 varchar[],
_3242 varchar[],
_3247 varchar[],
_3255 varchar[],
_3256 varchar[],
_3258 varchar[],
_3266 varchar[],
_328  varchar[],
_3280 varchar[],
_3284 varchar[],
_3286 varchar[],
_3287 varchar[],
_3313 varchar[],
_3314 varchar[],
_3315 varchar[],
_3316 varchar[],
_3317 varchar[],
_3318 varchar[],
_3320 varchar[],
_3325 varchar[],
_3326 varchar[],
_3327 varchar[],
_3329 varchar[],
_3330 varchar[],
_3331 varchar[],
_3332 varchar[],
_3336 varchar[],
_3337 varchar[],
_3338 varchar[],
_3339 varchar[],
_3340 varchar[],
_3341 varchar[],
_3342 varchar[],
_3343 varchar[],
_3344 varchar[],
_3348 varchar[],
_3352 varchar[],
_3353 varchar[],
_336 varchar[],
_337 varchar[],
_338 varchar[],
_340 varchar[],
_3446 varchar[],
_3447 varchar[],
_3448 varchar[],
_3449 varchar[],
_3450 varchar[],
_3451 varchar[],
_3452 varchar[],
_3453 varchar[],
_3454 varchar[],
_3455 varchar[],
_3456 varchar[],
_3457 varchar[],
_3458 varchar[],
_3459 varchar[],
_3460 varchar[],
_3461 varchar[],
_3466 varchar[],
_3467 varchar[],
_3468 varchar[],
_3469 varchar[],
_3470 varchar[],
_3472 varchar[],
_3475 varchar[],
_3476 varchar[],
_3477 varchar[],
_3478 varchar[],
_3479 varchar[],
_348 varchar[],
_3481 varchar[],
_3482 varchar[],
_3483 varchar[],
_3487 varchar[],
_3488 varchar[],
_3489 varchar[],
_3490 varchar[],
_3491 varchar[],
_3492 varchar[],
_3493 varchar[],
_3494 varchar[],
_3495 varchar[],
_3496 varchar[],
_3497 varchar[],
_3498 varchar[],
_3499 varchar[],
_35 varchar[],
_3500 varchar[],
_3501 varchar[],
_3546 varchar[],
_3547 varchar[],
_3548 varchar[],
_3549 varchar[],
_3555 varchar[],
_357 varchar[],
_3570 varchar[],
_3575 varchar[],
_3583 varchar[],
_359 varchar[],
_36 varchar[],
_3602 varchar[],
_3607 varchar[],
_3608 varchar[],
_3609 varchar[],
_3648 varchar[],
_3649 varchar[],
_3650 varchar[],
_3651 varchar[],
_3654 varchar[],
_3656 varchar[],
_3657 varchar[],
_3658 varchar[],
_3665 varchar[],
_3666 varchar[],
_3667 varchar[],
_3668 varchar[],
_3669 varchar[],
_3670 varchar[],
_3671 varchar[],
_3672 varchar[],
_3673 varchar[],
_3674 varchar[],
_3675 varchar[],
_3677 varchar[],
_368 varchar[],
_3686 varchar[],
_3687 varchar[],
_3688 varchar[],
_3689 varchar[],
_3690 varchar[],
_3691 varchar[],
_3692 varchar[],
_3693 varchar[],
_3703 varchar[],
_3705 varchar[],
_3706 varchar[],
_3707 varchar[],
_3708 varchar[],
_3709 varchar[],
_371 varchar[],
_3710 varchar[],
_3711 varchar[],
_3717 varchar[],
_3718 varchar[],
_3719 varchar[],
_372 varchar[],
_3720 varchar[],
_3739 varchar[],
_3740 varchar[],
_3741 varchar[],
_3754 varchar[],
_3755 varchar[],
_3756 varchar[],
_3757 varchar[],
_3758 varchar[],
_378 varchar[],
_379 varchar[],
_38 varchar[],
_380 varchar[],
_381 varchar[],
_382 varchar[],
_3824 varchar[],
_3826 varchar[],
_3827 varchar[],
_3828 varchar[],
_3829 varchar[],
_3830 varchar[],
_3831 varchar[],
_3832 varchar[],
_3833 varchar[],
_3834 varchar[],
_3835 varchar[],
_3836 varchar[],
_3837 varchar[],
_3838 varchar[],
_3839 varchar[],
_3840 varchar[],
_3841 varchar[],
_3851 varchar[],
_3852 varchar[],
_3853 varchar[],
_3854 varchar[],
_3857 varchar[],
_3872 varchar[],
_3876 varchar[],
_3878 varchar[],
_3882 varchar[],
_3886 varchar[],
_3887 varchar[],
_3888 varchar[],
_3889 varchar[],
_3890 varchar[],
_3891 varchar[],
_3892 varchar[],
_3894 varchar[],
_3895 varchar[],
_3896 varchar[],
_3897 varchar[],
_39 varchar[],
_3907 varchar[],
_3908 varchar[],
_3920 varchar[],
_3923 varchar[],
_3924 varchar[],
_3925 varchar[],
_3926 varchar[],
_3931 varchar[],
_3937 varchar[],
_3953 varchar[],
_3954 varchar[],
_3955 varchar[],
_3957 varchar[],
_3958 varchar[],
_3959 varchar[],
_40 varchar[],
_4013 varchar[],
_4021 varchar[],
_4025 varchar[],
_4028 varchar[],
_4035 varchar[],
_412 varchar[],
_4157 varchar[],
_4177 varchar[],
_4178 varchar[],
_4179 varchar[],
_418 varchar[],
_42 varchar[],
_446 varchar[],
_465 varchar[],
_484 varchar[],
_493 varchar[],
_508 varchar[],
_510 varchar[],
_513 varchar[],
_514 varchar[],
_523 varchar[],
_524 varchar[],
_527 varchar[],
_535 varchar[],
_542 varchar[],
_547 varchar[],
_555 varchar[],
_560 varchar[],
_572 varchar[],
_582 varchar[],
_604 varchar[],
_624 varchar[],
_629 varchar[],
_633 varchar[],
_742 varchar[],
_743 varchar[],
_744 varchar[],
_745 varchar[],
_746 varchar[],
_77 varchar[],
_790 varchar[],
_80126 varchar[],
_822 varchar[],
_823 varchar[],
_824 varchar[],
_825 varchar[],
_826 varchar[],
_830 varchar[],
_831 varchar[],
_832 varchar[],
_834 varchar[],
_835 varchar[],
_836 varchar[],
_837 varchar[],
_838 varchar[],
_852 varchar[],
_902 varchar[],
_906 varchar[],
_907 varchar[],
_908 varchar[]);
Unsupported WITH clause or DISTINCT ON found in cte_statement.
Converted crosstab SQL:

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ketenpartner_meetwaarden_en_medicatie\ketenpartner_mw_med_meetw_cross.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ketenpartner_meetwaarden_en_medicatie\ketenpartner_mw_med_meetwaarden.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ketenpartner_meetwaarden_en_medicatie\ketenpartner_mw_med_meetw_medic.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ketenpartner_meetwaarden_en_medicatie\ketenpartner_mw_med_episodes.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ketenpartner_meetwaarden_en_medicatie\ketenpartner_mw_med_zorgpad.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kinderen_met_adhd\adhd_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kinderen_met_adhd\adhd_indicatoren_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kinderen_met_adhd\adhd_indicatoren.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kinderen_met_adhd\adhd_indicatoren_abs_adhb.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kinderen_met_adhd\adhd_indicatoren_adhb.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kinderen_met_adhd\adhd_patientenlijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kinderen_met_adhd\adhd_oproeplijst.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# kopie van proigia zg substitutie #}
WITH kalenderjaar AS (
  SELECT
    CASE
      WHEN CAST('${p
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kinderen_met_adhd\kinderen_met_adhd_substitutie.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# kopie van populatiedashboard #}
WITH medewerker_nieuw AS (
  SELECT
    m.naam,
    f.naam AS fun
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kinderen_met_adhd\kinderen_met_adhd_contacten.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kinderen_met_adhd\kinderen_met_adhd_contacten_aantal.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# kopie van proigia_last_cont_pp #}
SELECT
  patient_id,
  MAX(datum) AS last_contact
FROM {{ ref('
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kinderen_met_adhd\kinderen_met_adhd_last_cont_pp.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kinderen_met_adhd\kinderen_met_adhd_kalenderjaar_contact.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kinderen_met_adhd_medicatie_-_onze_huisartsen\adhd_medicatie_kind_53530047_verzamel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kinderen_met_adhd_medicatie_-_onze_huisartsen\adhd_medicatie_kind_53530047_patientenlijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kinderen_met_adhd_medicatie_-_onze_huisartsen\adhd_medicatie_kind_53530047_medicatie.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# View t.b.v. indicatoren die ook naar overleden ptn. kijken. #}
WITH pre AS (
  SELECT
    CAST(ST
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_af_indicatoren_v3.0\kwartaal_ind_af_v3_0_alle_ptn.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_af_indicatoren_v3.0\kwartaal_ind_af_v3_0_zg_vertaling.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Laatst gebruikte indicator nr=58 #}
WITH praktijkpopulatie AS (
  SELECT
    *
  FROM {{ ref('kwa
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_af_indicatoren_v3.0\kwartaal_ind_af_pop_v3_0_indicatoren_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_af_indicatoren_v3.0\kwartaal_ind_af_pop_v3_0_indicatoren.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# LET OP! Lijst bevat een UNION met ptn die overleden zijn. #} {# Denk er bij het toevoegen van een
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_af_indicatoren_v3.0\kwartaal_ind_af_pop_v3_0_filterlijst.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# De volgende categorieen zijn er: afwijking, auscultatie, bloeddruk, chadsvasc, creatine, ecg, egf
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_af_indicatoren_v3.0\kwartaal_ind_af_zorg_v3_0_indicatoren_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_af_indicatoren_v3.0\kwartaal_ind_af_zorg_v3_0_indicatoren.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_af_indicatoren_v3.0\kwartaal_ind_af_zorg_v3_0_filterlijst.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# View t.b.v. indicatoren die ook naar overleden ptn. kijken. #}
WITH pre AS (
  SELECT
    CAST('$
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_af_indicatoren_v3.0_-_gez\kwartaal_ind_af_v3_0_gez_alle_ptn.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_af_indicatoren_v3.0_-_gez\kwartaal_ind_af_v3_0_gez_zg_vertaling.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Laatst gebruikte indicator nr=58 #}
WITH praktijkpopulatie AS (
  SELECT
    *
  FROM {{ ref('kwa
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_af_indicatoren_v3.0_-_gez\kwartaal_ind_af_pop_v3_0_gez_indicatoren_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_af_indicatoren_v3.0_-_gez\kwartaal_ind_af_pop_v3_0_gez_indicatoren.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# LET OP! Lijst bevat een UNION met ptn die overleden zijn. #} {# Denk er bij het toevoegen van een
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_af_indicatoren_v3.0_-_gez\kwartaal_ind_af_pop_v3_0_gez_filterlijst.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# De volgende categorieen zijn er: afwijking, auscultatie, bloeddruk, chadsvasc, creatine, ecg, egf
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_af_indicatoren_v3.0_-_gez\kwartaal_ind_af_zorg_v3_0_gez_indicatoren_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_af_indicatoren_v3.0_-_gez\kwartaal_ind_af_zorg_v3_0_gez_indicatoren.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_af_indicatoren_v3.0_-_gez\kwartaal_ind_af_zorg_v3_0_gez_filterlijst.sql

[ERROR] Failed to process kwartaal_ind_astma_v3_0_algemeen.pry: Invalid PRY format: 'queries:' section not found
[ERROR] Failed to process kwartaal_ind_astma_v3_0_encrypted.pry: Invalid PRY format: 'queries:' section not found
[ERROR] Failed to process kwartaal_ind_astma_v3_0_gez_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_astma_indicatoren_v3.0_-_gez\kwartaal_ind_astma_v3_0_gez_vertaling.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# De volgende categorieen zijn er: episode, hoofdbehandelaar, substitutie, deelname ketenzorg, geen
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_astma_indicatoren_v3.0_-_gez\kwart_ind_astma_pop_v3_0_gez_indic_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_astma_indicatoren_v3.0_-_gez\kwart_ind_astma_pop_v3_0_gez_indic.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_astma_indicatoren_v3.0_-_gez\kwart_ind_astma_pop_v3_0_gez_filterlijst.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# De volgende categorieen zijn er: alcohol, beweging, functioneren, inhalatietechniek, longaanvalle
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_astma_indicatoren_v3.0_-_gez\kwartaal_ind_astma_zorg_v3_0_gez_indicatoren_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_astma_indicatoren_v3.0_-_gez\kwartaal_ind_astma_zorg_v3_0_gez_indicatoren.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_astma_indicatoren_v3.0_-_gez\kwartaal_ind_astma_zorg_v3_0_gez_filterlijst.sql

[ERROR] Failed to process kwartaal_ind_bbr_v3_0_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_bbr_indicatoren_v3.0\kwartaal_ind_bbr_v3_0_zg_vertaling.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_bbr_indicatoren_v3.0\kwartaal_ind_bbr_pop_v3_0_indicatoren_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_bbr_indicatoren_v3.0\kwartaal_ind_bbr_pop_v3_0_indicatoren.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_bbr_indicatoren_v3.0\kwartaal_ind_bbr_pop_v3_0_filterlijst.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# De volgende categorieen zijn er: albuminurie, alcohol, beweging, bloeddruk, bmi, controlebeleid, 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_bbr_indicatoren_v3.0\kwartaal_ind_bbr_zorg_v3_0_indicatoren_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_bbr_indicatoren_v3.0\kwartaal_ind_bbr_zorg_v3_0_indicatoren.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_bbr_indicatoren_v3.0\kwartaal_ind_bbr_zorg_v3_0_filterlijst.sql

[ERROR] Failed to process kwartaal_ind_cl_v3_0_encrypted.pry: Invalid PRY format: 'queries:' section not found
[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Data komt uit view proigia_zg_criteria_v3_vertaling_dm_cvrm, deze view bevat naast DM/CVRM ook de
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_coronair_lijden_indicatoren_v3.0\kwartaal_ind_cl_v3_0_zg_vertaling.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_coronair_lijden_indicatoren_v3.0\kwartaal_ind_cl_pop_v3_0_indicatoren_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_coronair_lijden_indicatoren_v3.0\kwartaal_ind_cl_pop_v3_0_indicatoren.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_coronair_lijden_indicatoren_v3.0\kwartaal_ind_cl_pop_v3_0_filterlijst.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# De volgende categorieen zijn er: angineuze bezwaren, auscultatie, bloeddruk, ecg, egfr, hartfalen
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_coronair_lijden_indicatoren_v3.0\kwartaal_ind_cl_zorg_v3_0_indicatoren_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_coronair_lijden_indicatoren_v3.0\kwartaal_ind_cl_zorg_v3_0_indicatoren.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_coronair_lijden_indicatoren_v3.0\kwartaal_ind_cl_zorg_v3_0_filterlijst.sql

[ERROR] Failed to process kwartaal_ind_cns_v3_0_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_cns_indicatoren_v3.0\kwartaal_ind_cns_v3_0_zg_vertaling.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# De volgende categorieen zijn er: nierschade, hoofdbehandelaar, substitutie, deelname ketenzorg, g
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_cns_indicatoren_v3.0\kwartaal_ind_cns_pop_v3_0_indicatoren_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_cns_indicatoren_v3.0\kwartaal_ind_cns_pop_v3_0_indicatoren.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_cns_indicatoren_v3.0\kwartaal_ind_cns_pop_v3_0_filterlijst.sql

[ERROR] Failed to process kwartaal_ind_copdastma_v3_0_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_copdastma_indicatoren_v3.0\kwart_ind_copdastma_v3_0_vertaling.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_copdastma_indicatoren_v3.0\kwart_ind_copdastma_v3_0_vertaling_copd.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_copdastma_indicatoren_v3.0\kwart_ind_copdastma_v3_0_vertaling_astma.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# De volgende categorieen zijn er: episode, hoofdbehandelaar, substitutie, deelname ketenzorg, geen
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_copdastma_indicatoren_v3.0\kwart_ind_copdastma_pop_v3_0_indic_abs_copd.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_copdastma_indicatoren_v3.0\kwart_ind_copdastma_pop_v3_0_indic_copd.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# De volgende categorieen zijn er: episode, hoofdbehandelaar, substitutie, deelname ketenzorg, geen
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_copdastma_indicatoren_v3.0\kwart_ind_copdastma_pop_v3_0_indic_abs_astma.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_copdastma_indicatoren_v3.0\kwart_ind_copdastma_pop_v3_0_indic_astma.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_copdastma_indicatoren_v3.0\kwart_ind_copdastma_pop_v3_0_filterlijst_copd.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_copdastma_indicatoren_v3.0\kwart_ind_copdastma_pop_v3_0_filterlijst_astma.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# De volgende categorieen zijn er: alcohol, beweging, bmi, functioneren, gewicht, gold, inhalatiete
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_copdastma_indicatoren_v3.0\kwartaal_ind_copdastma_zorg_v3_0_indic_abs_copd.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_copdastma_indicatoren_v3.0\kwartaal_ind_copdastma_zorg_v3_0_indic_copd.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# De volgende categorieen zijn er: alcohol, allergie, beweging, bmi, functioneren, histamine test, 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_copdastma_indicatoren_v3.0\kwartaal_ind_copdastma_zorg_v3_0_indic_abs_astma.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_copdastma_indicatoren_v3.0\kwartaal_ind_copdastma_zorg_v3_0_indic_astma.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_copdastma_indicatoren_v3.0\kwartaal_ind_copdastma_zorg_v3_0_filterlijst_copd.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_copdastma_indicatoren_v3.0\kwartaal_ind_copdastma_zorg_v3_0_filterl_astma.sql

[ERROR] Failed to process kwartaal_ind_copd_v3_0_algemeen.pry: Invalid PRY format: 'queries:' section not found
[ERROR] Failed to process kwartaal_ind_copd_v3_0_encrypted.pry: Invalid PRY format: 'queries:' section not found
[ERROR] Failed to process kwartaal_ind_copd_v3_0_gez_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_copd_indicatoren_v3.0_-_gez\kwartaal_ind_copd_v3_0_gez_vertaling.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# De volgende categorieen zijn er: episode, hoofdbehandelaar, substitutie, deelname ketenzorg, geen
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_copd_indicatoren_v3.0_-_gez\kwart_ind_copd_pop_v3_0_gez_indic_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_copd_indicatoren_v3.0_-_gez\kwart_ind_copd_pop_v3_0_gez_indic.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_copd_indicatoren_v3.0_-_gez\kwart_ind_copd_pop_v3_0_gez_filterlijst.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# De volgende categorieen zijn er: alcohol, beweging, bmi, functioneren, gewicht, gold, lichaamsbew
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_copd_indicatoren_v3.0_-_gez\kwartaal_ind_copd_zorg_v3_0_gez_indicatoren_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_copd_indicatoren_v3.0_-_gez\kwartaal_ind_copd_zorg_v3_0_gez_indicatoren.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_copd_indicatoren_v3.0_-_gez\kwartaal_ind_copd_zorg_v3_0_gez_filterlijst.sql

[ERROR] Failed to process kwartaal_ind_cvrm_v3_0_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_cvrm_indicatoren_v3.0\kw_ind_cvrm_pop_v3_0_ind_extra_info_abs_vvr.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_cvrm_indicatoren_v3.0\kw_ind_cvrm_pop_v3_0_ind_extra_info_vvr.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_cvrm_indicatoren_v3.0\kw_ind_cvrm_pop_v3_0_lijst_extra_info_vvr.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_cvrm_indicatoren_v3.0\kwartaal_ind_cvrm_v3_0_zg_vertaling.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_cvrm_indicatoren_v3.0\kwartaal_ind_cvrm_v3_0_zg_vertaling_hvz.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_cvrm_indicatoren_v3.0\kwartaal_ind_cvrm_v3_0_zg_vertaling_vvr.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# De volgende categorieen zijn er: episode, hoofdbehandelaar, substitutie, deelname ketenzorg, geen
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_cvrm_indicatoren_v3.0\kwartaal_ind_cvrm_pop_v3_0_indicatoren_abs_hvz.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_cvrm_indicatoren_v3.0\kwartaal_ind_cvrm_pop_v3_0_indicatoren_hvz.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# De volgende categorieen zijn er: episode, hoofdbehandelaar, substitutie, deelname ketenzorg, geen
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_cvrm_indicatoren_v3.0\kwartaal_ind_cvrm_pop_v3_0_indicatoren_abs_vvr.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_cvrm_indicatoren_v3.0\kwartaal_ind_cvrm_pop_v3_0_indicatoren_vvr.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_cvrm_indicatoren_v3.0\kwartaal_ind_cvrm_pop_v3_0_filterlijst_hvz.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_cvrm_indicatoren_v3.0\kwartaal_ind_cvrm_pop_v3_0_filterlijst_vvr.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# De volgende categorieen zijn er: albuminurie, alcohol, beweging, bloeddruk, bmi, ecg, egfr, famil
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_cvrm_indicatoren_v3.0\kwartaal_ind_cvrm_zorg_v3_0_indicatoren_abs_hvz.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_cvrm_indicatoren_v3.0\kwartaal_ind_cvrm_zorg_v3_0_indicatoren_hvz.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# De volgende categorieen zijn er: albuminurie, alcohol, beweging, bloeddruk, bmi, egfr, familieana
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_cvrm_indicatoren_v3.0\kwartaal_ind_cvrm_zorg_v3_0_indicatoren_abs_vvr.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_cvrm_indicatoren_v3.0\kwartaal_ind_cvrm_zorg_v3_0_indicatoren_vvr.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_cvrm_indicatoren_v3.0\kwartaal_ind_cvrm_zorg_v3_0_filterlijst_hvz.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_cvrm_indicatoren_v3.0\kwartaal_ind_cvrm_zorg_v3_0_filterlijst_vvr.sql

[ERROR] Failed to process kwartaal_ind_cvrm_v3_0_gez_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_cvrm_indicatoren_v3.0_-_gez\kw_ind_cvrm_pop_v3_0_gez_ind_extra_info_abs_vvr.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_cvrm_indicatoren_v3.0_-_gez\kw_ind_cvrm_pop_v3_0_gez_ind_extra_info_vvr.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_cvrm_indicatoren_v3.0_-_gez\kw_ind_cvrm_pop_v3_0_gez_lijst_extra_info_vvr.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_cvrm_indicatoren_v3.0_-_gez\kwartaal_ind_cvrm_v3_0_gez_vertaling.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# De volgende categorieen zijn er: episode, hoofdbehandelaar, substitutie, deelname ketenzorg, geen
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_cvrm_indicatoren_v3.0_-_gez\kwartaal_ind_cvrm_pop_v3_0_gez_ind_abs_hvz.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_cvrm_indicatoren_v3.0_-_gez\kwartaal_ind_cvrm_pop_v3_0_gez_ind_hvz.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# De volgende categorieen zijn er: episode, hoofdbehandelaar, substitutie, deelname ketenzorg, geen
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_cvrm_indicatoren_v3.0_-_gez\kwartaal_ind_cvrm_pop_v3_0_gez_ind_abs_vvr.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_cvrm_indicatoren_v3.0_-_gez\kwartaal_ind_cvrm_pop_v3_0_gez_ind_vvr.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_cvrm_indicatoren_v3.0_-_gez\kwartaal_ind_cvrm_pop_v3_0_gez_lijst_hvz.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_cvrm_indicatoren_v3.0_-_gez\kwartaal_ind_cvrm_pop_v3_0_gez_lijst_vvr.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# De volgende categorieen zijn er: albuminurie, alcohol, beweging, bloeddruk, bmi, egfr, familieana
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_cvrm_indicatoren_v3.0_-_gez\kwartaal_ind_cvrm_zorg_v3_0_gez_indic_abs_hvz.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_cvrm_indicatoren_v3.0_-_gez\kwartaal_ind_cvrm_zorg_v3_0_gez_indicatoren_hvz.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# De volgende categorieen zijn er: albuminurie, alcohol, beweging, bloeddruk, bmi,egfr, familieanam
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_cvrm_indicatoren_v3.0_-_gez\kwartaal_ind_cvrm_zorg_v3_0_gez_indic_abs_vvr.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_cvrm_indicatoren_v3.0_-_gez\kwartaal_ind_cvrm_zorg_v3_0_gez_indicatoren_vvr.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_cvrm_indicatoren_v3.0_-_gez\kwartaal_ind_cvrm_zorg_v3_0_gez_filterlijst_hvz.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_cvrm_indicatoren_v3.0_-_gez\kwartaal_ind_cvrm_zorg_v3_0_gez_filterlijst_vvr.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: CREATE VIEW kwartaal_ind_dem_ongewenst_gewichtsverlies
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_dementie_indicatoren_v3.0\kwartaal_ind_dem_ongewenst_gewichtsverlies.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_dementie_indicatoren_v3.0\kwartaal_ind_dem_v3_0_zg_vertaling.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# De volgende categorieen zijn er: episode, hoofdbehandelaar, substitutie, deelname ketenzorg, geen
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_dementie_indicatoren_v3.0\kwartaal_ind_dem_pop_v3_0_indicatoren_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_dementie_indicatoren_v3.0\kwartaal_ind_dem_pop_v3_0_indicatoren.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_dementie_indicatoren_v3.0\kwartaal_ind_dem_pop_v3_0_filterlijst.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# De volgende categorieen zijn er: aanvullende gegevens, gehoorproblemen, gewicht, izp, mantelzorg,
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_dementie_indicatoren_v3.0\kwartaal_ind_dem_zorg_v3_0_indicatoren_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_dementie_indicatoren_v3.0\kwartaal_ind_dem_zorg_v3_0_indicatoren.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_dementie_indicatoren_v3.0\kwartaal_ind_dem_zorg_v3_0_filterlijst.sql

[ERROR] Failed to process kwartaal_ind_dm_v3_0_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_dm_indicatoren_v3.0\kwartaal_ind_dm_v3_0_zg_vertaling.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# De volgende categorieen zijn er: episode, hoofdbehandelaar, substitutie, deelname ketenzorg, geen
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_dm_indicatoren_v3.0\kwartaal_ind_dm_pop_v3_0_indicatoren_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_dm_indicatoren_v3.0\kwartaal_ind_dm_pop_v3_0_indicatoren.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_dm_indicatoren_v3.0\kwartaal_ind_dm_pop_v3_0_filterlijst.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# De volgende categorieen zijn er: albuminurie, alcohol, beweging, bloeddruk, bmi, controlebeleid, 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_dm_indicatoren_v3.0\kwartaal_ind_dm_zorg_v3_0_indicatoren_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_dm_indicatoren_v3.0\kwartaal_ind_dm_zorg_v3_0_indicatoren.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_dm_indicatoren_v3.0\kwartaal_ind_dm_zorg_v3_0_filterlijst.sql

[ERROR] Failed to process kwartaal_ind_dm_v3_0_gez_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_dm_indicatoren_v3.0_-_gez\kwartaal_ind_dm_v3_0_gez_vertaling.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_dm_indicatoren_v3.0_-_gez\kwartaal_ind_dm_pop_v3_0_gez_indicatoren_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_dm_indicatoren_v3.0_-_gez\kwartaal_ind_dm_pop_v3_0_gez_indicatoren.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_dm_indicatoren_v3.0_-_gez\kwartaal_ind_dm_pop_v3_0_gez_filterlijst.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# De volgende categorieen zijn er: albuminurie, alcohol, beweging, bloeddruk, bmi, controlebeleid, 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_dm_indicatoren_v3.0_-_gez\kwartaal_ind_dm_zorg_v3_0_gez_indicatoren_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_dm_indicatoren_v3.0_-_gez\kwartaal_ind_dm_zorg_v3_0_gez_indicatoren.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_dm_indicatoren_v3.0_-_gez\kwartaal_ind_dm_zorg_v3_0_gez_filterlijst.sql

[ERROR] Failed to process kwartaal_ind_epa_v3_0_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_epa_indicatoren_v3.0\kwartaal_ind_epa_v3_0_zg_vertaling.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# De volgende categorieen zijn er: episode, hoofdbehandelaar, substitutie, deelname ketenzorg, geen
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_epa_indicatoren_v3.0\kwartaal_ind_epa_pop_v3_0_indicatoren_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_epa_indicatoren_v3.0\kwartaal_ind_epa_pop_v3_0_indicatoren.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_epa_indicatoren_v3.0\kwartaal_ind_epa_pop_v3_0_filterlijst.sql

[ERROR] Failed to process kwartaal_ind_epa_v3_0_gez_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_epa_indicatoren_v3.0_-_gez\kwartaal_ind_epa_v3_0_gez_zg_vertaling.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# De volgende categorieen zijn er: episode, hoofdbehandelaar, substitutie, deelname ketenzorg, geen
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_epa_indicatoren_v3.0_-_gez\kwartaal_ind_epa_pop_v3_0_gez_indicatoren_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_epa_indicatoren_v3.0_-_gez\kwartaal_ind_epa_pop_v3_0_gez_indicatoren.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_epa_indicatoren_v3.0_-_gez\kwartaal_ind_epa_pop_v3_0_gez_filterlijst.sql

[ERROR] Failed to process kwartaalrapport_ind_ggz_jeugd_v3_0_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_ggz_jeugd_indicatoren_v3.0\kwartaal_ind_ggz_jeugd_v3_0_zg_vertaling.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# CategorieÃ«n: episode, hoofdbehandelaar, substitutie, deelname ketenzorg, geen deelname ketenzorg,
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_ggz_jeugd_indicatoren_v3.0\kwartaal_ind_ggz_jeugd_pop_v3_0_indicatoren_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_ggz_jeugd_indicatoren_v3.0\kwartaal_ind_ggz_jeugd_pop_v3_0_indicatoren.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_ggz_jeugd_indicatoren_v3.0\kwartaal_ind_ggz_jeugd_pop_v3_0_filterlijst.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# De volgende categorieen zijn er: medicatie, SDQ #} {# laatste gebruikte indicator nr = 507 #}
WIT
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_ggz_jeugd_indicatoren_v3.0\kwartaal_ind_ggz_jeugd_zorg_v3_0_indicatoren_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_ggz_jeugd_indicatoren_v3.0\kwartaal_ind_ggz_jeugd_zorg_v3_0_indicatoren.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_ggz_jeugd_indicatoren_v3.0\kwartaal_ind_ggz_jeugd_zorg_v3_0_filterlijst.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {{ medewerker_koppeling_medewerkerbeheer() }}
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_ggz_indicatoren_v3.0\kwartaal_ggz_medewerker.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_ggz_indicatoren_v3.0\kwartaal_ggz_contact_pz.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_ggz_indicatoren_v3.0\kwartaal_ggz_contact_pz_per_pt.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_ggz_indicatoren_v3.0\kwartaal_ggz_wachttijd.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# kopie van proigia episode filter #} {# gemaakt omdat alleen de actieve episodes getoond moeten wo
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_ggz_indicatoren_v3.0\kwartaal_ggz_episode_filter.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# kopie van proigia icpc codes #}
WITH icpc_codes AS (
  SELECT
    icpc
  FROM (VALUES
    ('P%'),
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_ggz_indicatoren_v3.0\kwartaal_ggz_icpc_codes.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW kwartaal_ggz_episode AS

SELECT * FROM crosstab($$
    SELECT
        patient_id,
        name,
        ARRAY[min(begindatum)::varchar,
                max(einddatum)::varchar,
                max(status_datum)::varchar,
                max(status_vlag)::varchar,
                array_agg(distinct icpc)::varchar,
                max(begindatum)::varchar,
                min(einddatum)::varchar,
                min(begindatum_nonactief)::varchar,
                max(einddatum_nonactief)::varchar,
                max(begindatum_nonactief)::varchar,
                min(einddatum_nonactief)::varchar] as waardes
    FROM kwartaal_ggz_episode_filter
    JOIN kwartaal_ggz_icpc_codes ON icpc ilike searchstring
    GROUP BY patient_id, name
    ORDER BY patient_id, name
$$,$$
    SELECT name FROM kwartaal_ggz_icpc_codes ORDER BY name;
$$) as ct(
    patient_id bigint,
    p_ varchar[],
    p01_ varchar[],
    p03_ varchar[],
    p05_ varchar[],
    p06_ varchar[],
    p15_ varchar[],
    p15_02 varchar[],
    p16_ varchar[],
    p17_ varchar[],
    p18_ varchar[],
    p19_ varchar[],
    p19_01 varchar[],
    p20_ varchar[],
    p21_ varchar[],
    p70_ varchar[],
    p70_01 varchar[],
    p70_02 varchar[],
    p71_ varchar[],
    p72_ varchar[],
    p73_ varchar[],
    p74_ varchar[],
    p76_ varchar[],
    p78_ varchar[],
    p98_ varchar[],
    p99_ varchar[],
    z_ varchar[],
    z04_ varchar[],
    z04_03 varchar[],
    z29_ varchar[],
    z29_01 varchar[]
);
Converted crosstab SQL:
WITH cte1 AS (

    SELECT
        patient_id,
        name,
        ARRAY[min(begindatum)::varchar,
                max(einddatum)::varchar,
                max(status_datum)::varchar,
                max(status_vlag)::varchar,
                array_agg(distinct icpc)::varchar,
                max(begindatum)::varchar,
                min(einddatum)::varchar,
                min(begindatum_nonactief)::varchar,
                max(einddatum_nonactief)::varchar,
                max(begindatum_nonactief)::varchar,
                min(einddatum_nonactief)::varchar] as waardes
    FROM {{ ref('kwartaal_ggz_episode_filter') }}
    JOIN {{ ref('kwartaal_ggz_icpc_codes') }} ON icpc ilike searchstring
    GROUP BY patient_id, name
    ORDER BY patient_id, name

)
SELECT patient_id
, {{ dbt_utils.pivot('name',        dbt_utils.get_column_values(ref('kwartaal_ggz_icpc_codes'),'categorie',default=[]),        agg='',        then_value='name',        else_value="ARRAY_CONSTRUCT()",        quote_identifiers=False)}} 
FROM cte1
GROUP BY patient_id
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_ggz_indicatoren_v3.0\kwartaal_ggz_episode.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_ggz_indicatoren_v3.0\kwartaal_ggz_contact_12mnd.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_ggz_indicatoren_v3.0\kwartaal_ggz_verrichting.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_ggz_indicatoren_v3.0\kwartaal_ggz_sggz.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_ggz_indicatoren_v3.0\kwartaal_ind_ggz_v3_0_zg_vertaling.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# CategorieÃ«n: episode, hoofdbehandelaar, substitutie, deelname ketenzorg, geen deelname ketenzorg,
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_ggz_indicatoren_v3.0\kwartaal_ind_ggz_pop_v3_0_indicatoren_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_ggz_indicatoren_v3.0\kwartaal_ind_ggz_pop_v3_0_indicatoren.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_ggz_indicatoren_v3.0\kwartaal_ind_ggz_pop_v3_0_filterlijst.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# De volgende categorieen zijn er: 4DKL, depressie, IZP, medicatie #} {# laatste gebruikte indicato
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_ggz_indicatoren_v3.0\kwartaal_ind_ggz_zorg_v3_0_indicatoren_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_ggz_indicatoren_v3.0\kwartaal_ind_ggz_zorg_v3_0_indicatoren.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_ggz_indicatoren_v3.0\kwartaal_ind_ggz_zorg_v3_0_filterlijst.sql

[ERROR] Failed to process kwartaal_ind_hartfalen_v3_0_encrypted.pry: Invalid PRY format: 'queries:' section not found
[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Data komt uit view proigia_zg_criteria_v4_verzamel_dm_cvrm, deze view bevat naast DM/CVRM ook de 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_hartfalen_indicatoren_v3.0\kwartaal_ind_hf_v3_0_zg_vertaling.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_hartfalen_indicatoren_v3.0\kwartaal_ind_hf_pop_v3_0_indicatoren_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_hartfalen_indicatoren_v3.0\kwartaal_ind_hf_pop_v3_0_indicatoren.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_hartfalen_indicatoren_v3.0\kwartaal_ind_hf_pop_v3_0_filterlijst.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# De volgende categorieen zijn er: bloeddruk, bnp, ecg, echografie, egfr, hb, gewicht, glucose, ldl
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_hartfalen_indicatoren_v3.0\kwartaal_ind_hf_zorg_v3_0_indicatoren_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_hartfalen_indicatoren_v3.0\kwartaal_ind_hf_zorg_v3_0_indicatoren.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_hartfalen_indicatoren_v3.0\kwartaal_ind_hf_zorg_v3_0_filterlijst.sql

[ERROR] Failed to process kwartaal_ind_hvz_v3_0_algemeen.pry: Invalid PRY format: 'queries:' section not found
[ERROR] Failed to process kwartaal_ind_hvz_v3_0_encrypted.pry: Invalid PRY format: 'queries:' section not found
[ERROR] Failed to process kwartaal_ind_hvz_v3_0_gez_algemeen.pry: Invalid PRY format: 'queries:' section not found
[ERROR] Failed to process kwartaal_ind_hvz_v3_0_gez_encrypted.pry: Invalid PRY format: 'queries:' section not found
[ERROR] Failed to process kwartaalrapport_ind_osteoporose_v3_0_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_osteoporose_indicatoren_v3.0\kwart_ind_osteoporose_v3_0_zg_vertaling.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# CategorieÃ«n: DBC, deelname ketenzorg, dexa, episode, geen deelname ketenzorg, hoofdbehandelaar, s
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_osteoporose_indicatoren_v3.0\kwart_ind_osteoporose_pop_v3_0_indicatoren_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_osteoporose_indicatoren_v3.0\kwart_ind_osteoporose_pop_v3_0_indicatoren.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_osteoporose_indicatoren_v3.0\kwart_ind_osteoporose_pop_v3_0_filterlijst.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# De volgende categorieen zijn er: bmi, controlebeleid, medicatie, risicoprofiel, lengte, vallen #}
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_osteoporose_indicatoren_v3.0\kwart_ind_osteoporose_zorg_v3_0_indicatoren_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_osteoporose_indicatoren_v3.0\kwart_ind_osteoporose_zorg_v3_0_indicatoren.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_osteoporose_indicatoren_v3.0\kwart_ind_osteoporose_zorg_v3_0_filterlijst.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: CREATE VIEW ongewenstgewichtsverlies
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_oz_indicatoren_v3.0\ongewenstgewichtsverlies.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_oz_indicatoren_v3.0\kwartaal_oz_ger_event_ooit.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_oz_indicatoren_v3.0\kwartaal_oz_medicatie_nieuw_3_mnd.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# In deze _3mt view wordt de uitslag getoond van 3 maanden geleden, dus uitslag vÃ³Ã³r de peildatum m
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_oz_indicatoren_v3.0\kwartaal_ind_oz_v3_0_verzameltabel.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# De volgende categorieen zijn er: dbc, deelname ketenzorg, episode, geslacht, #} {# hoofdbehandela
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_oz_indicatoren_v3.0\kwartaal_ind_oz_pop_v3_0_indicatoren_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_oz_indicatoren_v3.0\kwartaal_ind_oz_pop_v3_0_indicatoren.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_oz_indicatoren_v3.0\kwartaal_ind_oz_pop_v3_0_filterlijst.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# De volgende categorieen zijn er: aanvullende gegevens, adl, alcohol, barthel-index, bloeddruk, da
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_oz_indicatoren_v3.0\kwartaal_ind_oz_zorg_v3_0_indicatoren_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_oz_indicatoren_v3.0\kwartaal_ind_oz_zorg_v3_0_indicatoren.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_oz_indicatoren_v3.0\kwartaal_ind_oz_zorg_v3_0_filterlijst.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: CREATE VIEW ongewenstgewichtsverlies_gez
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_oz_indicatoren_v3.0_-_gez\ongewenstgewichtsverlies_gez.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_oz_indicatoren_v3.0_-_gez\kwartaal_oz_ger_event_ooit_gez.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_oz_indicatoren_v3.0_-_gez\kwartaal_oz_medicatie_nieuw_3_mnd_gez.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# In deze _3mt view wordt de uitslag getoond van 3 maanden geleden, dus uitslag vÃ³Ã³r de peildatum m
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_oz_indicatoren_v3.0_-_gez\kwartaal_ind_oz_v3_0_gez_verzameltabel.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# De volgende categorieen zijn er: dbc, deelname ketenzorg, episode, geslacht, #} {# hoofdbehandela
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_oz_indicatoren_v3.0_-_gez\kwartaal_ind_oz_pop_v3_0_gez_indicatoren_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_oz_indicatoren_v3.0_-_gez\kwartaal_ind_oz_pop_v3_0_gez_indicatoren.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_oz_indicatoren_v3.0_-_gez\kwartaal_ind_oz_pop_v3_0_gez_filterlijst.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# De volgende categorieen zijn er: aanvullende gegevens, adl, alcohol, barthel-index, bloeddruk, da
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_oz_indicatoren_v3.0_-_gez\kwartaal_ind_oz_zorg_v3_0_gez_indicatoren_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_oz_indicatoren_v3.0_-_gez\kwartaal_ind_oz_zorg_v3_0_gez_indicatoren.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_oz_indicatoren_v3.0_-_gez\kwartaal_ind_oz_zorg_v3_0_gez_filterlijst.sql

[ERROR] Failed to process kwartaal_ind_vvr_v3_0_algemeen.pry: Invalid PRY format: 'queries:' section not found
[ERROR] Failed to process kwartaal_ind_vvr_v3_0_encrypted.pry: Invalid PRY format: 'queries:' section not found
[ERROR] Failed to process kwartaal_ind_vvr_v3_0_gez_algemeen.pry: Invalid PRY format: 'queries:' section not found
[ERROR] Failed to process kwartaal_ind_vvr_v3_0_gez_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_af_patientenlijst_v3.0\kwartaal_pl_af_v3_0_zg_vertaling.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_af_patientenlijst_v3.0\kwartaal_pl_af_v3_0_patientenlijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_af_patientenlijst_v3.0\kwartaal_pl_af_v3_0_tussen.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_af_patientenlijst_v3.0\kwartaal_pl_af_v3_0_inclusie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_af_patientenlijst_v3.0\kwartaal_pl_af_v3_0_exclusie.sql

[ERROR] Failed to process kwartaalrapport_pl_af_v3_0_encrypted.pry: Invalid PRY format: 'queries:' section not found
[ERROR] Failed to process kwartaalrapport_pl_astma_v3_0_algemeen.pry: Invalid PRY format: 'queries:' section not found
[ERROR] Failed to process kwartaalrapport_pl_astma_v3_0_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_bbr_patientenlijst_v3.0\kwartaal_pl_bbr_v3_0_vertaling.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_bbr_patientenlijst_v3.0\kwartaal_pl_bbr_v3_0_patientenlijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_bbr_patientenlijst_v3.0\kwartaal_pl_bbr_v3_0_tussen.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_bbr_patientenlijst_v3.0\kwartaal_pl_bbr_v3_0_inclusie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_bbr_patientenlijst_v3.0\kwartaal_pl_bbr_v3_0_exclusie.sql

[ERROR] Failed to process kwartaalrapport_pl_bbr_v3_0_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_coronair_lijden_patientenlijst_v3.0\kwartaal_pl_cl_v3_0_zg_vertaling.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_coronair_lijden_patientenlijst_v3.0\kwartaal_pl_cl_v3_0_patientenlijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_coronair_lijden_patientenlijst_v3.0\kwartaal_pl_cl_v3_0_tussen.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_coronair_lijden_patientenlijst_v3.0\kwartaal_pl_cl_v3_0_inclusie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_coronair_lijden_patientenlijst_v3.0\kwartaal_pl_cl_v3_0_exclusie.sql

[ERROR] Failed to process kwartaalrapport_pl_cl_v3_0_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_cns_patientenlijst_v3.0\kwartaal_pl_cns_v3_0_vertaling.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_cns_patientenlijst_v3.0\kwartaal_pl_cns_v3_0_patientenlijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_cns_patientenlijst_v3.0\kwartaal_pl_cns_v3_0_tussen.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_cns_patientenlijst_v3.0\kwartaal_pl_cns_v3_0_inclusie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_cns_patientenlijst_v3.0\kwartaal_pl_cns_v3_0_exclusie.sql

[ERROR] Failed to process kwartaalrapport_pl_cns_v3_0_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_copdastma_patientenlijst_v3.0\kwart_pl_copdastma_v3_0_vertaling.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_copdastma_patientenlijst_v3.0\kwart_pl_copdastma_v3_0_vertaling_copd.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_copdastma_patientenlijst_v3.0\kwart_pl_copdastma_v3_0_vertaling_astma.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_copdastma_patientenlijst_v3.0\kwart_pl_copdastma_v3_0_patientenlijst_copd.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_copdastma_patientenlijst_v3.0\kwart_pl_copdastma_v3_0_tussen_copd.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_copdastma_patientenlijst_v3.0\kwart_pl_copdastma_v3_0_inclusie_copd.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_copdastma_patientenlijst_v3.0\kwart_pl_copdastma_v3_0_exclusie_copd.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_copdastma_patientenlijst_v3.0\kwart_pl_copdastma_v3_0_patientenlijst_astma.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_copdastma_patientenlijst_v3.0\kwart_pl_copdastma_v3_0_tussen_astma.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_copdastma_patientenlijst_v3.0\kwart_pl_copdastma_v3_0_inclusie_astma.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_copdastma_patientenlijst_v3.0\kwart_pl_copdastma_v3_0_exclusie_astma.sql

[ERROR] Failed to process kwartaalrapport_pl_copdastma_v3_0_encrypted.pry: Invalid PRY format: 'queries:' section not found
[ERROR] Failed to process kwartaalrapport_pl_copd_v3_0_algemeen.pry: Invalid PRY format: 'queries:' section not found
[ERROR] Failed to process kwartaalrapport_pl_copd_v3_0_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_cvrm_patientenlijst_v3.0\kwartaal_pl_cvrm_v3_0_zg_vertaling.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_cvrm_patientenlijst_v3.0\kwart_pl_cvrm_v3_0_vertaling_hvz.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_cvrm_patientenlijst_v3.0\kwart_pl_cvrm_v3_0_vertaling_vvr.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_cvrm_patientenlijst_v3.0\kwartaal_pl_cvrm_v3_0_patientenlijst_hvz.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_cvrm_patientenlijst_v3.0\kwartaal_pl_cvrm_v3_0_tussen_hvz.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_cvrm_patientenlijst_v3.0\kwartaal_pl_cvrm_v3_0_inclusie_hvz.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_cvrm_patientenlijst_v3.0\kwartaal_pl_cvrm_v3_0_exclusie_hvz.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_cvrm_patientenlijst_v3.0\kwartaal_pl_cvrm_v3_0_patientenlijst_vvr.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_cvrm_patientenlijst_v3.0\kwartaal_pl_cvrm_v3_0_tussen_vvr.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_cvrm_patientenlijst_v3.0\kwartaal_pl_cvrm_v3_0_inclusie_vvr.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_cvrm_patientenlijst_v3.0\kwartaal_pl_cvrm_v3_0_exclusie_vvr.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_cvrm_patientenlijst_v3.0\kwartaal_pl_cvrm_v3_0_53530008_k90.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_cvrm_patientenlijst_v3.0\kwartaal_pl_cvrm_v3_0_inkaarten.sql

[ERROR] Failed to process kwartaalrapport_pl_cvrm_v3_0_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_dementie_patientenlijst_v3.0\kwartaal_pl_dem_v3_0_zg_vertaling.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_dementie_patientenlijst_v3.0\kwartaal_pl_dem_v3_0_patientenlijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_dementie_patientenlijst_v3.0\kwartaal_pl_dem_v3_0_tussen.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_dementie_patientenlijst_v3.0\kwartaal_pl_dem_v3_0_inclusie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_dementie_patientenlijst_v3.0\kwartaal_pl_dem_v3_0_exclusie.sql

[ERROR] Failed to process kwartaal_pl_dementie_v3_0_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_dm_patientenlijst_v3.0\kwartaal_pl_dm_v3_0_vertaling.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_dm_patientenlijst_v3.0\kwartaal_pl_dm_v3_0_patientenlijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_dm_patientenlijst_v3.0\kwartaal_pl_dm_v3_0_tussen.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_dm_patientenlijst_v3.0\kwartaal_pl_dm_v3_0_inclusie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_dm_patientenlijst_v3.0\kwartaal_pl_dm_v3_0_exclusie.sql

[ERROR] Failed to process kwartaalrapport_pl_dm_v3_0_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_epa_patientenlijst_v3.0\kwartaal_pl_epa_v3_0_zg_vertaling.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_epa_patientenlijst_v3.0\kwartaal_pl_epa_v3_0_patientenlijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_epa_patientenlijst_v3.0\kwartaal_pl_epa_v3_0_tussen.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_epa_patientenlijst_v3.0\kwartaal_pl_epa_v3_0_inclusie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_epa_patientenlijst_v3.0\kwartaal_pl_epa_v3_0_exclusie.sql

[ERROR] Failed to process kwartaalrapport_pl_epa_v3_0_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_ggz_patientenlijst_v3.0\kwartaal_pl_ggz_v3_0_vertaling.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_ggz_patientenlijst_v3.0\kwartaal_pl_ggz_jeugd_v3_0_vertaling.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_ggz_patientenlijst_v3.0\kwartaal_pl_ggz_v3_0_patientenlijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_ggz_patientenlijst_v3.0\kwartaal_pl_ggz_v3_0_tussen.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_ggz_patientenlijst_v3.0\kwartaal_pl_ggz_v3_0_inclusie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_ggz_patientenlijst_v3.0\kwartaal_pl_ggz_v3_0_exclusie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_ggz_patientenlijst_v3.0\kwartaal_pl_ggz_jeugd_v3_0_patientenlijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_ggz_patientenlijst_v3.0\kwartaal_pl_ggz_jeugd_v3_0_tussen.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_ggz_patientenlijst_v3.0\kwartaal_pl_ggz_jeugd_v3_0_inclusie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_ggz_patientenlijst_v3.0\kwartaal_pl_ggz_jeugd_v3_0_exclusie.sql

[ERROR] Failed to process kwartaalrapport_pl_ggz_v3_0_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_hartfalen_patientenlijst_v3.0\kwartaal_pl_hf_v3_0_vertaling.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_hartfalen_patientenlijst_v3.0\kwartaal_pl_hf_v3_0_patientenlijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_hartfalen_patientenlijst_v3.0\kwartaal_pl_hf_v3_0_tussen.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_hartfalen_patientenlijst_v3.0\kwartaal_pl_hf_v3_0_inclusie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_hartfalen_patientenlijst_v3.0\kwartaal_pl_hf_v3_0_exclusie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_hartfalen_patientenlijst_v3.0\kwartaal_pl_hf_v3_0_mogelijk_hf.sql

[ERROR] Failed to process kwartaalrapport_pl_hartfalen_v3_0_encrypted.pry: Invalid PRY format: 'queries:' section not found
[ERROR] Failed to process kwartaalrapport_pl_hvz_v3_0_algemeen.pry: Invalid PRY format: 'queries:' section not found
[ERROR] Failed to process kwartaalrapport_pl_hvz_v3_0_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_osteoporose_patientenlijst_v3.0\kwartaal_pl_osteoporose_v3_0_vertaling.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_osteoporose_patientenlijst_v3.0\kwartaal_pl_osteoporose_v3_0_patientenlijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_osteoporose_patientenlijst_v3.0\kwartaal_pl_osteoporose_v3_0_tussen.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_osteoporose_patientenlijst_v3.0\kwartaal_pl_osteoporose_v3_0_inclusie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_osteoporose_patientenlijst_v3.0\kwartaal_pl_osteoporose_v3_0_exclusie.sql

[ERROR] Failed to process kwartaalrapport_pl_osteoporose_v3_0_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_oz_patientenlijst_v3.0\kwartaal_pl_oz_v3_0_vertaling.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_oz_patientenlijst_v3.0\kwartaal_pl_oz_v3_0_patientenlijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_oz_patientenlijst_v3.0\kwartaal_pl_oz_v3_0_tussen.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_oz_patientenlijst_v3.0\kwartaal_pl_oz_v3_0_inclusie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwartaalrapport_oz_patientenlijst_v3.0\kwartaal_pl_oz_v3_0_exclusie.sql

[ERROR] Failed to process kwartaalrapport_pl_oz_v3_0_encrypted.pry: Invalid PRY format: 'queries:' section not found
[ERROR] Failed to process kwartaalrapport_pl_vvr_v3_0_algemeen.pry: Invalid PRY format: 'queries:' section not found
[ERROR] Failed to process kwartaalrapport_pl_vvr_v3_0_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwetsbare_ouderen\kwetsbare_ouderen_ge_lijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwetsbare_ouderen\kwetsbare_ouderen_multimorbiditeit.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwetsbare_ouderen\kwetsbare_ouderen_ge_score.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwetsbare_ouderen\kwetsbare_ouderen_ca_score.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwetsbare_ouderen\kwetsbare_ouderen_ge_score_3mt.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwetsbare_ouderen\kwetsbare_ouderen_ca_score_3mt.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwetsbare_ouderen\kwetsbare_ouderen_nieuw_aandachtspunt.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwetsbare_ouderen\kwetsbare_ouderen_nieuw_aandachtspunt_berekening.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwetsbare_ouderen\kwetsbare_ouderen_mw_epi_indic_pl.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwetsbare_ouderen\kwetsbare_ouderen_indicatoren_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwetsbare_ouderen\kwetsbare_ouderen_indicatoren.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwetsbare_ouderen\kwetsbare_ouderen_patientenlijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwetsbare_ouderen\kwetsbare_ouderen_patientenlijst_tussen.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwetsbare_ouderen\kwetsbare_ouderen_patientenlijst_tonen.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwetsbare_ouderen\kwetsbare_ouderen_pl_extra_info.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwetsbare_ouderen\kwetsbare_ouderen_pl_extra_info_tussen.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwetsbare_ouderen\kwetsbare_ouderen_pl_extra_info_tonen.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwetsbare_ouderen\kwetsbare_ouderen_patienten_gegevens.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwetsbare_ouderen\kwetsbare_ouderen_patienten_gegevens_60.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwetsbare_ouderen\kwetsbare_ouderen_episode.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwetsbare_ouderen\kwetsbare_ouderen_medicaties.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwetsbare_ouderen\kwetsbare_ouderen_medicatie_overzicht.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW kwetsbare_ouderen_meetwaarden_pl AS  
SELECT * FROM
crosstab(
            'WITH bepalingen AS
      (
    SELECT 
      patient_id::varchar,
      nhgnummer,
      CASE uitslag_cleaned
            WHEN ''ha'' THEN ''huisarts''
            WHEN ''spec'' THEN ''specialist''
            WHEN ''ovond'' THEN ''overig/onbekend''
            ELSE uitslag
        END as uitslag,
      COALESCE(aw.output, uitslag_num) as uitslag_num,
      datum
    FROM bepaling b
    LEFT JOIN indelingen.alfanumerieke_waarden aw
            ON b.nhgnummer=aw.nhgnr
            AND aw.input=uitslag
    WHERE nhgnummer IN (3015,2808,2789,2803,2802,2793,3453,2787,2788)
        AND datum < ''${peildatum}''
            )
            SELECT
                DISTINCT ON (patient_id,nhgnummer::integer)
                patient_id,
                nhgnummer::integer,
                ARRAY[coalesce(waarde_omschrijving,tekst_waarde)::varchar,
                datum::varchar,
                CASE WHEN uitslag_num is not null
                        AND (rw.ineen_min is null OR rw.ineen_min <= uitslag_num)
                        AND (rw.ineen_max is null OR rw.ineen_max >= uitslag_num)
                     THEN uitslag_num END::varchar             
                        ] as waarde_datum_num
            FROM (
            SELECT   
                patient_id,
                nhgnummer,
                datum,
                uitslag as tekst_waarde,
                indelingen.translate_labcode_answers(nhgnummer::int, uitslag) as waarde_omschrijving,
                CASE WHEN nhgnummer=560 AND uitslag_num <3 THEN uitslag_num *100
                    ELSE uitslag_num END as uitslag_num
            FROM bepalingen        
            LEFT JOIN indelingen.nhg_labcodes lc ON (nhgnummer=lc.nhgnr)    
            ) AS bepaling
            LEFT JOIN indelingen.nhg_labcodes_referentie_waarden rw ON (nhgnummer=rw.nhgnr)
            ORDER BY patient_id,nhgnummer,datum DESC,tekst_waarde NULLS LAST,waarde_omschrijving NULLS LAST',
     'SELECT s.a[n] FROM generate_series(1,9) as n 
     CROSS JOIN (SELECT ARRAY[3015,2808,2789,2803,2802,2793,3453,2787,2788]
      as a) s ORDER BY n'
) as ct(
       patient_id bigint,
       ozhb_az    varchar[],
   kwbh_az	  varchar[],
   ozp_az     varchar[],
   zzpv_az    varchar[],
   cizi_az    varchar[],
   gfit_aq	  varchar[],
   ozrz_az    varchar[],
   oztv_az    varchar[],
   ozvc_az    varchar[]);
Converted crosstab SQL:

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwetsbare_ouderen\kwetsbare_ouderen_meetwaarden_pl.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwetsbare_ouderen\kwetsbare_ouderen_epi_pl.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwetsbare_ouderen\kwetsbare_ouderen_episode_3mt.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwetsbare_ouderen\kwetsbare_ouderen_medicaties_3mt.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwetsbare_ouderen\kwetsbare_ouderen_medicatie_overzicht_3mt.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\meer_tijd_voor_de_patient_-_verwijzingen_-_hcdo\mtvdp_53530025_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\meer_tijd_voor_de_patient_-_verwijzingen_-_hcdo\mtvdp_53530025_indicatoren_verwijzingen.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\meer_tijd_voor_de_patient_-_verwijzingen_-_hcdo\mtvdp_53530025_patientenlijst_verwijzingen_jaar.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\meer_tijd_voor_de_patient_-_verwijzingen_-_hcdo\mtvdp_53530025_patientenlijst_verwijzingen_week.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\meer_tijd_voor_de_patient_-_verwijzingen_-_hcdo\mtvdp_53530025_verwijzingen_medewerker.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {{ medewerker_koppeling_medewerkerbeheer() }}
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\meer_tijd_voor_de_patient_-_verwijzingen_-_hcdo\mtvdp_53530025_medewerker.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\meer_tijd_voor_de_patient_-_verwijzingen_-_hcdo\mtvdp_53530025_verwijzing_voorselectie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\meer_tijd_voor_de_patient_-_verwijzingen_-_hcdo\mtvdp_53530025_verwijzing.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_astma_bij_kinderen_v1.2_indicatoren\nhg_astma_v1_2_kind_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_astma_bij_kinderen_v1.2_indicatoren\nhg_astma_v1_2_kind_indicatoren_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_astma_bij_kinderen_v1.2_indicatoren\nhg_astma_v1_2_kind_indicatoren.sql

[ERROR] Failed to process nhg_astma_v1_2_kind_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_astma_bij_kinderen_v1.2_patientenlijst\nhg_astma_v1_2_kind_pl_patientenlijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_astma_bij_kinderen_v1.2_patientenlijst\nhg_astma_v1_2_kind_pl_tussen.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_astma_bij_kinderen_v1.2_patientenlijst\nhg_astma_v1_2_kind_pl_inclusie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_astma_bij_kinderen_v1.2_patientenlijst\nhg_astma_v1_2_kind_pl_exclusie.sql

[ERROR] Failed to process nhg_astma_v1_2_kind_pl_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_astma_bij_volwassenen_v3.2_indicatoren\nhg_astma_v3_2_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_astma_bij_volwassenen_v3.2_indicatoren\nhg_astma_v3_2_indicatoren_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_astma_bij_volwassenen_v3.2_indicatoren\nhg_astma_v3_2_indicatoren.sql

[ERROR] Failed to process nhg_astma_v3_2_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_astma_bij_volwassenen_v3.2_patientenlijst\nhg_astma_v3_2_patientenlijst_patientenlijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_astma_bij_volwassenen_v3.2_patientenlijst\nhg_astma_v3_2_tussen.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_astma_bij_volwassenen_v3.2_patientenlijst\nhg_astma_v3_2_inclusie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_astma_bij_volwassenen_v3.2_patientenlijst\nhg_astma_v3_2_exclusie.sql

[ERROR] Failed to process nhg_astma_v3_2_patientenlijst_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_astma_bij_volwassenen_v3.3_indicatoren\nhg_astma_v3_3_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_astma_bij_volwassenen_v3.3_indicatoren\nhg_astma_v3_3_indicatoren_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_astma_bij_volwassenen_v3.3_indicatoren\nhg_astma_v3_3_indicatoren.sql

[ERROR] Failed to process nhg_astma_v3_3_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_astma_bij_volwassenen_v3.3_patientenlijst\nhg_astma_v3_3_patientenlijst_patientenlijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_astma_bij_volwassenen_v3.3_patientenlijst\nhg_astma_v3_3_tussen.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_astma_bij_volwassenen_v3.3_patientenlijst\nhg_astma_v3_3_inclusie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_astma_bij_volwassenen_v3.3_patientenlijst\nhg_astma_v3_3_exclusie.sql

[ERROR] Failed to process nhg_astma_v3_3_patientenlijst_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_cns_v1.2_indicatoren\nhg_cns_v1_2_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_cns_v1.2_indicatoren\nhg_cns_v1_2_indicatoren_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_cns_v1.2_indicatoren\nhg_cns_v1_2_indicatoren.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_cns_v1.2_indicatoren\nhg_cns_v1_2_contraindicatie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_cns_v1.2_patientenlijst\nhg_cns_v1_2_patientenlijst_patientenlijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_cns_v1.2_patientenlijst\nhg_cns_v1_2_patientenlijst_tussen.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_cns_v1.2_patientenlijst\nhg_cns_v1_2_patientenlijst_inclusie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_cns_v1.2_patientenlijst\nhg_cns_v1_2_patientenlijst_exclusie.sql

[ERROR] Failed to process nhg_cns_v1_2_patientenlijst_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_copd_v3.2_indicatoren\nhg_copd_v3_2_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_copd_v3.2_indicatoren\nhg_copd_v3_2_indicatoren_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_copd_v3.2_indicatoren\nhg_copd_v3_2_indicatoren.sql

[ERROR] Failed to process nhg_copd_v3_2_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_copd_v3.2_patientenlijst\nhg_copd_v3_2_patientenlijst_patientenlijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_copd_v3.2_patientenlijst\nhg_copd_v3_2_patientenlijst_tussen.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_copd_v3.2_patientenlijst\nhg_copd_v3_2_patientenlijst_inclusie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_copd_v3.2_patientenlijst\nhg_copd_v3_2_patientenlijst_exclusie.sql

[ERROR] Failed to process nhg_copd_v3_2_patientenlijst_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_cvrm_hoog_risico_v1.10_indicatoren\nhg_cvrm_hr_v1_10_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_cvrm_hoog_risico_v1.10_indicatoren\nhg_cvrm_hr_v1_10_indicatoren_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_cvrm_hoog_risico_v1.10_indicatoren\nhg_cvrm_hr_v1_10_indicatoren.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_cvrm_hoog_risico_v1.10_indicatoren\nhg_cvrm_hr_v1_10_contraindicatie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_cvrm_hoog_risico_v1.10_patientenlijst\nhg_cvrm_hr_v1_10_patientenlijst_patientenlijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_cvrm_hoog_risico_v1.10_patientenlijst\nhg_cvrm_hr_v1_10_pl_tussen.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_cvrm_hoog_risico_v1.10_patientenlijst\nhg_cvrm_hr_v1_10_pl_inclusie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_cvrm_hoog_risico_v1.10_patientenlijst\nhg_cvrm_hr_v1_10_pl_exclusie.sql

[ERROR] Failed to process nhg_cvrm_hr_v1_10_pl_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_cvrm_hoog_risico_v1.9_indicatoren\nhg_cvrm_hr_v1_9_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_cvrm_hoog_risico_v1.9_indicatoren\nhg_cvrm_hr_v1_9_indicatoren_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_cvrm_hoog_risico_v1.9_indicatoren\nhg_cvrm_hr_v1_9_indicatoren.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_cvrm_hoog_risico_v1.9_indicatoren\nhg_cvrm_hr_v1_9_contraindicatie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_cvrm_hoog_risico_v1.9_patientenlijst\nhg_cvrm_hr_v1_9_patientenlijst_patientenlijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_cvrm_hoog_risico_v1.9_patientenlijst\nhg_cvrm_hr_v1_9_pl_tussen.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_cvrm_hoog_risico_v1.9_patientenlijst\nhg_cvrm_hr_v1_9_pl_inclusie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_cvrm_hoog_risico_v1.9_patientenlijst\nhg_cvrm_hr_v1_9_pl_exclusie.sql

[ERROR] Failed to process nhg_cvrm_hr_v1_9_pl_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_cvrm_hvz_v1.15_indicatoren\nhg_cvrm_hvz_v1_15_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_cvrm_hvz_v1.15_indicatoren\nhg_cvrm_hvz_v1_15_indicatoren_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_cvrm_hvz_v1.15_indicatoren\nhg_cvrm_hvz_v1_15_indicatoren.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_cvrm_hvz_v1.15_indicatoren\nhg_cvrm_hvz_v1_15_contraindicatie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_cvrm_hvz_v1.15_patientenlijst\nhg_cvrm_hvz_v1_15_patientenlijst_patientenlijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_cvrm_hvz_v1.15_patientenlijst\nhg_cvrm_hvz_v1_15_patientenlijst_tussen.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_cvrm_hvz_v1.15_patientenlijst\nhg_cvrm_hvz_v1_15_patientenlijst_inclusie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_cvrm_hvz_v1.15_patientenlijst\nhg_cvrm_hvz_v1_15_patientenlijst_exclusie.sql

[ERROR] Failed to process nhg_cvrm_hvz_v1_15_patientenlijst_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_cvrm_standaard_(2024)\nhg_cvrm_std_2024_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_cvrm_standaard_(2024)\nhg_cvrm_std_2024_indicatoren_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_cvrm_standaard_(2024)\nhg_cvrm_std_2024_indicatoren.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_cvrm_standaard_(2024)\nhg_cvrm_std_2024_pl_in_zorg.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_cvrm_standaard_(2024)\nhg_cvrm_std_2024_pl_zeer_hoog_risico.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_cvrm_standaard_(2024)\nhg_cvrm_std_2024_pl_hoog_risico.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_cvrm_standaard_(2024)\nhg_cvrm_std_2024_pl_matig_verhoogd_risico.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_cvrm_standaard_(2024)\nhg_cvrm_std_2024_pl_ldl_niet_gereguleerd_hvz.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_cvrm_standaard_(2024)\nhg_cvrm_std_2024_pl_stop_lipidenverlager.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_cvrm_standaard_(2024)\nhg_cvrm_std_2024_pl_kwets_ouderen_diast_70.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_cvrm_standaard_(2024)\nhg_cvrm_std_2024_pl_streefwaarde_bloeddruk.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_cvrm_standaard_(2024)\nhg_cvrm_std_2024_pl_ldl_niet_gereguleerd.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_cvrm_standaard_(2024)\nhg_cvrm_std_2024_pl_sec_hypertensie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_cvrm_standaard_(2024)\nhg_cvrm_std_2024_pl_onderbehandeling.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_cvrm_standaard_(2024)\nhg_cvrm_std_2024_pl_risicoprofiel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_cvrm_standaard_(2024)\nhg_cvrm_std_2024_pl_risicoschatting.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_cvrm_standaard_(2024)\nhg_cvrm_std_2024_pl_epa_qriskscore_10.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_cvrm_standaard_(2024)\nhg_cvrm_std_2024_pl_top10_roken.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_cvrm_standaard_(2024)\nhg_cvrm_std_2024_pl_top10_medicatie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_cvrm_standaard_(2024)\nhg_cvrm_std_2024_pl_cac_score.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_cvrm_standaard_(2024)\nhg_cvrm_std_2024_pl_lijst_voor_apotheek.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_cvrm_standaard_(2024)\nhg_cvrm_std_2024_pl_ongewenste_medicatie_combi.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_cvrm_standaard_(2024)\nhg_cvrm_std_2024_pl_medicatie_optimalisatie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_cvrm_standaard_(2024)\nhg_cvrm_std_2024_pl_psychosoc_risicofac.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_cvrm_standaard_(2024)\nhg_cvrm_std_2024_pl_wel_rh19_geen_rh24.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_cvrm_standaard_(2024)\nhg_cvrm_std_2024_c03_inclusie_chron.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_cvrm_standaard_(2024)\nhg_cvrm_std_2024_c03_inclusie_actueel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_cvrm_standaard_(2024)\nhg_cvrm_std_2024_radiotherapie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_cvrm_standaard_(2024)\nhg_cvrm_std_2024_ldl.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_cvrm_standaard_(2024)\nhg_cvrm_std_2024_rrsy_alle.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_cvrm_standaard_(2024)\nhg_cvrm_std_2024_rrsy_ka.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_cvrm_standaard_(2024)\nhg_cvrm_std_2024_rrsy_gem.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_cvrm_standaard_(2024)\nhg_cvrm_std_2024_rrdi_ka.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_cvrm_standaard_(2024)\nhg_cvrm_std_2024_chol_8_ooit.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_cvrm_standaard_(2024)\nhg_cvrm_std_2024_rrsy_180_ooit.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_cvrm_standaard_(2024)\nhg_cvrm_std_2024_contact_p19.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# LET OP: er is een block medicatie_epa.pry beschikbaar, maar is enkel bedoeld voor seg1. #}
WITH m
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_cvrm_standaard_(2024)\nhg_cvrm_std_2024_med_epa.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_cvrm_standaard_(2024)\nhg_cvrm_std_2024_med_epa_actueel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_cvrm_standaard_(2024)\nhg_cvrm_std_2024_bloeddruk_sd.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_dm_v1.16_indicatoren\nhg_dm_v1_16_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_dm_v1.16_indicatoren\nhg_dm_v1_16_indicatoren_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_dm_v1.16_indicatoren\nhg_dm_v1_16_indicatoren.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_dm_v1.16_indicatoren\nhg_dm_v1_16_contraindicatie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_dm_v1.16_patientenlijst\nhg_dm_v1_16_patientenlijst_patientenlijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_dm_v1.16_patientenlijst\nhg_dm_v1_16_patientenlijst_tussen.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_dm_v1.16_patientenlijst\nhg_dm_v1_16_patientenlijst_inclusie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_dm_v1.16_patientenlijst\nhg_dm_v1_16_patientenlijst_exclusie.sql

[ERROR] Failed to process nhg_dm_v1_16_patientenlijst_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0\nhg_jaarverslag_v2_0_achterstandswijk.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0\nhg_jaarverslag_v2_0_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0\nhg_jaarverslag_v2_0_leeftijd_bins.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0\nhg_jaarverslag_v2_0_verdeling_populatie_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0\nhg_jaarverslag_v2_0_verdeling_populatie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0\nhg_jaarverslag_v2_0_mutaties_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0\nhg_jaarverslag_v2_0_mutaties.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0\nhg_jaarverslag_v2_0_verzekering.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0\nhg_jaarverslag_v2_0_aandoeningen_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0\nhg_jaarverslag_v2_0_aandoeningen.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0\nhg_jaarverslag_v2_0_top10_epi.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0\nhg_jaarverslag_v2_0_ind_dm_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0\nhg_jaarverslag_v2_0_ind_dm.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0\nhg_jaarverslag_v2_0_ind_copd_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0\nhg_jaarverslag_v2_0_ind_copd.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0\nhg_jaarverslag_v2_0_ind_hvz_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0\nhg_jaarverslag_v2_0_ind_hvz.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0\nhg_jaarverslag_v2_0_ind_vvr_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0\nhg_jaarverslag_v2_0_ind_vvr.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0\nhg_jaarverslag_v2_0_ind_astma_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0\nhg_jaarverslag_v2_0_ind_astma.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0\nhg_jaarverslag_v2_0_medicatie_overzicht_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0\nhg_jaarverslag_v2_0_medicatie_overzicht.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0\nhg_jaarverslag_v2_0_polyfarmacie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0\nhg_jaarverslag_v2_0_top10_medicatie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0\nhg_jaarverslag_v2_0_prescriptie_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0\nhg_jaarverslag_v2_0_prescriptie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0\nhg_jaarverslag_v2_0_verrichting_cat.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0\nhg_jaarverslag_v2_0_verrichting_alg.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0\nhg_jaarverslag_v2_0_verrichting_top10_overig.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0\nhg_jaarverslag_v2_0_verrichting_top10mi.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0\nhg_jaarverslag_v2_0_verrichting_per_mw.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0\nhg_jaarverslag_v2_0_verrichting_pohggz_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0\nhg_jaarverslag_v2_0_verrichting_pohggz.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0\nhg_jaarverslag_v2_0_ver_pohggz_cat.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0\nhg_jaarverslag_v2_0_ver_pohggz_lftd.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0\nhg_jaarverslag_v2_0_contacten_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0\nhg_jaarverslag_v2_0_contacten.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0\nhg_jaarverslag_v2_0_contacten_lftd.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0\nhg_jaarverslag_v2_0_contacten_icpc_per_mw.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0\nhg_jaarverslag_v2_0_contacten_mind_30_mw.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0\nhg_jaarverslag_v2_0_patient_alle.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0\nhg_jaarverslag_v2_0_patient.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {{ medewerker_koppeling_medewerkerbeheer() }}
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0\nhg_jaarverslag_v2_0_medewerker.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# een vaste praktijkpopulatie wordt bepaald, dit ivm berekening van % of per 1.000 pt #}
SELECT
  (
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0\nhg_jaarverslag_v2_0_verrichting_pt.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0\nhg_jaarverslag_v2_0_verrichtingen.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0\nhg_jaarverslag_v2_0_inuitschrijving.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0\nhg_jaarverslag_v2_0_medicatie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0_-_hcdo\nhg_jaarverslag_v2_0_53530025_achterstandswijk.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0_-_hcdo\nhg_jaarverslag_v2_0_53530025_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0_-_hcdo\nhg_jaarverslag_v2_0_53530025_verzamel_peiljaar.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0_-_hcdo\nhg_jaarverslag_v2_0_53530025_leeftijd_bins.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0_-_hcdo\nhg_jv_v2_0_53530025_verdeling_populatie_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0_-_hcdo\nhg_jaarverslag_v2_0_53530025_verdeling_populatie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0_-_hcdo\nhg_jaarverslag_v2_0_53530025_mutaties_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0_-_hcdo\nhg_jaarverslag_v2_0_53530025_mutaties.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0_-_hcdo\nhg_jaarverslag_v2_0_53530025_verzekering_std_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0_-_hcdo\nhg_jaarverslag_v2_0_53530025_verzekering_std.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0_-_hcdo\nhg_jaarverslag_v2_0_53530025_ind_dm_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0_-_hcdo\nhg_jaarverslag_v2_0_53530025_ind_dm.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0_-_hcdo\nhg_jaarverslag_v2_0_53530025_ind_copd_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0_-_hcdo\nhg_jaarverslag_v2_0_53530025_ind_copd.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0_-_hcdo\nhg_jaarverslag_v2_0_53530025_ind_hvz_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0_-_hcdo\nhg_jaarverslag_v2_0_53530025_ind_hvz.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0_-_hcdo\nhg_jaarverslag_v2_0_53530025_ind_vvr_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0_-_hcdo\nhg_jaarverslag_v2_0_53530025_ind_vvr.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0_-_hcdo\nhg_jaarverslag_v2_0_53530025_ind_astma_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0_-_hcdo\nhg_jaarverslag_v2_0_53530025_ind_astma.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0_-_hcdo\nhg_jaarverslag_v2_0_53530025_oz_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0_-_hcdo\nhg_jaarverslag_v2_0_53530025_oz.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0_-_hcdo\nhg_jaarverslag_v2_0_53530025_ggz_medicatie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0_-_hcdo\nhg_jaarverslag_v2_0_53530025_ggz_controles_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0_-_hcdo\nhg_jaarverslag_v2_0_53530025_ggz_controles.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0_-_hcdo\nhg_jv_v2_0_53530025_medicatie_overzicht_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0_-_hcdo\nhg_jaarverslag_v2_0_53530025_polyfarmacie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0_-_hcdo\nhg_jaarverslag_v2_0_53530025_prescriptie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0_-_hcdo\nhg_jaarverslag_v2_0_53530025_verrichting_cat.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0_-_hcdo\nhg_jaarverslag_v2_0_53530025_verrichting_alg.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0_-_hcdo\nhg_jaarverslag_v2_0_53530025_verrichting_mi.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0_-_hcdo\nhg_jv_v2_0_53530025_verrichting_pohggz_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0_-_hcdo\nhg_jaarverslag_v2_0_53530025_verrichting_pohggz.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0_-_hcdo\nhg_jaarverslag_v2_0_53530025_ver_pohggz_cat.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0_-_hcdo\nhg_jaarverslag_v2_0_53530025_ver_pohggz_lftd.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0_-_hcdo\nhg_jaarverslag_v2_0_53530025_contacten_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0_-_hcdo\nhg_jaarverslag_v2_0_53530025_contacten.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0_-_hcdo\nhg_jaarverslag_v2_0_53530025_contacten_lftd.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0_-_hcdo\nhg_jaarverslag_v2_0_53530025_gez_problemen_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0_-_hcdo\nhg_jaarverslag_v2_0_53530025_gez_problemen.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0_-_hcdo\nhg_jaarverslag_v2_0_53530025_gez_problemen_t10.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0_-_hcdo\nhg_jaarverslag_v2_0_53530025_gez_problemen_t10_v.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0_-_hcdo\nhg_jaarverslag_v2_0_53530025_gez_problemen_t10_m.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {{ medewerker_koppeling_medewerkerbeheer() }}
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0_-_hcdo\nhg_jaarverslag_v2_0_53530025_medewerker.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0_-_hcdo\nhg_jaarverslag_v2_0_53530025_verrichtingen.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0_-_hcdo\nhg_jaarverslag_v2_0_53530025_inuitschrijving.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0_-_hcdo\nhg_jaarverslag_v2_0_53530025_years.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0_-_hcdo\nhg_jaarverslag_v2_0_53530025_patient.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0_-_hcdo\nhg_jaarverslag_v2_0_53530025_medicatie.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# kopie van proigia_episode_filter #}
WITH pre_episode AS (
  SELECT
    episode_id,
    patient_id
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0_-_hcdo\nhg_jaarverslag_v2_0_53530025_epi_filter.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# kopie van proigia_icpc_codes #}
WITH icpc_codes AS (
  SELECT
    icpc
  FROM (VALUES
    ('A05%'
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0_-_hcdo\nhg_jaarverslag_v2_0_53530025_icpc_codes.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW nhg_jaarverslag_v2_0_53530025_episode AS

WITH pre AS
(
SELECT * FROM crosstab($$
    SELECT
        ARRAY[patient_id::varchar,
            eind_periode::varchar] AS unique_field,
        name,
        ARRAY[min(begindatum)::varchar,
                max(einddatum)::varchar,
                max(status_datum)::varchar,
                max(status_vlag)::varchar,
                array_agg(distinct icpc)::varchar,
                max(begindatum)::varchar,
                min(einddatum)::varchar,
                min(begindatum_nonactief)::varchar,
                max(einddatum_nonactief)::varchar,
                max(begindatum_nonactief)::varchar,
                min(einddatum_nonactief)::varchar] AS waardes
    FROM nhg_jaarverslag_v2_0_53530025_epi_filter
    JOIN nhg_jaarverslag_v2_0_53530025_icpc_codes ON icpc ilike searchstring
    GROUP BY unique_field, name
    ORDER BY unique_field, name
$$,$$
    SELECT name FROM nhg_jaarverslag_v2_0_53530025_icpc_codes ORDER BY name;
$$) AS ct(
    unique_field varchar[],
    a05_ varchar[],
    a20_ varchar[],
    a49_01 varchar[],
		d75_ varchar[],
		k74_ varchar[],
		k75_ varchar[],
		k76_ varchar[],
		k77_ varchar[],
		k78_ varchar[],
		k86_ varchar[],
		k87_ varchar[],
		k89_ varchar[],
		k90_ varchar[],
		k92_ varchar[],
		k99_ varchar[],
		p15_ varchar[],
		p19_ varchar[],
		p20_ varchar[],
		p70_ varchar[],
		p21_ varchar[],
		p74_ varchar[],
		p76_ varchar[],
		p78_ varchar[],
		p80_ varchar[],
		r84_ varchar[],
		r95_ varchar[],
		r96_ varchar[],
		t90_ varchar[],
		t93_ varchar[],
		u76_ varchar[],
		x76_ varchar[],
		y77_ varchar[],
		z29_ varchar[])
)
SELECT
unique_field[1]:: bigint AS patient_id,
unique_field[2]::date AS eind_periode,
*
FROM pre;
Converted crosstab SQL:
WITH cte1 AS (

    SELECT
        ARRAY[patient_id::varchar,
            eind_periode::varchar] AS unique_field,
        name,
        ARRAY[min(begindatum)::varchar,
                max(einddatum)::varchar,
                max(status_datum)::varchar,
                max(status_vlag)::varchar,
                array_agg(distinct icpc)::varchar,
                max(begindatum)::varchar,
                min(einddatum)::varchar,
                min(begindatum_nonactief)::varchar,
                max(einddatum_nonactief)::varchar,
                max(begindatum_nonactief)::varchar,
                min(einddatum_nonactief)::varchar] AS waardes
    FROM {{ ref('nhg_jaarverslag_v2_0_53530025_epi_filter') }}
    JOIN {{ ref('nhg_jaarverslag_v2_0_53530025_icpc_codes') }} ON icpc ilike searchstring
    GROUP BY unique_field, name
    ORDER BY unique_field, name

)
SELECT unique_field
, {{ dbt_utils.pivot('name',        dbt_utils.get_column_values(ref('nhg_jaarverslag_v2_0_53530025_icpc_codes'),'categorie',default=[]),        agg='',        then_value='name',        else_value="ARRAY_CONSTRUCT()",        quote_identifiers=False)}} 
FROM cte1
GROUP BY unique_field
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0_-_hcdo\nhg_jaarverslag_v2_0_53530025_episode.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# kopie van proigia_labcodes #}
SELECT
    AS
  FROM (VALUES
    (35,),
    (181,),
    (192,),
   
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0_-_hcdo\nhg_jaarverslag_v2_0_53530025_labcodes.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# kopie van proigia_meetwaarden_filter #}
WITH nhgnr_verrijking AS (
  SELECT
    patient_id,
    b
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0_-_hcdo\nhg_jaarverslag_v2_0_53530025_mw_filter.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW nhg_jaarverslag_v2_0_53530025_mw AS
	
	WITH mw_pre AS
	(
	SELECT * FROM crosstab(
$$
    SELECT DISTINCT ON (unique_field, nhgnr)
        ARRAY[patient_id::varchar,
            eind_periode::varchar] AS unique_field,
        nhgnr,
        ARRAY[  uitslag_raw,
                datum::varchar,
                uitslag_waarde] AS waarde_datum
    FROM nhg_jaarverslag_v2_0_53530025_mw_filter
    JOIN nhg_jaarverslag_v2_0_53530025_labcodes USING (nhgnr)
    ORDER BY unique_field, nhgnr, datum DESC, uitslag_num DESC nulls last,
            uitslag_raw nulls last, uitslag_waarde nulls last
$$,$$
    SELECT nhgnr
    FROM indelingen.nhg_labcodes
    JOIN nhg_jaarverslag_v2_0_53530025_labcodes USING (nhgnr)
    ORDER BY nhgnr
$$
) AS ct(
    unique_field varchar[],
    alat_b varchar[],
    chhd_b_mi varchar[],
    chol_b_mt varchar[],
    hdl_b varchar[],
    k_b varchar[],
    krea_o_mk varchar[],
		ldl_b varchar[],
    na_b varchar[],
    tsh_b varchar[],
    rrdi_ka varchar[],
    rrsy_ka varchar[],
    pols_ao varchar[],
    krem_o_fb varchar[],
    schk_b_cd varchar[],
    rrgs_ka_mh varchar[],
    rrgd_ka_mh varchar[],
    rr3s_ka varchar[],
    rr3d_ka varchar[],
    krec_o_fb varchar[],
		egfc_o_fb varchar[],
		egcc_o_fb varchar[])
)
SELECT
unique_field[1]:: bigint AS patient_id,
unique_field[2]::date AS eind_periode,
*
FROM mw_pre;
Unsupported JOIN found in pivot_statement.
Converted crosstab SQL:

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0_-_hcdo\nhg_jaarverslag_v2_0_53530025_mw.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# kopie van proigia_atc_codes #}
WITH atc_codes AS (
  SELECT
    atc
  FROM (VALUES
    ('A02'),
 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0_-_hcdo\nhg_jaarverslag_v2_0_53530025_atc_codes.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# kopie van proigia_medicatie_filter #}
SELECT
  patient_id,
  atc AS categorie,
  voorschrijfdatum
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0_-_hcdo\nhg_jaarverslag_v2_0_53530025_med_filter.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW nhg_jaarverslag_v2_0_53530025_med AS
	
	WITH med_pre AS
	(
SELECT * FROM crosstab($$
    SELECT
        ARRAY[patient_id::varchar,
            eind_periode::varchar] AS unique_field,
        categorie,
        ARRAY[
            COUNT(*)::varchar,
            max(voorschrijfdatum)::varchar,
            min(voorschrijfdatum)::varchar,
            array_agg(distinct atc_code)::varchar
            ] AS resultaat
    FROM nhg_jaarverslag_v2_0_53530025_med_filter
    GROUP BY unique_field, categorie
    ORDER BY unique_field, categorie
$$,$$
    SELECT atc FROM nhg_jaarverslag_v2_0_53530025_atc_codes ORDER BY atc
$$) as
(
    unique_field varchar[],
		a02 varchar[],
		a02bc varchar[],
		j01 varchar[],
		j01aa02 varchar[],
		j01ce02 varchar[],
		j01ce05 varchar[],
		j01cf02 varchar[],
		j01cf05 varchar[],
		j01ea01 varchar[],
		j01ma02 varchar[],
		j01xe01 varchar[],
    n05a varchar[],
		n05an01 varchar[],
		n05b varchar[],
    n05c varchar[],
    n06a varchar[],
		n06b varchar[])
)
SELECT
unique_field[1]:: bigint AS patient_id,
unique_field[2]::date AS eind_periode,
*
FROM med_pre;
Converted crosstab SQL:
WITH cte1 AS (

    SELECT
        ARRAY[patient_id::varchar,
            eind_periode::varchar] AS unique_field,
        categorie,
        ARRAY[
            COUNT(*)::varchar,
            max(voorschrijfdatum)::varchar,
            min(voorschrijfdatum)::varchar,
            array_agg(distinct atc_code)::varchar
            ] AS resultaat
    FROM {{ ref('nhg_jaarverslag_v2_0_53530025_med_filter') }}
    GROUP BY unique_field, categorie
    ORDER BY unique_field, categorie

)
SELECT unique_field
, {{ dbt_utils.pivot('atc',        dbt_utils.get_column_values(ref('nhg_jaarverslag_v2_0_53530025_atc_codes'),'categorie',default=[]),        agg='',        then_value='categorie',        else_value="ARRAY_CONSTRUCT()",        quote_identifiers=False)}} 
FROM cte1
GROUP BY unique_field
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0_-_hcdo\nhg_jaarverslag_v2_0_53530025_med.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# een vaste praktijkpopulatie wordt bepaald, dit ivm berekening van % of per 1.000 pt #}
SELECT
  (
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0_-_hcdo\nhg_jaarverslag_v2_0_53530025_verrichting_pt.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0_-_hcdo\nhg_jaarverslag_v2_0_53530025_verrichting.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# kopie van proigia_journaal_filter #}
WITH jr_clean AS (
  SELECT
    patient_id,
    journaal_id,
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0_-_hcdo\nhg_jaarverslag_v2_0_53530025_journaal_filter.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# kopie van proigia_contact #}
WITH icpc_context AS (
  SELECT
    patient_id,
    CAST(datumtijd A
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_jaarverslag_v2.0_-_hcdo\nhg_jaarverslag_v2_0_53530025_contact.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_stoppen_met_roken_v1.1_indicatoren\nhg_smr_v1_1_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_stoppen_met_roken_v1.1_indicatoren\nhg_smr_v1_1_indicatoren_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_stoppen_met_roken_v1.1_indicatoren\nhg_smr_v1_1_indicatoren.sql

[ERROR] Failed to process nhg_stoppen_met_roken_v1_1_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_stoppen_met_roken_v1.1_patientenlijst\nhg_smr_v1_1_patientenlijst_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_stoppen_met_roken_v1.1_patientenlijst\nhg_smr_v1_1_patientenlijst_patientenlijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_stoppen_met_roken_v1.1_patientenlijst\nhg_smr_v1_1_patientenlijst_tussen.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_stoppen_met_roken_v1.1_patientenlijst\nhg_smr_v1_1_patientenlijst_nhg_smr.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\nhg_stoppen_met_roken_v1.1_patientenlijst\nhg_smr_v1_1_patientenlijst_ruiter_poh.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\npa_thema-audit_laboratorium-diagnostiek-cirkel\npa_thema_audit_lab_patientenlijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\npa_thema-audit_laboratorium-diagnostiek-cirkel\npa_thema_audit_lab_labcodes.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: (
  SELECT
    CAST(1 AS INT) AS id,
    'Klinische chemie (bloed)' AS omschrijving
  UNION
  SELECT
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\npa_thema-audit_laboratorium-diagnostiek-cirkel\npa_thema_audit_lab_legenda.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# kopie van proigia_meetwaarden_filter #}
WITH nhgnr_verrijking AS (
  SELECT
    patient_id,
    b
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\npa_thema-audit_laboratorium-diagnostiek-cirkel\npa_thema_audit_lab_meetwaarden_filter.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\npa_thema-audit_laboratorium-diagnostiek-cirkel\npa_thema_audit_lab_tsh_laag.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\npa_thema-audit_laboratorium-diagnostiek-cirkel\npa_thema_audit_lab_tsh_hoog.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\npa_thema-audit_laboratorium-diagnostiek-cirkel\npa_thema_audit_lab_meetwaarden_afwijkend.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\npa_thema-audit_laboratorium-diagnostiek-cirkel\npa_thema_audit_lab_meetwaarden.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\npa_thema-audit_verantwoord_voorschrijven\npa_thema_audit_vv_last_cont_pp.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\npa_thema-audit_verantwoord_voorschrijven\npa_thema_audit_vv_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\npa_thema-audit_verantwoord_voorschrijven\npa_thema_audit_vv_med_pp_chronisch.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\npa_thema-audit_verantwoord_voorschrijven\npa_thema_audit_vv_medicatie_opiaat_laxans.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\npa_thema-audit_verantwoord_voorschrijven\npa_thema_audit_vv_indicatoren_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\npa_thema-audit_verantwoord_voorschrijven\npa_thema_audit_vv_indicatoren.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\npa_thema-audit_verantwoord_voorschrijven\npa_thema_audit_vv_pl_2_1.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\npa_thema-audit_verantwoord_voorschrijven\npa_thema_audit_vv_pl_2_1_7.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\npa_thema-audit_verantwoord_voorschrijven\npa_thema_audit_vv_pl_2_2.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\npa_thema-audit_verantwoord_voorschrijven\npa_thema_audit_vv_pl_2_3.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\npa_thema-audit_verantwoord_voorschrijven\npa_thema_audit_vv_pl_2_4.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\npa_thema-audit_verantwoord_voorschrijven\npa_thema_audit_vv_pl_3_1.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\npa_thema-audit_verantwoord_voorschrijven\npa_thema_audit_vv_pl_3_2_1.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\npa_thema-audit_verantwoord_voorschrijven\npa_thema_audit_vv_pl_3_2_2.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\npa_thema-audit_verantwoord_voorschrijven\npa_thema_audit_vv_pl_3_2_5.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\npa_thema-audit_verantwoord_voorschrijven\npa_thema_audit_vv_pl_3_3.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\npa_thema-audit_verantwoord_voorschrijven\npa_thema_audit_vv_pl_3_4.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\npa_thema-audit_verantwoord_voorschrijven\npa_thema_audit_vv_pl_3_5.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\npa_thema-audit_verantwoord_voorschrijven\npa_thema_audit_vv_pl_4_1.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\npa_thema-audit_verantwoord_voorschrijven\npa_thema_audit_vv_pl_4_1_1.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\npa_thema-audit_verantwoord_voorschrijven\npa_thema_audit_vv_pl_5_1.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\npa_thema-audit_verantwoord_voorschrijven\npa_thema_audit_vv_pl_5_2.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\npa_thema-audit_verantwoord_voorschrijven\npa_thema_audit_vv_pl_6_1.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\npa_thema-audit_verantwoord_voorschrijven\npa_thema_audit_vv_pl_6_2.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\npa_thema-audit_verantwoord_voorschrijven\npa_thema_audit_vv_pl_7_2_3.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\npa_thema-audit_verantwoord_voorschrijven\npa_thema_audit_vv_allergie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\npa_thema-audit_verantwoord_voorschrijven\npa_thema_audit_vv_medicatie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\npa_thema-audit_verantwoord_voorschrijven\npa_thema_audit_vv_med_opiaat.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\npa_thema-audit_verantwoord_voorschrijven\npa_thema_audit_vv_med_laxans.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\npa_thema-audit_verantwoord_voorschrijven\npa_thema_audit_vv_journaal.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\npa_thema-audit_verantwoord_voorschrijven\npa_thema_audit_vv_contact.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\npa_thema-audit_verantwoord_voorschrijven\npa_thema_audit_vv_medicatie_antibiotica.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\npa_thema-audit_verantwoord_voorschrijven\npa_thema_audit_vv_medicatie_antidepressiva.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ondersteuning_labaanvragen\o_lab_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ondersteuning_labaanvragen\o_lab_doelgroep.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ondersteuning_labaanvragen\o_lab_mw_nodig_getest.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ondersteuning_labaanvragen\o_lab_zorgpad.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ondersteuning_labaanvragen\o_lab_kenmerken.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ondersteuning_labaanvragen\o_lab_inkaartlijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ondersteuning_labaanvragen\o_lab_beslisondersteuning.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ondersteuning_labaanvragen\o_lab_laatste_registratie_dd.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ondersteuning_labaanvragen\o_lab_verzameltabel_3mt.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# alat #}
SELECT
  'ALAT' AS "Meting",
  NULL AS "PP zonder medicatie en LDL stabiel",
  NULL AS "P
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ondersteuning_labaanvragen\o_lab_minimale_labaanvraag.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# kopie van proigia_patienten_gegevens #}
SELECT
  patient_id,
  patientnummer,
  bsn,
  categorie,
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ondersteuning_labaanvragen\o_lab_patienten_gegevens.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# kopie van proigia_episode_filter #}
WITH pre_episode AS (
  SELECT
    episode_id,
    patient_id
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ondersteuning_labaanvragen\o_lab_episode_filter.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# kopie van proigia_icpc_codes #}
WITH icpc_codes AS (
  SELECT
    icpc
  FROM (VALUES
    ('A05%'
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ondersteuning_labaanvragen\o_lab_icpc_codes.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW o_lab_episode AS

SELECT * FROM crosstab($$
    SELECT
        patient_id,
        name,
        ARRAY[min(begindatum)::varchar,
                max(einddatum)::varchar,
                max(status_datum)::varchar,
                max(status_vlag)::varchar,
                array_agg(distinct icpc)::varchar,
                max(begindatum)::varchar,
                min(einddatum)::varchar,
                min(begindatum_nonactief)::varchar,
                max(einddatum_nonactief)::varchar,
                max(begindatum_nonactief)::varchar,
                min(einddatum_nonactief)::varchar] as waardes
    FROM o_lab_episode_filter
    JOIN o_lab_icpc_codes ON icpc ilike searchstring
    GROUP BY patient_id, name
    ORDER BY patient_id, name
$$,$$
    SELECT name FROM o_lab_icpc_codes ORDER BY name;
$$) as ct(
    patient_id bigint,
    a05_ varchar[],
    a91_05 varchar[],
    k74_ varchar[],
    k75_ varchar[],
    k76_ varchar[],
    k77_ varchar[],
    k86_ varchar[],
    k87_ varchar[],
    k89_ varchar[],
    k90_03 varchar[],
    k92_01 varchar[],
    k99_01 varchar[],
    l88_ varchar[],
    t85_ varchar[],
    t86_ varchar[],
    t90_ varchar[],
    t90_02 varchar[],
    t93_ varchar[],
    u99_01 varchar[],
		w78_ varchar[]
);
Converted crosstab SQL:
WITH cte1 AS (

    SELECT
        patient_id,
        name,
        ARRAY[min(begindatum)::varchar,
                max(einddatum)::varchar,
                max(status_datum)::varchar,
                max(status_vlag)::varchar,
                array_agg(distinct icpc)::varchar,
                max(begindatum)::varchar,
                min(einddatum)::varchar,
                min(begindatum_nonactief)::varchar,
                max(einddatum_nonactief)::varchar,
                max(begindatum_nonactief)::varchar,
                min(einddatum_nonactief)::varchar] as waardes
    FROM {{ ref('o_lab_episode_filter') }}
    JOIN {{ ref('o_lab_icpc_codes') }} ON icpc ilike searchstring
    GROUP BY patient_id, name
    ORDER BY patient_id, name

)
SELECT patient_id
, {{ dbt_utils.pivot('name',        dbt_utils.get_column_values(ref('o_lab_icpc_codes'),'categorie',default=[]),        agg='',        then_value='name',        else_value="ARRAY_CONSTRUCT()",        quote_identifiers=False)}} 
FROM cte1
GROUP BY patient_id
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ondersteuning_labaanvragen\o_lab_episode.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {#  kopie van proigia_labcodes #}
SELECT
    as
  FROM (VALUES
    (15,35,40,77,100,111,152,181,192,
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ondersteuning_labaanvragen\o_lab_labcodes.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {#  kopie van proigia_meetwaarden_filter #}
 	WITH nhgnr_verrijking AS
(
    SELECT
        patient_
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ondersteuning_labaanvragen\o_lab_meetwaarden_filter.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW o_lab_meetwaarden AS

SELECT * FROM crosstab(
$$
    SELECT DISTINCT ON (patient_id, nhgnr)
        patient_id,
        nhgnr,
        ARRAY[  uitslag_raw,
                datum::varchar,
                uitslag_waarde] as waarde_datum
    FROM o_lab_meetwaarden_filter
    JOIN o_lab_labcodes USING (nhgnr)
    ORDER BY patient_id, nhgnr, datum DESC, uitslag_num DESC nulls last,
            uitslag_raw nulls last, uitslag_waarde nulls last
$$,$$
    SELECT nhgnr
    FROM indelingen.nhg_labcodes
    JOIN o_lab_labcodes USING (nhgnr)
    ORDER BY nhgnr
$$
) as ct(
patient_id bigint,
	af_b varchar[],
	alat_b varchar[],
	albk_u_mi varchar[],
	asat_b varchar[],
	baso_b_md varchar[],
	bili_b varchar[],
	ca_b varchar[],
	chhd_b_mi varchar[],
	chol_b_mt varchar[],
	diff_b_mt varchar[],
	eo_b_md varchar[],
	ery_b_mt varchar[],
	foli_b varchar[],
	fosf_b varchar[],
	ft4_b varchar[],
	ggt_b varchar[],
	gluc_b_nu varchar[],
	gluc_bc_nu varchar[],
	hb_b varchar[],
	hdl_b varchar[],
	ht_b varchar[],
	k_b varchar[],
	krea_o_mk varchar[],
	ldl_b varchar[],
	leuk_b_mt varchar[],
	li_b_st varchar[],
	lymf_b_md varchar[],
	mchc_b varchar[],
	mcv_b varchar[],
	mono_b_md varchar[],
	na_b varchar[],
	neut_b_md varchar[],
	neut_b_mt varchar[],
	pth_b varchar[],
	rdw_b_md varchar[],
	trig_b varchar[],
	trom_b_mt varchar[],
	tsh_b varchar[],
	vb12_b varchar[],
	rrsy_ka varchar[],
	krem_o_fb varchar[],
	rrsy_ka_mh varchar[],
	dmhb_tz varchar[],
	ldld_b varchar[],
	cvhb_kz varchar[],
	hbac_b varchar[],
gluc_ba_nu varchar[],
	hbap_b varchar[],
	nfhb_uz varchar[],
	krec_o_fb varchar[],
glup_bc_nu varchar[],
	hbap_b_po varchar[],
	ldl_b_po varchar[],
	egfc_o_fb varchar[],
	egcc_o_fb varchar[]);
Unsupported JOIN found in pivot_statement.
Converted crosstab SQL:

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ondersteuning_labaanvragen\o_lab_meetwaarden.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# kopie van proigia_atc_codes #}
WITH atc_codes AS (
  SELECT
    atc
  FROM (VALUES
    ('A10'),
 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ondersteuning_labaanvragen\o_lab_atc_codes.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# kopie van proigia_medicatie_filter #}
SELECT
  patient_id,
  atc AS categorie,
  voorschrijfdatum
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ondersteuning_labaanvragen\o_lab_medicatie_filter.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW o_lab_medicatie_4mnd AS
	
SELECT * FROM crosstab($$
    SELECT
        patient_id,
        categorie,
        ARRAY[
            count(*)::varchar,
            max(voorschrijfdatum)::varchar,
            min(voorschrijfdatum)::varchar,
            array_agg(distinct atc_code)::varchar
            ] as resultaat
    FROM o_lab_medicatie_filter
		WHERE voorschrijfdatum>='${peildatum}'::date-'4 months'::interval
    GROUP BY patient_id, categorie
    ORDER BY patient_id, categorie
$$,$$
    SELECT atc FROM o_lab_atc_codes ORDER BY atc
$$) as
(
    patient_id bigint,
		a10 varchar[],
		b01ae varchar[],
		b01af varchar[],
		c01aa varchar[],
		c01bd01 varchar[],
		c02 varchar[],
		c03 varchar[],
		c03da01 varchar[],
		c03da04 varchar[],
		c07 varchar[],
		c08 varchar[],
		c09 varchar[],
		c10 varchar[],
		h03aa varchar[],
		h03bb varchar[],
		l04ax03 varchar[],
		m04aa01 varchar[],
		m04ab03 varchar[],
		n05ah02 varchar[],
		n05ah03 varchar[],
		n05ah04 varchar[],
		n05an01 varchar[]);
Converted crosstab SQL:
WITH cte1 AS (

    SELECT
        patient_id,
        categorie,
        ARRAY[
            count(*)::varchar,
            max(voorschrijfdatum)::varchar,
            min(voorschrijfdatum)::varchar,
            array_agg(distinct atc_code)::varchar
            ] as resultaat
    FROM {{ ref('o_lab_medicatie_filter') }}
		WHERE voorschrijfdatum>='${peildatum}'::date-'4 months'::interval
    GROUP BY patient_id, categorie
    ORDER BY patient_id, categorie

)
SELECT patient_id
, {{ dbt_utils.pivot('atc',        dbt_utils.get_column_values(ref('o_lab_atc_codes'),'categorie',default=[]),        agg='',        then_value='categorie',        else_value="ARRAY_CONSTRUCT()",        quote_identifiers=False)}} 
FROM cte1
GROUP BY patient_id
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ondersteuning_labaanvragen\o_lab_medicatie_4mnd.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ondersteuning_labaanvragen\o_lab_medicatie_chron_atc2.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ondersteuning_labaanvragen\o_lab_medicatie_chron_atc4.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ondersteuning_labaanvragen\o_lab_medicatie_chron_atc6.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ondersteuning_labaanvragen\o_lab_meetwaarden_ooit.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ondersteuning_labaanvragen\o_lab_meetwaarden_rh12.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ondersteuning_labaanvragen\o_lab_registraties_mw_nhgnummers.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ondersteuning_labaanvragen\o_lab_registraties_mw_kwartalen.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ondersteuning_labaanvragen\o_lab_registraties_mw_eind.sql

Crosstab function detected, converting to dbt-compatible SQL.
	CREATE VIEW o_lab_registraties_meetwaarden AS
	SELECT * FROM crosstab(
		$$
		SELECT
			patient_id,
			deler,
			aantal
		FROM o_lab_registraties_mw_eind
		$$,
		$$
			SELECT DISTINCT
			code || '_' || periode as kolommen
			FROM o_lab_registraties_mw_nhgnummers
			CROSS JOIN o_lab_registraties_mw_kwartalen
			ORDER BY kolommen
		$$
		)
	as ct(
	patient_id bigint,
	"af_b_q1" text,
	"af_b_q2" text,
	"af_b_q3" text,
	"af_b_q4" text,
	"af_b_totaal_jaar" text,
	"alat_b_q1" text,
	"alat_b_q2" text,
	"alat_b_q3" text,
	"alat_b_q4" text,
	"alat_b_totaal_jaar" text,
	"albk_u_mi_q1" text,
	"albk_u_mi_q2" text,
	"albk_u_mi_q3" text,
	"albk_u_mi_q4" text,
	"albk_u_mi_totaal_jaar" text,
	"asat_b_q1" text,
	"asat_b_q2" text,
	"asat_b_q3" text,
	"asat_b_q4" text,
	"asat_b_totaal_jaar" text,
	"bili_b_q1" text,
	"bili_b_q2" text,
	"bili_b_q3" text,
	"bili_b_q4" text,
	"bili_b_totaal_jaar" text,
	"ca_b_q1" text,
	"ca_b_q2" text,
	"ca_b_q3" text,
	"ca_b_q4" text,
	"ca_b_totaal_jaar" text,
	"chhd_b_mi_q1" text,
	"chhd_b_mi_q2" text,
	"chhd_b_mi_q3" text,
	"chhd_b_mi_q4" text,
	"chhd_b_mi_totaal_jaar" text,
	"chol_b_mt_q1" text,
	"chol_b_mt_q2" text,
	"chol_b_mt_q3" text,
	"chol_b_mt_q4" text,
	"chol_b_mt_totaal_jaar" text,
	"egfr_q1" text,
	"egfr_q2" text,
	"egfr_q3" text,
	"egfr_q4" text,
	"egfr_totaal_jaar" text,
	"fosf_b_q1" text,
	"fosf_b_q2" text,
	"fosf_b_q3" text,
	"fosf_b_q4" text,
	"fosf_b_totaal_jaar" text,
	"ft4_b_q1" text,
	"ft4_b_q2" text,
	"ft4_b_q3" text,
	"ft4_b_q4" text,
	"ft4_b_totaal_jaar" text,
	"ggt_b_q1" text,
	"ggt_b_q2" text,
	"ggt_b_q3" text,
	"ggt_b_q4" text,
	"ggt_b_totaal_jaar" text,
	"glucose_nuchter_q1" text,
	"glucose_nuchter_q2" text,
	"glucose_nuchter_q3" text,
	"glucose_nuchter_q4" text,
	"glucose_nuchter_totaal_jaar" text,
	"hba1c_q1" text,
	"hba1c_q2" text,
	"hba1c_q3" text,
	"hba1c_q4" text,
	"hba1c_totaal_jaar" text,
	"hb_b_q1" text,
	"hb_b_q2" text,
	"hb_b_q3" text,
	"hb_b_q4" text,
	"hb_b_totaal_jaar" text,
	"hdl_b_q1" text,
	"hdl_b_q2" text,
	"hdl_b_q3" text,
	"hdl_b_q4" text,
	"hdl_b_totaal_jaar" text,
	"k_b_q1" text,
	"k_b_q2" text,
	"k_b_q3" text,
	"k_b_q4" text,
	"k_b_totaal_jaar" text,
	"ldl_q1" text,
	"ldl_q2" text,
	"ldl_q3" text,
	"ldl_q4" text,
	"ldl_totaal_jaar" text,
	"leuk_b_mt_q1" text,
	"leuk_b_mt_q2" text,
	"leuk_b_mt_q3" text,
	"leuk_b_mt_q4" text,
	"leuk_b_mt_totaal_jaar" text,
	"li_b_st_q1" text,
	"li_b_st_q2" text,
	"li_b_st_q3" text,
	"li_b_st_q4" text,
	"li_b_st_totaal_jaar" text,
	"na_b_q1" text,
	"na_b_q2" text,
	"na_b_q3" text,
	"na_b_q4" text,
	"na_b_totaal_jaar" text,
	"neut_b_md_q1" text,
	"neut_b_md_q2" text,
	"neut_b_md_q3" text,
	"neut_b_md_q4" text,
	"neut_b_md_totaal_jaar" text,
	"trig_b_q1" text,
	"trig_b_q2" text,
	"trig_b_q3" text,
	"trig_b_q4" text,
	"trig_b_totaal_jaar" text,
	"tsh_b_q1" text,
	"tsh_b_q2" text,
	"tsh_b_q3" text,
	"tsh_b_q4" text,
	"tsh_b_totaal_jaar" text
	);
Unsupported JOIN found in pivot_statement.
Converted crosstab SQL:

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ondersteuning_labaanvragen\o_lab_registraties_meetwaarden.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ondersteuning_labaanvragen\o_lab_patienten_gegevens_3mt.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# kopie van proigia_episode_filter #}
WITH pre_episode AS (
  SELECT
    episode_id,
    patient_id
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ondersteuning_labaanvragen\o_lab_episode_filter_3mt.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW o_lab_episode_3mt AS

SELECT * FROM crosstab($$
    SELECT
        patient_id,
        name,
        ARRAY[min(begindatum)::varchar,
                max(einddatum)::varchar,
                max(status_datum)::varchar,
                max(status_vlag)::varchar,
                array_agg(distinct icpc)::varchar,
                max(begindatum)::varchar,
                min(einddatum)::varchar,
                min(begindatum_inactief)::varchar,
                max(einddatum_inactief)::varchar,
                max(begindatum_inactief)::varchar,
                min(einddatum_inactief)::varchar] as waardes
    FROM o_lab_episode_filter_3mt
    JOIN o_lab_icpc_codes ON icpc ilike searchstring
    GROUP BY patient_id, name
    ORDER BY patient_id, name
$$,$$
    SELECT name FROM o_lab_icpc_codes ORDER BY name;
$$) as ct(
    patient_id bigint,
    a05_ varchar[],
    a91_05 varchar[],
    k74_ varchar[],
    k75_ varchar[],
    k76_ varchar[],
    k77_ varchar[],
    k86_ varchar[],
    k87_ varchar[],
    k89_ varchar[],
    k90_03 varchar[],
    k92_01 varchar[],
    k99_01 varchar[],
    l88_ varchar[],
    t85_ varchar[],
    t86_ varchar[],
    t90_ varchar[],
    t90_02 varchar[],
    t93_ varchar[],
    u99_01 varchar[],
		w78_ varchar[]
);	
Converted crosstab SQL:
WITH cte1 AS (

    SELECT
        patient_id,
        name,
        ARRAY[min(begindatum)::varchar,
                max(einddatum)::varchar,
                max(status_datum)::varchar,
                max(status_vlag)::varchar,
                array_agg(distinct icpc)::varchar,
                max(begindatum)::varchar,
                min(einddatum)::varchar,
                min(begindatum_inactief)::varchar,
                max(einddatum_inactief)::varchar,
                max(begindatum_inactief)::varchar,
                min(einddatum_inactief)::varchar] as waardes
    FROM {{ ref('o_lab_episode_filter_3mt') }}
    JOIN {{ ref('o_lab_icpc_codes') }} ON icpc ilike searchstring
    GROUP BY patient_id, name
    ORDER BY patient_id, name

)
SELECT patient_id
, {{ dbt_utils.pivot('name',        dbt_utils.get_column_values(ref('o_lab_icpc_codes'),'categorie',default=[]),        agg='',        then_value='name',        else_value="ARRAY_CONSTRUCT()",        quote_identifiers=False)}} 
FROM cte1
GROUP BY patient_id
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ondersteuning_labaanvragen\o_lab_episode_3mt.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {#  kopie van proigia_meetwaarden_filter #}
 	WITH nhgnr_verrijking AS
(
    SELECT
        patient_
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ondersteuning_labaanvragen\o_lab_meetwaarden_filter_3mt.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW o_lab_meetwaarden_3mt AS

SELECT * FROM crosstab(
$$
    SELECT DISTINCT ON (patient_id, nhgnr)
        patient_id, 
        nhgnr, 
        ARRAY[  uitslag_raw,
                datum::varchar,
                uitslag_waarde] as waarde_datum
    FROM o_lab_meetwaarden_filter_3mt
    JOIN o_lab_labcodes USING (nhgnr)
    ORDER BY patient_id, nhgnr, datum DESC, uitslag_num DESC nulls last,
            uitslag_raw nulls last, uitslag_waarde nulls last
$$,$$
    SELECT nhgnr
    FROM indelingen.nhg_labcodes 
    JOIN o_lab_labcodes USING (nhgnr)
    ORDER BY nhgnr
$$
) as ct(
patient_id bigint,
	af_b varchar[],
	alat_b varchar[],
	albk_u_mi varchar[],
	asat_b varchar[],
	baso_b_md varchar[],
	bili_b varchar[],
	ca_b varchar[],
	chhd_b_mi varchar[],
	chol_b_mt varchar[],
	diff_b_mt varchar[],
	eo_b_md varchar[],
	ery_b_mt varchar[],
	foli_b varchar[],
	fosf_b varchar[],
	ft4_b varchar[],
	ggt_b varchar[],
	gluc_b_nu varchar[],
	gluc_bc_nu varchar[],
	hb_b varchar[],
	hdl_b varchar[],
	ht_b varchar[],
	k_b varchar[],
	krea_o_mk varchar[],
	ldl_b varchar[],
	leuk_b_mt varchar[],
	li_b_st varchar[],
	lymf_b_md varchar[],
	mchc_b varchar[],
	mcv_b varchar[],
	mono_b_md varchar[],
	na_b varchar[],
	neut_b_md varchar[],
	neut_b_mt varchar[],
	pth_b varchar[],
	rdw_b_md varchar[],
	trig_b varchar[],
	trom_b_mt varchar[],
	tsh_b varchar[],
	vb12_b varchar[],
	rrsy_ka varchar[],
	krem_o_fb varchar[],
	rrsy_ka_mh varchar[],
	dmhb_tz varchar[],
	ldld_b varchar[],
	cvhb_kz varchar[],
	hbac_b varchar[],
gluc_ba_nu varchar[],
	hbap_b varchar[],
	nfhb_uz varchar[],
	krec_o_fb varchar[],
glup_bc_nu varchar[],
	hbap_b_po varchar[],
	ldl_b_po varchar[],
	egfc_o_fb varchar[],
	egcc_o_fb varchar[]);
Unsupported JOIN found in pivot_statement.
Converted crosstab SQL:

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ondersteuning_labaanvragen\o_lab_meetwaarden_3mt.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# kopie van proigia_medicatie_filter #}
SELECT
  patient_id,
  atc AS categorie,
  voorschrijfdatum
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ondersteuning_labaanvragen\o_lab_medicatie_filter_3mt.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW o_lab_medicatie_4mnd_3mt AS

SELECT * FROM crosstab($$
    SELECT
        patient_id,
        categorie,
        ARRAY[
            count(*)::varchar,
            max(voorschrijfdatum)::varchar,
            min(voorschrijfdatum)::varchar,
            array_agg(distinct atc_code)::varchar
            ] as resultaat
    FROM o_lab_medicatie_filter_3mt
		WHERE voorschrijfdatum>='${peildatum}'::date-'7 months'::interval
    GROUP BY patient_id, categorie
    ORDER BY patient_id, categorie
$$,$$
    SELECT atc FROM o_lab_atc_codes ORDER BY atc
$$) as
(
    patient_id bigint,
		a10 varchar[],
		b01ae varchar[],
		b01af varchar[],
		c01aa varchar[],
		c01bd01 varchar[],
		c02 varchar[],
		c03 varchar[],
		c03da01 varchar[],
		c03da04 varchar[],
		c07 varchar[],
		c08 varchar[],
		c09 varchar[],
		c10 varchar[],
		h03aa varchar[],
		h03bb varchar[],
		l04ax03 varchar[],
		m04aa01 varchar[],
		m04ab03 varchar[],
		n05ah02 varchar[],
		n05ah03 varchar[],
		n05ah04 varchar[],
		n05an01 varchar[]);
Converted crosstab SQL:
WITH cte1 AS (

    SELECT
        patient_id,
        categorie,
        ARRAY[
            count(*)::varchar,
            max(voorschrijfdatum)::varchar,
            min(voorschrijfdatum)::varchar,
            array_agg(distinct atc_code)::varchar
            ] as resultaat
    FROM {{ ref('o_lab_medicatie_filter_3mt') }}
		WHERE voorschrijfdatum>='${peildatum}'::date-'7 months'::interval
    GROUP BY patient_id, categorie
    ORDER BY patient_id, categorie

)
SELECT patient_id
, {{ dbt_utils.pivot('atc',        dbt_utils.get_column_values(ref('o_lab_atc_codes'),'categorie',default=[]),        agg='',        then_value='categorie',        else_value="ARRAY_CONSTRUCT()",        quote_identifiers=False)}} 
FROM cte1
GROUP BY patient_id
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ondersteuning_labaanvragen\o_lab_medicatie_4mnd_3mt.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ondersteuning_labaanvragen\o_lab_medicatie_chron_atc2_3mt.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ondersteuning_labaanvragen\o_lab_medicatie_chron_atc4_3mt.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ondersteuning_labaanvragen\o_lab_medicatie_chron_atc6_3mt.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ondersteuning_labaanvragen\o_lab_meetwaarden_ooit_3mt.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ondersteuning_labaanvragen\o_lab_meetwaarden_rh12_3mt.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\oproepagenda_-_ketenzorg_arnhem\oproepagenda_53530047_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\oproepagenda_-_ketenzorg_arnhem\oproepagenda_53530047_patientenlijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\oproepagenda_-_ketenzorg_arnhem\oproepagenda_53530047_patientenlijst_dm.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\oproepagenda_-_ketenzorg_arnhem\oproepagenda_53530047_patientenlijst_copd.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\oproepagenda_-_ketenzorg_arnhem\oproepagenda_53530047_patientenlijst_astma.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\oproepagenda_-_ketenzorg_arnhem\oproepagenda_53530047_patientenlijst_cvrm.sql

[ERROR] Failed to process oproepagenda_53530047_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\oproepagenda_-_syntein\oproepagenda_53530083_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\oproepagenda_-_syntein\oproepagenda_53530083_patientenlijst_dm.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\oproepagenda_-_syntein\oproepagenda_53530083_patientenlijst_copd.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\oproepagenda_-_syntein\oproepagenda_53530083_patientenlijst_hvz.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\oproepagenda_-_syntein\oproepagenda_53530083_patientenlijst_vvr.sql

[ERROR] Failed to process oproepagenda_53530083_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\oproepagenda_-_ghc\oproepagenda_53530098_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\oproepagenda_-_ghc\oproepagenda_53530098_patientenlijst_ketenzorg.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\oproepagenda_-_ghc\oproepagenda_53530098_pl_geen_ketenzorg.sql

[ERROR] Failed to process oproepagenda_53530098_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\oproepagenda_-_meditta\oproepagenda_53530099_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\oproepagenda_-_meditta\oproepagenda_53530099_patientenlijst_dm.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\oproepagenda_-_meditta\oproepagenda_53530099_patientenlijst_copd.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\oproepagenda_-_meditta\oproepagenda_53530099_patientenlijst_astma.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\oproepagenda_-_meditta\oproepagenda_53530099_patientenlijst_cvrm.sql

[ERROR] Failed to process oproepagenda_53530099_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\oproepagenda_-_neo\oproepagenda_53530277_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\oproepagenda_-_neo\oproepagenda_53530277_patientenlijst_dm.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\oproepagenda_-_neo\oproepagenda_53530277_patientenlijst_cvrm.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\oproepagenda_-_neo\oproepagenda_53530277_patientenlijst_copd.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\oproepagenda_-_neo\oproepagenda_53530277_patientenlijst_astma.sql

[ERROR] Failed to process oproepagenda_53530277_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\oproepagenda_-_haringvliet\oproepagenda_53530329_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\oproepagenda_-_haringvliet\oproepagenda_53530329_patientenlijst_dm.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\oproepagenda_-_haringvliet\oproepagenda_53530329_patientenlijst_astma.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\oproepagenda_-_haringvliet\oproepagenda_53530329_patientenlijst_copd.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\oproepagenda_-_haringvliet\oproepagenda_53530329_patientenlijst_hvz.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\oproepagenda_-_haringvliet\oproepagenda_53530329_patientenlijst_vvr.sql

[ERROR] Failed to process oproepagenda_53530329_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\oproepagenda_-_rijnmond_dokters\oproepagenda_53533096_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\oproepagenda_-_rijnmond_dokters\oproepagenda_53533096_patientenlijst_dm.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\oproepagenda_-_rijnmond_dokters\oproepagenda_53533096_patientenlijst_cvrm.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\oproepagenda_-_rijnmond_dokters\oproepagenda_53533096_patientenlijst_copd.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\oproepagenda_-_rijnmond_dokters\oproepagenda_53533096_patientenlijst_astma.sql

[ERROR] Failed to process oproepagenda_53533096_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\oproepagenda_-_zgwb\oproepagenda_53533156_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\oproepagenda_-_zgwb\oproepagenda_53533156_patientenlijst_dm.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\oproepagenda_-_zgwb\oproepagenda_53533156_patientenlijst_copd.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\oproepagenda_-_zgwb\oproepagenda_53533156_patientenlijst_astma.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\oproepagenda_-_zgwb\oproepagenda_53533156_patientenlijst_cvrm.sql

[ERROR] Failed to process oproepagenda_53533156_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\oproepagenda_ggz_-_dohsgepozob\oproepagenda_ggz_53530007_0210_verzamel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\oproepagenda_ggz_-_dohsgepozob\oproepagenda_ggz_53530007_0210_pl_ggz_vlw.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\oproepagenda_ggz_-_dohsgepozob\oproepagenda_ggz_53530007_0210_pl_ggz_jgd.sql

[ERROR] Failed to process oproepagenda_ggz_53530007_0151_0210_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\oproepagenda_integrale_ketenzorg\oproepagenda_ikz_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\oproepagenda_integrale_ketenzorg\oproepagenda_ikz_tussen.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\oproepagenda_integrale_ketenzorg\oproepagenda_ikz_pl_ketenzorg.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\oproepagenda_integrale_ketenzorg\oproepagenda_ikz_pl_geen_ketenzorg.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\oproepagenda_integrale_ketenzorg\oproepagenda_ikz_indicatoren_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\oproepagenda_integrale_ketenzorg\oproepagenda_ikz_indicatoren.sql

[ERROR] Failed to process oproepagenda_integrale_ketenzorg_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\oproepagenda_poh-ggz_covid-19\oa_poh_ggz_covid_19_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\oproepagenda_poh-ggz_covid-19\oa_poh_ggz_covid_19_patientenlijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\oproepagenda_poh-ggz_covid-19\oa_poh_ggz_covid_19_contacten.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\oproepagenda\oproepagenda_v1_0_patientenlijst_dm.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\oproepagenda\oproepagenda_v1_0_patientenlijst_copd.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\oproepagenda\oproepagenda_v1_0_patientenlijst_astma.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\oproepagenda\oproepagenda_v1_0_patientenlijst_zhr.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\oproepagenda\oproepagenda_v1_0_patientenlijst_hr.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\oproepagenda\oproepagenda_v1_0_patientenlijst_cvrm.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\oproepagenda\oproepagenda_v1_0_patientenlijst_af.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\oproepagenda\oproepagenda_v1_0_patientenlijst_hf.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\oproepagenda\oproepagenda_v1_0_patientenlijst_cns.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Let op! Voor osteoporose is nog geen standaard uitgewerkt. View is uitgewerkt voor 53530082. #}
S
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\oproepagenda\oproepagenda_v1_0_patientenlijst_osteoporose.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\oproepagenda\oproepagenda_v1_0_patientenlijst_oz.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# View overgenomen uit OA 53530556 en wijkt op sommige punten af van de standaard. #}
{# Veel kolom
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\oproepagenda\oproepagenda_v1_0_patientenlijst_sk.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\oproepagenda\oproepagenda_v1_0_indicatoren_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\oproepagenda\oproepagenda_v1_0_indicatoren.sql

[ERROR] Failed to process oproepagenda_v1_0_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\osteoporose\ost_med_verzameling_medicatie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\osteoporose\ost_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\osteoporose\ost_patlijst_osteoporose.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\osteoporose\ost_patlijst_fractuurrisico.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\osteoporose\ost_patlijst_risico_definitie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\osteoporose\ost_patlijst_medicatie_tussen.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\osteoporose\ost_patlijst_medicatie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\osteoporose\ost_med.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\osteoporose\ost_med_episode_filter.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\osteoporose\ost_med_icpc_codes.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW ost_med_episode AS
SELECT * FROM crosstab($$
    SELECT
        patient_id,
        name,
        ARRAY[min(begindatum)::varchar,
                max(einddatum)::varchar,
                max(status_datum)::varchar,
                max(status_vlag)::varchar,
                array_agg(distinct icpc)::varchar,
                max(begindatum)::varchar,
                min(einddatum)::varchar,
                min(begindatum_nonactief)::varchar,
                max(einddatum_nonactief)::varchar,
                max(begindatum_nonactief)::varchar,
                min(einddatum_nonactief)::varchar] as waardes
    FROM ost_med_episode_filter
    JOIN ost_med_icpc_codes ON icpc ilike searchstring
    GROUP BY patient_id, name
    ORDER BY patient_id, name
$$,$$
    SELECT name FROM ost_med_icpc_codes ORDER BY name;
$$) as ct(
    patient_id bigint,
    a91_07 varchar[],
    d94_01 varchar[],
    d94_02 varchar[],
    d99_ varchar[],
    d99_06 varchar[],
    l72_ varchar[],
    l73_ varchar[],
    l74_ varchar[],
    l75_ varchar[],
    l76_ varchar[],
    l76_06 varchar[],
    l88_ varchar[],
    l95_ varchar[],
    l95_01 varchar[],
    l95_02 varchar[],
    p15_ varchar[],
    p16_ varchar[],
    p17_ varchar[],
    r95_ varchar[],
    t73_ varchar[],
    t85_ varchar[],
    t90 varchar[],
    t90_ varchar[],
    t90_01 varchar[],
    t90_02 varchar[],
    t99_07 varchar[],
    t99_08 varchar[]
);
Converted crosstab SQL:
WITH cte1 AS (

    SELECT
        patient_id,
        name,
        ARRAY[min(begindatum)::varchar,
                max(einddatum)::varchar,
                max(status_datum)::varchar,
                max(status_vlag)::varchar,
                array_agg(distinct icpc)::varchar,
                max(begindatum)::varchar,
                min(einddatum)::varchar,
                min(begindatum_nonactief)::varchar,
                max(einddatum_nonactief)::varchar,
                max(begindatum_nonactief)::varchar,
                min(einddatum_nonactief)::varchar] as waardes
    FROM {{ ref('ost_med_episode_filter') }}
    JOIN {{ ref('ost_med_icpc_codes') }} ON icpc ilike searchstring
    GROUP BY patient_id, name
    ORDER BY patient_id, name

)
SELECT patient_id
, {{ dbt_utils.pivot('name',        dbt_utils.get_column_values(ref('ost_med_icpc_codes'),'categorie',default=[]),        agg='',        then_value='name',        else_value="ARRAY_CONSTRUCT()",        quote_identifiers=False)}} 
FROM cte1
GROUP BY patient_id
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\osteoporose\ost_med_episode.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\osteoporose\ost_med_labcodes.sql

[WARNING] SQL was not modified during conversion
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\osteoporose\ost_med_meetwaarden_filter.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW ost_med_meetwaarden AS
SELECT * FROM crosstab(
$$
    SELECT DISTINCT ON (patient_id, nhgnr)
        patient_id,
        nhgnr,
        ARRAY[  uitslag_raw,
                datum::varchar,
                uitslag_waarde] as waarde_datum
    FROM ost_med_meetwaarden_filter
    JOIN ost_med_labcodes USING (nhgnr)
    ORDER BY patient_id, nhgnr, datum DESC, uitslag_num DESC nulls last,
            uitslag_raw nulls last, uitslag_waarde nulls last
$$,$$
    SELECT nhgnr
    FROM indelingen.nhg_labcodes
    JOIN ost_med_labcodes USING (nhgnr)
    ORDER BY nhgnr
$$
) as ct(
patient_id bigint,
af_b varchar[],
alat_b varchar[],
alb_b varchar[],
alb_u varchar[],
alb_ue_mt varchar[],
albk_u_mi varchar[],
albk_ue_mi varchar[],
asat_b varchar[],
bili_b varchar[],
ca_b varchar[],
chhd_b_mi varchar[],
chol_b_mt varchar[],
fosf_b varchar[],
fosf_u varchar[],
fosf_ue_mt varchar[],
ft4_b varchar[],
gew_ao varchar[],
glhb_b varchar[],
gluc_b_nn varchar[],
gluc_b_nu varchar[],
gluc_bc_nn varchar[],
gluc_bc_nu varchar[],
hb_b varchar[],
hdl_b varchar[],
k_b varchar[],
k_u varchar[],
krea_b varchar[],
krea_o_mk varchar[],
ldhd_b_mi varchar[],
ldl_b varchar[],
lngp_ao varchar[],
na_b varchar[],
oa01_o varchar[],
oa02_o varchar[],
oa03_o varchar[],
oa04_o varchar[],
oa05_o varchar[],
pap_xp_bv varchar[],
pap_xp_im varchar[],
pap_xp_iz varchar[],
pap_xp_mm varchar[],
pap_xp_wo varchar[],
papa_xp varchar[],
papb_xp varchar[],
papc_xp varchar[],
paph_xp varchar[],
papk_xp varchar[],
papn_xp varchar[],
papo_xp varchar[],
papp_xp varchar[],
phad_b_sr varchar[],
pth_b varchar[],
q001_b varchar[],
q002_b varchar[],
q003_b varchar[],
quet_ao varchar[],
t4_b varchar[],
te_u_kw varchar[],
trig_b varchar[],
trom_b_mt varchar[],
tsh_b varchar[],
vb12_b varchar[],
vd_b varchar[],
alco_pq varchar[],
ampu_lv_li varchar[],
ampu_lv_re varchar[],
angk_kq varchar[],
asac_rz varchar[],
asdu_rq varchar[],
asfb_rq varchar[],
asgb_rq varchar[],
ashs_rq varchar[],
asit_rq varchar[],
askk_rq varchar[],
aspk_rq varchar[],
astl_rq varchar[],
astt_rq varchar[],
aswi_rq varchar[],
aswk_rq varchar[],
bewg_lv_li varchar[],
bewg_lv_re varchar[],
clkl_kq varchar[],
cohz_kq varchar[],
dmtv_tq varchar[],
dafu_fz varchar[],
dblo_lv_li varchar[],
dblo_lv_re varchar[],
decc_kq varchar[],
detk_kq varchar[],
dmfm_tq varchar[],
dmp_tz varchar[],
dmrp_fa_li varchar[],
dmrp_fa_re varchar[],
druk_lv_li varchar[],
druk_lv_re varchar[],
dysp_rq varchar[],
eelt_lv_li varchar[],
eelt_lv_re varchar[],
fcpb_rl varchar[],
frpb_rl_mi varchar[],
fvnb_rl varchar[],
fvnb_rl_mp varchar[],
fvns_rl varchar[],
fvpb_rl varchar[],
fvpb_rl_mp varchar[],
fvrp_rl varchar[],
fvrv_rl varchar[],
hypt_kq varchar[],
infc_lv_li varchar[],
infc_lv_re varchar[],
insp_lv_li varchar[],
insp_lv_re varchar[],
kleu_lv_li varchar[],
kleu_lv_re varchar[],
libw_aq varchar[],
mofv_ns_li varchar[],
mofv_ns_re varchar[],
minh_rq varchar[],
onpr_rq varchar[],
pakj_aq varchar[],
pals_rq varchar[],
padp_kv_li varchar[],
padp_kv_re varchar[],
rook_aq varchar[],
rrdi_ka varchar[],
rrsy_ka varchar[],
staf_lv_li varchar[],
staf_lv_re varchar[],
snsv_ns_li varchar[],
snsv_ns_re varchar[],
ulce_lv_li varchar[],
ulce_lv_re varchar[],
voed_tz varchar[],
vsho_tq varchar[],
dmac_tz varchar[],
dmcb_tz varchar[],
ascb_rz varchar[],
cott_rq varchar[],
coac_rz varchar[],
cocb_rz varchar[],
asrz_rz varchar[],
dmrz_tz varchar[],
dmmd_tq	varchar[],
adgw_tq varchar[],
advd_tq varchar[],
admi_aq varchar[],
adgv_aq varchar[],
adlb_aq varchar[],
corz_rz varchar[],
aser_rq varchar[],
adsa_zq varchar[],
dmto_fz varchar[],
opmo_lv varchar[],
fcnb_rl varchar[],
frnb_rl_mi varchar[],
rfam_rq varchar[],
ausc_rl varchar[],
omva_dh varchar[],
pols_ao varchar[],
frns_rl_mi varchar[],
krea_o_fb varchar[],
krem_o_fb varchar[],
gfr_b varchar[],
lyso_nl varchar[],
ntpr_b varchar[],
sipd_aq varchar[],
stda_az varchar[],
srda_aq varchar[],
rfms_rq varchar[],
afau_rl varchar[],
roac_az varchar[],
papq_xp varchar[],
pavl_kq varchar[],
rrsy_ka_mh varchar[],
rrdi_ka_mh varchar[],
schk_b varchar[],
ausc_kh varchar[],
afau_kh varchar[],
hvvw_kz varchar[],
fvsb_rl varchar[],
fvrn_rl varchar[],
frsb_rl_mi varchar[],
polr_ao varchar[],
fufo_fa varchar[],
hvzf_kq varchar[],
asvw_rz varchar[],
advd_aq varchar[],
byvd_aa varchar[],
dmvw_tz varchar[],
rfim_b varchar[],
fhcf_tq varchar[],
bdha_la varchar[],
rivu_sq varchar[],
hvtm_kq varchar[],
ecg_kh varchar[],
dmhb_tz varchar[],
coer_rq varchar[],
mrcd_rq varchar[],
bdht_lh varchar[],
rhvz_kq_fb varchar[],
echo_un_li varchar[],
echo_un_re varchar[],
ccq1_rq varchar[],
ccq2_rq varchar[],
ccq3_rq varchar[],
ccq4_rq varchar[],
ccq5_rq varchar[],
ccq6_rq varchar[],
ccq7_rq varchar[],
ccq8_rq varchar[],
ccq9_rq varchar[],
ccqx_rq varchar[],
ccqs_rq varchar[],
ccqf_rq varchar[],
ccqm_rq varchar[],
ccqt_rq varchar[],
mosr_aq varchar[],
ashb_rz varchar[],
cohb_rz varchar[],
hvcb_kz varchar[],
hvrz_kz varchar[],
_sh1_pq varchar[],
_sh2_pq varchar[],
_sh3_pq varchar[],
_sh4_pq varchar[],
_sh5_pq varchar[],
_sht_pq varchar[],
mmst_pq varchar[],
vvig_tq varchar[],
h002_sa varchar[],
h003_sa varchar[],
vvmi_ao_mi varchar[],
rr24_ka_mh varchar[],
rrgs_ka_mh varchar[],
rrgd_ka_mh varchar[],
rrds_ka_mh varchar[],
rrdd_ka_mh varchar[],
gewv_aa varchar[],
covv_rq varchar[],
o2sa_ao varchar[],
ldld_b varchar[],
b12t_b varchar[],
gzhb_pz varchar[],
fsfu_fz varchar[],
bzvd_aa varchar[],
pver_kq varchar[],
dcer_kq varchar[],
vd3m_b varchar[],
acqt_rq varchar[],
aval_aq varchar[],
pofa_aq varchar[],
slpb_aq varchar[],
smst_pq varchar[],
vipl_pq varchar[],
vlsc_aq varchar[],
oztv_az varchar[],
ozvc_az varchar[],
ozp_az varchar[],
gfit_aq varchar[],
cizi_az varchar[],
zzpv_az varchar[],
adme_aq varchar[],
kwbh_az varchar[],
gdst_pq varchar[],
_dan_pq varchar[],
_dde_pq varchar[],
_ddi_pq varchar[],
_dso_pq varchar[],
cvhb_kz varchar[],
hbac_b varchar[],
blmz_aq varchar[],
ocfm_xq varchar[],
ccfm_dq varchar[],
echo_kh varchar[],
poed_le varchar[],
mnpz_xq varchar[],
zlcp_ra varchar[],
coex_rq varchar[],
ozhb_az varchar[],
dchb_az varchar[],
drug_aq varchar[],
bdi1_pq varchar[],
bdi2_pq varchar[],
bai_pq varchar[],
uihb_uz varchar[],
skhb_tz varchar[],
gluc_ba_nu varchar[],
gluc_ba_nn varchar[],
hf65_kq varchar[],
nngb_aq varchar[],
fitn_aq varchar[],
rh12_kq_fb varchar[],
rvfh_kq_fb varchar[],
hfvw_kz varchar[],
adag_aq varchar[],
vmhf_kq varchar[],
hklp_kq varchar[],
hbap_b varchar[],
dst_aq varchar[],
hfcb_kz varchar[],
ra_lq varchar[],
ecgf_kh varchar[],
rrs7_ka_mh varchar[],
rrd7_ka_mh varchar[],
phq9_pq varchar[],
rr3s_ka varchar[],
rr3d_ka varchar[],
cact_rq varchar[],
nfhb_uz varchar[],
audc_pq varchar[],
obhb_az varchar[],
obcb_az varchar[],
obrz_az varchar[],
afrz_kz varchar[],
afhb_kz varchar[],
afcb_kz varchar[],
ozcb_az varchar[],
ozrz_az varchar[],
hfrz_kz varchar[],
uicb_uz varchar[],
skcb_tz varchar[],
nfcb_uz varchar[],
uirz_uz varchar[],
skrz_tz varchar[],
nfrz_uz varchar[],
dpos_pq varchar[],
dper_pq varchar[],
dprc_pq varchar[],
dpsb_pq varchar[],
ggvc_pz varchar[],
ggcb_pz varchar[],
ggrz_pz varchar[],
ggbm_pq varchar[],
ggad_pq varchar[],
ggp_pz varchar[],
ansb_pq varchar[],
agsg_pq varchar[],
agsb_pq varchar[],
oshb_lz varchar[],
oscb_lz varchar[],
osrz_lz varchar[],
coae_rq varchar[],
act_rq varchar[],
ggbe_pz varchar[],
krec_o_fb varchar[],
acqk_rq varchar[],
scfq_rl varchar[],
asoc_rq varchar[],
zpvu_sq varchar[],
fcnb_rl_mi varchar[],
frnz_rl_mi varchar[],
slsb_pq varchar[],
afty_kh varchar[],
chva_az_fb varchar[],
cafa_aq varchar[],
clhb_kz varchar[],
clcb_kz varchar[],
clrz_kz varchar[],
pahb_kz varchar[],
pacb_kz varchar[],
parz_kz varchar[],
kwcz_az varchar[],
fcem_rl varchar[],
fcem_rl_mi varchar[],
fvem_rl varchar[],
fvem_rl_mp varchar[],
fvem_rl_mi varchar[],
frem_rl_mi varchar[],
frez_rl_mi varchar[],
glup_bc_nu varchar[],
glup_bc_nn varchar[],
krea_b_po varchar[],
krem_o_po  varchar[],
krec_o_po  varchar[],
hbap_b_po varchar[],
crp_b_po varchar[],
ddim_b_po varchar[],
tni_b_po varchar[],
tnt_b_po varchar[],
dmkz_tz varchar[],
askz_rz varchar[],
cokz_rz varchar[],
cvkz_kz varchar[],
gzkz_pz varchar[],
ozkz_az varchar[],
dckz_kz varchar[],
uikz_uz varchar[],
skkz_tz varchar[],
nfkz_uz varchar[],
obkz_az varchar[],
afkz_kz varchar[],
oskz_lz	varchar[],
clkz_kz varchar[],
pakz_kz	varchar[],
rost_aq varchar[],
rsto__promed varchar[]);
Unsupported JOIN found in pivot_statement.
Converted crosstab SQL:

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\osteoporose\ost_med_meetwaarden.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\osteoporose\ost_med_prednison.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\osteoporose\ost_med_prednison_einddata.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# In deze view wordt de fictieve kleinste einddatum van het gebruik bepaald, #} {# door alle startd
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\osteoporose\ost_med_prednison_startdata.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Als het verschil (eerste datum gebruik - laatste datum gebruik) >= 90, #} {# dan is het een langd
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\osteoporose\ost_med_prednison_langdurig.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\osteoporose\ost_atc_codes.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\osteoporose\ost_medicatie_filter.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW ost_medicatie AS
SELECT * FROM crosstab($$
    SELECT
        patient_id,
        categorie,
        ARRAY[
            count(*)::varchar,
            max(voorschrijfdatum)::varchar,
            min(voorschrijfdatum)::varchar,
            array_agg(distinct atc_code)::varchar
            ] as resultaat
    FROM ost_medicatie_filter
    GROUP BY patient_id, categorie
    ORDER BY patient_id, categorie
$$,$$
    SELECT atc FROM ost_atc_codes ORDER BY atc
$$) as
(
    patient_id bigint,
    h02ab04 varchar[],
    h02ab06 varchar[],
    h02ab07 varchar[],
    l02bg01 varchar[],
    l02bg02 varchar[],
    l02bg03 varchar[],
    l02bg04 varchar[],
    l02bg05 varchar[],
    l02bg06 varchar[]);
Converted crosstab SQL:
WITH cte1 AS (

    SELECT
        patient_id,
        categorie,
        ARRAY[
            count(*)::varchar,
            max(voorschrijfdatum)::varchar,
            min(voorschrijfdatum)::varchar,
            array_agg(distinct atc_code)::varchar
            ] as resultaat
    FROM {{ ref('ost_medicatie_filter') }}
    GROUP BY patient_id, categorie
    ORDER BY patient_id, categorie

)
SELECT patient_id
, {{ dbt_utils.pivot('atc',        dbt_utils.get_column_values(ref('ost_atc_codes'),'categorie',default=[]),        agg='',        then_value='categorie',        else_value="ARRAY_CONSTRUCT()",        quote_identifiers=False)}} 
FROM cte1
GROUP BY patient_id
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\osteoporose\ost_medicatie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\osteoporose\ost_bisfosfonaten_half_jaar_gestopt.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\osteoporose_-_sez\osteoporose_53530008_verzamel.sql

[WARNING] SQL was not modified during conversion
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\osteoporose_-_sez\osteoporose_53530008_ind_doelgroep_1.sql

[WARNING] SQL was not modified during conversion
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\osteoporose_-_sez\osteoporose_53530008_ind_doelgroep_2.sql

[WARNING] SQL was not modified during conversion
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\osteoporose_-_sez\osteoporose_53530008_ind_doelgroep_3.sql

[WARNING] SQL was not modified during conversion
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\osteoporose_-_sez\osteoporose_53530008_ind_doelgroep_4.sql

[WARNING] SQL was not modified during conversion
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\osteoporose_-_sez\osteoporose_53530008_ind_doelgroep_5.sql

[WARNING] SQL was not modified during conversion
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\osteoporose_-_sez\osteoporose_53530008_ind_doelgroep_6.sql

[WARNING] SQL was not modified during conversion
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\osteoporose_-_sez\osteoporose_53530008_ind_doelgroep_7.sql

[WARNING] SQL was not modified during conversion
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\osteoporose_-_sez\osteoporose_53530008_ind_doelgroep_8.sql

[WARNING] SQL was not modified during conversion
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\osteoporose_-_sez\osteoporose_53530008_ind_doelgroep_9.sql

[WARNING] SQL was not modified during conversion
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\osteoporose_-_sez\osteoporose_53530008_ind_doelgroep_10.sql

[WARNING] SQL was not modified during conversion
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\osteoporose_-_sez\osteoporose_53530008_ind_doelgroep_11.sql

[WARNING] SQL was not modified during conversion
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\osteoporose_-_sez\osteoporose_53530008_ind_doelgroep_12.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\osteoporose_-_sez\osteoporose_53530008_pl.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# In Proigia episode kijken we naar een laatste of een eerste datum per ICPC. #} {# Voor het tellen
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\osteoporose_-_sez\osteoporose_53530008_fractuur.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Contact hoeft niet gekoppeld te zijn aan ICPC. #} {# Doel: bepalen of ptn sowieso al bij de huisa
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\osteoporose_-_sez\osteoporose_53530008_contact.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\osteoporose_-_sez\osteoporose_53530008_dexamethason.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\osteoporose_-_sez\osteoporose_53530008_dexamethason_einddata.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# In deze view wordt de fictieve kleinste einddatum van het gebruik bepaald, #} {# door alle startd
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\osteoporose_-_sez\osteoporose_53530008_dexamethason_startdata.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Als het verschil (eerste datum gebruik - laatste datum gebruik) >= 15, #} {# dan is het een langd
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\osteoporose_-_sez\osteoporose_53530008_dexamethason_langdurig.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ouderenzorg\ouderenzorg_patienten_gegevens_60.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ouderenzorg\ouderenzorg_episode.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ouderenzorg\ouderenzorg_medicatie_overzicht.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ouderenzorg\ouderenzorg_contacten_per_icpc.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ouderenzorg\ouderenzorg_contacten_icpc.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ouderenzorg\ouderenzorg_contra_indicatie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ouderenzorg\ouderenzorg_apotheek_inschrijving.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {{ ruiter_poh_seg2() }} {# KOPIE VAN proigia_zg_criteria_v3_std_ruiter_poh. Uitzondering proigia mee
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ouderenzorg\ouderenzorg_ruiter_poh.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ouderenzorg\ouderenzorg_episode_3mt.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ouderenzorg\ouderenzorg_medicatie_overzicht_3mt.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ouderenzorg\ouderenzorg_ge_lijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ouderenzorg\ouderenzorg_multimorbiditeit.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ouderenzorg\ouderenzorg_ge_score.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ouderenzorg\ouderenzorg_ca_score.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ouderenzorg\ouderenzorg_ge_score_3mt.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ouderenzorg\ouderenzorg_ca_score_3mt.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ouderenzorg\ouderenzorg_nieuw_aandachtspunt.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ouderenzorg\ouderenzorg_nieuw_aandachtspunt_berekening.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ouderenzorg\ouderenzorg_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ouderenzorg\ouderenzorg_indicatoren_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ouderenzorg\ouderenzorg_indicatoren_perc.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ouderenzorg\ouderenzorg_pl_icpc_meetw.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ouderenzorg\ouderenzorg_pl_icpc_meetw_tonen.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ouderenzorg\ouderenzorg_pl_monitoring.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ouderenzorg\ouderenzorg_pl_monitoring_tonen.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ouderenzorg\ouderenzorg_pl_monitoring_tonen_75.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ouderenzorg_-_zorg_voor_zuid\ouderenzorg_53530073_patienten_gegevens_60.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ouderenzorg_-_zorg_voor_zuid\ouderenzorg_53530073_episode.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ouderenzorg_-_zorg_voor_zuid\ouderenzorg_53530073_medicaties.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ouderenzorg_-_zorg_voor_zuid\ouderenzorg_53530073_medicatie_overzicht.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ouderenzorg_-_zorg_voor_zuid\ouderenzorg_53530073_icpcs.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW ouderenzorg_53530073_meetwaarden AS  
SELECT * FROM
crosstab(
            'WITH bepalingen AS
        (
        SELECT 
            patient_id::varchar,
            nhgnummer,
            CASE LOWER(uitslag)
                WHEN ''ha'' THEN ''huisarts''
                WHEN ''spec'' THEN ''specialist''
                WHEN ''ovond'' THEN ''overig/onbekend''
                ELSE uitslag
                END as uitslag,
            COALESCE(aw.output, uitslag_num) as uitslag_num,
            datum
        FROM bepaling b
        LEFT JOIN indelingen.alfanumerieke_waarden aw
            ON b.nhgnummer=aw.nhgnr
            AND aw.input=uitslag
        WHERE nhgnummer IN (3015,3453,5454,2788,2787,2785,2808,3686,2777,2793,2802,2803,2435,2789,2673,2773,2783,2848,2839,2838,2840,2804,2841,2799,2681,2794,2809,2790,524,3583,1919,3907,3908)
            AND datum < ''${peildatum}''
            )
            SELECT
                DISTINCT ON (patient_id,nhgnummer::integer)
                patient_id,
                nhgnummer::integer,
                ARRAY[coalesce(waarde_omschrijving,tekst_waarde)::varchar,
		            datum::varchar,
		            CASE WHEN uitslag_num is not null
				AND (rw.ineen_min is null OR rw.ineen_min <= uitslag_num)
				AND (rw.ineen_max is null OR rw.ineen_max >= uitslag_num)
				THEN uitslag_num END::varchar             
                        ] as waarde_datum_num
            FROM (
            SELECT   
                patient_id,
                nhgnummer,
                datum,
                uitslag as tekst_waarde,
                indelingen.translate_labcode_answers(nhgnummer::int, uitslag) as waarde_omschrijving,
                CASE WHEN nhgnummer=560 AND uitslag_num <3 THEN uitslag_num*100
                    ELSE uitslag_num END as uitslag_num
            FROM bepalingen        
            LEFT JOIN indelingen.nhg_labcodes lc ON (nhgnummer=lc.nhgnr)
            ) AS bepaling
            LEFT JOIN indelingen.nhg_labcodes_referentie_waarden rw ON (nhgnummer=rw.nhgnr)
            ORDER BY patient_id,nhgnummer,datum DESC,tekst_waarde NULLS LAST,waarde_omschrijving NULLS LAST',
	   'SELECT s.a[n] FROM generate_series(1,33) as n 
	   CROSS JOIN (SELECT ARRAY[3015,3453,5454,2788,2787,2785,2808,3686,2777,2793,2802,2803,2435,2789,2673,2773,2783,2848,2839,2838,2840,2804,2841,2799,2681,2794,2809,2790,524,3583,1919,3907,3908]
	    as a) s ORDER BY n'
) as ct(
       patient_id bigint,
       ozhb_az    varchar[],
		   ozcb_az	  varchar[],
		   ozrz_az    varchar[],
		   ozvc_az	  varchar[],
		   oztv_az	  varchar[],
		   awkw_az	  varchar[],
		   kwbh_az	  varchar[],
		   kwcz_az	  varchar[],
		   pofa_aq	  varchar[],
		   gfit_aq	  varchar[],
		   cizi_az	  varchar[],
		   zzpv_az    varchar[],
		   mmst_pq	  varchar[],
		   ozp_az 	  varchar[],
		   gewv_aa	  varchar[],
		   aval_aq    varchar[],
		   vlsc_aq	  varchar[],
		   blmz_aq    varchar[],
		   orpl_aq    varchar[],
		   ortd_aq    varchar[],
		   orps_aq    varchar[],
		   adme_aq	  varchar[],
		   hbmb_aq	  varchar[],
		   emst_aq	  varchar[],
		   oldt_pq	  varchar[],
		   mnat_aq	  varchar[],
		   mnao_aq	  varchar[],
		   wmpw_aq    varchar[],
		   krea_o_mk  varchar[],
		   krec_o_fb  varchar[],
	       krem_o_fb  varchar[],
		   egfc_o_fb  varchar[],
		   egcc_o_fb  varchar[]);
Converted crosstab SQL:

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ouderenzorg_-_zorg_voor_zuid\ouderenzorg_53530073_meetwaarden.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ouderenzorg_-_zorg_voor_zuid\ouderenzorg_53530073_contacten_per_icpc.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ouderenzorg_-_zorg_voor_zuid\ouderenzorg_53530073_contacten_icpc.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ouderenzorg_-_zorg_voor_zuid\ouderenzorg_53530073_contra_indicatie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ouderenzorg_-_zorg_voor_zuid\ouderenzorg_53530073_medicatie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ouderenzorg_-_zorg_voor_zuid\ouderenzorg_53530073_episode_3mt.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ouderenzorg_-_zorg_voor_zuid\ouderenzorg_53530073_medicaties_3mt.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ouderenzorg_-_zorg_voor_zuid\ouderenzorg_53530073_medicatie_overzicht_3mt.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ouderenzorg_-_zorg_voor_zuid\ouderenzorg_53530073_ge_lijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ouderenzorg_-_zorg_voor_zuid\ouderenzorg_53530073_multimorbiditeit.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ouderenzorg_-_zorg_voor_zuid\ouderenzorg_53530073_ge_score.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ouderenzorg_-_zorg_voor_zuid\ouderenzorg_53530073_ca_score.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ouderenzorg_-_zorg_voor_zuid\ouderenzorg_53530073_ge_score_3mt.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ouderenzorg_-_zorg_voor_zuid\ouderenzorg_53530073_ca_score_3mt.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ouderenzorg_-_zorg_voor_zuid\ouderenzorg_53530073_nieuw_aandachtspunt.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ouderenzorg_-_zorg_voor_zuid\ouderenzorg_53530073_nw_aandachtspunt_berekening.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ouderenzorg_-_zorg_voor_zuid\ouderenzorg_53530073_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ouderenzorg_-_zorg_voor_zuid\ouderenzorg_53530073_indicatoren_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ouderenzorg_-_zorg_voor_zuid\ouderenzorg_53530073_indicatoren_perc.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ouderenzorg_-_zorg_voor_zuid\ouderenzorg_53530073_pl_extra.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ouderenzorg_-_zorg_voor_zuid\ouderenzorg_53530073_pl_extra_tussen.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ouderenzorg_-_zorg_voor_zuid\ouderenzorg_53530073_pl_hboz.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ouderenzorg_-_zorg_voor_zuid\ouderenzorg_53530073_pl_a05.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ouderenzorg_-_zorg_voor_zuid\ouderenzorg_53530073_pl_p20.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ouderenzorg_-_zorg_voor_zuid\ouderenzorg_53530073_pl_p70.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ouderenzorg_-_zorg_voor_zuid\ouderenzorg_53530073_pl_fi_027.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ouderenzorg_-_zorg_voor_zuid\ouderenzorg_53530073_pl_icpc_meetw.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ouderenzorg_-_zorg_voor_zuid\ouderenzorg_53530073_pl_icpc_meetw_tonen.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ouderenzorg_-_zorg_voor_zuid\ouderenzorg_53530073_pl_monitoring.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ouderenzorg_-_zorg_voor_zuid\ouderenzorg_53530073_pl_monitoring_tonen.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwetsbare_ouderen_-_rijn_en_duin\ouderenzorg_53530250_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwetsbare_ouderen_-_rijn_en_duin\ouderenzorg_53530250_indic_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwetsbare_ouderen_-_rijn_en_duin\ouderenzorg_53530250_indicatoren.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwetsbare_ouderen_-_rijn_en_duin\ouderenzorg_53530250_patientenlijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\kwetsbare_ouderen_-_rijn_en_duin\ouderenzorg_53530250_patientenlijst_kort.sql

[ERROR] Failed to process ouderenzorg_53533295_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ouderenzorg_indicatoren_-_ghc\ouderenzorg_indic_53530098_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ouderenzorg_indicatoren_-_ghc\ouderenzorg_indic_53530098_indicatoren_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ouderenzorg_indicatoren_-_ghc\ouderenzorg_indic_53530098_indicatoren.sql

[ERROR] Failed to process ouderenzorg_indicatoren_53530098_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ouderenzorg_patientenlijst_-_ghc\ouderenzorg_pl_53530098_patientenlijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ouderenzorg_patientenlijst_-_ghc\ouderenzorg_pl_53530098_tussen.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ouderenzorg_patientenlijst_-_ghc\ouderenzorg_pl_53530098_inclusie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ouderenzorg_patientenlijst_-_ghc\ouderenzorg_pl_53530098_exclusie.sql

[ERROR] Failed to process ouderenzorg_patientenlijst_53530098_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\overzicht_keten_kwartaaluitkomsten\overzicht_keten_pop_multi_q.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# DM: Totaal #}
SELECT
  tmpzorg.kwartaal,
  'DM' AS zorgstraat,
  'Totaal' AS indicator_type,
  NU
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\overzicht_keten_kwartaaluitkomsten\overzicht_keten_zorg_multi_q.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\overzicht_keten_kwartaaluitkomsten\overzicht_keten_verzamel_multi_q.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\overzicht_keten_kwartaaluitkomsten\overzicht_keten_overzicht.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\overzicht_keten_kwartaaluitkomsten\overzicht_keten_nummerbin.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# **********************************************************************\
 * DIT RAPPORT NIET VERWI
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\overzicht_verrichtingen_poh_ouderen\overzicht_verrichtingen_poho_functie.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Verrichtingen door POH'er mee in rapport #}
SELECT
  huisarts_naam AS "Huisartsnaam",
  ARRAY_TO_
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\overzicht_verrichtingen_poh_ouderen\overzicht_verrichtingen_poho_incl.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Verrichtingen door POH'er niet mee in rapport #}
SELECT
  his_code AS "Memocode",
  COUNT(*) AS "
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\overzicht_verrichtingen_poh_ouderen\overzicht_verrichtingen_poho_excl.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\overzicht_verrichtingen_poh_ouderen\overzicht_verrichtingen_poho_huisartsen.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\overzicht_verrichtingen_poh_ouderen\overzicht_verrichtingen_poho_medewerkers.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\overzicht_verrichtingen_poh_ouderen\overzicht_verrichtingen_poho_datums.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# **********************************************************************\
 * DIT RAPPORT NIET VERWI
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\overzicht_verrichtingen_poh_somatiek\overzicht_verrichtingen_pohs_functie.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Verrichtingen door POH'er mee in rapport #}
SELECT
  huisarts_naam AS "Huisartsnaam",
  ARRAY_TO_
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\overzicht_verrichtingen_poh_somatiek\overzicht_verrichtingen_pohs_incl.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Verrichtingen door POH'er niet mee in rapport #}
SELECT
  his_code AS "Memocode",
  COUNT(*) AS "
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\overzicht_verrichtingen_poh_somatiek\overzicht_verrichtingen_pohs_excl.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\overzicht_verrichtingen_poh_somatiek\overzicht_verrichtingen_pohs_huisartsen.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\overzicht_verrichtingen_poh_somatiek\overzicht_verrichtingen_pohs_medewerkers.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\overzicht_verrichtingen_poh_somatiek\overzicht_verrichtingen_pohs_datums.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\patientenlijst_proactieve_zorgplanning\patientenlijst_pzp_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\patientenlijst_proactieve_zorgplanning\patientenlijst_pzp_patientenlijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\patientenlijst_proactieve_zorgplanning\patientenlijst_pzp_contacten.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\patiÃ«ntenlijst_ouderenzorg_en_andere_ketens\pl_oz_en_andere_ketens_dm.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\patiÃ«ntenlijst_ouderenzorg_en_andere_ketens\pl_oz_en_andere_ketens_copd.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\patiÃ«ntenlijst_ouderenzorg_en_andere_ketens\pl_oz_en_andere_ketens_astma.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\patiÃ«ntenlijst_ouderenzorg_en_andere_ketens\pl_oz_en_andere_ketens_hvz.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\patiÃ«ntenlijst_ouderenzorg_en_andere_ketens\pl_oz_en_andere_ketens_vvr.sql

[ERROR] Failed to process patientenlijst_oz_en_andere_ketens_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\patientenselectie_declaratie_1.0_insuline\ps_declaratie_1_0_insuline_patientenlijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\patientenselectie_declaratie_1.0_insuline\ps_declaratie_1_0_insuline_meetwaarden.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\patientenselectie_declaratie_1.0_insuline\ps_declaratie_1_0_insuline_praktijk.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\patientenselectie_declaratie_1.0_poct_-_ghc\ps_declaratie_1_0_poct_patientenlijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\patientenselectie_declaratie_1.0_poct_-_ghc\ps_declaratie_1_0_poct_meetwaarden.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\patientenselectie_declaratie_1.0_poct_-_ghc\ps_declaratie_1_0_poct_patienten_gegevens.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\patientenselectie_declaratie_1.0_poct_-_ghc\ps_declaratie_1_0_poct_praktijk.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\patientenselectie_declaratie_1.0_poh-ggz_-_53533104\ps_declaratie_1_0_poh_ggz_patientenlijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\patientenselectie_declaratie_1.0_poh-ggz_-_53533104\ps_declaratie_1_0_poh_ggz_meetwaarden.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\patientenselectie_declaratie_1.0_poh-ggz_-_53533104\ps_declaratie_1_0_poh_ggz_patienten_gegevens.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\patientenselectie_declaratie_1.0_poh-ggz_-_53533104\ps_declaratie_1_0_poh_ggz_praktijk.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\patientenselectie_declaratie_diagnosestelling_dementie_-_ghc\ps_declaratie_diag_dementie_patientenlijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\patientenselectie_declaratie_diagnosestelling_dementie_-_ghc\ps_declaratie_diag_dementie_episode.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\patientenselectie_declaratie_diagnosestelling_dementie_-_ghc\ps_declaratie_diag_dementie_meetwaarden.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Kopie van proigia_patienten_gegevens #} {# Afwijking 1: huisarts_agb #} {# Afwijking 2: selectie 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\patientenselectie_declaratie_diagnosestelling_dementie_-_ghc\ps_declaratie_diag_dementie_patienten_gegevens.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\patientenselectie_declaratie_diagnosestelling_dementie_-_ghc\ps_declaratie_diag_dementie_praktijk.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# LET OP! View geeft nog meerdere regels per patient door zg_agb #}
SELECT
  *
FROM {{ ref('proigia
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\patientenselectie_declaratie_v2.1_dbc\ps_decl_v2_1_dbc_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\patientenselectie_declaratie_v2.1_dbc\ps_decl_v2_1_dbc_patientenlijst_dm.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\patientenselectie_declaratie_v2.1_dbc\ps_decl_v2_1_dbc_patientenlijst_bbr.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\patientenselectie_declaratie_v2.1_dbc\ps_decl_v2_1_dbc_patientenlijst_copd.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\patientenselectie_declaratie_v2.1_dbc\ps_decl_v2_1_dbc_patientenlijst_astma.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\patientenselectie_declaratie_v2.1_dbc\ps_decl_v2_1_dbc_patientenlijst_cvrm.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\patientenselectie_declaratie_v2.1_dbc\ps_decl_v2_1_dbc_patientenlijst_hvz.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\patientenselectie_declaratie_v2.1_dbc\ps_decl_v2_1_dbc_patientenlijst_vvr.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\patientenselectie_declaratie_v2.1_dbc\ps_decl_v2_1_dbc_patientenlijst_hf.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\patientenselectie_declaratie_v2.1_dbc\ps_decl_v2_1_dbc_patientenlijst_cns.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\patientenselectie_declaratie_v2.1_dbc\ps_decl_v2_1_dbc_patientenlijst_epa.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\patientenselectie_declaratie_v2.1_dbc\ps_decl_v2_1_dbc_patientenlijst_af.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\patientenselectie_declaratie_v2.1_dbc\ps_decl_v2_1_dbc_patientenlijst_cl.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\patientenselectie_declaratie_v2.1_dbc\ps_decl_v2_1_dbc_patientenlijst_ouderenzorg.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\patientenselectie_declaratie_v2.1_dbc\ps_decl_v2_1_dbc_patientenlijst_dementie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\patientenselectie_declaratie_v2.1_dbc\ps_decl_v2_1_dbc_patientenlijst_dementie_s3.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\patientenselectie_declaratie_v2.1_dbc\ps_decl_v2_1_dbc_patientenlijst_os.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\patientenselectie_declaratie_v2.1_dbc\ps_decl_v2_1_dbc_patientenlijst_ggz.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\patientenselectie_declaratie_v2.1_dbc\ps_decl_v2_1_dbc_patientenlijst_ggz_jeugd.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\patientenselectie_declaratie_v2.1_dbc\ps_decl_v2_1_dbc_patientenlijst_copdastma.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\patientenselectie_declaratie_v2.1_dbc\ps_decl_v2_1_dbc_indicatoren_cvrm.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Deze view wordt gebruikt in ps_declaratie_v2_1_populatie #}
SELECT
  zg_agb,
  zg_agb_s3,
  agb,

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\patientenselectie_declaratie_v2.1_dbc\ps_decl_v2_1_dbc_patienten_gegevens.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\patientenselectie_declaratie_v2.1_populatie\ps_decl_v2_1_pop_patientenlijst_gez.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\patientenselectie_declaratie_v2.1_populatie\ps_decl_v2_1_pop_patientenlijst_ggz.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\patientenselectie_declaratie_v2.1_populatie\ps_decl_v2_1_pop_patientenlijst_s3.sql

[ERROR] Failed to process ps_declaratie_v2_1_populatie_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\patientenselectie_zorgactiviteit\ps_zorgactiviteit_pl.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\patientenselectie_zorgactiviteit\ps_zorgactiviteit_verrichting.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# kopie van proigia_last_cont_pp #}
WITH last_entry AS (
  SELECT
    patient_id,
    MAX(datum) AS
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\poh_ggz_-_consulten_per_medewerker\poh_ggz_consulten_per_mw_last_cont_pp.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\poh_ggz_-_consulten_per_medewerker\poh_ggz_consulten_per_mw_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\poh_ggz_-_consulten_per_medewerker\poh_ggz_consulten_per_mw_pl.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\poh_ggz_-_consulten_per_medewerker\poh_ggz_consulten_per_mw_patient.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\poh_ggz_-_consulten_per_medewerker\poh_ggz_consulten_per_mw_medewerker.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# kopie van proigia_episode_filter (geen exacte kopie i.v.m. einddatum) #}
WITH pre_episode AS (
  
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\poh_ggz_-_consulten_per_medewerker\poh_ggz_consulten_per_mw_episode_filter.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# kopie van proigia_journaal_filter (geen exacte kopie i.v.m. begin- en einddatum) #}
WITH jr_clean
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\poh_ggz_-_consulten_per_medewerker\poh_ggz_consulten_per_mw_journaal_filter.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# kopie van proigia_contact (geen exacte kopie) #}
WITH icpc_context AS (
  SELECT
    patient_id,

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\poh_ggz_-_consulten_per_medewerker\poh_ggz_consulten_per_mw_contact.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# kopie van ggz_basis_volw_contact_p (geen exacte kopie) #}
WITH pre_select AS (
  SELECT
    patie
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\poh_ggz_-_consulten_per_medewerker\poh_ggz_consulten_per_mw_contact_p.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\poh_ggz_-_consulten_per_medewerker\poh_ggz_consulten_per_mw_atc_codes.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# kopie van ggz_basis_volw_medicatie_filter #}
SELECT
  patient_id,
  atc AS categorie,
  voorschri
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\poh_ggz_-_consulten_per_medewerker\poh_ggz_consulten_per_mw_medicatie_filter.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW poh_ggz_consulten_per_mw_medicatie AS

SELECT * FROM crosstab($$
    SELECT
        patient_id,
        categorie,
        ARRAY[
            COUNT(*)::varchar,
            MAX(voorschrijfdatum)::varchar,
            MIN(voorschrijfdatum)::varchar,
            array_agg(distinct atc_code)::varchar
            ] AS resultaat
    FROM poh_ggz_consulten_per_mw_medicatie_filter
    GROUP BY patient_id, categorie
    ORDER BY patient_id, categorie
$$,$$
    SELECT atc FROM poh_ggz_consulten_per_mw_atc_codes ORDER BY atc
$$) AS
(
    patient_id bigint,
    n05a varchar[],
    n05ba varchar[],
    n05cd varchar[],
    n05cf varchar[],
    n06a varchar[]);
Converted crosstab SQL:
WITH cte1 AS (

    SELECT
        patient_id,
        categorie,
        ARRAY[
            COUNT(*)::varchar,
            MAX(voorschrijfdatum)::varchar,
            MIN(voorschrijfdatum)::varchar,
            array_agg(distinct atc_code)::varchar
            ] AS resultaat
    FROM {{ ref('poh_ggz_consulten_per_mw_medicatie_filter') }}
    GROUP BY patient_id, categorie
    ORDER BY patient_id, categorie

)
SELECT patient_id
, {{ dbt_utils.pivot('atc',        dbt_utils.get_column_values(ref('poh_ggz_consulten_per_mw_atc_codes'),'categorie',default=[]),        agg='',        then_value='categorie',        else_value="ARRAY_CONSTRUCT()",        quote_identifiers=False)}} 
FROM cte1
GROUP BY patient_id
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\poh_ggz_-_consulten_per_medewerker\poh_ggz_consulten_per_mw_medicatie.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {#  kopie van proigia_lacodes (geen exacte kopie i.v.m. enkel 1 meetwaarde) #}
SELECT
    as
  FROM 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\poh_ggz_-_consulten_per_medewerker\poh_ggz_consulten_per_mw_labcodes.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# kopie van proigia_meetwaarden_filter(geen exacte kopie i.v.m. einddatum en geen uitzonderingen) #
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\poh_ggz_-_consulten_per_medewerker\poh_ggz_consulten_per_mw_meetwaarden_filter.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW poh_ggz_consulten_per_mw_meetwaarden AS
	
SELECT * FROM crosstab(
$$
    SELECT DISTINCT ON (patient_id, nhgnr)
        patient_id,
        nhgnr,
        ARRAY[  uitslag_raw,
                datum::varchar,
                uitslag_waarde] as waarde_datum
    FROM poh_ggz_consulten_per_mw_meetwaarden_filter
    JOIN poh_ggz_consulten_per_mw_labcodes USING (nhgnr)
    ORDER BY patient_id, nhgnr, datum DESC, uitslag_num DESC nulls last,
            uitslag_raw nulls last, uitslag_waarde nulls last
$$,$$
    SELECT nhgnr
    FROM indelingen.nhg_labcodes
    JOIN poh_ggz_consulten_per_mw_labcodes USING (nhgnr)
    ORDER BY nhgnr
$$
) as ct(
patient_id bigint,
	ggiz_pz varchar[],
	ggbe_pz varchar[]);
Unsupported JOIN found in pivot_statement.
Converted crosstab SQL:

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\poh_ggz_-_consulten_per_medewerker\poh_ggz_consulten_per_mw_meetwaarden.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\poh-ggz_kpi_indicatoren_-_nucleus\poh_ggz_kpi_ind_53533162_verzamel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\poh-ggz_kpi_indicatoren_-_nucleus\poh_ggz_kpi_ind_53533162_indicatoren_maand_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\poh-ggz_kpi_indicatoren_-_nucleus\poh_ggz_kpi_ind_53533162_indicatoren_maand.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\poh-ggz_kpi_indicatoren_-_nucleus\poh_ggz_kpi_ind_53533162_indicatoren_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\poh-ggz_kpi_indicatoren_-_nucleus\poh_ggz_kpi_ind_53533162_indicatoren.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\poh-ggz_kpi_indicatoren_-_nucleus\poh_ggz_kpi_ind_53533162_kalenderjaar.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\poh-ggz_kpi_indicatoren_-_nucleus\poh_ggz_kpi_ind_53533162_episode.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {{ medicatie_epa() }}
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\poh-ggz_kpi_indicatoren_-_nucleus\poh_ggz_kpi_ind_53533162_med_epa.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# In deze view nemen we alleen POH-GGZ verrichtingen mee uit het desbetreffende kalenderjaar. #} {#
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\poh-ggz_kpi_indicatoren_-_nucleus\poh_ggz_kpi_ind_53533162_verrichtingen_pre_beh.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Deze view wordt gebruikt om te bepalen op welke datum de intake en het behandelplan hebben plaats
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\poh-ggz_kpi_indicatoren_-_nucleus\poh_ggz_kpi_ind_53533162_in_behandeling.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# In deze view nemen we alleen POH-GGZ verrichtingen mee uit het desbetreffende kalenderjaar. #} {#
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\poh-ggz_kpi_indicatoren_-_nucleus\poh_ggz_kpi_ind_53533162_verrichtingen_in_beh.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# In deze view nemen we alleen POH-GGZ verrichtingen mee uit het desbetreffende kalenderjaar. #}
WI
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\poh-ggz_kpi_indicatoren_-_nucleus\poh_ggz_kpi_ind_53533162_verrichting.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Verrichtingen afgelopen jaar kijkt naar: verrichtingen tussen 1 jan en de peildatum. #} {# Verric
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\poh-ggz_kpi_indicatoren_-_nucleus\poh_ggz_kpi_ind_53533162_verrichting_per_patient.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\poh-ggz_kpi_indicatoren_jeugd_-_nucleus\poh_ggz_kpi_ind_jeugd_53533162_verzamel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\poh-ggz_kpi_indicatoren_jeugd_-_nucleus\poh_ggz_kpi_ind_jeugd_53533162_ind_maand_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\poh-ggz_kpi_indicatoren_jeugd_-_nucleus\poh_ggz_kpi_ind_jeugd_53533162_ind_maand.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# verschil met volwassen rapport is dat hier ook Z episode wordt meegenomen #}
SELECT
  patient_id,
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\poh-ggz_kpi_indicatoren_jeugd_-_nucleus\poh_ggz_kpi_ind_jeugd_53533162_episode.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\poh-ggz_kpi_patientenlijst_-_nucleus\poh_ggz_kpi_pl_53533162_patientenlijst.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {{ medewerker_koppeling_medewerkerbeheer() }}
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\poh-ggz_kpi_patientenlijst_-_nucleus\poh_ggz_kpi_pl_53533162_medewerker.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\poh-ggz_kpi_patientenlijst_jeugd_-_nucleus\poh_ggz_kpi_pl_jeugd_53533162_pat_verrichting.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\poh-ggz_kpi_patientenlijst_jeugd_-_nucleus\poh_ggz_kpi_pl_jeugd_53533162_pat_patient.sql

[ERROR] Failed to process poh_ggz_kpi_pl_jeugd_53533162_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\poh-s_monitor_lhv_zk\pohs_monitor_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\poh-s_monitor_lhv_zk\pohs_monitor_indicatoren_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\poh-s_monitor_lhv_zk\pohs_monitor_indicatoren.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {{ medewerker_koppeling_medewerkerbeheer() }}
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\poh-s_monitor_lhv_zk\pohs_monitor_medewerker.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\poh-s_monitor_lhv_zk\pohs_monitor_verrichting.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\poh-s_monitor_lhv_zk\pohs_monitor_kwartaaltarief.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\populatiedashboard_filterfunctionaliteit\populatiedashboard_filter_patientenlijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\populatiedashboard_filterfunctionaliteit\populatiedashboard_filter_trendlijn.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\populatiedashboard_filterfunctionaliteit\populatiedashboard_filter_detailpagina.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\populatiedashboard_filterfunctionaliteit\populatiedashboard_filter_medicatie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\populatiedashboard_filterfunctionaliteit\populatiedashboard_filter_icpc.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\populatiedashboard_filterfunctionaliteit\populatiedashboard_filter_epi.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\populatiedashboard_filterfunctionaliteit\populatiedashboard_filter_icpcbin.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\populatiedashboard_filterfunctionaliteit\populatiedashboard_filter_feestbin.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\populatiedashboard_filterfunctionaliteit\populatiedashboard_filter_epi_alle.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\populatiedashboard_filterfunctionaliteit\populatiedashboard_filter_epi_chronisch.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\populatiedashboard_filterfunctionaliteit\populatiedashboard_filter_achterstandswijk.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {{ medewerker_koppeling_medewerkerbeheer() }}
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\populatiedashboard_filterfunctionaliteit\populatiedashboard_filter_medewerker.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\populatiedashboard_filterfunctionaliteit\populatiedashboard_filter_journaal.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\populatiedashboard_filterfunctionaliteit\populatiedashboard_filter_contactmoment.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\populatiedashboard_filterfunctionaliteit\populatiedashboard_filter_contactgroep.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\populatiedashboard_filterfunctionaliteit\populatiedashboard_filter_gezris_verz.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\populatiedashboard_filterfunctionaliteit\populatiedashboard_filter_kwetsbaarheid.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\populatiedashboard_filterfunctionaliteit\populatiedashboard_filter_medicaties.sql

[ERROR] Failed to process populatiedashboard_filter_ppa_algemeen.pry: Invalid PRY format: 'queries:' section not found
[ERROR] Failed to process populatiedashboard_filter_ppa_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\populatierapport_-_voswiz\populatierapport_voswiz_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\populatierapport_-_voswiz\populatierapport_voswiz_patientenlijst.sql

[ERROR] Failed to process populatierapport_voswiz_colum_properties.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\populatierapport_-_voswiz\populatierapport_voswiz_filter_icpcbin.sql

[WARNING] SQL was not modified during conversion
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\populatierapport_-_voswiz\populatierapport_voswiz_verrichting_poh_ggz.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {{ verrichting_huisarts_pre_deel1() }}
WHERE icpc ilike ANY((SELECT icpcs FROM {{ ref('populatierapp
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\populatierapport_-_voswiz\populatierapport_voswiz_verrichting_ha_ggz_pre.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {{ verrichting_huisarts_deel1() }}
FROM {{ ref('populatierapport_voswiz_verrichting_ha_ggz_pre') }}

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\populatierapport_-_voswiz\populatierapport_voswiz_verrichting_ha_ggz.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {{ verrichting_huisarts_deel1() }}
FROM STG.P{{praktijk_agb}}.verrichting
{{ verrichting_huisarts_de
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\populatierapport_-_voswiz\populatierapport_voswiz_verrichting_ha.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\populatierapport_-_voswiz\populatierapport_voswiz_verrichting_overig.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\populatierapport_-_voswiz\populatierapport_voswiz_pohggzjeugd_functie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\populatierapport_-_voswiz\populatierapport_voswiz_contactmoment.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Gekozen voor FROM STG.P{{praktijk_agb}}.episode i.p.v. FROM {{ ref('proigia_episode_filter') }} v
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\populatierapport_-_voswiz\populatierapport_voswiz_episode.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_allergie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_apotheek.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: CREATE VIEW proigia_journaal_filter_ooit
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_journaal_filter_ooit.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: CREATE VIEW proigia_journaal_filter
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_journaal_filter.sql

[WARNING] SQL was not modified during conversion
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_contact_ooit.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_last_cont_pp.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_contact.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_icpc_hoofdstukken.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_contacten_per_icpc.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_contactmoment.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: CREATE VIEW proigia_journaal_filter_3mt
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_journaal_filter_3mt.sql

[WARNING] SQL was not modified during conversion
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_contact_3mt.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_last_cont_pp_3mt.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: CREATE VIEW proigia_journaal_filter_current_date
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_journaal_filter_current_date.sql

[WARNING] SQL was not modified during conversion
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_contact_current_date.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_last_cont_pp_current_date.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_contraindicatie.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE MATERIALIZED VIEW proigia_episode_filter AS
WITH clean_episode AS MATERIALIZED
(
    SELECT
        episode_id,
        patient_id,
        begindatum,
        einddatum,
        CASE WHEN episode_status IS NULL THEN NULL
            WHEN episode_status ~* '^a' THEN 1
            ELSE 0 END::smallint as status_vlag,
        CASE WHEN einddatum <'${peildatum}' THEN 0 ELSE 1 END as status_datum,
        icpc_cleaned as icpc
    FROM episode
    WHERE (COALESCE(begindatum, '0001-01-01'::timestamp) < '${peildatum}')
),
pre_episode AS
(
    SELECT
        episode_id,
        patient_id,
        begindatum,
        einddatum,
        status_vlag,
        status_datum,
        icpc,
        CASE WHEN begindatum=einddatum 
            AND (icpc SIMILAR TO '(R95|R96|T90|K74|K75|K76|K77|K78|K89|K90|K92.01|K99.01)%|(K92)') 
            THEN 1 ELSE 0 END as episode_elimineren
    FROM clean_episode
),
episode_filter_pre AS
(
SELECT
    e.episode_id,
    e.patient_id,
    CASE WHEN status_datum=1 THEN e.begindatum ELSE NULL END as begindatum,
    CASE WHEN status_datum=0 THEN e.begindatum ELSE NULL END as begindatum_nonactief,
    CASE WHEN status_datum=1 THEN e.einddatum ELSE NULL END as einddatum,
    CASE WHEN status_datum=0 THEN e.einddatum ELSE NULL END as einddatum_nonactief,
    e.status_vlag,
    e.status_datum,
    e.icpc,
    COALESCE(i.description, 'ICPC code onbekend') as icpc_omschrijving
FROM pre_episode e
LEFT JOIN indelingen.icpc_description i ON e.icpc = i.code
WHERE episode_elimineren=0
)
    SELECT
        episode_id,
        patient_id,
        begindatum,
        begindatum_nonactief,
        einddatum,
        einddatum_nonactief,
        status_vlag,
        status_datum,
        icpc,
        icpc_omschrijving
    FROM episode_filter_pre
    
    
    UNION SELECT * FROM
        (SELECT 
                episode_id,
                patient_id,
                begindatum,
                begindatum_nonactief,
                einddatum,
                einddatum_nonactief,
                status_vlag,
                status_datum,
                journaal.icpc, 
                icpc_omschrijving
            FROM (
                SELECT DISTINCT ON (patient_id,icpc)
                journaal.patient_id,
                COALESCE(journaalregel.icpc, journaal.icpc) as icpc
                FROM journaal
                LEFT JOIN journaalregel USING (journaal_id)
                WHERE journaalregel.soepcode='E'
                    AND journaal.episode_icpc='K29'
                ) AS journaal
            LEFT JOIN (
                SELECT 
                    episode_id,
                    patient_id,
                    CASE WHEN status_datum=1 THEN begindatum ELSE NULL END as begindatum,
                    CASE WHEN status_datum=0 THEN begindatum ELSE NULL END as begindatum_nonactief,
                    CASE WHEN status_datum=1 THEN einddatum ELSE NULL END as einddatum,
                    CASE WHEN status_datum=0 THEN einddatum ELSE NULL END as einddatum_nonactief,
                    status_vlag,
                    status_datum,
                    icpc, 
                    icpc_omschrijving
                FROM (
                SELECT DISTINCT ON (patient_id)
                    episode_id,
                    patient_id,
                    begindatum,
                    einddatum,
                    CASE WHEN episode_status IS NULL THEN NULL
                        WHEN episode_status ~* '^a' THEN 1
                        ELSE 0 END::smallint as status_vlag,
                    CASE WHEN einddatum <'${peildatum}' THEN 0 ELSE 1 END as status_datum,
                    icpc_cleaned as icpc,
                    omschrijving as icpc_omschrijving
                FROM episode e
                WHERE e.icpc_cleaned = 'K29'  
                ORDER BY patient_id,begindatum
                ) AS episode
                ) AS episode_nonactief USING (patient_id)
            ) AS episodes_onder_k29
            WHERE string_to_array('${agb}', ',')::int[] && ARRAY[1008608];


CREATE INDEX IF NOT EXISTS proigia_episode_filter_icpc ON proigia_episode_filter USING gin (icpc gin_trgm_ops);
ANALYZE proigia_episode_filter;
Converted crosstab SQL:

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_episode_filter.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_icpc_codes.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW proigia_episode AS
SELECT * FROM crosstab($$
    SELECT
        patient_id,
        name,
        ARRAY[min(begindatum)::varchar,
                max(einddatum)::varchar,
                max(status_datum)::varchar,
                max(status_vlag)::varchar,
                array_agg(distinct icpc)::varchar,
                max(begindatum)::varchar,
                min(einddatum)::varchar,
                min(begindatum_nonactief)::varchar,
                max(einddatum_nonactief)::varchar,
                max(begindatum_nonactief)::varchar,
                min(einddatum_nonactief)::varchar] as waardes
    FROM proigia_episode_filter
    JOIN proigia_icpc_codes ON icpc ilike searchstring
    GROUP BY patient_id, name
    ORDER BY patient_id, name
$$,$$
    SELECT name FROM proigia_icpc_codes ORDER BY name;
$$) as ct(
patient_id bigint,
Converted crosstab SQL:

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_episode.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_episode_categorie.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE MATERIALIZED VIEW proigia_episode_filter_3mt AS
WITH 
clean_episode AS MATERIALIZED 
(
    SELECT
        episode_id,
        patient_id,
        begindatum,
        einddatum,            
        CASE WHEN episode_status IS NULL THEN NULL
             WHEN episode_status ~* '^a' THEN 1
        ELSE 0 END::smallint                            AS status_vlag,
        CASE WHEN einddatum <'${peildatum}'::date-'3 months'::interval THEN 0 
        ELSE 1 END                                      AS status_datum,
        icpc_cleaned                                    AS icpc 
    FROM episode 
    WHERE begindatum < '${peildatum}'::date-'3 months'::interval
),
pre_episode AS
(
    SELECT
        episode_id,
        patient_id,
        begindatum,
        einddatum,
        status_vlag,
        status_datum,
        icpc,
        CASE WHEN begindatum=einddatum 
            AND (icpc SIMILAR TO '(R95|R96|T90|K74|K75|K76|K77|K78|K89|K90|K92.01|K99.01)%|(K92)') 
            THEN 1 ELSE 0 END as episode_elimineren
    FROM clean_episode
),
episode_filter_pre AS
(
SELECT
    e.episode_id,
    e.patient_id,
    CASE WHEN status_datum=1 THEN e.begindatum ELSE NULL END as begindatum,
    CASE WHEN status_datum=0 THEN e.begindatum ELSE NULL END as begindatum_nonactief,
    CASE WHEN status_datum=1 THEN e.einddatum ELSE NULL END as einddatum,
    CASE WHEN status_datum=0 THEN e.einddatum ELSE NULL END as einddatum_nonactief,
    e.status_vlag,
    e.status_datum,
    e.icpc,
    COALESCE(i.description, 'ICPC code onbekend') as icpc_omschrijving
FROM pre_episode e
LEFT JOIN indelingen.icpc_description i ON e.icpc = i.code
WHERE episode_elimineren=0
)
    SELECT
        episode_id,
        patient_id,
        begindatum,
        begindatum_nonactief,
        einddatum,
        einddatum_nonactief,
        status_vlag,
        status_datum,
        icpc,
        icpc_omschrijving
    FROM episode_filter_pre
    
    
    UNION SELECT * FROM
        (SELECT 
                episode_id,
                patient_id,
                begindatum,
                begindatum_nonactief,
                einddatum,
                einddatum_nonactief,
                status_vlag,
                status_datum,
                journaal.icpc, 
                icpc_omschrijving
            FROM (
                SELECT DISTINCT ON (patient_id,icpc)
                journaal.patient_id,
                COALESCE(journaalregel.icpc, journaal.icpc) as icpc
                FROM journaal
                LEFT JOIN journaalregel USING (journaal_id)
                WHERE journaalregel.soepcode='E'
                    AND journaal.episode_icpc='K29'
                ) AS journaal
            LEFT JOIN (
                SELECT 
                    episode_id,
                    patient_id,
                    CASE WHEN status_datum=1 THEN begindatum ELSE NULL END as begindatum,
                    CASE WHEN status_datum=0 THEN begindatum ELSE NULL END as begindatum_nonactief,
                    CASE WHEN status_datum=1 THEN einddatum ELSE NULL END as einddatum,
                    CASE WHEN status_datum=0 THEN einddatum ELSE NULL END as einddatum_nonactief,
                    status_vlag,
                    status_datum,
                    icpc, 
                    icpc_omschrijving
                FROM (
                SELECT DISTINCT ON (patient_id)
                    episode_id,
                    patient_id,
                    begindatum,
                    einddatum,
                    CASE WHEN episode_status IS NULL THEN NULL
                        WHEN episode_status ~* '^a' THEN 1
                        ELSE 0 END::smallint as status_vlag,
                    CASE WHEN einddatum <'${peildatum}'::date-'3 months'::interval THEN 0 ELSE 1 END as status_datum,
                    icpc_cleaned as icpc,
                    omschrijving as icpc_omschrijving
                FROM episode e
                WHERE e.icpc_cleaned = 'K29'  
                ORDER BY patient_id,begindatum
                ) AS episode
                ) AS episode_nonactief USING (patient_id)
            ) AS episodes_onder_k29
            WHERE string_to_array('${agb}', ',')::int[] && ARRAY[1008608];

CREATE INDEX IF NOT EXISTS proigia_episode_filter_3mt_icpc ON proigia_episode_filter_3mt USING gin (icpc gin_trgm_ops);
ANALYZE proigia_episode_filter_3mt;
Converted crosstab SQL:

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_episode_filter_3mt.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW proigia_episode_3mt AS
SELECT * FROM crosstab($$
    SELECT
        patient_id,
        name,
        ARRAY[min(begindatum)::varchar,
                max(einddatum)::varchar,
                max(status_datum)::varchar,
                max(status_vlag)::varchar,
                array_agg(distinct icpc)::varchar,
                max(begindatum)::varchar,
                min(einddatum)::varchar,
                min(begindatum_nonactief)::varchar,
                max(einddatum_nonactief)::varchar,
                max(begindatum_nonactief)::varchar,
                min(einddatum_nonactief)::varchar] as waardes
    FROM proigia_episode_filter_3mt
    JOIN proigia_icpc_codes ON icpc ilike searchstring
    GROUP BY patient_id, name
    ORDER BY patient_id, name
$$,$$
    SELECT name FROM proigia_icpc_codes ORDER BY name;
$$) as ct(
patient_id bigint,
Converted crosstab SQL:

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_episode_3mt.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE MATERIALIZED VIEW proigia_episode_filter_current_date AS
WITH 
	clean_episode AS MATERIALIZED 
(
    SELECT
        episode_id,
        patient_id,
        begindatum,
        einddatum,
        CASE WHEN episode_status IS NULL THEN NULL
            WHEN episode_status ~* '^a' THEN 1
            ELSE 0 END::smallint                            AS status_vlag,
        CASE WHEN einddatum < CURRENT_DATE THEN 0 
        ELSE 1 END                                          AS status_datum,
        icpc_cleaned                                        AS icpc 
    FROM episode
    WHERE (COALESCE(begindatum, '0001-01-01'::timestamp) < CURRENT_DATE)
),
pre_episode AS
(
    SELECT
        episode_id,
        patient_id,
        begindatum,
        einddatum,
        status_vlag,
        status_datum,
        icpc,
        CASE WHEN begindatum=einddatum 
		        AND (icpc SIMILAR TO '(R95|R96|T90|K74|K75|K76|K77|K78|K89|K90|K92.01|K99.01)%|(K92)') 
		        THEN 1 ELSE 0 END                               AS episode_elimineren
    FROM clean_episode 
),
episode_filter_pre AS
(
SELECT
    e.episode_id,
    e.patient_id,
    CASE WHEN status_datum=1 THEN e.begindatum ELSE NULL END as begindatum,
		CASE WHEN status_datum=0 THEN e.begindatum ELSE NULL END as begindatum_nonactief,
		CASE WHEN status_datum=1 THEN e.einddatum ELSE NULL END as einddatum,
		CASE WHEN status_datum=0 THEN e.einddatum ELSE NULL END as einddatum_nonactief,
    e.status_vlag,
    e.status_datum,
    e.icpc,
    COALESCE(i.description, 'ICPC code onbekend') as icpc_omschrijving
FROM pre_episode e
LEFT JOIN indelingen.icpc_description i ON e.icpc = i.code
	WHERE episode_elimineren=0
	)
		SELECT
			episode_id,
			patient_id,
			begindatum,
			begindatum_nonactief,
			einddatum,
			einddatum_nonactief,
			status_vlag,
			status_datum,
			icpc,
			icpc_omschrijving
		FROM episode_filter_pre
		
		
		UNION SELECT * FROM
			(SELECT 
					episode_id,
					patient_id,
					begindatum,
					begindatum_nonactief,
					einddatum,
					einddatum_nonactief,
					status_vlag,
					status_datum,
					journaal.icpc, 
					icpc_omschrijving
				FROM (
					SELECT DISTINCT ON (patient_id,icpc)
					journaal.patient_id,
					COALESCE(journaalregel.icpc, journaal.icpc) as icpc
					FROM journaal
					LEFT JOIN journaalregel USING (journaal_id)
					WHERE journaalregel.soepcode='E'
						AND journaal.episode_icpc='K29'
					) AS journaal
				LEFT JOIN (
					SELECT 
						episode_id,
						patient_id,
						CASE WHEN status_datum=1 THEN begindatum ELSE NULL END as begindatum,
						CASE WHEN status_datum=0 THEN begindatum ELSE NULL END as begindatum_nonactief,
						CASE WHEN status_datum=1 THEN einddatum ELSE NULL END as einddatum,
						CASE WHEN status_datum=0 THEN einddatum ELSE NULL END as einddatum_nonactief,
						status_vlag,
						status_datum,
						icpc, 
						icpc_omschrijving
					FROM (
					SELECT DISTINCT ON (patient_id)
						episode_id,
						patient_id,
						begindatum,
						einddatum,
						CASE WHEN episode_status IS NULL THEN NULL
							WHEN episode_status ~* '^a' THEN 1
							ELSE 0 END::smallint as status_vlag,
						CASE WHEN einddatum < CURRENT_DATE THEN 0 ELSE 1 END as status_datum,
						icpc_cleaned as icpc,
						omschrijving as icpc_omschrijving
					FROM episode e
					WHERE e.icpc_cleaned = 'K29'  
					ORDER BY patient_id,begindatum
					) AS episode
					) AS episode_nonactief USING (patient_id)
				) AS episodes_onder_k29
				WHERE string_to_array('${agb}', ',')::int[] && ARRAY[1008608];

CREATE INDEX IF NOT EXISTS proigia_episode_filter_current_icpc ON proigia_episode_filter_current_date USING gin (icpc gin_trgm_ops);
ANALYZE proigia_episode_filter_current_date;
Converted crosstab SQL:

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_episode_filter_current_date.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_icpc_codes_current_date.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW proigia_episode_current_date AS
SELECT * FROM crosstab($$
    SELECT
        patient_id,
        name,
        ARRAY[min(begindatum)::varchar,
                max(einddatum)::varchar,
                max(status_datum)::varchar,
                max(status_vlag)::varchar,
                array_agg(distinct icpc)::varchar,
                max(begindatum)::varchar,
                min(einddatum)::varchar,
                min(begindatum_nonactief)::varchar,
                max(einddatum_nonactief)::varchar,
                max(begindatum_nonactief)::varchar,
                min(einddatum_nonactief)::varchar] as waardes
    FROM proigia_episode_filter_current_date
    JOIN proigia_icpc_codes_current_date ON icpc ilike searchstring
    GROUP BY patient_id, name
    ORDER BY patient_id, name
$$,$$
    SELECT name FROM proigia_icpc_codes_current_date ORDER BY name;
$$) as ct(
    patient_id bigint,
		a04_ varchar[],
		a05_ varchar[],
		a20_ varchar[],
		a29_01 varchar[],
		a49_01 varchar[],
		a49_02 varchar[],
		a80_ varchar[],
		a91_05 varchar[],
		a97_ varchar[],
		a97_02 varchar[],
		a99_ varchar[],
		b72_ varchar[],
		b73_ varchar[],
		b74_ varchar[],
		b78_ varchar[],
		b79_ varchar[],
		b80_ varchar[],
		b81_ varchar[],
		b82_ varchar[],
		b83 varchar[],
		b83_ varchar[],
		b83_01 varchar[],
		b83_02 varchar[],
		d02_ varchar[],
		d03_ varchar[],
		d14_ varchar[],
		d15_ varchar[],
		d16_ varchar[],
		d17_ varchar[],
		d72_ varchar[],
		d74_ varchar[],
		d77_01 varchar[],
		d84_ varchar[],
		d85_ varchar[],
		d86_ varchar[],
		d86_01 varchar[],
		d87 varchar[],
		d87_ varchar[],
		d87_01 varchar[],
		d87_02 varchar[],
		d97_04 varchar[],
		f05_ varchar[],
		f83_01 varchar[],
		h02_ varchar[],
		k49_01 varchar[],
		k71_ varchar[],
		k71_01 varchar[],
		k71_02 varchar[],
		k73_ varchar[],
		k73_01 varchar[],
		k73_02 varchar[],
		k74 varchar[],
		k74_ varchar[],
		k74_01 varchar[],
		k74_02 varchar[],
		k75_ varchar[],
		k76 varchar[],
		k76_ varchar[],
		k76_01 varchar[],
		k76_02 varchar[],
		k77 varchar[],
		k77_ varchar[],
		k77_01 varchar[],
		k77_02 varchar[],
		k78_ varchar[],
		k79_ varchar[],
		k79_01 varchar[],
		k79_02 varchar[],
		k82_ varchar[],
		k83_ varchar[],
		k83_01 varchar[],
		k83_02 varchar[],
		k84_ varchar[],
		k84_01 varchar[],
		k84_02 varchar[],
		k84_03 varchar[],
		k84_07 varchar[],
		k85_ varchar[],
		k86_ varchar[],
		k87_ varchar[],
		k89_ varchar[],
		k90 varchar[],
		k90_ varchar[],
		k90_01 varchar[],
		k90_02 varchar[],
		k90_03 varchar[],
		k91_ varchar[],
		k92 varchar[],
		k92_ varchar[],
		k92_01 varchar[],
		k92_02 varchar[],
		k92_03 varchar[],
		k93_ varchar[],
		k94_01 varchar[],
		k94_02 varchar[],
		k99_ varchar[],
		k99_01 varchar[],
		k99_02 varchar[],
		k99_03 varchar[],
		k99_04 varchar[],
		k99_05 varchar[],
		k99_06 varchar[],
		l29_ varchar[],
		l49_01 varchar[],
		l72_ varchar[],
		l73_ varchar[],
		l74_ varchar[],
		l74_01 varchar[],
		l74_02 varchar[],
		l75_ varchar[],
		l75_01 varchar[],
		l76_ varchar[],
		l76_06 varchar[],
		l88 varchar[],
		l88_ varchar[],
		l88_01 varchar[],
		l88_02 varchar[],
		l95_ varchar[],
		l95_01 varchar[],
		l95_02 varchar[],
		n94_ varchar[],
		n94_02 varchar[],
		p_ varchar[],
		p01_ varchar[],
		p02_ varchar[],
		p02_01 varchar[],
		p03_ varchar[],
		p04_ varchar[],
		p05_ varchar[],
		p06_ varchar[],
		p06_01 varchar[],
		p07_ varchar[],
		p08_ varchar[],
		p08_01 varchar[],
		p08_02 varchar[],
		p08_03 varchar[],
		p09_ varchar[],
		p10_ varchar[],
		p10_01 varchar[],
		p10_02 varchar[],
		p11_ varchar[],
		p12_ varchar[],
		p13_ varchar[],
		p15_ varchar[],
		p15_01 varchar[],
		p15_02 varchar[],
		p15_03 varchar[],
		p15_05 varchar[],
		p15_06 varchar[],
		p16_ varchar[],
		p17_ varchar[],
		p18_ varchar[],
		p19_ varchar[],
		p19_01 varchar[],
		p19_02 varchar[],
		p20_ varchar[],
		p21_ varchar[],
		p22_ varchar[],
		p23_ varchar[],
		p24_ varchar[],
		p24_01 varchar[],
		p24_02 varchar[],
		p24_03 varchar[],
		p25_ varchar[],
		p27_ varchar[],
		p28_ varchar[],
		p29_ varchar[],
		p70_ varchar[],
		p70_01 varchar[],
		p70_02 varchar[],
		p71_ varchar[],
		p71_04 varchar[],
		p72_ varchar[],
		p73_ varchar[],
		p73_02 varchar[],
		p74_ varchar[],
		p74_01 varchar[],
		p74_02 varchar[],
		p75_ varchar[],
		p76_ varchar[],
		p76_01 varchar[],
		p76_02 varchar[],
		p77_ varchar[],
		p77_01 varchar[],
		p77_02 varchar[],
		p78_ varchar[],
		p79_ varchar[],
		p79_01 varchar[],
		p79_02 varchar[],
		p80_ varchar[],
		p80_01 varchar[],
		p80_02 varchar[],
		p85_ varchar[],
		p98_ varchar[],
		p99_ varchar[],
		p99_01 varchar[],
		r02_ varchar[],
		r05_ varchar[],
		r29_02 varchar[],
		r44_ varchar[],
		r81_ varchar[],
		r91_ varchar[],
		r95_ varchar[],
		r96 varchar[],
		r96_ varchar[],
		r96_01 varchar[],
		r96_02 varchar[],
		s91_ varchar[],
		s97_ varchar[],
		t05_ varchar[],
		t06_ varchar[],
		t06_01 varchar[],
		t06_02 varchar[],
		t29_ varchar[],
		t82_ varchar[],
		t83_ varchar[],
		t85_ varchar[],
		t86_ varchar[],
		t90 varchar[],
		t90_ varchar[],
		t90_01 varchar[],
		t90_02 varchar[],
		t91_ varchar[],
		t93 varchar[],
		t93_ varchar[],
		t93_01 varchar[],
		t93_02 varchar[],
		t93_03 varchar[],
		t93_04 varchar[],
		t99_07 varchar[],
		t99_08 varchar[],
		u04_ varchar[],
		u04_01 varchar[],
		u04_02 varchar[],
		u04_03 varchar[],
		u05_02 varchar[],
		u07_ varchar[],
		u71_ varchar[],
		u71_02 varchar[],
		u77_ varchar[],
		u78_ varchar[],
		u79_ varchar[],
		u80_ varchar[],
		u80_02 varchar[],
		u85_ varchar[],
		u88_ varchar[],
		u98_ varchar[],
		u98_01 varchar[],
		u98_03 varchar[],
		u99_ varchar[],
		u99_01 varchar[],
		w78_ varchar[],
		w79_ varchar[],
		w81_ varchar[],
		x37_ varchar[],
		z_ varchar[],
		z01_ varchar[],
		z02_ varchar[],
		z03_ varchar[],
		z03_01 varchar[],
		z03_02 varchar[],
		z03_03 varchar[],
		z04_ varchar[],
		z04_01 varchar[],
		z04_02 varchar[],
		z04_03 varchar[],
		z04_04 varchar[],
		z04_05 varchar[],
		z05_ varchar[],
		z05_01 varchar[],
		z05_02 varchar[],
		z05_03 varchar[],
		z05_04 varchar[],
		z05_05 varchar[],
		z06_ varchar[],
		z07_ varchar[],
		z07_01 varchar[],
		z07_02 varchar[],
		z07_03 varchar[],
		z08_ varchar[],
		z08_01 varchar[],
		z08_02 varchar[],
		z09_ varchar[],
		z09_01 varchar[],
		z09_02 varchar[],
		z10_ varchar[],
		z10_01 varchar[],
		z10_02 varchar[],
		z11_ varchar[],
		z12_ varchar[],
		z12_01 varchar[],
		z12_02 varchar[],
		z13_ varchar[],
		z13_01 varchar[],
		z13_02 varchar[],
		z13_03 varchar[],
		z14_ varchar[],
		z15_ varchar[],
		z16_ varchar[],
		z16_01 varchar[],
		z16_02 varchar[],
		z16_03 varchar[],
		z18_ varchar[],
		z19_ varchar[],
		z20_ varchar[],
		z21_ varchar[],
		z21_01 varchar[],
		z21_02 varchar[],
		z22_ varchar[],
		z23_ varchar[],
		z24_ varchar[],
		z25_ varchar[],
		z25_01 varchar[],
		z27_ varchar[],
		z28_ varchar[],
		z29_ varchar[],
		z29_01 varchar[],
		z29_02 varchar[],
		z29_03 varchar[]
);
Converted crosstab SQL:
WITH cte1 AS (

    SELECT
        patient_id,
        name,
        ARRAY[min(begindatum)::varchar,
                max(einddatum)::varchar,
                max(status_datum)::varchar,
                max(status_vlag)::varchar,
                array_agg(distinct icpc)::varchar,
                max(begindatum)::varchar,
                min(einddatum)::varchar,
                min(begindatum_nonactief)::varchar,
                max(einddatum_nonactief)::varchar,
                max(begindatum_nonactief)::varchar,
                min(einddatum_nonactief)::varchar] as waardes
    FROM {{ ref('proigia_episode_filter_current_date') }}
    JOIN {{ ref('proigia_icpc_codes_current_date') }} ON icpc ilike searchstring
    GROUP BY patient_id, name
    ORDER BY patient_id, name

)
SELECT patient_id
, {{ dbt_utils.pivot('name',        dbt_utils.get_column_values(ref('proigia_icpc_codes_current_date'),'categorie',default=[]),        agg='',        then_value='name',        else_value="ARRAY_CONSTRUCT()",        quote_identifiers=False)}} 
FROM cte1
GROUP BY patient_id
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_episode_current_date.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_icpc_codes_seg2.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW proigia_episode_seg2 AS
SELECT * FROM crosstab($$
    SELECT
        patient_id,
        name,
        ARRAY[min(begindatum)::varchar,
                max(einddatum)::varchar,
                max(status_datum)::varchar,
                max(status_vlag)::varchar,
                array_agg(distinct icpc)::varchar,
                max(begindatum)::varchar,
                min(einddatum)::varchar,
                min(begindatum_nonactief)::varchar,
                max(einddatum_nonactief)::varchar,
                max(begindatum_nonactief)::varchar,
                min(einddatum_nonactief)::varchar] as waardes
    FROM proigia_episode_filter
    JOIN proigia_icpc_codes_seg2 ON icpc ilike searchstring
    GROUP BY patient_id, name
    ORDER BY patient_id, name
$$,$$
    SELECT name FROM proigia_icpc_codes_seg2 ORDER BY name;
$$) as ct(
    patient_id bigint,
    __DBT_MACRO_0__
	);
Converted crosstab SQL:
WITH cte1 AS (

    SELECT
        patient_id,
        name,
        ARRAY[min(begindatum)::varchar,
                max(einddatum)::varchar,
                max(status_datum)::varchar,
                max(status_vlag)::varchar,
                array_agg(distinct icpc)::varchar,
                max(begindatum)::varchar,
                min(einddatum)::varchar,
                min(begindatum_nonactief)::varchar,
                max(einddatum_nonactief)::varchar,
                max(begindatum_nonactief)::varchar,
                min(einddatum_nonactief)::varchar] as waardes
    FROM {{ ref('proigia_episode_filter') }}
    JOIN {{ ref('proigia_icpc_codes_seg2') }} ON icpc ilike searchstring
    GROUP BY patient_id, name
    ORDER BY patient_id, name

)
SELECT patient_id
, {{ dbt_utils.pivot('name',        dbt_utils.get_column_values(ref('proigia_icpc_codes_seg2'),'categorie',default=[]),        agg='',        then_value='name',        else_value="ARRAY_CONSTRUCT()",        quote_identifiers=False)}} 
FROM cte1
GROUP BY patient_id
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_episode_seg2.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_fi_labcodes.sql

[WARNING] SQL was not modified during conversion
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_fi_meetwaarden_filter.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE MATERIALIZED VIEW proigia_fi_meetwaarden AS
SELECT * FROM crosstab(
$$
    SELECT DISTINCT ON (patient_id, nhgnr)
        patient_id,
        nhgnr,
        ARRAY[  uitslag_raw,
                datum::varchar,
                uitslag_waarde] as waarde_datum
    FROM proigia_fi_meetwaarden_filter
    JOIN proigia_fi_labcodes USING (nhgnr)
    ORDER BY patient_id, nhgnr, datum DESC, uitslag_num DESC nulls last,
            uitslag_raw nulls last, uitslag_waarde nulls last
$$,$$
    SELECT nhgnr
    FROM indelingen.nhg_labcodes
    JOIN proigia_fi_labcodes USING (nhgnr)
    ORDER BY nhgnr
$$
) as ct(
patient_id bigint,
gew_ao varchar[],
quet_ao varchar[],
alco_pq varchar[],
rook_aq varchar[],
rrdi_ka varchar[],
rrsy_ka varchar[],
krem_o_fb varchar[],
gfr_b varchar[],
srda_aq varchar[],
krec_o_fb varchar[],
rost_aq varchar[],
rsto__promed varchar[]);

ANALYZE proigia_fi_meetwaarden;
Unsupported JOIN found in pivot_statement.
Converted crosstab SQL:

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_fi_meetwaarden.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Let op: denk bij aanpassingen ook aan proigia_fi_lijst_kwetsbaarheid #}
SELECT
  1 AS nr,
  ARRAY
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_fi_lijst.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Let op: denk bij aanpassingen ook aan proigia_fi_lijst_kwetsbaarheid #}
SELECT
  patient_id,
  AR
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_fi_score_filter.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: CREATE VIEW proigia_fi_verzameltabel
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_fi_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_fiscore.sql

[WARNING] SQL was not modified during conversion
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_fi_meetwaarden_filter_3mt.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE MATERIALIZED VIEW proigia_fi_meetwaarden_3mt AS
SELECT * FROM crosstab(
$$
    SELECT DISTINCT ON (patient_id, nhgnr)
        patient_id,
        nhgnr,
        ARRAY[  uitslag_raw,
                datum::varchar,
                uitslag_waarde] as waarde_datum
    FROM proigia_fi_meetwaarden_filter_3mt
    JOIN proigia_fi_labcodes USING (nhgnr)
    ORDER BY patient_id, nhgnr, datum DESC, uitslag_num DESC nulls last,
            uitslag_raw nulls last, uitslag_waarde nulls last
$$,$$
    SELECT nhgnr
    FROM indelingen.nhg_labcodes
    JOIN proigia_fi_labcodes USING (nhgnr)
    ORDER BY nhgnr
$$
) as ct(
patient_id bigint,
gew_ao varchar[],
quet_ao varchar[],
alco_pq varchar[],
rook_aq varchar[],
rrdi_ka varchar[],
rrsy_ka varchar[],
krem_o_fb varchar[],
gfr_b varchar[],
srda_aq varchar[],
krec_o_fb varchar[],
rost_aq varchar[],
rsto__promed varchar[]);

ANALYZE proigia_fi_meetwaarden_3mt;
Unsupported JOIN found in pivot_statement.
Converted crosstab SQL:

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_fi_meetwaarden_3mt.sql

[WARNING] SQL was not modified during conversion
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_fi_score_filter_3mt.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: CREATE VIEW proigia_fi_verzameltabel_3mt
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_fi_verzameltabel_3mt.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_fiscore_3mt.sql

[WARNING] SQL was not modified during conversion
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_fi_score_filter_3mt_seg2.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: CREATE VIEW proigia_fi_verzameltabel_3mt_seg2
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_fi_verzameltabel_3mt_seg2.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_fiscore_3mt_seg2.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# FI views in dit bestand worden gebruikt voor de bepaling van kwetsbaarheid in de Qlik dashboards.
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_fi_lijst_kwetsbaarheid.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_fi_score_filter_kwetsbaarheid.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW proigia_fi_verzameltabel_kwetsbaarheid AS

SELECT * FROM crosstab(
$$
WITH ficat_series AS
(
    SELECT
        patient_id,
        generate_series(1,50)::varchar AS fi_cat
    FROM proigia_patienten_gegevens
    UNION
    SELECT
        patient_id, 
        'tot'::varchar AS fi_cat
    FROM proigia_patienten_gegevens
)
SELECT
    patient_id,
    fi_cat,
    CASE 
        WHEN fi_cat = 'tot' 
        THEN
            CASE WHEN nrs IS NULL 
            THEN 0
            ELSE array_length(nrs,1)
            END
        WHEN get_number(fi_cat) = ANY(nrs) 
        THEN 1 
        ELSE 0
        END AS fi_cat_ind
    FROM ficat_series
    LEFT JOIN proigia_fi_score_filter USING (patient_id)
    ORDER BY patient_id, fi_cat
Converted crosstab SQL:

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_fi_verzameltabel_kwetsbaarheid.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_fiscore_kwetsbaarheid.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_fi_multidomein_kwetsbaarheid.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Retinopathie/macupathie #}
WITH retino_maculopathie_pre AS (
  SELECT
    patient_id,
    geboort
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_fundus_laatste.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_fundus_labcodes.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {#  Kopie van proigia_meetwaarden_filter (niet exact) #}
{#  LET OP! Deze view is specifiek voor de 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_fundus_mw_filter_22mnd.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW proigia_fundus_22mnd AS
SELECT * FROM crosstab(
$$
    SELECT DISTINCT ON (patient_id, nhgnr)
        patient_id,
        nhgnr,
        ARRAY[  uitslag_raw,
                datum::varchar,
                uitslag_waarde] as waarde_datum
    FROM proigia_fundus_mw_filter_22mnd
    JOIN proigia_fundus_labcodes USING (nhgnr)
    ORDER BY patient_id, nhgnr, datum DESC, uitslag_num DESC nulls last,
            uitslag_raw nulls last, uitslag_waarde nulls last
$$,$$
    SELECT nhgnr
    FROM indelingen.nhg_labcodes
    JOIN proigia_fundus_labcodes USING (nhgnr)
    ORDER BY nhgnr
$$
) as ct(
patient_id bigint,
dmrp_fa_li_22mnd varchar[],
dmrp_fa_re_22mnd varchar[],
dmr7_fa_li_22mnd varchar[],
dmr7_fa_re_22mnd varchar[],
dmma_fa_li_22mnd varchar[],
dmma_fa_re_22mnd varchar[]
);
Unsupported JOIN found in pivot_statement.
Converted crosstab SQL:

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_fundus_22mnd.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_funduscontrole.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_kwetsbaarheid_episode.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_kwetsbaarheid_medicatie_overzicht.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_kwetsbaarheid_ge_lijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_kwetsbaarheid_ge_score.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_kwetsbaarheid_episode_3mnd_6mnd.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_kwetsbaarheid_medicatie_overzicht_3mnd_6mnd.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_kwetsbaarheid_ge_score_3mnd_6mnd.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_griepprik.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_zorgstraten.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW proigia_hoofdbehandelaar AS

SELECT * FROM crosstab($$
WITH alle_hb AS
(
    SELECT
        patient_id,
        nhgnr,
        datum,
        uitslag_raw,
        uitslag_waarde
    FROM proigia_meetwaarden_filter
    WHERE omschrijving ilike '%hoofdbehandelaar%'
),
max_datum_niet_ha AS
(
    SELECT
        patient_id,
        nhgnr,
        max(datum) as max_dd_niet_huisarts
    FROM alle_hb
    WHERE (uitslag_waarde <> 'huisarts' or uitslag_waarde IS NULL)
    GROUP BY patient_id, nhgnr
),
min_datum_wel_ha AS
(
    SELECT
        patient_id,
        nhgnr,
        min(datum) as min_dd_huisarts
    FROM alle_hb
    LEFT JOIN max_datum_niet_ha USING (patient_id, nhgnr)
    WHERE uitslag_waarde = 'huisarts'
    AND (datum >= max_dd_niet_huisarts or max_dd_niet_huisarts IS NULL)
    GROUP BY patient_id, nhgnr
)
SELECT
    patient_id,
    nhgnr,
    ARRAY[min_dd_huisarts, max_dd_niet_huisarts]
FROM min_datum_wel_ha
LEFT JOIN max_datum_niet_ha USING (patient_id, nhgnr)
ORDER BY patient_id, nhgnr
$$,$$
SELECT nhgnr FROM indelingen.nhg_labcodes
JOIN proigia_labcodes USING (nhgnr)
WHERE omschrijving ilike '%hoofdbehandelaar%'
ORDER BY nhgnr
$$) AS (
    patient_id bigint,
    dmhb date[],
    ashb date[],
    cohb date[],
    gzhb date[],
    cvhb date[],
    ozhb date[],
    dchb date[],
    uihb date[],
    skhb date[],
    nfhb date[],
    obhb date[],
    afhb date[],
    oshb date[],
    clhb date[],
    pahb date[],
    czhb date[],
		dehb date[]);
Unsupported JOIN found in pivot_statement.
Converted crosstab SQL:

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_hoofdbehandelaar.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW proigia_zorgweigeraar AS

SELECT * FROM crosstab($$
WITH alle_zw_bepalingen AS
(
    SELECT
        patient_id,
        nhgnr,
        datum,
        uitslag_waarde,
        zorgstraat,
        substring(memo, 3,2) as bepalingtype
    FROM proigia_zorgstraten
    LEFT JOIN proigia_meetwaarden_filter USING (nhgnr)
    WHERE zorgstraat IS NOT NULL
    AND (memo ~ '..cb' OR memo ~ '..rz' OR memo ~ '..kz')
),
min_kz AS
(
    SELECT
        patient_id,
        zorgstraat,
        min(datum) as min_datum_kz
    FROM alle_zw_bepalingen
    WHERE bepalingtype = 'kz'
    GROUP BY patient_id, zorgstraat
),
alle_zw_momenten AS
(
    SELECT
        patient_id,
        nhgnr,
        datum,
        uitslag_waarde,
        zorgstraat,
        bepalingtype,
        CASE WHEN string_to_array('${agb}', ',')::int[] && ARRAY[1053315,1057853,1058365] THEN
					 (CASE WHEN bepalingtype = 'rz' 
						AND uitslag_waarde IS NOT NULL THEN 1
						WHEN bepalingtype = 'cb'
						AND (uitslag_waarde = 'geen programmatische zorg'
							OR uitslag_waarde = 'geen geregelde zorg'
							OR uitslag_waarde = 'geen vast controlebeleid') THEN 1
						WHEN bepalingtype = 'kz' AND uitslag_waarde = 'nee' THEN 1
						ELSE 0 END)
				ELSE (CASE WHEN bepalingtype = 'rz' THEN 1
						WHEN bepalingtype = 'cb'
						AND (uitslag_waarde = 'geen programmatische zorg'
							OR uitslag_waarde = 'geen geregelde zorg'
							OR uitslag_waarde = 'geen vast controlebeleid') THEN 1
						WHEN bepalingtype = 'kz' AND uitslag_waarde = 'nee' THEN 1
						ELSE 0 END)
			END as zorgweigeraar
    FROM alle_zw_bepalingen
    LEFT JOIN min_kz USING (patient_id, zorgstraat)
    WHERE bepalingtype = 'kz'
    OR datum < min_datum_kz
    OR min_datum_kz IS NULL
),
laatste_zw_moment_pppz AS
(
    SELECT distinct on (patient_id, zorgstraat)
        patient_id,
        zorgstraat,
        datum,
        zorgweigeraar
    FROM alle_zw_momenten
    ORDER BY patient_id, zorgstraat, datum DESC, zorgweigeraar DESC
),
zw_laatste_jaar AS
(
    SELECT
        patient_id,
        zorgstraat,
        max(zorgweigeraar) as zw_jaar
    FROM alle_zw_momenten
    WHERE datum >= '${peildatum}'::date-'1 year'::interval
    GROUP BY patient_id, zorgstraat
),
zw_ooit AS
(
    SELECT
        patient_id,
        zorgstraat,
        max(zorgweigeraar) as zw_ooit
    FROM alle_zw_momenten
    GROUP BY patient_id, zorgstraat
)
SELECT
    patient_id,
    zorgstraat,
    ARRAY[zorgweigeraar,
          COALESCE(zw_jaar,zorgweigeraar),
          zw_ooit] as zorgweigeraar
FROM laatste_zw_moment_pppz l
LEFT JOIN zw_laatste_jaar j USING (patient_id, zorgstraat)
LEFT JOIN zw_ooit o USING (patient_id, zorgstraat)
ORDER BY patient_id, zorgstraat
$$,$$
SELECT distinct zorgstraat
FROM proigia_zorgstraten
WHERE zorgstraat IS NOT NULL
ORDER BY zorgstraat
$$) as ct (
    patient_id bigint,
    af_zw int[],
    as_zw int[],
    cl_zw int[],
    co_zw int[],
		de_zw int[],
    dm_zw int[],
    gg_zw int[],
    hf_zw int[],
    hv_zw int[],
    nf_zw int[],
    ob_zw int[],
    os_zw int[],
    oz_zw int[],
    pa_zw int[],
    sk_zw int[],
    ui_zw int[]
);
Unsupported WITH clause or DISTINCT ON found in cte_statement.
Converted crosstab SQL:

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_zorgweigeraar.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW proigia_dubbele_hb AS
SELECT * FROM crosstab($$
WITH alle_hb AS
(
    SELECT
        patient_id,
        memo,
        datum,
        uitslag_waarde
    FROM proigia_meetwaarden_filter
    WHERE omschrijving ilike '%hoofdbehandelaar%'
    ORDER BY patient_id, memo, uitslag_waarde, datum desc
),
grouping_uitslagen AS
(
    SELECT
        patient_id,
        memo,
        datum,
        array_agg(distinct uitslag_waarde) FILTER (WHERE uitslag_waarde IS NOT NULL) as uitslagen
    FROM alle_hb
    GROUP BY patient_id, memo, datum
)
SELECT distinct on (patient_id, memo)
    patient_id,
    memo||'_db',
    ARRAY[CASE WHEN array_length(uitslagen, 1) > 1 THEN 1 ELSE 0 END::varchar,
            datum::varchar, uitslagen::varchar] as dubbel
FROM grouping_uitslagen
ORDER BY patient_id, memo, datum desc
$$,$$
SELECT
    memo||'_db'
FROM indelingen.nhg_labcodes
JOIN proigia_labcodes USING (nhgnr)
WHERE omschrijving ilike '%hoofdbehandelaar%'
ORDER BY memo
$$) as ct(
    patient_id bigint,
    afhb_db varchar[],
    ashb_db varchar[],
    clhb_db varchar[],
    cohb_db varchar[],
    cvhb_db varchar[],
    czhb_db varchar[],
    dchb_db varchar[],
    dehb_db varchar[],
    dmhb_db varchar[],
    gzhb_db varchar[],
    nfhb_db varchar[],
    obhb_db varchar[],
    oshb_db varchar[],
    ozhb_db varchar[],
    pahb_db varchar[],
    skhb_db varchar[],
    uihb_db varchar[]
);
Unsupported JOIN found in pivot_statement.
Converted crosstab SQL:

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_dubbele_hb.sql

Crosstab function detected, converting to dbt-compatible SQL.
	CREATE VIEW proigia_zorgtype AS

	SELECT * FROM crosstab($$
WITH alle_zorgtype_bepalingen AS
(
    SELECT
        patient_id,
        nhgnr,
        datum,
        uitslag_raw,
        uitslag_waarde,
        zorgstraat,
        substring(memo, 3,2) as bepalingtype
    FROM proigia_zorgstraten
    LEFT JOIN proigia_meetwaarden_filter USING (nhgnr)
    WHERE zorgstraat IS NOT NULL
    AND (memo ~ '..cb' OR memo ~ '..kz')
),
min_kz AS
(
    SELECT
        patient_id,
        zorgstraat,
        min(datum) as min_datum_kz
    FROM alle_zorgtype_bepalingen
    WHERE bepalingtype = 'kz'
    GROUP BY patient_id, zorgstraat
),
alle_zorgtype_momenten AS
(
    SELECT
        patient_id,
        nhgnr,
        datum,
        uitslag_waarde,
        zorgstraat,
        bepalingtype
    FROM alle_zorgtype_bepalingen
    LEFT JOIN min_kz USING (patient_id, zorgstraat)
    WHERE bepalingtype = 'kz'
    OR datum < min_datum_kz
    OR min_datum_kz IS NULL
),
laatste_zorgtype_moment AS
(
    SELECT distinct on (patient_id, zorgstraat)
        patient_id,
        zorgstraat,
        datum,
        uitslag_waarde
    FROM alle_zorgtype_momenten
    ORDER BY patient_id, zorgstraat, datum DESC
),
max_datum_gpz AS
(
    SELECT
        patient_id,
        zorgstraat,
        max(datum) as max_dd_gpz
    FROM alle_zorgtype_momenten
    WHERE (uitslag_waarde = 'geen programmatische zorg'
		    OR uitslag_waarde = 'geen geregelde zorg'
			OR uitslag_waarde = 'geen vast controlebeleid'
			OR uitslag_waarde = 'nee')
    GROUP BY patient_id, zorgstraat
),
min_datum_niet_gpz AS
(
    SELECT
        patient_id,
        zorgstraat,
        min(datum) as min_dd_niet_gpz
    FROM alle_zorgtype_momenten
    LEFT JOIN max_datum_gpz USING (patient_id, zorgstraat)
    WHERE uitslag_waarde <> 'geen programmatische zorg'
		AND uitslag_waarde <> 'geen geregelde zorg'
		AND uitslag_waarde <> 'geen vast controlebeleid'
		AND uitslag_waarde <> 'nee'
    AND (datum >= max_dd_gpz or max_dd_gpz IS NULL)
    GROUP BY patient_id, zorgstraat
)
SELECT
    patient_id,
    zorgstraat,
    ARRAY[min_dd_niet_gpz, max_dd_gpz]
FROM laatste_zorgtype_moment
LEFT JOIN min_datum_niet_gpz USING (patient_id, zorgstraat)
LEFT JOIN max_datum_gpz USING (patient_id, zorgstraat)
ORDER BY patient_id, zorgstraat
$$,$$
SELECT distinct zorgstraat
FROM proigia_zorgstraten
WHERE zorgstraat IS NOT NULL
ORDER BY zorgstraat
$$) AS (
    patient_id bigint,
    afcb date[],
    ascb date[],
    clcb date[],
    cocb date[],
		decb date[],
    dmcb date[],
    ggcb date[],
    hfcb date[],
    hvcb date[],
    nfcb date[],
    obcb date[],
    oscb date[],
    ozcb date[],
    pacb date[],
    skcb date[],
    uicb date[]
);
Unsupported WITH clause or DISTINCT ON found in cte_statement.
Converted crosstab SQL:

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_zorgtype.sql

Crosstab function detected, converting to dbt-compatible SQL.
	CREATE VIEW proigia_substitutie AS

	SELECT * FROM crosstab($$
WITH kalenderjaar AS
(
		SELECT CASE WHEN '${peildatum}'::varchar ILIKE '%-01-01'
		 THEN (EXTRACT(year FROM '${peildatum}'::date) - 1)
			ELSE EXTRACT(year FROM '${peildatum}'::date)
			END as kalenderjaar
),
	alle_hb AS
(
    SELECT
        patient_id,
        nhgnr,
        datum,
        uitslag_raw,
        uitslag_waarde
    FROM proigia_meetwaarden_filter
    WHERE omschrijving ilike '%hoofdbehandelaar%'
	    ORDER BY patient_id, nhgnr, uitslag_waarde, datum DESC
),

max_datum_huisarts AS
(
    SELECT distinct on (patient_id, nhgnr)
        patient_id,
        datum as max_dd_huisarts,
        nhgnr
    FROM alle_hb
    WHERE uitslag_waarde='huisarts'
    ORDER BY patient_id, nhgnr, datum DESC
),
min_datum_specialist_na_ha AS
(
    SELECT distinct on (patient_id, nhgnr)
        patient_id,
        datum as min_dd_specialist,
        nhgnr
    FROM alle_hb
    LEFT JOIN max_datum_huisarts USING (patient_id, nhgnr)
    WHERE uitslag_waarde='specialist'
    AND datum > max_dd_huisarts
    ORDER BY patient_id, nhgnr, datum ASC
),
doorverwijzing AS
(
    SELECT
        patient_id,
        1::varchar as doorverwijzing,
        nhgnr
    FROM min_datum_specialist_na_ha mds
	    CROSS JOIN kalenderjaar
    WHERE EXTRACT(year FROM min_dd_specialist) = kalenderjaar
),

max_datum_specialist AS
(
    SELECT distinct on (patient_id, nhgnr)
        patient_id,
        datum AS max_dd_specialist,
        nhgnr
    FROM alle_hb
    WHERE uitslag_waarde='specialist'
    ORDER BY patient_id, nhgnr, datum DESC
),
min_datum_huisarts_na_spec AS
(
    SELECT distinct on (patient_id, nhgnr)
        patient_id,
        datum as min_dd_huisarts,
        nhgnr
    FROM alle_hb
    LEFT JOIN max_datum_specialist USING (patient_id, nhgnr)
    WHERE uitslag_waarde='huisarts'
    AND datum > max_dd_specialist
    ORDER BY patient_id, nhgnr, datum ASC
),
terugverwijzing AS
(
    SELECT
        patient_id,
        1::varchar as terugverwijzing,
        nhgnr
    FROM min_datum_huisarts_na_spec
    CROSS JOIN kalenderjaar
    WHERE EXTRACT(year FROM min_dd_huisarts) = kalenderjaar
),

max_datum_specialist_voor_spec AS
(
    SELECT distinct on (patient_id, nhgnr)
        patient_id,
        datum AS max_dd_specialist,
        min_dd_specialist,
        nhgnr
    FROM alle_hb ah
    LEFT JOIN min_datum_specialist_na_ha USING (patient_id, nhgnr)
    WHERE uitslag_waarde='specialist'
    AND datum < min_dd_specialist
    ORDER BY patient_id, nhgnr, datum DESC
),
min_datum_huisarts_tussen AS
(
    SELECT distinct on (patient_id, nhgnr)
        patient_id,
        datum AS min_dd_huisarts,
        nhgnr
    FROM alle_hb ah
    LEFT JOIN max_datum_specialist_voor_spec USING (patient_id, nhgnr)
    WHERE uitslag_waarde='huisarts'
    AND datum > max_dd_specialist
    ORDER BY patient_id, nhgnr, datum ASC
),
tdverwijzing AS
(
    SELECT
        patient_id,
        1::varchar AS terug_doorverwijzing,
        nhgnr
    FROM min_datum_huisarts_tussen
    LEFT JOIN max_datum_specialist_voor_spec USING (patient_id, nhgnr)
    CROSS JOIN kalenderjaar
    WHERE EXTRACT(year FROM min_dd_huisarts) = kalenderjaar
),
	
max_datum_huisarts_voor_ha AS
	(
    SELECT distinct on (patient_id, nhgnr)
        patient_id,
        datum AS max_dd_huisarts,
        min_dd_huisarts,
        nhgnr
    FROM alle_hb ah
    LEFT JOIN min_datum_huisarts_na_spec USING (patient_id, nhgnr)
    WHERE uitslag_waarde='huisarts'
    AND datum < min_dd_huisarts
    ORDER BY patient_id, nhgnr, datum DESC
),
	min_datum_specialist_tussen AS 
(
    SELECT distinct on (patient_id, nhgnr)
        patient_id,
        datum AS min_dd_specialist,
        nhgnr
    FROM alle_hb ah
    LEFT JOIN max_datum_huisarts_voor_ha USING (patient_id, nhgnr)
    WHERE uitslag_waarde='specialist'
    AND datum > max_dd_huisarts
    ORDER BY patient_id, nhgnr, datum ASC
),
dtverwijzing AS
(
    SELECT
        patient_id,
        1::varchar as door_terugverwijzing,
        nhgnr
    FROM min_datum_specialist_tussen mds
	    CROSS JOIN kalenderjaar
    WHERE EXTRACT(year FROM min_dd_specialist) = kalenderjaar
),
verwijzingen_niet_leeg AS
(
    SELECT
        patient_id,
        nhgnr,
        COALESCE(doorverwijzing,0::varchar) as doorverwijzing,
	        COALESCE(terugverwijzing,0::varchar) as terugverwijzing,
	        COALESCE(terug_doorverwijzing,0::varchar) as terug_doorverwijzing,
	        COALESCE(door_terugverwijzing,0::varchar) as door_terugverwijzing
    FROM doorverwijzing d
    FULL OUTER JOIN terugverwijzing t USING (patient_id, nhgnr)
    FULL OUTER JOIN tdverwijzing td USING (patient_id, nhgnr)
    FULL OUTER JOIN dtverwijzing dt USING (patient_id, nhgnr)
)
SELECT
    patient_id,
    nhgnr,
    ARRAY[doorverwijzing, terugverwijzing, terug_doorverwijzing, door_terugverwijzing]
FROM verwijzingen_niet_leeg
ORDER BY patient_id, nhgnr
$$,$$
SELECT nhgnr FROM indelingen.nhg_labcodes
JOIN proigia_labcodes USING (nhgnr)
WHERE omschrijving ilike '%hoofdbehandelaar%'
ORDER BY nhgnr
$$) AS (
   patient_id bigint,
   dm_verw varchar[],
   as_verw varchar[],
   co_verw varchar[],
   gz_verw varchar[],
   cv_verw varchar[],
   oz_verw varchar[],
   dc_verw varchar[],
   ui_verw varchar[],
   sk_verw varchar[],
   nf_verw varchar[],
   ob_verw varchar[],
   af_verw varchar[],
   os_verw varchar[],
   cl_verw varchar[],
   pa_verw varchar[],
   cz_verw varchar[],
   de_verw varchar[]);
Unsupported JOIN found in pivot_statement.
Converted crosstab SQL:

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_substitutie.sql

Crosstab function detected, converting to dbt-compatible SQL.
	CREATE VIEW proigia_dubbele_deelname_kz AS
SELECT * FROM crosstab($$
WITH alle_kz AS
(
    SELECT
        patient_id,
        memo,
        datum,
        uitslag_waarde
    FROM proigia_meetwaarden_filter
    WHERE omschrijving ilike '%deeln%keten%'
    ORDER BY patient_id, memo, uitslag_waarde, datum desc
),
grouping_uitslagen AS
(
    SELECT
        patient_id,
        memo,
        datum,
        array_agg(distinct uitslag_waarde) FILTER (WHERE uitslag_waarde IS NOT NULL) as uitslagen
    FROM alle_kz
    GROUP BY patient_id, memo, datum
)
SELECT distinct on (patient_id, memo)
    patient_id,
    memo||'_db',
    ARRAY[CASE WHEN array_length(uitslagen, 1) > 1 THEN 1 ELSE 0 END::varchar,
            datum::varchar, uitslagen::varchar] as dubbel
FROM grouping_uitslagen
ORDER BY patient_id, memo, datum desc
$$,$$
SELECT
    memo||'_db'
FROM indelingen.nhg_labcodes
JOIN proigia_labcodes USING (nhgnr)
WHERE omschrijving ilike '%deeln%keten%'
ORDER BY memo
$$) as ct(
    patient_id bigint,
    afkz_db varchar[],
    askz_db varchar[],
    clkz_db varchar[],
    cokz_db varchar[],
    cvkz_db varchar[],
    dckz_db varchar[],
    dekz_db varchar[],
    dmkz_db varchar[],
    gzkz_db varchar[],
    nfkz_db varchar[],
    obkz_db varchar[],
		oskz_db varchar[],
    ozkz_db varchar[],
		pakz_db varchar[],
    skkz_db varchar[],
    uikz_db varchar[]
)
Unsupported JOIN found in pivot_statement.
Converted crosstab SQL:

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_dubbele_deelname_kz.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW proigia_deelname_ketenzorg AS
SELECT * FROM crosstab($$
WITH alle_dk AS
(
    SELECT
        patient_id,
        nhgnr,
        datum,
        uitslag_raw,
        uitslag_waarde
    FROM proigia_meetwaarden_filter
    WHERE omschrijving ilike '%deeln%keten%'
),
max_datum_niet_dk AS
(
    SELECT
        patient_id,
        nhgnr,
        max(datum) as max_dd_niet_dk
    FROM alle_dk
    WHERE (uitslag_waarde <> 'ja' or uitslag_waarde IS NULL)
    GROUP BY patient_id, nhgnr
),
min_datum_wel_dk AS
(
    SELECT
        patient_id,
        nhgnr,
        min(datum) as min_dd_dk
    FROM alle_dk
    LEFT JOIN max_datum_niet_dk USING (patient_id, nhgnr)
    WHERE uitslag_waarde = 'ja'
    AND (datum >= max_dd_niet_dk or max_dd_niet_dk IS NULL)
    GROUP BY patient_id, nhgnr
)
SELECT
    patient_id,
    nhgnr,
    ARRAY[min_dd_dk, max_dd_niet_dk]
FROM min_datum_wel_dk
LEFT JOIN max_datum_niet_dk USING (patient_id, nhgnr)
ORDER BY patient_id, nhgnr
$$,$$
SELECT nhgnr FROM indelingen.nhg_labcodes
JOIN proigia_labcodes USING (nhgnr)
WHERE omschrijving ilike '%deeln%keten%'
ORDER BY nhgnr
$$) AS (
    patient_id bigint,
    dmkz date[],
    askz date[],
    cokz date[],
    cvkz date[],
    gzkz date[],
    ozkz date[],
    dckz date[],
    uikz date[],
    skkz date[],
    nfkz date[],
    obkz date[],     
    afkz date[],
		oskz date[],
    clkz date[],
		pakz date[],
    dekz date[]);
Unsupported JOIN found in pivot_statement.
Converted crosstab SQL:

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_deelname_ketenzorg.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW proigia_hoofdbehandelaar_seg2 AS


SELECT * FROM crosstab($$
WITH alle_hb AS
(
    SELECT
        patient_id,
        nhgnr,
        datum,
        uitslag_raw,
        uitslag_waarde
    FROM proigia_meetwaarden_filter_seg2
    WHERE omschrijving ilike '%hoofdbehandelaar%'
),
max_datum_niet_ha AS
(
    SELECT
        patient_id,
        nhgnr,
        max(datum) as max_dd_niet_huisarts
    FROM alle_hb
    WHERE (uitslag_waarde <> 'huisarts' or uitslag_waarde IS NULL)
    GROUP BY patient_id, nhgnr
),
min_datum_wel_ha AS
(
    SELECT
        patient_id,
        nhgnr,
        min(datum) as min_dd_huisarts
    FROM alle_hb
    LEFT JOIN max_datum_niet_ha USING (patient_id, nhgnr)
    WHERE uitslag_waarde = 'huisarts'
    AND (datum >= max_dd_niet_huisarts or max_dd_niet_huisarts IS NULL)
    GROUP BY patient_id, nhgnr
)
SELECT
    patient_id,
    nhgnr,
    ARRAY[min_dd_huisarts, max_dd_niet_huisarts]
FROM min_datum_wel_ha
LEFT JOIN max_datum_niet_ha USING (patient_id, nhgnr)
ORDER BY patient_id, nhgnr
$$,$$
SELECT nhgnr FROM indelingen.nhg_labcodes
JOIN proigia_labcodes_seg2 USING (nhgnr)
WHERE omschrijving ilike '%hoofdbehandelaar%'
ORDER BY nhgnr
$$) AS (
    patient_id bigint,
    dmhb date[],
    ashb date[],
    cohb date[],
    gzhb date[],
    cvhb date[],
    ozhb date[],
    dchb date[],
    uihb date[],
    skhb date[],
    nfhb date[],
    obhb date[],
    afhb date[],
    oshb date[],
    clhb date[],
    pahb date[],
    czhb date[],
    dehb date[],
    adhb date[]);
Unsupported JOIN found in pivot_statement.
Converted crosstab SQL:

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_hoofdbehandelaar_seg2.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW proigia_zorgweigeraar_seg2 AS


SELECT * FROM crosstab($$
WITH alle_zw_bepalingen AS
(
    SELECT
        patient_id,
        nhgnr,
        datum,
        uitslag_waarde,
        zorgstraat,
        substring(memo, 3,2) as bepalingtype
    FROM proigia_zorgstraten
    LEFT JOIN proigia_meetwaarden_filter_seg2 USING (nhgnr)
    WHERE zorgstraat IS NOT NULL
    AND (memo ~ '..cb' OR memo ~ '..rz' OR memo ~ '..kz')
),
min_kz AS
(
    SELECT
        patient_id,
        zorgstraat,
        min(datum) as min_datum_kz
    FROM alle_zw_bepalingen
    WHERE bepalingtype = 'kz'
    GROUP BY patient_id, zorgstraat
),
alle_zw_momenten AS
(
    SELECT
        patient_id,
        nhgnr,
        datum,
        uitslag_waarde,
        zorgstraat,
        bepalingtype,
        CASE WHEN string_to_array('${agb}', ',')::int[] && ARRAY[1053315,1057853,1058365] THEN
					 (CASE WHEN bepalingtype = 'rz' 
						AND uitslag_waarde IS NOT NULL THEN 1
						WHEN bepalingtype = 'cb'
						AND (uitslag_waarde = 'geen programmatische zorg'
							OR uitslag_waarde = 'geen geregelde zorg'
							OR uitslag_waarde = 'geen vast controlebeleid') THEN 1
						WHEN bepalingtype = 'kz' AND uitslag_waarde = 'nee' THEN 1
						ELSE 0 END)
				ELSE (CASE WHEN bepalingtype = 'rz' THEN 1
						WHEN bepalingtype = 'cb'
						AND (uitslag_waarde = 'geen programmatische zorg'
							OR uitslag_waarde = 'geen geregelde zorg'
							OR uitslag_waarde = 'geen vast controlebeleid') THEN 1
						WHEN bepalingtype = 'kz' AND uitslag_waarde = 'nee' THEN 1
						ELSE 0 END)
			END as zorgweigeraar
    FROM alle_zw_bepalingen
    LEFT JOIN min_kz USING (patient_id, zorgstraat)
    WHERE bepalingtype = 'kz'
    OR datum < min_datum_kz
    OR min_datum_kz IS NULL
),
laatste_zw_moment_pppz AS
(
    SELECT distinct on (patient_id, zorgstraat)
        patient_id,
        zorgstraat,
        datum,
        zorgweigeraar
    FROM alle_zw_momenten
    ORDER BY patient_id, zorgstraat, datum DESC, zorgweigeraar DESC
),
zw_laatste_jaar AS
(
    SELECT
        patient_id,
        zorgstraat,
        max(zorgweigeraar) as zw_jaar
    FROM alle_zw_momenten
    WHERE datum >= '${peildatum}'::date-'1 year'::interval
    GROUP BY patient_id, zorgstraat
),
zw_ooit AS
(
    SELECT
        patient_id,
        zorgstraat,
        max(zorgweigeraar) as zw_ooit
    FROM alle_zw_momenten
    GROUP BY patient_id, zorgstraat
)
SELECT
    patient_id,
    zorgstraat,
    ARRAY[zorgweigeraar,
          COALESCE(zw_jaar,zorgweigeraar),
          zw_ooit] as zorgweigeraar
FROM laatste_zw_moment_pppz l
LEFT JOIN zw_laatste_jaar j USING (patient_id, zorgstraat)
LEFT JOIN zw_ooit o USING (patient_id, zorgstraat)
ORDER BY patient_id, zorgstraat
$$,$$
SELECT distinct zorgstraat
FROM proigia_zorgstraten
WHERE zorgstraat IS NOT NULL
ORDER BY zorgstraat
$$) as ct (
    patient_id bigint,
    af_zw int[],
    as_zw int[],
    cl_zw int[],
    co_zw int[],
		de_zw int[],
    dm_zw int[],
    gg_zw int[],
    hf_zw int[],
    hv_zw int[],
    nf_zw int[],
    ob_zw int[],
    os_zw int[],
    oz_zw int[],
    pa_zw int[],
    sk_zw int[],
    ui_zw int[]
);
Unsupported WITH clause or DISTINCT ON found in cte_statement.
Converted crosstab SQL:

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_zorgweigeraar_seg2.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW proigia_dubbele_hb_seg2 AS


SELECT * FROM crosstab($$
WITH alle_hb AS
(
    SELECT
        patient_id,
        memo,
        datum,
        uitslag_waarde
    FROM proigia_meetwaarden_filter_seg2
    WHERE omschrijving ilike '%hoofdbehandelaar%'
    ORDER BY patient_id, memo, uitslag_waarde, datum desc
),
grouping_uitslagen AS
(
    SELECT
        patient_id,
        memo,
        datum,
        array_agg(distinct uitslag_waarde) FILTER (WHERE uitslag_waarde IS NOT NULL) as uitslagen
    FROM alle_hb
    GROUP BY patient_id, memo, datum
)
SELECT distinct on (patient_id, memo)
    patient_id,
    memo||'_db',
    ARRAY[CASE WHEN array_length(uitslagen, 1) > 1 THEN 1 ELSE 0 END::varchar,
            datum::varchar, uitslagen::varchar] as dubbel
FROM grouping_uitslagen
ORDER BY patient_id, memo, datum desc
$$,$$
SELECT
    memo||'_db'
FROM indelingen.nhg_labcodes
JOIN proigia_labcodes_seg2 USING (nhgnr)
WHERE omschrijving ilike '%hoofdbehandelaar%'
ORDER BY memo
$$) as ct(
    patient_id bigint,
    adhb_db varchar[],
    afhb_db varchar[],
    ashb_db varchar[],
    clhb_db varchar[],
    cohb_db varchar[],
    cvhb_db varchar[],
    czhb_db varchar[],
    dchb_db varchar[],
    dehb_db varchar[],
    dmhb_db varchar[],
    gzhb_db varchar[],
    nfhb_db varchar[],
    obhb_db varchar[],
    oshb_db varchar[],
    ozhb_db varchar[],
    pahb_db varchar[],
    skhb_db varchar[],
    uihb_db varchar[]
);
Unsupported JOIN found in pivot_statement.
Converted crosstab SQL:

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_dubbele_hb_seg2.sql

Crosstab function detected, converting to dbt-compatible SQL.
	CREATE VIEW proigia_zorgtype_seg2 AS


	SELECT * FROM crosstab($$
WITH alle_zorgtype_bepalingen AS
(
    SELECT
        patient_id,
        nhgnr,
        datum,
        uitslag_raw,
        uitslag_waarde,
        zorgstraat,
        substring(memo, 3,2) as bepalingtype
    FROM proigia_zorgstraten
    LEFT JOIN proigia_meetwaarden_filter_seg2 USING (nhgnr)
    WHERE zorgstraat IS NOT NULL
    AND (memo ~ '..cb' OR memo ~ '..kz')
),
min_kz AS
(
    SELECT
        patient_id,
        zorgstraat,
        min(datum) as min_datum_kz
    FROM alle_zorgtype_bepalingen
    WHERE bepalingtype = 'kz'
    GROUP BY patient_id, zorgstraat
),
alle_zorgtype_momenten AS
(
    SELECT
        patient_id,
        nhgnr,
        datum,
        uitslag_waarde,
        zorgstraat,
        bepalingtype
    FROM alle_zorgtype_bepalingen
    LEFT JOIN min_kz USING (patient_id, zorgstraat)
    WHERE bepalingtype = 'kz'
    OR datum < min_datum_kz
    OR min_datum_kz IS NULL
),
laatste_zorgtype_moment AS
(
    SELECT distinct on (patient_id, zorgstraat)
        patient_id,
        zorgstraat,
        datum,
        uitslag_waarde
    FROM alle_zorgtype_momenten
    ORDER BY patient_id, zorgstraat, datum DESC
),
max_datum_gpz AS
(
    SELECT
        patient_id,
        zorgstraat,
        max(datum) as max_dd_gpz
    FROM alle_zorgtype_momenten
    WHERE (uitslag_waarde = 'geen programmatische zorg'
		    OR uitslag_waarde = 'geen geregelde zorg'
			OR uitslag_waarde = 'geen vast controlebeleid'
			OR uitslag_waarde = 'nee')
    GROUP BY patient_id, zorgstraat
),
min_datum_niet_gpz AS
(
    SELECT
        patient_id,
        zorgstraat,
        min(datum) as min_dd_niet_gpz
    FROM alle_zorgtype_momenten
    LEFT JOIN max_datum_gpz USING (patient_id, zorgstraat)
    WHERE uitslag_waarde <> 'geen programmatische zorg'
		AND uitslag_waarde <> 'geen geregelde zorg'
		AND uitslag_waarde <> 'geen vast controlebeleid'
		AND uitslag_waarde <> 'nee'
    AND (datum >= max_dd_gpz or max_dd_gpz IS NULL)
    GROUP BY patient_id, zorgstraat
)
SELECT
    patient_id,
    zorgstraat,
    ARRAY[min_dd_niet_gpz, max_dd_gpz]
FROM laatste_zorgtype_moment
LEFT JOIN min_datum_niet_gpz USING (patient_id, zorgstraat)
LEFT JOIN max_datum_gpz USING (patient_id, zorgstraat)
ORDER BY patient_id, zorgstraat
$$,$$
SELECT distinct zorgstraat
FROM proigia_zorgstraten
WHERE zorgstraat IS NOT NULL
ORDER BY zorgstraat
$$) AS (
    patient_id bigint,
    afcb date[],
    ascb date[],
    clcb date[],
    cocb date[],
		decb date[],
    dmcb date[],
    ggcb date[],
    hfcb date[],
    hvcb date[],
    nfcb date[],
    obcb date[],
    oscb date[],
    ozcb date[],
    pacb date[],
    skcb date[],
    uicb date[]
);
Unsupported WITH clause or DISTINCT ON found in cte_statement.
Converted crosstab SQL:

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_zorgtype_seg2.sql

Crosstab function detected, converting to dbt-compatible SQL.

	CREATE VIEW proigia_substitutie_seg2 AS


	SELECT * FROM crosstab($$
WITH kalenderjaar AS
(
		SELECT CASE WHEN '${peildatum}'::varchar ILIKE '%-01-01'
		 THEN (EXTRACT(year FROM '${peildatum}'::date) - 1)
			ELSE EXTRACT(year FROM '${peildatum}'::date)
			END as kalenderjaar
),
	alle_hb AS
(
    SELECT
        patient_id,
        nhgnr,
        datum,
        uitslag_raw,
        uitslag_waarde
    FROM proigia_meetwaarden_filter_seg2
    WHERE omschrijving ilike '%hoofdbehandelaar%'
	    ORDER BY patient_id, nhgnr, uitslag_waarde, datum DESC
),

max_datum_huisarts AS
(
    SELECT distinct on (patient_id, nhgnr)
        patient_id,
        datum as max_dd_huisarts,
        nhgnr
    FROM alle_hb
    WHERE uitslag_waarde='huisarts'
    ORDER BY patient_id, nhgnr, datum DESC
),
min_datum_specialist_na_ha AS
(
    SELECT distinct on (patient_id, nhgnr)
        patient_id,
        datum as min_dd_specialist,
        nhgnr
    FROM alle_hb
    LEFT JOIN max_datum_huisarts USING (patient_id, nhgnr)
    WHERE uitslag_waarde='specialist'
    AND datum > max_dd_huisarts
    ORDER BY patient_id, nhgnr, datum ASC
),
doorverwijzing AS
(
    SELECT
        patient_id,
        1::varchar as doorverwijzing,
        nhgnr
    FROM min_datum_specialist_na_ha mds
	    CROSS JOIN kalenderjaar
    WHERE EXTRACT(year FROM min_dd_specialist) = kalenderjaar
),

max_datum_specialist AS
(
    SELECT distinct on (patient_id, nhgnr)
        patient_id,
        datum AS max_dd_specialist,
        nhgnr
    FROM alle_hb
    WHERE uitslag_waarde='specialist'
    ORDER BY patient_id, nhgnr, datum DESC
),
min_datum_huisarts_na_spec AS
(
    SELECT distinct on (patient_id, nhgnr)
        patient_id,
        datum as min_dd_huisarts,
        nhgnr
    FROM alle_hb
    LEFT JOIN max_datum_specialist USING (patient_id, nhgnr)
    WHERE uitslag_waarde='huisarts'
    AND datum > max_dd_specialist
    ORDER BY patient_id, nhgnr, datum ASC
),
terugverwijzing AS
(
    SELECT
        patient_id,
        1::varchar as terugverwijzing,
        nhgnr
    FROM min_datum_huisarts_na_spec
    CROSS JOIN kalenderjaar
    WHERE EXTRACT(year FROM min_dd_huisarts) = kalenderjaar
),

max_datum_specialist_voor_spec AS
(
    SELECT distinct on (patient_id, nhgnr)
        patient_id,
        datum AS max_dd_specialist,
        min_dd_specialist,
        nhgnr
    FROM alle_hb ah
    LEFT JOIN min_datum_specialist_na_ha USING (patient_id, nhgnr)
    WHERE uitslag_waarde='specialist'
    AND datum < min_dd_specialist
    ORDER BY patient_id, nhgnr, datum DESC
),
min_datum_huisarts_tussen AS
(
    SELECT distinct on (patient_id, nhgnr)
        patient_id,
        datum AS min_dd_huisarts,
        nhgnr
    FROM alle_hb ah
    LEFT JOIN max_datum_specialist_voor_spec USING (patient_id, nhgnr)
    WHERE uitslag_waarde='huisarts'
    AND datum > max_dd_specialist
    ORDER BY patient_id, nhgnr, datum ASC
),
tdverwijzing AS
(
    SELECT
        patient_id,
        1::varchar AS terug_doorverwijzing,
        nhgnr
    FROM min_datum_huisarts_tussen
    LEFT JOIN max_datum_specialist_voor_spec USING (patient_id, nhgnr)
    CROSS JOIN kalenderjaar
    WHERE EXTRACT(year FROM min_dd_huisarts) = kalenderjaar
),
	
max_datum_huisarts_voor_ha AS
	(
    SELECT distinct on (patient_id, nhgnr)
        patient_id,
        datum AS max_dd_huisarts,
        min_dd_huisarts,
        nhgnr
    FROM alle_hb ah
    LEFT JOIN min_datum_huisarts_na_spec USING (patient_id, nhgnr)
    WHERE uitslag_waarde='huisarts'
    AND datum < min_dd_huisarts
    ORDER BY patient_id, nhgnr, datum DESC
),
	min_datum_specialist_tussen AS 
(
    SELECT distinct on (patient_id, nhgnr)
        patient_id,
        datum AS min_dd_specialist,
        nhgnr
    FROM alle_hb ah
    LEFT JOIN max_datum_huisarts_voor_ha USING (patient_id, nhgnr)
    WHERE uitslag_waarde='specialist'
    AND datum > max_dd_huisarts
    ORDER BY patient_id, nhgnr, datum ASC
),
dtverwijzing AS
(
    SELECT
        patient_id,
        1::varchar as door_terugverwijzing,
        nhgnr
    FROM min_datum_specialist_tussen mds
	    CROSS JOIN kalenderjaar
    WHERE EXTRACT(year FROM min_dd_specialist) = kalenderjaar
),
verwijzingen_niet_leeg AS
(
    SELECT
        patient_id,
        nhgnr,
        COALESCE(doorverwijzing,0::varchar) as doorverwijzing,
	        COALESCE(terugverwijzing,0::varchar) as terugverwijzing,
	        COALESCE(terug_doorverwijzing,0::varchar) as terug_doorverwijzing,
	        COALESCE(door_terugverwijzing,0::varchar) as door_terugverwijzing
    FROM doorverwijzing d
    FULL OUTER JOIN terugverwijzing t USING (patient_id, nhgnr)
    FULL OUTER JOIN tdverwijzing td USING (patient_id, nhgnr)
    FULL OUTER JOIN dtverwijzing dt USING (patient_id, nhgnr)
)
SELECT
    patient_id,
    nhgnr,
    ARRAY[doorverwijzing, terugverwijzing, terug_doorverwijzing, door_terugverwijzing]
FROM verwijzingen_niet_leeg
ORDER BY patient_id, nhgnr
$$,$$
SELECT nhgnr FROM indelingen.nhg_labcodes
JOIN proigia_labcodes_seg2 USING (nhgnr)
WHERE omschrijving ilike '%hoofdbehandelaar%'
ORDER BY nhgnr
$$) AS (
   patient_id bigint,
   dm_verw varchar[],
   as_verw varchar[],
   co_verw varchar[],
   gz_verw varchar[],
   cv_verw varchar[],
   oz_verw varchar[],
   dc_verw varchar[],
   ui_verw varchar[],
   sk_verw varchar[],
   nf_verw varchar[],
   ob_verw varchar[],
   af_verw varchar[],
   os_verw varchar[],
   cl_verw varchar[],
   pa_verw varchar[],
   cz_verw varchar[],
   de_verw varchar[],
   ad_verw varchar[]);
Unsupported JOIN found in pivot_statement.
Converted crosstab SQL:

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_substitutie_seg2.sql

Crosstab function detected, converting to dbt-compatible SQL.
	CREATE VIEW proigia_dubbele_deelname_kz_seg2 AS


SELECT * FROM crosstab($$
WITH alle_kz AS
(
    SELECT
        patient_id,
        memo,
        datum,
        uitslag_waarde
    FROM proigia_meetwaarden_filter_seg2
    WHERE omschrijving ILIKE '%deeln%keten%'
    ORDER BY patient_id, memo, uitslag_waarde, datum desc
),
grouping_uitslagen AS
(
    SELECT
        patient_id,
        memo,
        datum,
        array_agg(distinct uitslag_waarde) FILTER (WHERE uitslag_waarde IS NOT NULL) as uitslagen
    FROM alle_kz
    GROUP BY patient_id, memo, datum
)
SELECT distinct on (patient_id, memo)
    patient_id,
    memo||'_db',
    ARRAY[CASE WHEN array_length(uitslagen, 1) > 1 THEN 1 ELSE 0 END::varchar,
            datum::varchar, uitslagen::varchar] as dubbel
FROM grouping_uitslagen
ORDER BY patient_id, memo, datum desc
$$,$$
SELECT
    memo||'_db'
FROM indelingen.nhg_labcodes
JOIN proigia_labcodes_seg2 USING (nhgnr)
WHERE omschrijving ILIKE '%deeln%keten%'
ORDER BY memo
$$) as ct(
    patient_id bigint,
    afkz_db varchar[],
    askz_db varchar[],
    clkz_db varchar[],
    cokz_db varchar[],
    cvkz_db varchar[],
    dckz_db varchar[],
    dekz_db varchar[],
    dmkz_db varchar[],
    gzkz_db varchar[],
    nfkz_db varchar[],
    obkz_db varchar[],
		oskz_db varchar[],
    ozkz_db varchar[],
		pakz_db varchar[],
    skkz_db varchar[],
    uikz_db varchar[]
)
Unsupported JOIN found in pivot_statement.
Converted crosstab SQL:

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_dubbele_deelname_kz_seg2.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW proigia_deelname_ketenzorg_seg2 AS
SELECT * FROM crosstab($$
WITH alle_dk AS
(
    SELECT
        patient_id,
        nhgnr,
        datum,
        uitslag_raw,
        uitslag_waarde
    FROM proigia_meetwaarden_filter_seg2
    WHERE omschrijving ILIKE '%deeln%keten%'
),
max_datum_niet_dk AS
(
    SELECT
        patient_id,
        nhgnr,
        max(datum) as max_dd_niet_dk
    FROM alle_dk
    WHERE (uitslag_waarde <> 'ja' or uitslag_waarde IS NULL)
    GROUP BY patient_id, nhgnr
),
min_datum_wel_dk AS
(
    SELECT
        patient_id,
        nhgnr,
        min(datum) as min_dd_dk
    FROM alle_dk
    LEFT JOIN max_datum_niet_dk USING (patient_id, nhgnr)
    WHERE uitslag_waarde = 'ja'
    AND (datum >= max_dd_niet_dk or max_dd_niet_dk IS NULL)
    GROUP BY patient_id, nhgnr
)
SELECT
    patient_id,
    nhgnr,
    ARRAY[min_dd_dk, max_dd_niet_dk]
FROM min_datum_wel_dk
LEFT JOIN max_datum_niet_dk USING (patient_id, nhgnr)
ORDER BY patient_id, nhgnr
$$,$$
SELECT nhgnr FROM indelingen.nhg_labcodes
JOIN proigia_labcodes_seg2 USING (nhgnr)
WHERE omschrijving ILIKE '%deeln%keten%'
ORDER BY nhgnr
$$) AS (
    patient_id bigint,
    dmkz date[],
    askz date[],
    cokz date[],
    cvkz date[],
    gzkz date[],
    ozkz date[],
    dckz date[],
    uikz date[],
    skkz date[],
    nfkz date[],
    obkz date[],     
    afkz date[],
		oskz date[],
    clkz date[],
		pakz date[],
    dekz date[]);
Unsupported JOIN found in pivot_statement.
Converted crosstab SQL:

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_deelname_ketenzorg_seg2.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# medewerkers uit medewerkerbeheer en hun his-naam #}
WITH medewerker_nieuw AS (
  SELECT
    m.naa
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_medewerker.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_atc_codes.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_medicatie_filter.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW proigia_medicatie AS
SELECT * FROM crosstab($$
    SELECT
        patient_id,
        categorie,
        ARRAY[
            count(*)::varchar,
            max(voorschrijfdatum)::varchar,
            min(voorschrijfdatum)::varchar,
            array_agg(distinct atc_code)::varchar,
            max(actueel)::varchar] as resultaat
    FROM proigia_medicatie_filter
    GROUP BY patient_id, categorie
    ORDER BY patient_id, categorie
$$,$$
    SELECT atc FROM proigia_atc_codes ORDER BY atc
$$) as
(
    patient_id bigint,
Converted crosstab SQL:

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_medicatie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_chronische_medicatie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_actuele_medicatie.sql

[WARNING] SQL was not modified during conversion
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_polyfarmacie.sql

[WARNING] SQL was not modified during conversion
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_polyfarmacie_2jr.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_medicatie_categorie.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# LET OP: deze view kijkt alleen naar omschrijvingen met MG of mg. #} {# Product_sterkte wordt gebr
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_medicatie_dosis.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_medicatie_doac.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_atc_codes_2jr.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_medicatie_filter_2jr.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW proigia_medicatie_2jr AS
SELECT * FROM crosstab($$
    SELECT
        patient_id,
        categorie,
        ARRAY[
            count(*)::varchar,
            max(voorschrijfdatum)::varchar,
            min(voorschrijfdatum)::varchar,
            array_agg(distinct atc_code)::varchar
            ] as resultaat
    FROM proigia_medicatie_filter_2jr
    GROUP BY patient_id, categorie
    ORDER BY patient_id, categorie
$$,$$
    SELECT atc FROM proigia_atc_codes_2jr ORDER BY atc
$$) as
(
    patient_id bigint,
		a02 varchar[],
 		a02ba varchar[],
 		a02bc varchar[],
 		a02bc01 varchar[],
 		a02bc02 varchar[],
 		a10 varchar[],
 		a10a varchar[],
 		a10ab varchar[],
 		a10ab01 varchar[],
 		a10ab04 varchar[],
 		a10ab05 varchar[],
 		a10ab06 varchar[],
 		a10ac varchar[],
 		a10ac01 varchar[],
 		a10ad varchar[],
 		a10ad01 varchar[],
 		a10ad04 varchar[],
 		a10ad05 varchar[],
 		a10ad06 varchar[],
 		a10ae varchar[],
 		a10ae04 varchar[],
 		a10ae05 varchar[],
 		a10ae06 varchar[],
 		a10ae54 varchar[],
 		a10ae56 varchar[],
 		a10b varchar[],
 		a10ba varchar[],
 		a10ba02 varchar[],
 		a10bb varchar[],
 		a10bb01 varchar[],
 		a10bb03 varchar[],
 		a10bb09 varchar[],
 		a10bb12 varchar[],
 		a10bd varchar[],
 		a10bd02 varchar[],
 		a10bd03 varchar[],
 		a10bd05 varchar[],
 		a10bd07 varchar[],
 		a10bd08 varchar[],
 		a10bd10 varchar[],
 		a10bd11 varchar[],
 		a10bd15 varchar[],
 		a10bd16 varchar[],
 		a10bd20 varchar[],
 		a10bf varchar[],
 		a10bf01 varchar[],
 		a10bg varchar[],
 		a10bg03 varchar[],
 		a10bh varchar[],
 		a10bh01 varchar[],
 		a10bh02 varchar[],
 		a10bh03 varchar[],
 		a10bh05 varchar[],
 		a10bj varchar[],
 		a10bj01 varchar[],
 		a10bj02 varchar[],
 		a10bj03 varchar[],
 		a10bj05 varchar[],
 		a10bk varchar[],
 		a10bk01 varchar[],
 		a10bk02 varchar[],
 		a10bk03 varchar[],
 		a10bx varchar[],
 		a10bx02 varchar[],
 		b01 varchar[],
 		b01a varchar[],
 		b01aa varchar[],
 		b01aa03 varchar[],
 		b01aa04 varchar[],
 		b01aa07 varchar[],
 		b01ab varchar[],
 		b01ab01 varchar[],
 		b01ab02 varchar[],
 		b01ab03 varchar[],
 		b01ab04 varchar[],
 		b01ab05 varchar[],
 		b01ab06 varchar[],
 		b01ab09 varchar[],
 		b01ab10 varchar[],
 		b01ac varchar[],
 		b01ac01 varchar[],
 		b01ac04 varchar[],
 		b01ac05 varchar[],
 		b01ac06 varchar[],
 		b01ac07 varchar[],
 		b01ac08 varchar[],
 		b01ac09 varchar[],
 		b01ac11 varchar[],
 		b01ac13 varchar[],
 		b01ac14 varchar[],
 		b01ac16 varchar[],
 		b01ac17 varchar[],
 		b01ac21 varchar[],
 		b01ac22 varchar[],
 		b01ac24 varchar[],
 		b01ac27 varchar[],
 		b01ac30 varchar[],
 		b01ac56 varchar[],
 		b01ad varchar[],
 		b01ad02 varchar[],
 		b01ad04 varchar[],
 		b01ad11 varchar[],
 		b01ad12 varchar[],
 		b01ae varchar[],
 		b01ae07 varchar[],
 		b01af varchar[],
 		b01af01 varchar[],
 		b01af02 varchar[],
 		b01af03 varchar[],
 		b01ax varchar[],
 		b01ax05 varchar[],
 		b01ax06 varchar[],
 		b03 varchar[],
 		b03x varchar[],
 		b03xa varchar[],
 		b03xa01 varchar[],
 		c01 varchar[],
 		c01a varchar[],
 		c01aa varchar[],
 		c01aa05 varchar[],
 		c01b varchar[],
 		c01ba varchar[],
 		c01ba01 varchar[],
 		c01bc varchar[],
 		c01bc04 varchar[],
 		c01bd varchar[],
 		c01bd01 varchar[],
 		c01bd05 varchar[],
 		c01c varchar[],
 		c01ca varchar[],
 		c01ca24 varchar[],
 		c01da varchar[],
 		c01da01 varchar[],
 		c01da02 varchar[],
 		c01da08 varchar[],
 		c01da14 varchar[],
 		c02 varchar[],
 		c02a varchar[],
 		c02ab varchar[],
 		c02ab01 varchar[],
 		c02ac varchar[],
 		c02ac05 varchar[],
 		c02c varchar[],
 		c02ca varchar[],
 		c02ca04 varchar[],
 		c02cd varchar[],
 		c02ck varchar[],
 		c02d varchar[],
 		c02db02 varchar[],
 		c02dc01 varchar[],
 		c02k varchar[],
 		c02kd01 varchar[],
 		c02kx02 varchar[],
 		c02kx04 varchar[],
 		c03 varchar[],
 		c03a varchar[],
 		c03aa varchar[],
 		c03aa03 varchar[],
 		c03b varchar[],
 		c03ba04 varchar[],
 		c03ba11 varchar[],
 		c03c varchar[],
 		c03ca varchar[],
 		c03ca01 varchar[],
 		c03cb varchar[],
 		c03cc varchar[],
 		c03d varchar[],
 		c03da varchar[],
 		c03da01 varchar[],
 		c04 varchar[],
 		c04a varchar[],
 		c04ab01 varchar[],
 		c04ca varchar[],
 		c05 varchar[],
 		c06 varchar[],
 		c07 varchar[],
 		c07a varchar[],
 		c07aa varchar[],
 		c07aa03 varchar[],
 		c07aa05 varchar[],
 		c07aa07 varchar[],
 		c07ab varchar[],
 		c07ab02 varchar[],
 		c07ab03 varchar[],
 		c07ab04 varchar[],
 		c07ab09 varchar[],
 		c07ab12 varchar[],
 		c07ag01 varchar[],
 		c07ag02 varchar[],
 		c07b varchar[],
 		c07bb02 varchar[],
 		c07ca varchar[],
 		c07cb varchar[],
 		c08 varchar[],
 		c08c varchar[],
 		c08ca02 varchar[],
 		c08ca03 varchar[],
 		c08ca04 varchar[],
 		c08ca05 varchar[],
 		c08ca08 varchar[],
 		c08ca09 varchar[],
 		c08ca13 varchar[],
 		c08cc varchar[],
 		c08d varchar[],
 		c08da varchar[],
 		c08da01 varchar[],
 		c08db varchar[],
 		c08db01 varchar[],
 		c09 varchar[],
 		c09a varchar[],
 		c09aa varchar[],
 		c09aa01 varchar[],
 		c09aa02 varchar[],
 		c09aa03 varchar[],
 		c09aa04 varchar[],
 		c09aa05 varchar[],
 		c09aa09 varchar[],
 		c09b varchar[],
 		c09ba02 varchar[],
 		c09ba03 varchar[],
 		c09ba04 varchar[],
 		c09ba09 varchar[],
 		c09bb02 varchar[],
 		c09bb04 varchar[],
 		c09bx01 varchar[],
 		c09c varchar[],
 		c09ca varchar[],
 		c09ca01 varchar[],
 		c09ca02 varchar[],
 		c09ca03 varchar[],
 		c09ca04 varchar[],
 		c09ca06 varchar[],
 		c09ca07 varchar[],
 		c09ca08 varchar[],
 		c09cb varchar[],
 		c09cc varchar[],
 		c09cd varchar[],
 		c09cx varchar[],
 		c09d varchar[],
 		c09da01 varchar[],
 		c09da02 varchar[],
 		c09da03 varchar[],
 		c09da04 varchar[],
 		c09da06 varchar[],
 		c09da07 varchar[],
 		c09da08 varchar[],
 		c09db02 varchar[],
 		c09dx03 varchar[],
 		c09x varchar[],
 		c09xa02 varchar[],
 		c09xa52 varchar[],
 		c10 varchar[],
 		c10a varchar[],
 		c10aa varchar[],
 		c10aa01 varchar[],
 		c10aa03 varchar[],
 		c10aa05 varchar[],
 		c10aa07 varchar[],
 		c10ab varchar[],
 		c10ab04 varchar[],
 		c10ax varchar[],
 		c10ax09 varchar[],
 		c10ax13 varchar[],
 		c10b varchar[],
 		c10ba varchar[],
 		c10ba02 varchar[],
 		c10ba05 varchar[],
 		h01 varchar[],
 		h01b varchar[],
 		h01ba varchar[],
 		h01ba02 varchar[],
 		h02 varchar[],
 		h02a varchar[],
 		h02ab varchar[],
 		h02ab01 varchar[],
 		h02ab02 varchar[],
 		h02ab04 varchar[],
 		h02ab06 varchar[],
 		h02ab07 varchar[],
 		h02ab08 varchar[],
 		h02ab09 varchar[],
 		h06ab06 varchar[],
 		h06ab07 varchar[],
 		j01 varchar[],
 		j01aa02 varchar[],
 		j01ce02 varchar[],
 		j01ce05 varchar[],
 		j01cf02 varchar[],
 		j01cf05 varchar[],
 		j01ea01 varchar[],
 		j01ma02 varchar[],
 		j01xe01 varchar[],
 		j07bb varchar[],
 		m01a varchar[],
 		m01ab05 varchar[],
 		m01ab51 varchar[],
 		m01ab55 varchar[],
 		m01ae01 varchar[],
 		m01ae02 varchar[],
 		m01ae52 varchar[],
 		m01ba03 varchar[],
 		m05 varchar[],
 		n02ab varchar[],
 		n02ba varchar[],
 		n02be51 varchar[],
 		n02cc varchar[],
 		n05a varchar[],
    n05ad06 varchar[],
    n05ae03 varchar[],
    n05ae05 varchar[],
    n05ah02 varchar[],
    n05ah03 varchar[], 
    n05ah04 varchar[],
    n05al01 varchar[],
    n05al05 varchar[],
    n05ax08 varchar[],
    n05ax12 varchar[], 
    n05ax13 varchar[], 
    n05ax15 varchar[], 
    n05ax16 varchar[],
 		n05c varchar[],
 		n06a varchar[],
 		n06aa varchar[],
 		n06ab varchar[],
 		n06ax05 varchar[],
 		n06ax16 varchar[],
 		n06ax21 varchar[],
 		n07ba varchar[],
 		r03 varchar[],
 		r03a varchar[],
 		r03ac varchar[],
 		r03ac02 varchar[],
 		r03ac03 varchar[],
 		r03ac12 varchar[],
 		r03ac13 varchar[],
 		r03ac18 varchar[],
 		r03ac19 varchar[],
 		r03ak varchar[],
 		r03ak06 varchar[],
 		r03ak07 varchar[],
 		r03ak08 varchar[],
 		r03ak09 varchar[],
 		r03ak10 varchar[],
 		r03ak11 varchar[],
 		r03ak12 varchar[],
 		r03ak13 varchar[],
 		r03ak14 varchar[],
 		r03al varchar[],
 		r03al01 varchar[],
 		r03al02 varchar[],
 		r03al03 varchar[],
 		r03al04 varchar[],
 		r03al05 varchar[],
 		r03al06 varchar[],
 		r03al07 varchar[],
 		r03al08 varchar[],
 		r03al09 varchar[],
 		r03al11 varchar[],
 		r03al12 varchar[],
 		r03b varchar[],
 		r03ba varchar[],
 		r03ba01 varchar[],
 		r03ba02 varchar[],
 		r03ba05 varchar[],
 		r03ba08 varchar[],
 		r03bb varchar[],
 		r03bb01 varchar[],
 		r03bb04 varchar[],
 		r03bb05 varchar[],
 		r03bb06 varchar[],
 		r03bb07 varchar[],
 		r03bc varchar[],
 		r03bc01 varchar[],
 		r03bc03 varchar[],
 		r03c varchar[],
 		r03cc varchar[],
 		r03cc02 varchar[],
 		r03d varchar[],
 		r03da varchar[],
 		r03da04 varchar[],
 		r03dc varchar[],
 		r03dc03 varchar[],
 		r03dx varchar[],
 		r03dx05 varchar[],
 		r03dx07 varchar[],
 		r03dx08 varchar[],
 		r03dx09 varchar[],
 		r03dx10 varchar[]);
Converted crosstab SQL:
WITH cte1 AS (

    SELECT
        patient_id,
        categorie,
        ARRAY[
            count(*)::varchar,
            max(voorschrijfdatum)::varchar,
            min(voorschrijfdatum)::varchar,
            array_agg(distinct atc_code)::varchar
            ] as resultaat
    FROM {{ ref('proigia_medicatie_filter_2jr') }}
    GROUP BY patient_id, categorie
    ORDER BY patient_id, categorie

)
SELECT patient_id
, {{ dbt_utils.pivot('atc',        dbt_utils.get_column_values(ref('proigia_atc_codes_2jr'),'categorie',default=[]),        agg='',        then_value='categorie',        else_value="ARRAY_CONSTRUCT()",        quote_identifiers=False)}} 
FROM cte1
GROUP BY patient_id
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_medicatie_2jr.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_medicatie_filter_3mt.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW proigia_medicatie_3mt AS
SELECT * FROM crosstab($$
    SELECT
        patient_id,
        categorie,
        ARRAY[
            count(*)::varchar,
            max(voorschrijfdatum)::varchar,
            min(voorschrijfdatum)::varchar,
            array_agg(distinct atc_code)::varchar
            ] as resultaat
    FROM proigia_medicatie_filter_3mt
    GROUP BY patient_id, categorie
    ORDER BY patient_id, categorie
$$,$$
    SELECT atc FROM proigia_atc_codes ORDER BY atc
$$) as
(
    patient_id bigint,
Converted crosstab SQL:

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_medicatie_3mt.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_chronische_medicatie_3mt.sql

[WARNING] SQL was not modified during conversion
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_polyfarmacie_3mt.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_medicatie_filter_3mt_seg2.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW proigia_medicatie_3mt_seg2 AS
SELECT * FROM crosstab($$
    SELECT
        patient_id,
        categorie,
        ARRAY[
            count(*)::varchar,
            max(voorschrijfdatum)::varchar,
            min(voorschrijfdatum)::varchar,
            array_agg(distinct atc_code)::varchar
            ] AS resultaat
    FROM proigia_medicatie_filter_3mt_seg2
    GROUP BY patient_id, categorie
    ORDER BY patient_id, categorie
$$,$$
    SELECT atc FROM proigia_atc_codes_seg2 ORDER BY atc
$$) AS
(
    patient_id bigint,
Converted crosstab SQL:

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_medicatie_3mt_seg2.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_atc_codes_ineen.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_medicatie_filter_ineen.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW proigia_medicatie_ineen AS
SELECT * FROM crosstab($$
    SELECT
        patient_id,
        categorie,
        ARRAY[
            count(*)::varchar,
            max(voorschrijfdatum)::varchar,
            min(voorschrijfdatum)::varchar,
            array_agg(distinct atc_code)::varchar
            ] as resultaat
    FROM proigia_medicatie_filter_ineen
    GROUP BY patient_id, categorie
    ORDER BY patient_id, categorie
$$,$$
    SELECT atc FROM proigia_atc_codes_ineen ORDER BY atc
$$) as
(
    patient_id bigint,
		a02 varchar[],
		a02ba varchar[],
    a02bc varchar[],
    a02bc01 varchar[],
    a02bc02 varchar[],
    a10 varchar[],
    a10a varchar[],
		a10ab varchar[],
		a10ac varchar[],
		a10ad varchar[],
		a10ae varchar[],
    a10b varchar[],
    a10ba varchar[],
    a10ba02 varchar[],
    a10bb varchar[],
    a10bd varchar[],
    a10bd02 varchar[],
    a10bd03 varchar[],
    a10bd05 varchar[],
    a10bd07 varchar[],
    a10bd08 varchar[],
    a10bd19 varchar[],
    a10bd20 varchar[],
    a10bf varchar[],
    a10bg varchar[],
    a10bg03 varchar[],
    a10bh varchar[],
    a10bk03 varchar[],
    a10bx varchar[],
		b01 varchar[],
    b01a varchar[],
		b01aa varchar[],
    b01ab varchar[],
		b01ac varchar[],
		b01ac01 varchar[],
		b01ac04 varchar[],
		b01ac06 varchar[],
		b01ac07 varchar[],
		b01ac08 varchar[],
		b01ac22 varchar[],
		b01ac24 varchar[],
    b01ac56 varchar[],
		b01ad varchar[],
		b01ae varchar[],
		b01af varchar[],
		b01ax varchar[],
		c01 varchar[],
		c01aa05 varchar[],
    c01b varchar[],
		c01ba01 varchar[],
		c01ba03 varchar[],
		c01bc03 varchar[],
		c01bc04 varchar[],
    c01da varchar[],
    c02 varchar[],
    c03 varchar[],
    c03a varchar[],
		c03ad01 varchar[],
		c03ca01 varchar[],
		c03ca02 varchar[],
		c03cb01 varchar[],
		c03cb02 varchar[],
		c03da01 varchar[],
		c03da04 varchar[],
		c03eb01 varchar[],
		c03eb02 varchar[],
    c04 varchar[],
    c05 varchar[],
    c05ae03 varchar[],
		c06 varchar[],
    c07 varchar[],
    c07aa varchar[],
    c07ab varchar[],
    c08 varchar[],
    c08d varchar[],
    c08da01 varchar[],
    c08da51 varchar[],
    c08db01 varchar[],
    c09 varchar[],
    c09a varchar[],
    c09aa varchar[],
    c09b varchar[],
    c09ba varchar[],
    c09bb varchar[],
    c09bb10 varchar[],
    c09bx varchar[],
    c09c varchar[],
    c09ca varchar[],
    c09ca01 varchar[],
    c09ca02 varchar[],
    c09ca03 varchar[],
    c09ca04 varchar[],
    c09ca06 varchar[],
    c09ca07 varchar[],
    c09d varchar[],
    c09da varchar[],
    c09da01 varchar[],
    c09da03 varchar[],
    c09da04 varchar[],
    c09da06 varchar[],
    c09da07 varchar[],
    c09db varchar[],
    c09dx varchar[],
    c10 varchar[],
		c10a varchar[],
    c10aa varchar[],
    c10aa01 varchar[],
    c10ba varchar[],
		h02aa02 varchar[],
		h02ab varchar[],
		h02ab02 varchar[],
		h02ab04 varchar[],
    h02ab06 varchar[],
    h02ab07 varchar[],
    h02ab08 varchar[],
    h02ab09 varchar[],
    h02ab10 varchar[],
    h06ab06 varchar[],
    h06ab07 varchar[],
    j01 varchar[],
		j01aa02 varchar[],
		j01ce02 varchar[],
		j01ce05 varchar[],
		j01cf02 varchar[],
		j01cf05 varchar[],
		j01ea01 varchar[],
		j01ma02 varchar[],
		j01xe01 varchar[],
    j07bb varchar[],
    m01a varchar[],
    m01ab05 varchar[],
		m01ab51 varchar[],
		m01ab55 varchar[],
    m01ae varchar[],
    m01ae01 varchar[],
    m01ae02 varchar[],
    m01ae52 varchar[],
		m01ba03 varchar[],
    m05 varchar[],
		n02ab varchar[],
		n02aj02 varchar[],
		n02aj08 varchar[],
		n02aj14 varchar[],
		n02aj18 varchar[],
		n02aj19 varchar[],
		n02ba varchar[],
		n02be51 varchar[],
    n02cc varchar[],
    n05a varchar[],
    n05c varchar[],
    n06a varchar[],
    n06aa varchar[],
    n06ab varchar[],
		n06ax05 varchar[],
		n06ax16 varchar[],
    n06ax21 varchar[],
    n07ba varchar[],
    r03 varchar[],
    r03a varchar[],
    r03ac02 varchar[],
    r03ac03 varchar[],
		r03ac12 varchar[],
		r03ac13 varchar[],
		r03ac18 varchar[],
		r03ac19 varchar[],
    r03ak varchar[],
    r03ak04 varchar[],
    r03ak06 varchar[],
    r03ak07 varchar[],
		r03ak08 varchar[],
		r03ak09 varchar[],
		r03ak10 varchar[],
		r03ak11 varchar[],
    r03ak12 varchar[],
    r03ak13 varchar[],
    r03al02 varchar[],
		r03al03 varchar[],
		r03al04 varchar[],
		r03al05 varchar[],
		r03al06 varchar[],
    r03al08 varchar[],
    r03al09 varchar[],
    r03b varchar[],
    r03ba varchar[],
		r03bb04 varchar[],
		r03bb05 varchar[],
		r03bb06 varchar[],
		r03bb07 varchar[]);
Converted crosstab SQL:
WITH cte1 AS (

    SELECT
        patient_id,
        categorie,
        ARRAY[
            count(*)::varchar,
            max(voorschrijfdatum)::varchar,
            min(voorschrijfdatum)::varchar,
            array_agg(distinct atc_code)::varchar
            ] as resultaat
    FROM {{ ref('proigia_medicatie_filter_ineen') }}
    GROUP BY patient_id, categorie
    ORDER BY patient_id, categorie

)
SELECT patient_id
, {{ dbt_utils.pivot('atc',        dbt_utils.get_column_values(ref('proigia_atc_codes_ineen'),'categorie',default=[]),        agg='',        then_value='categorie',        else_value="ARRAY_CONSTRUCT()",        quote_identifiers=False)}} 
FROM cte1
GROUP BY patient_id
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_medicatie_ineen.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_medicatie_filter_ooit.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW proigia_medicatie_ooit AS
SELECT * FROM crosstab($$
    SELECT
        patient_id,
        categorie,
        ARRAY[
            count(*)::varchar,
            max(voorschrijfdatum)::varchar,
            min(voorschrijfdatum)::varchar,
            array_agg(distinct atc_code)::varchar,
            max(actueel)::varchar
            ] as resultaat
    FROM proigia_medicatie_filter_ooit
    GROUP BY patient_id, categorie
    ORDER BY patient_id, categorie
$$,$$
    SELECT atc FROM proigia_atc_codes ORDER BY atc
$$) as
(
    patient_id bigint,
Converted crosstab SQL:

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_medicatie_ooit.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_atc_codes_seg2.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_medicatie_filter_seg2.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW proigia_medicatie_seg2 AS
SELECT * FROM crosstab($$
    SELECT
        patient_id,
        categorie,
        ARRAY[
            count(*)::varchar,
            max(voorschrijfdatum)::varchar,
            min(voorschrijfdatum)::varchar,
            array_agg(distinct atc_code)::varchar,
            max(actueel)::varchar] as resultaat
    FROM proigia_medicatie_filter_seg2
    GROUP BY patient_id, categorie
    ORDER BY patient_id, categorie
$$,$$
    SELECT atc FROM proigia_atc_codes_seg2 ORDER BY atc
$$) as
(
    patient_id bigint,
    __DBT_MACRO_0__);
Converted crosstab SQL:
WITH cte1 AS (

    SELECT
        patient_id,
        categorie,
        ARRAY[
            count(*)::varchar,
            max(voorschrijfdatum)::varchar,
            min(voorschrijfdatum)::varchar,
            array_agg(distinct atc_code)::varchar,
            max(actueel)::varchar] as resultaat
    FROM {{ ref('proigia_medicatie_filter_seg2') }}
    GROUP BY patient_id, categorie
    ORDER BY patient_id, categorie

)
SELECT patient_id
, {{ dbt_utils.pivot('atc',        dbt_utils.get_column_values(ref('proigia_atc_codes_seg2'),'categorie',default=[]),        agg='',        then_value='categorie',        else_value="ARRAY_CONSTRUCT()",        quote_identifiers=False)}} 
FROM cte1
GROUP BY patient_id
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_medicatie_seg2.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_labcodes.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: CREATE MATERIALIZED VIEW proigia_meetwaarden_filter
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_meetwaarden_filter.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE MATERIALIZED VIEW proigia_meetwaarden AS
SELECT * FROM crosstab(
$$
    SELECT DISTINCT ON (patient_id, nhgnr)
        patient_id,
        nhgnr,
        ARRAY[  uitslag_raw,
                datum::varchar,
                uitslag_waarde] as waarde_datum
    FROM proigia_meetwaarden_filter
    JOIN proigia_labcodes USING (nhgnr)
    ORDER BY patient_id, nhgnr, datum DESC, uitslag_num DESC nulls last,
            uitslag_raw nulls last, uitslag_waarde nulls last
$$,$$
    SELECT nhgnr
    FROM indelingen.nhg_labcodes
    JOIN proigia_labcodes USING (nhgnr)
    ORDER BY nhgnr
$$
) as ct(
patient_id bigint,
Unsupported JOIN found in pivot_statement.
Converted crosstab SQL:

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_meetwaarden.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_labcodes_3mt.sql

[WARNING] SQL was not modified during conversion
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_meetwaarden_filter_3mt.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW proigia_meetwaarden_3mt AS
SELECT * FROM crosstab(
$$
    SELECT DISTINCT ON (patient_id, nhgnr)
        patient_id,
        nhgnr,
        ARRAY[  uitslag_raw,
                datum::varchar,
                uitslag_waarde] as waarde_datum
    FROM proigia_meetwaarden_filter_3mt
    JOIN proigia_labcodes_3mt USING (nhgnr)
    ORDER BY patient_id, nhgnr, datum DESC, uitslag_num DESC nulls last,
            uitslag_raw nulls last, uitslag_waarde nulls last
$$,$$
    SELECT nhgnr
    FROM indelingen.nhg_labcodes
    JOIN proigia_labcodes_3mt USING (nhgnr)
    ORDER BY nhgnr
$$
) as ct(
patient_id bigint,
af_b varchar[],
alat_b varchar[],
alb_b varchar[],
alb_u varchar[],
alb_ue_mt varchar[],
albk_u_mi varchar[],
albk_ue_mi varchar[],
asat_b varchar[],
bili_b varchar[],
bse_b_1u varchar[],
ca_b varchar[],
chhd_b_mi varchar[],
chol_b_mt varchar[],
crp_b varchar[],
diff_b_md varchar[],
digo_b_si varchar[],
eiw_u_sk varchar[],
eiw_ue_mt varchar[],
ery_b_mt varchar[],
fosf_b varchar[],
fosf_u varchar[],
fosf_ue_mt varchar[],
ft4_b varchar[],
gew_ao varchar[],
ggt_b varchar[],
glhb_b varchar[],
gluc_b_nn varchar[],
gluc_b_nu varchar[],
gluc_bc_nn varchar[],
gluc_bc_nu varchar[],
hb_b varchar[],
hdl_b varchar[],
ht_b varchar[],
k_b varchar[],
k_u varchar[],
krea_b varchar[],
krea_o_mk varchar[],
ldhd_b_mi varchar[],
ldl_b varchar[],
leuk_b_mt varchar[],
lngp_ao varchar[],
mcv_b varchar[],
na_b varchar[],
oa01_o varchar[],
oa02_o varchar[],
oa03_o varchar[],
oa04_o varchar[],
oa05_o varchar[],
pap_xp_bv varchar[],
pap_xp_im varchar[],
pap_xp_iz varchar[],
pap_xp_mm varchar[],
pap_xp_wo varchar[],
papa_xp varchar[],
papb_xp varchar[],
papc_xp varchar[],
paph_xp varchar[],
papk_xp varchar[],
papn_xp varchar[],
papo_xp varchar[],
papp_xp varchar[],
phad_b_sr varchar[],
pth_b varchar[],
q001_b varchar[],
q002_b varchar[],
q003_b varchar[],
q401_b varchar[],
qm12_b varchar[],
qm13_b varchar[],
qm21_b varchar[],
quet_ao varchar[],
te_b_mt varchar[],
te_u_kw varchar[],
trig_b varchar[],
trom_b_mt varchar[],
tsh_b varchar[],
vb12_b varchar[],
vd_b varchar[],
adfr_ao varchar[],
akll_rq varchar[],
alco_pq varchar[],
allg_az varchar[],
ampu_lv_li varchar[],
ampu_lv_re varchar[],
angk_kq varchar[],
angp_kq varchar[],
asac_rz varchar[],
asdd_rz varchar[],
asdl_rz varchar[],
asdu_rq varchar[],
ase_rz varchar[],
asel_rz varchar[],
asfb_rq varchar[],
asgb_rq varchar[],
ashr_rq varchar[],
ashs_rq varchar[],
asin_rq varchar[],
asit_rq varchar[],
askk_rq varchar[],
asla_rq varchar[],
opmf_rl varchar[],
aso_rq varchar[],
aspk_rq varchar[],
astl_rq varchar[],
astm_rq varchar[],
astt_rq varchar[],
astv_rq varchar[],
asvc_rz varchar[],
asvf_rq varchar[],
asvz_rq varchar[],
aswi_rq varchar[],
aswk_rq varchar[],
atof_aq varchar[],
atov_rq varchar[],
bewg_lv_li varchar[],
bewg_lv_re varchar[],
cata_fa_li varchar[],
cata_fa_re varchar[],
clin_kq varchar[],
clkl_kq varchar[],
dmtm_tq varchar[],
cohz_kq varchar[],
cva_kq varchar[],
dmtv_tq varchar[],
dafu_fz varchar[],
dbdi_tz varchar[],
dblo_lv_li varchar[],
dblo_lv_re varchar[],
decc_kq varchar[],
detk_kq varchar[],
dmdo_tz varchar[],
dme_tz varchar[],
dmel_tz varchar[],
dmfm_tq varchar[],
dmkl_tq varchar[],
dmo_tq varchar[],
dmp_tz varchar[],
dmrp_fa_li varchar[],
dmrp_fa_re varchar[],
dmsi_tz varchar[],
dmzo_tz varchar[],
dmzp_tz varchar[],
druk_lv_li varchar[],
druk_lv_re varchar[],
dysp_rq varchar[],
eain_ka_li varchar[],
eain_ka_re varchar[],
eelt_lv_li varchar[],
eelt_lv_re varchar[],
exal_zq varchar[],
fgbd_rq varchar[],
fbdd_rq varchar[],
frdp_rq varchar[],
fv1v_rl_fb varchar[],
fcpb_rl varchar[],
frpb_rl_mi varchar[],
fvfv_rl_fb varchar[],
fvnb_rl varchar[],
fvnb_rl_mp varchar[],
fvns_rl varchar[],
fvpb_rl varchar[],
fvpb_rl_mp varchar[],
fvrp_rl varchar[],
fvrv_rl varchar[],
ghas_lt varchar[],
hoas_rq varchar[],
hoes_rq varchar[],
hrin_kq varchar[],
hypt_kq varchar[],
infc_lv_li varchar[],
infc_lv_re varchar[],
insp_lv_li varchar[],
insp_lv_re varchar[],
kldm_tq varchar[],
kleu_lv_li varchar[],
kleu_lv_re varchar[],
lfcn_rl varchar[],
libw_aq varchar[],
lmbt_rl varchar[],
lwin_rq varchar[],
mdmw_tq varchar[],
mofv_ns_li varchar[],
mofv_ns_re varchar[],
minh_rq varchar[],
nkac_rq varchar[],
odas_rq varchar[],
oeas_rq varchar[],
onpr_rq varchar[],
pakj_aq varchar[],
pals_rq varchar[],
padp_kv_li varchar[],
padp_kv_re varchar[],
pgcn_tz varchar[],
piep_rq varchar[],
pkdo_tz varchar[],
patp_kv_li varchar[],
patp_kv_re varchar[],
rasp_ao varchar[],
rook_aq varchar[],
rrdi_ka varchar[],
rrse_ka_li varchar[],
rrse_ka_re varchar[],
rrsy_ka varchar[],
rrsy_ka_pl varchar[],
klac_rq varchar[],
staf_lv_li varchar[],
staf_lv_re varchar[],
senb_nq varchar[],
snsv_ns_li varchar[],
snsv_ns_re varchar[],
skst_tq varchar[],
sppl_ao varchar[],
spzn_rq varchar[],
reag_aq varchar[],
tia_kq varchar[],
ulce_lv_li varchar[],
ulce_lv_re varchar[],
vets_tq varchar[],
vipb_fq varchar[],
visz_fa_li varchar[],
visz_fa_re varchar[],
voed_tz varchar[],
vsho_tq varchar[],
vshr_tq varchar[],
dmac_tz varchar[],
aco_rq varchar[],
asee_rz varchar[],
aspe_rz varchar[],
dmcb_tz varchar[],
ascb_rz varchar[],
coo_rq varchar[],
codl_rz varchar[],
cott_rq varchar[],
coee_rz varchar[],
coac_rz varchar[],
cocb_rz varchar[],
oeco_rq varchar[],
asrz_rz varchar[],
dmrz_tz varchar[],
dmcd_tz varchar[],
rrsa_ka varchar[],
inss_tq varchar[],
asvd_rq varchar[],
asmw_rq varchar[],
comw_rq varchar[],
astv_rz varchar[],
dmtv_tz varchar[],
dmmd_tq varchar[],
adgw_tq varchar[],
advd_tq varchar[],
admi_aq varchar[],
adgv_aq varchar[],
adlb_aq varchar[],
dmvc_tz varchar[],
corz_rz varchar[],
glsw_tq varchar[],
gwsw_tq varchar[],
aser_rq varchar[],
coac_rq varchar[],
aszp_rz varchar[],
adsa_zq varchar[],
asza_rz varchar[],
asrv_rz varchar[],
dmrv_tz varchar[],
dmbm_tq varchar[],
asbm_rq varchar[],
cobm_rq varchar[],
dmto_fz varchar[],
rrar_kz varchar[],
rlho_rq varchar[],
dagh_rq varchar[],
shsm_zq varchar[],
srok_zq varchar[],
shdi_zq varchar[],
sasp_zq varchar[],
sano_zq varchar[],
bero_aq varchar[],
opmo_lv varchar[],
coel_rz varchar[],
fcnb_rl varchar[],
frnb_rl_mi varchar[],
rfam_rq varchar[],
ausc_rl varchar[],
omva_dh varchar[],
omva_lh varchar[],
pols_ao varchar[],
dm2_tq varchar[],
astm_kq varchar[],
copd_rq varchar[],
vism_fa_li varchar[],
vism_fa_re varchar[],
vism_fa varchar[],
visz_fa varchar[],
lcar_rq varchar[],
frns_rl_mi varchar[],
cotv_rq varchar[],
odco_rq varchar[],
covz_rq varchar[],
ccdd_rz varchar[],
krea_o_fb varchar[],
krem_o_fb varchar[],
gfr_b varchar[],
lyso_nl varchar[],
bnp_b varchar[],
ntpr_b varchar[],
roja_aq varchar[],
sipd_aq varchar[],
sgpd_aq varchar[],
stpg_aq varchar[],
misr_aq varchar[],
vgnv_aq varchar[],
staf_az varchar[],
stda_az varchar[],
srda_aq varchar[],
adnv_aq varchar[],
rnsr_aq varchar[],
prsr_aq varchar[],
absr_aq varchar[],
basr_aq varchar[],
arsr_aq varchar[],
pppd_aq varchar[],
robm_aq varchar[],
roin_aq varchar[],
robh_az varchar[],
rso_aq varchar[],
rotv_az varchar[],
sro_aq varchar[],
args_aq varchar[],
rfms_rq varchar[],
afau_rl varchar[],
rovc_az varchar[],
zwng_wq varchar[],
oafr_az varchar[],
affu_az varchar[],
taba_aq varchar[],
hvzc_kq varchar[],
opls_aa varchar[],
roac_az varchar[],
papq_xp varchar[],
anao_kq varchar[],
cosc_kq varchar[],
atsc_kq varchar[],
pavl_kq varchar[],
hych_tq varchar[],
fhc_tq varchar[],
rrsy_ka_mh varchar[],
rrdi_ka_mh varchar[],
hve_kz varchar[],
hvpe_kz varchar[],
ausc_kh varchar[],
afau_kh varchar[],
punt_kh varchar[],
hvvw_kz varchar[],
hyvm_ka varchar[],
fvsb_rl varchar[],
fvrn_rl varchar[],
frsb_rl_mi varchar[],
polr_ao varchar[],
polq_ao varchar[],
fufo_fa varchar[],
hvzf_kq varchar[],
hsin_kq varchar[],
asvw_rz varchar[],
klhz_kq varchar[],
hvbm_kq varchar[],
hvmw_kq varchar[],
advd_aq varchar[],
byvd_aa varchar[],
rovw_az varchar[],
dmvw_tz varchar[],
fhcf_tq varchar[],
rrdi_ka_ps varchar[],
rrsy_ka_ps varchar[],
bwov_aq varchar[],
rivu_sq varchar[],
antk_nq varchar[],
hvtm_kq varchar[],
hvtv_kq varchar[],
hvrv_kz varchar[],
ecg_kh varchar[],
ulcu_lv varchar[],
nrfu_uq varchar[],
lvhr_kq varchar[],
dmhb_tz varchar[],
hvtv_kz varchar[],
hvvc_kz varchar[],
coer_rq varchar[],
mrcd_rq varchar[],
rhvz_kq_fb varchar[],
x_lt varchar[],
echo_un_li varchar[],
echo_un_re varchar[],
ccq1_rq varchar[],
ccq2_rq varchar[],
ccq3_rq varchar[],
ccq4_rq varchar[],
ccq5_rq varchar[],
ccq6_rq varchar[],
ccq7_rq varchar[],
ccq8_rq varchar[],
ccq9_rq varchar[],
ccqx_rq varchar[],
ccqs_rq varchar[],
ccqf_rq varchar[],
ccqm_rq varchar[],
ccqt_rq varchar[],
mosr_aq varchar[],
ashb_rz varchar[],
cohb_rz varchar[],
hvcb_kz varchar[],
hvrz_kz varchar[],
_sh1_pq varchar[],
_sh2_pq varchar[],
_sh3_pq varchar[],
_sh4_pq varchar[],
_sh5_pq varchar[],
_sht_pq varchar[],
mms1_pq varchar[],
mms2_pq varchar[],
mms3_pq varchar[],
mms4_pq varchar[],
mms5_pq varchar[],
mms6_pq varchar[],
mms7_pq varchar[],
mms8_pq varchar[],
mms9_pq varchar[],
mm10_pq varchar[],
mm11_pq varchar[],
mmst_pq varchar[],
gq25_tq_fb varchar[],
old1_pq varchar[],
old2_pq varchar[],
old3_pq varchar[],
old4_pq varchar[],
old5_pq varchar[],
old6_pq varchar[],
old7_pq varchar[],
old8_pq varchar[],
old9_pq varchar[],
ol11_pq varchar[],
ol12_pq varchar[],
ol10_pq varchar[],
dmtv_lz varchar[],
dmod_tz varchar[],
dmad_tq varchar[],
edin_tq varchar[],
dmov_tz varchar[],
opmo_fa varchar[],
vvig_tq varchar[],
lvig_tq varchar[],
h002_sa varchar[],
h003_sa varchar[],
vvmi_ao_mi varchar[],
rr24_ka_mh varchar[],
rrgs_ka_mh varchar[],
rrgd_ka_mh varchar[],
rrhs_ka_mh varchar[],
rrhd_ka_mh varchar[],
rrls_ka_mh varchar[],
rrld_ka_mh varchar[],
rrpn_ka_mh varchar[],
rrns_ka_mh varchar[],
rrnd_ka_mh varchar[],
rrds_ka_mh varchar[],
rrdd_ka_mh varchar[],
slwh_rq varchar[],
gewv_aa varchar[],
gacw_rq varchar[],
covv_rq varchar[],
askw_rq varchar[],
amem_rq varchar[],
aeem_rq varchar[],
o2sa_ao varchar[],
oldt_pq varchar[],
ldld_b varchar[],
b12t_b varchar[],
gzhb_pz varchar[],
fsfu_fz varchar[],
bzvd_aa varchar[],
ipss_uq varchar[],
pver_kq varchar[],
dcer_kq varchar[],
acqt_rq varchar[],
rott_aq varchar[],
roes_aq varchar[],
aval_aq varchar[],
ebgp_aq varchar[],
pofa_aq varchar[],
slpb_aq varchar[],
smst_pq varchar[],
vipl_pq varchar[],
vlsc_aq varchar[],
ozo_aq varchar[],
awkw_az varchar[],
oze_az varchar[],
oztv_az varchar[],
ozvc_az varchar[],
ozp_az varchar[],
wmpw_aq varchar[],
gfit_aq varchar[],
cldt_aq varchar[],
cizi_az varchar[],
zzpv_az varchar[],
adme_aq varchar[],
kwbh_az varchar[],
gdst_pq varchar[],
_dan_pq varchar[],
_dde_pq varchar[],
_ddi_pq varchar[],
_dso_pq varchar[],
cvhb_kz varchar[],
hbac_b varchar[],
ortd_aq varchar[],
orpl_aq varchar[],
orps_aq varchar[],
blmz_aq varchar[],
hvso_kz varchar[],
ocfm_xq varchar[],
ccfm_dq varchar[],
iecg_kh varchar[],
brsr_aq varchar[],
vsnr_aq varchar[],
cvd_kv varchar[],
echo_kh varchar[],
prcs_rl varchar[],
prcs_dh varchar[],
palp_dl varchar[],
poed_le varchar[],
lvef_kh varchar[],
pndy_rq varchar[],
orpn_rq varchar[],
mnpz_xq varchar[],
zlcp_ra varchar[],
coex_rq varchar[],
ozhb_az varchar[],
dchb_az varchar[],
asab_rq varchar[],
coab_rq varchar[],
roab_aq varchar[],
hvab_kq varchar[],
drug_aq varchar[],
bdi1_pq varchar[],
bdi2_pq varchar[],
bai_pq varchar[],
uihb_uz varchar[],
skhb_tz varchar[],
gwtn_aq varchar[],
dctt_kq varchar[],
dcbm_kq varchar[],
dcab_kq varchar[],
gluc_ba_nu varchar[],
gluc_ba_nn varchar[],
hf65_kq varchar[],
nngb_aq varchar[],
fitn_aq varchar[],
rh12_kq_fb varchar[],
rvfh_kq_fb varchar[],
klhf_kq varchar[],
hfo_kq varchar[],
hfe_kz varchar[],
hfmw_kq varchar[],
hfvw_kz varchar[],
hfrv_kz varchar[],
hftv_kz varchar[],
hfvc_kz varchar[],
hfpe_kz varchar[],
addw_aq varchar[],
advb_aq varchar[],
adnb_aq varchar[],
adag_aq varchar[],
vmhf_kq varchar[],
sync_aq varchar[],
hklp_kq varchar[],
hbap_b varchar[],
inch_uq varchar[],
incf_uq varchar[],
sndv_uq varchar[],
inct_ua varchar[],
dst_aq varchar[],
hfcb_kz varchar[],
ra_lq varchar[],
ecgf_kh varchar[],
rrs7_ka_mh varchar[],
rrd7_ka_mh varchar[],
phq9_pq varchar[],
ipsq_uq varchar[],
cort_rq varchar[],
rr3s_ka varchar[],
rr3d_ka varchar[],
acq1_rq varchar[],
acq2_rq varchar[],
acq3_rq varchar[],
acq4_rq varchar[],
acq5_rq varchar[],
acq6_rq varchar[],
acq7_rq varchar[],
cac1_rq varchar[],
cac2_rq varchar[],
cac3_rq varchar[],
cac4_rq varchar[],
cac5_rq varchar[],
cac6_rq varchar[],
cac7_rq varchar[],
cact_rq varchar[],
nfhb_uz varchar[],
audc_pq varchar[],
obhb_az varchar[],
obcb_az varchar[],
obrz_az varchar[],
afrz_kz varchar[],
afhb_kz varchar[],
afcb_kz varchar[],
ozcb_az varchar[],
ozrz_az varchar[],
hfrz_kz varchar[],
uicb_uz varchar[],
skcb_tz varchar[],
nfcb_uz varchar[],
uirz_uz varchar[],
skrz_tz varchar[],
nfrz_uz varchar[],
prdn_dn varchar[],
adgc_aq varchar[],
rafk_aa varchar[],
hbsw_tq varchar[],
dpos_pq varchar[],
dper_pq varchar[],
dprc_pq varchar[],
dpsb_pq varchar[],
ggtv_pz varchar[],
ggvc_pz varchar[],
ggrv_pz varchar[],
ggcb_pz varchar[],
ggrz_pz varchar[],
ggbm_pq varchar[],
ggad_pq varchar[],
ggp_pz varchar[],
anes_pq varchar[],
ansb_pq varchar[],
agsg_pq varchar[],
agsb_pq varchar[],
sdo1_pq varchar[],
sdo2_pq varchar[],
sdo3_pq varchar[],
sdo4_pq varchar[],
sdo5_pq varchar[],
sdop_pq varchar[],
sdoi_pq varchar[],
sdj1_pq varchar[],
sdj2_pq varchar[],
sdj3_pq varchar[],
sdj4_pq varchar[],
sdj5_pq varchar[],
sdjp_pq varchar[],
sdji_pq varchar[],
oshb_lz varchar[],
oscb_lz varchar[],
osrz_lz varchar[],
coae_rq varchar[],
act1_rq varchar[],
act2_rq varchar[],
act3_rq varchar[],
act4_rq varchar[],
act5_rq varchar[],
act_rq varchar[],
gmct_tz varchar[],
ggiz_pz varchar[],
ggbe_pz varchar[],
cld3_aq varchar[],
cldc_aq varchar[],
krec_o_fb varchar[],
osab_lq varchar[],
ips1_uq varchar[],
ips2_uq varchar[],
ips3_uq varchar[],
ips4_uq varchar[],
ips5_uq varchar[],
ips6_uq varchar[],
ips7_uq varchar[],
acqk_rq varchar[],
scfq_rl varchar[],
asoc_rq varchar[],
zpvu_sq varchar[],
fvpb_rl_mi varchar[],
fvnb_rl_mi varchar[],
fcpb_rl_mi varchar[],
fcnb_rl_mi varchar[],
frpz_rl_mi varchar[],
frnz_rl_mi varchar[],
slsb_pq varchar[],
afty_kh varchar[],
chva_az_fb varchar[],
cafa_aq varchar[],
clhb_kz varchar[],
clcb_kz varchar[],
clrz_kz varchar[],
pahb_kz varchar[],
pacb_kz varchar[],
parz_kz varchar[],
kcaf_aa varchar[],
kclf_aa varchar[],
kczo_aa varchar[],
kwcz_az varchar[],
fcem_rl varchar[],
fcem_rl_mi varchar[],
fvem_rl varchar[],
fvem_rl_mp varchar[],
fvem_rl_mi varchar[],
frem_rl_mi varchar[],
frez_rl_mi varchar[],
glup_bc_nu varchar[],
glup_bc_nn varchar[],
zlc1_rq varchar[],
zlc2_rq varchar[],
zlc3_rq varchar[],
zlc4_rq varchar[],
rama_aa varchar[],
krea_b_po varchar[],
krem_o_po varchar[],
krec_o_po varchar[],
eiw_u_po varchar[],
hbap_b_po varchar[],
crp_b_po varchar[],
ddim_b_po varchar[],
tni_b_po varchar[],
tnt_b_po varchar[],
qm31_b varchar[],
qm32_b varchar[],
espd_aq varchar[],
dmrf_tz varchar[],
nhdl_b varchar[],
dmkz_tz varchar[],
askz_rz varchar[],
cokz_rz varchar[],
cvkz_kz varchar[],
gzkz_pz varchar[],
ozkz_az varchar[],
dckz_kz varchar[],
uikz_uz varchar[],
skkz_tz varchar[],
nfkz_uz varchar[],
obkz_az varchar[],
afkz_kz varchar[],
oskz_lz varchar[],
clkz_kz varchar[],
pakz_kz varchar[],
ldl_b_po varchar[],
nhdl_b_po varchar[],
czhb_az varchar[],
czcb_az varchar[],
hfty_kh varchar[],
dedd_pz varchar[],
izp_az varchar[],
dekz_pz varchar[],
dehb_pz varchar[],
derz_pz varchar[],
_iqi_ua varchar[],
egfc_o_fb varchar[],
egcc_o_fb varchar[],
dmr7_fa_li varchar[],
dmr7_fa_re varchar[],
dmma_fa_li varchar[],
dmma_fa_re varchar[],
albm_uq varchar[],
fac_ao varchar[],
caia_aq varchar[],
eetl_dq varchar[],
rcns_un_fb varchar[],
nief_un varchar[],
gsta_aq varchar[]);
Unsupported JOIN found in pivot_statement.
Converted crosstab SQL:

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_meetwaarden_3mt.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_mw_laatste_controle.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_mw_exacerbaties.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_mw_risicoscore_vvr.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_mw_rh.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_mw_rh_laatste.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_mw_rh12.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_mw_risicoverh_fact.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_mw_gewichtsverlies.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_mw_systole.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_mw_nierfunctie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_mw_albuminurie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_mw_exacerbaties_seg2.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_mw_risicoscore_vvr_seg2.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_mw_rh_seg2.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_mw_rh_laatste_seg2.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_mw_rh12_seg2.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_mw_gewichtsverlies_seg2.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_labcodes_current_date.sql

[WARNING] SQL was not modified during conversion
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_meetwaarden_filter_current_date.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW proigia_meetwaarden_current_date AS
SELECT * FROM crosstab(
$$
    SELECT DISTINCT ON (patient_id, nhgnr)
        patient_id,
        nhgnr,
        ARRAY[  uitslag_raw,
                datum::varchar,
                uitslag_waarde] as waarde_datum
    FROM proigia_meetwaarden_filter_current_date
    JOIN proigia_labcodes_current_date USING (nhgnr)
    ORDER BY patient_id, nhgnr, datum DESC, uitslag_num DESC nulls last,
            uitslag_raw nulls last, uitslag_waarde nulls last
$$,$$
    SELECT nhgnr
    FROM indelingen.nhg_labcodes
    JOIN proigia_labcodes_current_date USING (nhgnr)
    ORDER BY nhgnr
$$
) as ct(
patient_id bigint,
af_b varchar[],
alat_b varchar[],
alb_b varchar[],
alb_u varchar[],
alb_ue_mt varchar[],
albk_u_mi varchar[],
albk_ue_mi varchar[],
asat_b varchar[],
bili_b varchar[],
bse_b_1u varchar[],
ca_b varchar[],
chhd_b_mi varchar[],
chol_b_mt varchar[],
crp_b varchar[],
diff_b_md varchar[],
digo_b_si varchar[],
eiw_u_sk varchar[],
eiw_ue_mt varchar[],
ery_b_mt varchar[],
fosf_b varchar[],
fosf_u varchar[],
fosf_ue_mt varchar[],
ft4_b varchar[],
gew_ao varchar[],
ggt_b varchar[],
glhb_b varchar[],
gluc_b_nn varchar[],
gluc_b_nu varchar[],
gluc_bc_nn varchar[],
gluc_bc_nu varchar[],
hb_b varchar[],
hdl_b varchar[],
ht_b varchar[],
k_b varchar[],
k_u varchar[],
krea_b varchar[],
krea_o_mk varchar[],
ldhd_b_mi varchar[],
ldl_b varchar[],
leuk_b_mt varchar[],
lngp_ao varchar[],
mcv_b varchar[],
na_b varchar[],
oa01_o varchar[],
oa02_o varchar[],
oa03_o varchar[],
oa04_o varchar[],
oa05_o varchar[],
pap_xp_bv varchar[],
pap_xp_im varchar[],
pap_xp_iz varchar[],
pap_xp_mm varchar[],
pap_xp_wo varchar[],
papa_xp varchar[],
papb_xp varchar[],
papc_xp varchar[],
paph_xp varchar[],
papk_xp varchar[],
papn_xp varchar[],
papo_xp varchar[],
papp_xp varchar[],
phad_b_sr varchar[],
pth_b varchar[],
q001_b varchar[],
q002_b varchar[],
q003_b varchar[],
q401_b varchar[],
qm12_b varchar[],
qm13_b varchar[],
qm21_b varchar[],
quet_ao varchar[],
te_b_mt varchar[],
te_u_kw varchar[],
trig_b varchar[],
trom_b_mt varchar[],
tsh_b varchar[],
vb12_b varchar[],
vd_b varchar[],
adfr_ao varchar[],
akll_rq varchar[],
alco_pq varchar[],
allg_az varchar[],
ampu_lv_li varchar[],
ampu_lv_re varchar[],
angk_kq varchar[],
angp_kq varchar[],
asac_rz varchar[],
asdd_rz varchar[],
asdl_rz varchar[],
asdu_rq varchar[],
ase_rz varchar[],
asel_rz varchar[],
asfb_rq varchar[],
asgb_rq varchar[],
ashr_rq varchar[],
ashs_rq varchar[],
asin_rq varchar[],
asit_rq varchar[],
askk_rq varchar[],
asla_rq varchar[],
opmf_rl varchar[],
aso_rq varchar[],
aspk_rq varchar[],
astl_rq varchar[],
astm_rq varchar[],
astt_rq varchar[],
astv_rq varchar[],
asvc_rz varchar[],
asvf_rq varchar[],
asvz_rq varchar[],
aswi_rq varchar[],
aswk_rq varchar[],
atof_aq varchar[],
atov_rq varchar[],
bewg_lv_li varchar[],
bewg_lv_re varchar[],
cata_fa_li varchar[],
cata_fa_re varchar[],
clin_kq varchar[],
clkl_kq varchar[],
dmtm_tq varchar[],
cohz_kq varchar[],
cva_kq varchar[],
dmtv_tq varchar[],
dafu_fz varchar[],
dbdi_tz varchar[],
dblo_lv_li varchar[],
dblo_lv_re varchar[],
decc_kq varchar[],
detk_kq varchar[],
dmdo_tz varchar[],
dme_tz varchar[],
dmel_tz varchar[],
dmfm_tq varchar[],
dmkl_tq varchar[],
dmo_tq varchar[],
dmp_tz varchar[],
dmrp_fa_li varchar[],
dmrp_fa_re varchar[],
dmsi_tz varchar[],
dmzo_tz varchar[],
dmzp_tz varchar[],
druk_lv_li varchar[],
druk_lv_re varchar[],
dysp_rq varchar[],
eain_ka_li varchar[],
eain_ka_re varchar[],
eelt_lv_li varchar[],
eelt_lv_re varchar[],
exal_zq varchar[],
fgbd_rq varchar[],
fbdd_rq varchar[],
frdp_rq varchar[],
fv1v_rl_fb varchar[],
fcpb_rl varchar[],
frpb_rl_mi varchar[],
fvfv_rl_fb varchar[],
fvnb_rl varchar[],
fvnb_rl_mp varchar[],
fvns_rl varchar[],
fvpb_rl varchar[],
fvpb_rl_mp varchar[],
fvrp_rl varchar[],
fvrv_rl varchar[],
ghas_lt varchar[],
hoas_rq varchar[],
hoes_rq varchar[],
hrin_kq varchar[],
hypt_kq varchar[],
infc_lv_li varchar[],
infc_lv_re varchar[],
insp_lv_li varchar[],
insp_lv_re varchar[],
kldm_tq varchar[],
kleu_lv_li varchar[],
kleu_lv_re varchar[],
lfcn_rl varchar[],
libw_aq varchar[],
lmbt_rl varchar[],
lwin_rq varchar[],
mdmw_tq varchar[],
mofv_ns_li varchar[],
mofv_ns_re varchar[],
minh_rq varchar[],
nkac_rq varchar[],
odas_rq varchar[],
oeas_rq varchar[],
onpr_rq varchar[],
pakj_aq varchar[],
pals_rq varchar[],
padp_kv_li varchar[],
padp_kv_re varchar[],
pgcn_tz varchar[],
piep_rq varchar[],
pkdo_tz varchar[],
patp_kv_li varchar[],
patp_kv_re varchar[],
rasp_ao varchar[],
rook_aq varchar[],
rrdi_ka varchar[],
rrse_ka_li varchar[],
rrse_ka_re varchar[],
rrsy_ka varchar[],
rrsy_ka_pl varchar[],
klac_rq varchar[],
staf_lv_li varchar[],
staf_lv_re varchar[],
senb_nq varchar[],
snsv_ns_li varchar[],
snsv_ns_re varchar[],
skst_tq varchar[],
sppl_ao varchar[],
spzn_rq varchar[],
reag_aq varchar[],
tia_kq varchar[],
ulce_lv_li varchar[],
ulce_lv_re varchar[],
vets_tq varchar[],
vipb_fq varchar[],
visz_fa_li varchar[],
visz_fa_re varchar[],
voed_tz varchar[],
vsho_tq varchar[],
vshr_tq varchar[],
dmac_tz varchar[],
aco_rq varchar[],
asee_rz varchar[],
aspe_rz varchar[],
dmcb_tz varchar[],
ascb_rz varchar[],
coo_rq varchar[],
codl_rz varchar[],
cott_rq varchar[],
coee_rz varchar[],
coac_rz varchar[],
cocb_rz varchar[],
oeco_rq varchar[],
asrz_rz varchar[],
dmrz_tz varchar[],
dmcd_tz varchar[],
rrsa_ka varchar[],
inss_tq varchar[],
asvd_rq varchar[],
asmw_rq varchar[],
comw_rq varchar[],
astv_rz varchar[],
dmtv_tz varchar[],
dmmd_tq varchar[],
adgw_tq varchar[],
advd_tq varchar[],
admi_aq varchar[],
adgv_aq varchar[],
adlb_aq varchar[],
dmvc_tz varchar[],
corz_rz varchar[],
glsw_tq varchar[],
gwsw_tq varchar[],
aser_rq varchar[],
coac_rq varchar[],
aszp_rz varchar[],
adsa_zq varchar[],
asza_rz varchar[],
asrv_rz varchar[],
dmrv_tz varchar[],
dmbm_tq varchar[],
asbm_rq varchar[],
cobm_rq varchar[],
dmto_fz varchar[],
rrar_kz varchar[],
rlho_rq varchar[],
dagh_rq varchar[],
shsm_zq varchar[],
srok_zq varchar[],
shdi_zq varchar[],
sasp_zq varchar[],
sano_zq varchar[],
bero_aq varchar[],
opmo_lv varchar[],
coel_rz varchar[],
fcnb_rl varchar[],
frnb_rl_mi varchar[],
rfam_rq varchar[],
ausc_rl varchar[],
omva_dh varchar[],
omva_lh varchar[],
pols_ao varchar[],
dm2_tq varchar[],
astm_kq varchar[],
copd_rq varchar[],
vism_fa_li varchar[],
vism_fa_re varchar[],
vism_fa varchar[],
visz_fa varchar[],
lcar_rq varchar[],
frns_rl_mi varchar[],
cotv_rq varchar[],
odco_rq varchar[],
covz_rq varchar[],
ccdd_rz varchar[],
krea_o_fb varchar[],
krem_o_fb varchar[],
gfr_b varchar[],
lyso_nl varchar[],
bnp_b varchar[],
ntpr_b varchar[],
roja_aq varchar[],
sipd_aq varchar[],
sgpd_aq varchar[],
stpg_aq varchar[],
misr_aq varchar[],
vgnv_aq varchar[],
staf_az varchar[],
stda_az varchar[],
srda_aq varchar[],
adnv_aq varchar[],
rnsr_aq varchar[],
prsr_aq varchar[],
absr_aq varchar[],
basr_aq varchar[],
arsr_aq varchar[],
pppd_aq varchar[],
robm_aq varchar[],
roin_aq varchar[],
robh_az varchar[],
rso_aq varchar[],
rotv_az varchar[],
sro_aq varchar[],
args_aq varchar[],
rfms_rq varchar[],
afau_rl varchar[],
rovc_az varchar[],
zwng_wq varchar[],
oafr_az varchar[],
affu_az varchar[],
taba_aq varchar[],
hvzc_kq varchar[],
opls_aa varchar[],
roac_az varchar[],
papq_xp varchar[],
anao_kq varchar[],
cosc_kq varchar[],
atsc_kq varchar[],
pavl_kq varchar[],
hych_tq varchar[],
fhc_tq varchar[],
rrsy_ka_mh varchar[],
rrdi_ka_mh varchar[],
hve_kz varchar[],
hvpe_kz varchar[],
ausc_kh varchar[],
afau_kh varchar[],
punt_kh varchar[],
hvvw_kz varchar[],
hyvm_ka varchar[],
fvsb_rl varchar[],
fvrn_rl varchar[],
frsb_rl_mi varchar[],
polr_ao varchar[],
polq_ao varchar[],
fufo_fa varchar[],
hvzf_kq varchar[],
hsin_kq varchar[],
asvw_rz varchar[],
klhz_kq varchar[],
hvbm_kq varchar[],
hvmw_kq varchar[],
advd_aq varchar[],
byvd_aa varchar[],
rovw_az varchar[],
dmvw_tz varchar[],
fhcf_tq varchar[],
rrdi_ka_ps varchar[],
rrsy_ka_ps varchar[],
bwov_aq varchar[],
rivu_sq varchar[],
antk_nq varchar[],
hvtm_kq varchar[],
hvtv_kq varchar[],
hvrv_kz varchar[],
ecg_kh varchar[],
ulcu_lv varchar[],
nrfu_uq varchar[],
lvhr_kq varchar[],
dmhb_tz varchar[],
hvtv_kz varchar[],
hvvc_kz varchar[],
coer_rq varchar[],
mrcd_rq varchar[],
rhvz_kq_fb varchar[],
x_lt varchar[],
echo_un_li varchar[],
echo_un_re varchar[],
ccq1_rq varchar[],
ccq2_rq varchar[],
ccq3_rq varchar[],
ccq4_rq varchar[],
ccq5_rq varchar[],
ccq6_rq varchar[],
ccq7_rq varchar[],
ccq8_rq varchar[],
ccq9_rq varchar[],
ccqx_rq varchar[],
ccqs_rq varchar[],
ccqf_rq varchar[],
ccqm_rq varchar[],
ccqt_rq varchar[],
mosr_aq varchar[],
ashb_rz varchar[],
cohb_rz varchar[],
hvcb_kz varchar[],
hvrz_kz varchar[],
_sh1_pq varchar[],
_sh2_pq varchar[],
_sh3_pq varchar[],
_sh4_pq varchar[],
_sh5_pq varchar[],
_sht_pq varchar[],
mms1_pq varchar[],
mms2_pq varchar[],
mms3_pq varchar[],
mms4_pq varchar[],
mms5_pq varchar[],
mms6_pq varchar[],
mms7_pq varchar[],
mms8_pq varchar[],
mms9_pq varchar[],
mm10_pq varchar[],
mm11_pq varchar[],
mmst_pq varchar[],
gq25_tq_fb varchar[],
old1_pq varchar[],
old2_pq varchar[],
old3_pq varchar[],
old4_pq varchar[],
old5_pq varchar[],
old6_pq varchar[],
old7_pq varchar[],
old8_pq varchar[],
old9_pq varchar[],
ol11_pq varchar[],
ol12_pq varchar[],
ol10_pq varchar[],
dmtv_lz varchar[],
dmod_tz varchar[],
dmad_tq varchar[],
edin_tq varchar[],
dmov_tz varchar[],
opmo_fa varchar[],
vvig_tq varchar[],
lvig_tq varchar[],
h002_sa varchar[],
h003_sa varchar[],
vvmi_ao_mi varchar[],
rr24_ka_mh varchar[],
rrgs_ka_mh varchar[],
rrgd_ka_mh varchar[],
rrhs_ka_mh varchar[],
rrhd_ka_mh varchar[],
rrls_ka_mh varchar[],
rrld_ka_mh varchar[],
rrpn_ka_mh varchar[],
rrns_ka_mh varchar[],
rrnd_ka_mh varchar[],
rrds_ka_mh varchar[],
rrdd_ka_mh varchar[],
slwh_rq varchar[],
gewv_aa varchar[],
gacw_rq varchar[],
covv_rq varchar[],
askw_rq varchar[],
amem_rq varchar[],
aeem_rq varchar[],
o2sa_ao varchar[],
oldt_pq varchar[],
ldld_b varchar[],
b12t_b varchar[],
gzhb_pz varchar[],
fsfu_fz varchar[],
bzvd_aa varchar[],
ipss_uq varchar[],
pver_kq varchar[],
dcer_kq varchar[],
acqt_rq varchar[],
rott_aq varchar[],
roes_aq varchar[],
aval_aq varchar[],
ebgp_aq varchar[],
pofa_aq varchar[],
slpb_aq varchar[],
smst_pq varchar[],
vipl_pq varchar[],
vlsc_aq varchar[],
ozo_aq varchar[],
awkw_az varchar[],
oze_az varchar[],
oztv_az varchar[],
ozvc_az varchar[],
ozp_az varchar[],
wmpw_aq varchar[],
gfit_aq varchar[],
cldt_aq varchar[],
cizi_az varchar[],
zzpv_az varchar[],
adme_aq varchar[],
kwbh_az varchar[],
gdst_pq varchar[],
_dan_pq varchar[],
_dde_pq varchar[],
_ddi_pq varchar[],
_dso_pq varchar[],
cvhb_kz varchar[],
hbac_b varchar[],
ortd_aq varchar[],
orpl_aq varchar[],
orps_aq varchar[],
blmz_aq varchar[],
hvso_kz varchar[],
ocfm_xq varchar[],
ccfm_dq varchar[],
iecg_kh varchar[],
brsr_aq varchar[],
vsnr_aq varchar[],
cvd_kv varchar[],
echo_kh varchar[],
prcs_rl varchar[],
prcs_dh varchar[],
palp_dl varchar[],
poed_le varchar[],
lvef_kh varchar[],
pndy_rq varchar[],
orpn_rq varchar[],
mnpz_xq varchar[],
zlcp_ra varchar[],
coex_rq varchar[],
ozhb_az varchar[],
dchb_az varchar[],
asab_rq varchar[],
coab_rq varchar[],
roab_aq varchar[],
hvab_kq varchar[],
drug_aq varchar[],
bdi1_pq varchar[],
bdi2_pq varchar[],
bai_pq varchar[],
uihb_uz varchar[],
skhb_tz varchar[],
gwtn_aq varchar[],
dctt_kq varchar[],
dcbm_kq varchar[],
dcab_kq varchar[],
gluc_ba_nu varchar[],
gluc_ba_nn varchar[],
hf65_kq varchar[],
nngb_aq varchar[],
fitn_aq varchar[],
rh12_kq_fb varchar[],
rvfh_kq_fb varchar[],
klhf_kq varchar[],
hfo_kq varchar[],
hfe_kz varchar[],
hfmw_kq varchar[],
hfvw_kz varchar[],
hfrv_kz varchar[],
hftv_kz varchar[],
hfvc_kz varchar[],
hfpe_kz varchar[],
addw_aq varchar[],
advb_aq varchar[],
adnb_aq varchar[],
adag_aq varchar[],
vmhf_kq varchar[],
sync_aq varchar[],
hklp_kq varchar[],
hbap_b varchar[],
inch_uq varchar[],
incf_uq varchar[],
sndv_uq varchar[],
inct_ua varchar[],
dst_aq varchar[],
hfcb_kz varchar[],
ra_lq varchar[],
ecgf_kh varchar[],
rrs7_ka_mh varchar[],
rrd7_ka_mh varchar[],
phq9_pq varchar[],
ipsq_uq varchar[],
cort_rq varchar[],
rr3s_ka varchar[],
rr3d_ka varchar[],
acq1_rq varchar[],
acq2_rq varchar[],
acq3_rq varchar[],
acq4_rq varchar[],
acq5_rq varchar[],
acq6_rq varchar[],
acq7_rq varchar[],
cac1_rq varchar[],
cac2_rq varchar[],
cac3_rq varchar[],
cac4_rq varchar[],
cac5_rq varchar[],
cac6_rq varchar[],
cac7_rq varchar[],
cact_rq varchar[],
nfhb_uz varchar[],
audc_pq varchar[],
obhb_az varchar[],
obcb_az varchar[],
obrz_az varchar[],
afrz_kz varchar[],
afhb_kz varchar[],
afcb_kz varchar[],
ozcb_az varchar[],
ozrz_az varchar[],
hfrz_kz varchar[],
uicb_uz varchar[],
skcb_tz varchar[],
nfcb_uz varchar[],
uirz_uz varchar[],
skrz_tz varchar[],
nfrz_uz varchar[],
prdn_dn varchar[],
adgc_aq varchar[],
rafk_aa varchar[],
hbsw_tq varchar[],
dpos_pq varchar[],
dper_pq varchar[],
dprc_pq varchar[],
dpsb_pq varchar[],
ggtv_pz varchar[],
ggvc_pz varchar[],
ggrv_pz varchar[],
ggcb_pz varchar[],
ggrz_pz varchar[],
ggbm_pq varchar[],
ggad_pq varchar[],
ggp_pz varchar[],
anes_pq varchar[],
ansb_pq varchar[],
agsg_pq varchar[],
agsb_pq varchar[],
sdo1_pq varchar[],
sdo2_pq varchar[],
sdo3_pq varchar[],
sdo4_pq varchar[],
sdo5_pq varchar[],
sdop_pq varchar[],
sdoi_pq varchar[],
sdj1_pq varchar[],
sdj2_pq varchar[],
sdj3_pq varchar[],
sdj4_pq varchar[],
sdj5_pq varchar[],
sdjp_pq varchar[],
sdji_pq varchar[],
oshb_lz varchar[],
oscb_lz varchar[],
osrz_lz varchar[],
coae_rq varchar[],
act1_rq varchar[],
act2_rq varchar[],
act3_rq varchar[],
act4_rq varchar[],
act5_rq varchar[],
act_rq varchar[],
gmct_tz varchar[],
ggiz_pz varchar[],
ggbe_pz varchar[],
cld3_aq varchar[],
cldc_aq varchar[],
krec_o_fb varchar[],
osab_lq varchar[],
ips1_uq varchar[],
ips2_uq varchar[],
ips3_uq varchar[],
ips4_uq varchar[],
ips5_uq varchar[],
ips6_uq varchar[],
ips7_uq varchar[],
acqk_rq varchar[],
scfq_rl varchar[],
asoc_rq varchar[],
zpvu_sq varchar[],
fvpb_rl_mi varchar[],
fvnb_rl_mi varchar[],
fcpb_rl_mi varchar[],
fcnb_rl_mi varchar[],
frpz_rl_mi varchar[],
frnz_rl_mi varchar[],
slsb_pq varchar[],
afty_kh varchar[],
chva_az_fb varchar[],
cafa_aq varchar[],
clhb_kz varchar[],
clcb_kz varchar[],
clrz_kz varchar[],
pahb_kz varchar[],
pacb_kz varchar[],
parz_kz varchar[],
kcaf_aa varchar[],
kclf_aa varchar[],
kczo_aa varchar[],
kwcz_az varchar[],
fcem_rl varchar[],
fcem_rl_mi varchar[],
fvem_rl varchar[],
fvem_rl_mp varchar[],
fvem_rl_mi varchar[],
frem_rl_mi varchar[],
frez_rl_mi varchar[],
glup_bc_nu varchar[],
glup_bc_nn varchar[],
zlc1_rq varchar[],
zlc2_rq varchar[],
zlc3_rq varchar[],
zlc4_rq varchar[],
rama_aa varchar[],
krea_b_po varchar[],
krem_o_po varchar[],
krec_o_po varchar[],
eiw_u_po varchar[],
hbap_b_po varchar[],
crp_b_po varchar[],
ddim_b_po varchar[],
tni_b_po varchar[],
tnt_b_po varchar[],
qm31_b varchar[],
qm32_b varchar[],
espd_aq varchar[],
dmrf_tz varchar[],
nhdl_b varchar[],
dmkz_tz varchar[],
askz_rz varchar[],
cokz_rz varchar[],
cvkz_kz varchar[],
gzkz_pz varchar[],
ozkz_az varchar[],
dckz_kz varchar[],
uikz_uz varchar[],
skkz_tz varchar[],
nfkz_uz varchar[],
obkz_az varchar[],
afkz_kz varchar[],
oskz_lz varchar[],
clkz_kz varchar[],
pakz_kz varchar[],
ldl_b_po varchar[],
nhdl_b_po varchar[],
czhb_az varchar[],
czcb_az varchar[],
hfty_kh varchar[],
dedd_pz varchar[],
izp_az varchar[],
dekz_pz varchar[],
dehb_pz varchar[],
derz_pz varchar[],
_iqi_ua varchar[],
egfc_o_fb varchar[],
egcc_o_fb varchar[],
dmr7_fa_li varchar[],
dmr7_fa_re varchar[],
dmma_fa_li varchar[],
dmma_fa_re varchar[],
albm_uq varchar[],
fac_ao varchar[],
caia_aq varchar[],
eetl_dq varchar[],
rcns_un_fb varchar[],
nief_un varchar[],
gsta_aq varchar[]);
Unsupported JOIN found in pivot_statement.
Converted crosstab SQL:

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_meetwaarden_current_date.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_labcodes_seg2.sql

[WARNING] SQL was not modified during conversion
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_meetwaarden_filter_seg2.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW proigia_meetwaarden_seg2 AS
SELECT * FROM crosstab(
$$
    SELECT DISTINCT ON (patient_id, nhgnr)
        patient_id,
        nhgnr,
        ARRAY[  uitslag_raw,
                datum::varchar,
                uitslag_waarde] as waarde_datum
    FROM proigia_meetwaarden_filter_seg2
    JOIN proigia_labcodes_seg2 USING (nhgnr)
    ORDER BY patient_id, nhgnr, datum DESC, uitslag_num DESC nulls last,
            uitslag_raw nulls last, uitslag_waarde nulls last
$$,$$
    SELECT nhgnr
    FROM indelingen.nhg_labcodes
    JOIN proigia_labcodes_seg2 USING (nhgnr)
    ORDER BY nhgnr
$$
) as ct(
patient_id bigint,
Unsupported JOIN found in pivot_statement.
Converted crosstab SQL:

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_meetwaarden_seg2.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_override_pre.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_override.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_override_status.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_override_3mt_pre.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_override_3mt.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_override_3mt_status.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_patienten_gegevens_alle.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_patienten_gegevens.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_patienten_gegevens_current_date.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Er wordt Ã©Ã©n dag bij opgeteld, omdat in de views hierna < peildatum wordt gebruikt. #}
SELECT
  C
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_peildatum_extractiedatum.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_ruiter.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_ruiter_poh.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_verrichting.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage\proigia_opslagwijk.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage_qlik\proigia_qlik_metadata.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage_qlik\proigia_qlik_patienten_gegevens_alle.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# kopie van proigia_episode_filter - eigen peildatum #}
WITH pre_episode AS (
  SELECT
    episode_
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage_qlik\proigia_qlik_episode_filter.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# view wordt nog niet gebruikt, dus supportview gemaakt #}
WITH icpc_codes AS (
  SELECT
    icpc
 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage_qlik\proigia_qlik_icpc_codes.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW proigia_qlik_episode AS


WITH crosstab_episode AS
(
SELECT * FROM crosstab(
    $$
    SELECT
        patient_id,
        name,
        ARRAY[min(begindatum)::varchar,
                max(einddatum)::varchar,
                max(status_datum)::varchar,
                max(status_vlag)::varchar,
                array_agg(distinct icpc)::varchar,
                max(begindatum)::varchar,
                min(einddatum)::varchar,
                min(begindatum_nonactief)::varchar,
                max(einddatum_nonactief)::varchar,
                max(begindatum_nonactief)::varchar,
                min(einddatum_nonactief)::varchar] as waardes
    FROM proigia_qlik_episode_filter
    JOIN proigia_qlik_icpc_codes ON icpc ilike searchstring
    GROUP BY patient_id, name
    ORDER BY patient_id, name
$$,$$
    SELECT name
    FROM proigia_qlik_icpc_codes
    ORDER BY name;
$$
) as ct(
patient_id bigint,
    a04_ varchar[],
    a05_ varchar[],
    a10_ varchar[],
    a13_ varchar[],
    a20_ varchar[],
    a29_01 varchar[],
    a46_ varchar[],
    a49_ varchar[],
    a49_01 varchar[],
    a49_02 varchar[],
    a79_ varchar[],
    a80_ varchar[],
    a87_ varchar[],
    a91_05 varchar[],
    a91_06 varchar[],
    a91_07 varchar[],
    a97_ varchar[],
    a97_02 varchar[],
    a99_ varchar[],
    b72_ varchar[],
    b73_ varchar[],
    b74_ varchar[],
    b78_ varchar[],
    b79_ varchar[],
    b80_ varchar[],
    b81_ varchar[],
    b82_ varchar[],
    b83 varchar[],
    b83_ varchar[],
    b83_01 varchar[],
    b83_02 varchar[],
    b90_ varchar[],
    d01_ varchar[],
    d02_ varchar[],
    d03_ varchar[],
    d14_ varchar[],
    d15_ varchar[],
    d16_ varchar[],
    d17_ varchar[],
    d72_ varchar[],
    d74_ varchar[],
    d75_ varchar[],
    d76_ varchar[],
    d77_ varchar[],
    d77_01 varchar[],
    d84_ varchar[],
    d85_ varchar[],
    d86_ varchar[],
    d86_01 varchar[],
    d87 varchar[],
    d87_ varchar[],
    d87_01 varchar[],
    d87_02 varchar[],
    d94_ varchar[],
    d97_04 varchar[],
    f05_ varchar[],
    f74_01 varchar[],
    f75_ varchar[],
    f83_ varchar[],
    f83_01 varchar[],
    f99_ varchar[],
    h02_ varchar[],
    h75_01 varchar[],
    h86_ varchar[],
    k02_ varchar[],
    k07_ varchar[],
    k29 varchar[],
    k29_ varchar[],
    k49 varchar[],
    k49_ varchar[],
    k49_01 varchar[],
    k71_ varchar[],
    k72_01 varchar[],
    k73_ varchar[],
    k74 varchar[],
    k74_ varchar[],
    k74_01 varchar[],
    k74_02 varchar[],
    k75_ varchar[],
    k76 varchar[],
    k76_ varchar[],
    k76_01 varchar[],
    k76_02 varchar[],
    k77 varchar[],
    k77_ varchar[],
    k77_01 varchar[],
    k77_02 varchar[],
    k78_ varchar[],
    k79_ varchar[],
    k80_ varchar[],
    k82_ varchar[],
    k83_ varchar[],
    k83_01 varchar[],
    k83_02 varchar[],
    k84_03 varchar[],
    k85_ varchar[],
    k86_ varchar[],
    k87_ varchar[],
    k88_ varchar[],
    k89_ varchar[],
    k90 varchar[],
    k90_ varchar[],
    k90_01 varchar[],
    k90_02 varchar[],
    k90_03 varchar[],
    k91_ varchar[],
    k92 varchar[],
    k92_ varchar[],
    k92_01 varchar[],
    k92_03 varchar[],
    k93_ varchar[],
    k94_01 varchar[],
    k99_ varchar[],
    k99_01 varchar[],
    k99_06 varchar[],
    l29_ varchar[],
    l49_ varchar[],
    l71_01 varchar[],
    l88 varchar[],
    l88_ varchar[],
    l88_01 varchar[],
    l88_02 varchar[],
    l99_13 varchar[],
    n02_ varchar[],
    n74_ varchar[],
    n94_ varchar[],
    n94_02 varchar[],
    p_ varchar[],
    p01_ varchar[],
    p02_ varchar[],
    p03_ varchar[],
    p04_ varchar[],
    p05_ varchar[],
    p06_ varchar[],
    p06_01 varchar[],
    p10_ varchar[],
    p11_ varchar[],
    p12_ varchar[],
    p13_ varchar[],
    p15_ varchar[],
    p15_02 varchar[],
    p16_ varchar[],
    p17_ varchar[],
    p18_ varchar[],
    p19_ varchar[],
    p19_01 varchar[],
    p19_02 varchar[],
    p20_ varchar[],
    p21_ varchar[],
    p22_ varchar[],
    p23_ varchar[],
    p24_ varchar[],
    p25_ varchar[],
    p29_ varchar[],
    p70_ varchar[],
    p70_01 varchar[],
    p70_02 varchar[],
    p71_ varchar[],
    p72_ varchar[],
    p73_ varchar[],
    p74_ varchar[],
    p76_ varchar[],
    p78_ varchar[],
    p79_ varchar[],
    p85_ varchar[],
    p98_ varchar[],
    p99_ varchar[],
    r02_ varchar[],
    r05_ varchar[],
    r06_ varchar[],
    r29_02 varchar[],
    r44_ varchar[],
    r81_ varchar[],
    r84_ varchar[],
    r85_ varchar[],
    r91_ varchar[],
    r95_ varchar[],
    r96 varchar[],
    r96_ varchar[],
    r96_01 varchar[],
    r96_02 varchar[],
    s77_02 varchar[],
    s77_03 varchar[],
    s77_04 varchar[],
    s91_ varchar[],
    s97_ varchar[],
    t05_ varchar[],
    t06_ varchar[],
    t08_ varchar[],
    t29_ varchar[],
    t71_ varchar[],
    t82_ varchar[],
    t85_ varchar[],
    t86_ varchar[],
    t90 varchar[],
    t90_ varchar[],
    t90_01 varchar[],
    t90_02 varchar[],
    t91_ varchar[],
    t92_ varchar[],
    t93 varchar[],
    t93_ varchar[],
    t93_01 varchar[],
    t93_02 varchar[],
    t93_03 varchar[],
    t93_04 varchar[],
    t99_06 varchar[],
    t99_07 varchar[],
    u04_ varchar[],
    u04_01 varchar[],
    u04_02 varchar[],
    u04_03 varchar[],
    u75_ varchar[],
    u76_ varchar[],
    u77_ varchar[],
    u88_ varchar[],
    u98_01 varchar[],
    u98_03 varchar[],
    u99 varchar[],
    u99_ varchar[],
    u99_01 varchar[],
    w78_ varchar[],
    w79_ varchar[],
    w81_ varchar[],
    w84_02 varchar[],
    w84_03 varchar[],
    x37_ varchar[],
    x49_ varchar[],
    x75_ varchar[],
    x76_ varchar[],
    x77_ varchar[],
    y77_ varchar[],
    y78_ varchar[],
    z_ varchar[],
    z04_ varchar[],
    z04_03 varchar[],
    z07_ varchar[],
    z12_ varchar[],
    z16_ varchar[],
    z18_ varchar[],
    z20_ varchar[],
    z21_ varchar[],
    z22_ varchar[],
    z23_ varchar[],
    z24_ varchar[],
    z25_ varchar[],
    z28_ varchar[],
    z29_ varchar[],
    z29_01 varchar[])
)
SELECT ce.*,
    COALESCE(stable_patient_id,'missing') as stable_patient_id,
    '${agb}'::int as practice_agb,
    ARRAY[stable_patient_id,'${agb}'] as patient_id_agb
FROM crosstab_episode ce
LEFT JOIN proigia_qlik_patienten_gegevens_alle USING (patient_id);
Converted crosstab SQL:
WITH cte1 AS (

    SELECT
        patient_id,
        name,
        ARRAY[min(begindatum)::varchar,
                max(einddatum)::varchar,
                max(status_datum)::varchar,
                max(status_vlag)::varchar,
                array_agg(distinct icpc)::varchar,
                max(begindatum)::varchar,
                min(einddatum)::varchar,
                min(begindatum_nonactief)::varchar,
                max(einddatum_nonactief)::varchar,
                max(begindatum_nonactief)::varchar,
                min(einddatum_nonactief)::varchar] as waardes
    FROM {{ ref('proigia_qlik_episode_filter') }}
    JOIN {{ ref('proigia_qlik_icpc_codes') }} ON icpc ilike searchstring
    GROUP BY patient_id, name
    ORDER BY patient_id, name

)
SELECT patient_id
, {{ dbt_utils.pivot('name',        dbt_utils.get_column_values(ref('proigia_qlik_icpc_codes'),'categorie',default=[]),        agg='',        then_value='name',        else_value="ARRAY_CONSTRUCT()",        quote_identifiers=False)}} 
FROM cte1
GROUP BY patient_id
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage_qlik\proigia_qlik_episode.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Kopie van proigia_episode_filter. #} {# Afwijking: omschrijving. #}
WITH unnested AS (
  SELECT
 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage_qlik\proigia_qlik_dm2_in_remissie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage_qlik\proigia_qlik_medicatie_filter_3jr.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# kopie van proigia_atc_codes #}
WITH atc_codes AS (
  SELECT
    atc
  FROM (VALUES
    ('A02'),
 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage_qlik\proigia_qlik_atc_codes.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW proigia_qlik_medicatie_3jr_crosstab_pre AS
SELECT
    patient_id,
    practice_agb,
    patient_id_agb,
    voorschrijfdatum,
    einddatum,
    atc_code,
    chronisch,
    iteraties,
    atc as categorie
FROM proigia_qlik_medicatie_filter_3jr mf
JOIN proigia_qlik_atc_codes ON atc_code ilike searchstring;
Converted crosstab SQL:

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage_qlik\proigia_qlik_medicatie_3jr_crosstab_pre.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW proigia_qlik_medicatie_3jr AS
WITH crosstab_medicatie AS
(
SELECT * FROM crosstab($$
    SELECT
        patient_id,
        categorie,
        ARRAY[
            count(*)::varchar,
            max(voorschrijfdatum)::varchar,
            min(voorschrijfdatum)::varchar,
            array_agg(distinct atc_code)::varchar
            ] as resultaat
    FROM proigia_qlik_medicatie_3jr_crosstab_pre
    GROUP BY patient_id, categorie
    ORDER BY patient_id, categorie
$$,$$
    SELECT atc FROM proigia_qlik_atc_codes ORDER BY atc
$$) as
(
    patient_id bigint,
    a02 varchar[],
    a02ba varchar[],
    a02bc varchar[],
    a02bc01 varchar[],
    a02bc02 varchar[],
    a10 varchar[],
    a10a varchar[],
    a10ab varchar[],
    a10ab01 varchar[],
    a10ab04 varchar[],
    a10ab05 varchar[],
    a10ab06 varchar[],
    a10ac varchar[],
    a10ac01 varchar[],
    a10ad varchar[],
    a10ae varchar[],
    a10ae04 varchar[],
    a10ae05 varchar[],
    a10ae54 varchar[],
    a10ae56 varchar[],
    a10af varchar[],
    a10b varchar[],
    a10ba varchar[],
    a10ba02 varchar[],
    a10bb varchar[],
    a10bc varchar[],
    a10bd varchar[],
    a10bd02 varchar[],
    a10bd03 varchar[],
    a10bd05 varchar[],
    a10bd07 varchar[],
    a10bd08 varchar[],
    a10bd19 varchar[],
    a10bd20 varchar[],
    a10bf varchar[],
    a10bg varchar[],
    a10bg03 varchar[],
    a10bh varchar[],
    a10bj varchar[],
    a10bj01 varchar[],
    a10bj02 varchar[],
    a10bj03 varchar[],
    a10bj05 varchar[],
    a10bj06 varchar[],
    a10bk varchar[],
    a10bk03 varchar[],
    a10bx varchar[],
    b01 varchar[],
    b01a varchar[],
    b01aa varchar[],
    b01aa04 varchar[],
    b01aa07 varchar[],
    b01ab varchar[],
    b01ac varchar[],
    b01ac01 varchar[],
    b01ac04 varchar[],
    b01ac06 varchar[],
    b01ac07 varchar[],
    b01ac08 varchar[],
    b01ac22 varchar[],
    b01ac24 varchar[],
    b01ac56 varchar[],
    b01ad varchar[],
    b01ae varchar[],
    b01ae07 varchar[],
    b01af varchar[],
    b01af01 varchar[],
    b01af02 varchar[],
    b01af03 varchar[],
    b01ax varchar[],
    c0 varchar[],
    c01 varchar[],
    c01aa varchar[],
    c01aa05 varchar[],
    c01b varchar[],
    c01ba01 varchar[],
    c01ba03 varchar[],
    c01bc03 varchar[],
    c01bc04 varchar[],
    c01bd01 varchar[],
    c01da varchar[],
    c02 varchar[],
    c03 varchar[],
    c03a varchar[],
    c03aa03 varchar[],
    c03ad01 varchar[],
    c03ba04 varchar[],
    c03ca01 varchar[],
    c03ca02 varchar[],
    c03cb01 varchar[],
    c03cb02 varchar[],
    c03da01 varchar[],
    c03da04 varchar[],
    c03eb01 varchar[],
    c03eb02 varchar[],
    c04 varchar[],
    c05 varchar[],
    c05ae03 varchar[],
    c06 varchar[],
    c07 varchar[],
    c07aa07 varchar[],
    c07ab02 varchar[],
    c07ab03 varchar[],
    c07ab07 varchar[],
    c08 varchar[],
    c08ca01 varchar[],
    c08ca05 varchar[],
    c08ca13 varchar[],
    c08da01 varchar[],
    c08da51 varchar[],
    c08db01 varchar[],
    c09 varchar[],
    c09a varchar[],
    c09aa varchar[],
    c09aa02 varchar[],
    c09aa03 varchar[],
    c09aa04 varchar[],
    c09aa15 varchar[],
    c09b varchar[],
    c09ba varchar[],
    c09bb varchar[],
    c09bb10 varchar[],
    c09bx varchar[],
    c09c varchar[],
    c09ca varchar[],
    c09ca01 varchar[],
    c09ca02 varchar[],
    c09ca03 varchar[],
    c09ca04 varchar[],
    c09ca06 varchar[],
    c09ca07 varchar[],
    c09d varchar[],
    c09da varchar[],
    c09da01 varchar[],
    c09da03 varchar[],
    c09da04 varchar[],
    c09da06 varchar[],
    c09da07 varchar[],
    c09db varchar[],
    c09dx varchar[],
    c10 varchar[],
    c10a varchar[],
    c10aa varchar[],
    c10aa01 varchar[],
    c10ba varchar[],
    h02 varchar[],
    h02aa02 varchar[],
    h02ab varchar[],
    h02ab02 varchar[],
    h02ab04 varchar[],
    h02ab06 varchar[],
    h02ab07 varchar[],
    h02ab08 varchar[],
    h02ab09 varchar[],
    h02ab10 varchar[],
    h06ab06 varchar[],
    h06ab07 varchar[],
    j01 varchar[],
    j01aa02 varchar[],
    j01ce02 varchar[],
    j01ce05 varchar[],
    j01cf02 varchar[],
    j01cf05 varchar[],
    j01ea01 varchar[],
    j01ma02 varchar[],
    j01xe01 varchar[],
    j07bb varchar[],
    m01a varchar[],
    m01ab05 varchar[],
    m01ab51 varchar[],
    m01ab55 varchar[],
    m01ae varchar[],
    m01ae01 varchar[],
    m01ae02 varchar[],
    m01ae52 varchar[],
    m01ba03 varchar[],
    m04aa01 varchar[],
    m05 varchar[],
    n02ab varchar[],
    n02aj02 varchar[],
    n02aj08 varchar[],
    n02aj14 varchar[],
    n02aj18 varchar[],
    n02aj19 varchar[],
    n02ba varchar[],
    n02be51 varchar[],
    n02cc varchar[],
    n05a varchar[],
    n05aa varchar[],
    n05ab varchar[],
    n05ad varchar[],
    n05ae varchar[],
    n05af varchar[],
    n05ag varchar[],
    n05ah varchar[],
    n05al varchar[],
    n05an varchar[],
    n05ax varchar[],
    n05ba varchar[],
    n05be varchar[],
    n05c varchar[],
    n05cd varchar[],
    n05cf varchar[],
    n05cm varchar[],
    n06a varchar[],
    n06aa varchar[],
    n06ab varchar[],
    n06af varchar[],
    n06ag varchar[],
    n06ax varchar[],
    n06ax05 varchar[],
    n06ax16 varchar[],
    n06ax21 varchar[],
    n06ba varchar[],
    n06ba02 varchar[],
    n06ba04 varchar[],
    n06d varchar[],
    n07ba varchar[],
    r03 varchar[],
    r03a varchar[],
    r03aa varchar[],
    r03ab varchar[],
    r03ac varchar[],
    r03ac02 varchar[],
    r03ac03 varchar[],
    r03ac04 varchar[],
    r03ac12 varchar[],
    r03ac13 varchar[],
    r03ac18 varchar[],
    r03ac19 varchar[],
    r03ah varchar[],
    r03ak varchar[],
    r03ak04 varchar[],
    r03ak06 varchar[],
    r03ak07 varchar[],
    r03ak08 varchar[],
    r03ak09 varchar[],
    r03ak10 varchar[],
    r03ak11 varchar[],
    r03ak12 varchar[],
    r03ak13 varchar[],
    r03al varchar[],
    r03al03 varchar[],
    r03al04 varchar[],
    r03al05 varchar[],
    r03al06 varchar[],
    r03al07 varchar[],
    r03al08 varchar[],
    r03al09 varchar[],
    r03b varchar[],
    r03ba varchar[],
    r03ba01 varchar[],
    r03ba02 varchar[],
    r03ba05 varchar[],
    r03ba08 varchar[],
    r03bb varchar[],
    r03bb01 varchar[],
    r03bb04 varchar[],
    r03bb05 varchar[],
    r03bb06 varchar[],
    r03bb07 varchar[],
    r03bb54 varchar[],
    r03bc varchar[],
    r03bx varchar[],
    r03da varchar[],
    r03db varchar[],
    r03dc varchar[],
    r03dc03 varchar[],
    r03dx varchar[])
)
SELECT cm.*,
    COALESCE(stable_patient_id,'missing') as stable_patient_id,
    '${agb}'::int as practice_agb,
    ARRAY[stable_patient_id,'${agb}'] as patient_id_agb
FROM crosstab_medicatie cm
LEFT JOIN proigia_qlik_patienten_gegevens_alle USING (patient_id);
Converted crosstab SQL:
WITH cte1 AS (

    SELECT
        patient_id,
        categorie,
        ARRAY[
            count(*)::varchar,
            max(voorschrijfdatum)::varchar,
            min(voorschrijfdatum)::varchar,
            array_agg(distinct atc_code)::varchar
            ] as resultaat
    FROM {{ ref('proigia_qlik_medicatie_3jr_crosstab_pre') }}
    GROUP BY patient_id, categorie
    ORDER BY patient_id, categorie

)
SELECT patient_id
, {{ dbt_utils.pivot('atc',        dbt_utils.get_column_values(ref('proigia_qlik_atc_codes'),'categorie',default=[]),        agg='',        then_value='categorie',        else_value="ARRAY_CONSTRUCT()",        quote_identifiers=False)}} 
FROM cte1
GROUP BY patient_id
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage_qlik\proigia_qlik_medicatie_3jr.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage_qlik\proigia_qlik_polyfarmacie_pre.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# view is erg groot, voor nu alleen reguliere cnt meegenomen #}
WITH med_filter_1 AS (
  SELECT
   
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage_qlik\proigia_qlik_polyfarmacie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage_qlik\proigia_qlik_polyfarmacie_kalenderjaar.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# kopie van proigia_meetwaarden_filter - eigen labcodes, peildatum #}
WITH nhgnr_verrijking AS
(
  
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage_qlik\proigia_qlik_meetwaarden_filter_pre.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage_qlik\proigia_qlik_meetwaarden_filter.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage_qlik\proigia_qlik_meetwaarden_filter_ooit.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {#  Bij wijziging ook wijzigen in de ct in de view proigia_qlik_meetwaarden hieronder. #}
SELECT
   
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage_qlik\proigia_qlik_labcodes.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW proigia_qlik_meetwaarden AS

WITH crosstab_meetwaarden AS
(
    SELECT * FROM crosstab(
    $$
    SELECT DISTINCT ON (patient_id, nhgnr)
        patient_id,
        nhgnr,
        ARRAY[  uitslag_raw,
                datum::varchar,
                uitslag_waarde] as waarde_datum
    FROM proigia_qlik_meetwaarden_filter
    JOIN proigia_qlik_labcodes USING (nhgnr)
    ORDER BY patient_id, nhgnr, datum DESC,
            uitslag_raw nulls last, uitslag_waarde nulls last
$$,$$
    SELECT nhgnr
    FROM indelingen.nhg_labcodes
    JOIN proigia_qlik_labcodes USING (nhgnr)
    ORDER BY nhgnr
$$
) as ct(
patient_id bigint,
    af_b varchar[],
    alat_b varchar[],
    alb_b varchar[],
    alb_u varchar[],
    alb_ue_mt varchar[],
    albk_u_mi varchar[],
    albk_ue_mi varchar[],
    asat_b varchar[],
    bili_b varchar[],
    ca_b varchar[],
    chhd_b_mi varchar[],
    chol_b_mt varchar[],
    fosf_b varchar[],
    fosf_u varchar[],
    fosf_ue_mt varchar[],
    ft3_b varchar[],
    ft4_b varchar[],
    gew_ao varchar[],
    glhb_b varchar[],
    gluc_b_nn varchar[],
    gluc_b_nu varchar[],
    gluc_bc_nn varchar[],
    gluc_bc_nu varchar[],
    hb_b varchar[],
    hdl_b varchar[],
    k_b varchar[],
    k_u varchar[],
    krea_b varchar[],
    krea_o_mk varchar[],
    ldhd_b_mi varchar[],
    ldl_b varchar[],
    lngp_ao varchar[],
    na_b varchar[],
    oa01_o varchar[],
    oa02_o varchar[],
    oa03_o varchar[],
    oa04_o varchar[],
    oa05_o varchar[],
    pap_xp_bv varchar[],
    pap_xp_im varchar[],
    pap_xp_iz varchar[],
    pap_xp_mm varchar[],
    pap_xp_wo varchar[],
    papa_xp varchar[],
    papb_xp varchar[],
    papc_xp varchar[],
    paph_xp varchar[],
    papk_xp varchar[],
    papn_xp varchar[],
    papo_xp varchar[],
    papp_xp varchar[],
    phad_b_sr varchar[],
    pth_b varchar[],
    q001_b varchar[],
    q002_b varchar[],
    q003_b varchar[],
    quet_ao varchar[],
    te_u_kw varchar[],
    trig_b varchar[],
    trom_b_mt varchar[],
    tsh_b varchar[],
    vb12_b varchar[],
    vd_b varchar[],
    alco_pq varchar[],
    ampu_lv_li varchar[],
    ampu_lv_re varchar[],
    angk_kq varchar[],
    asac_rz varchar[],
    asdu_rq varchar[],
    asfb_rq varchar[],
    asgb_rq varchar[],
    ashs_rq varchar[],
    asit_rq varchar[],
    askk_rq varchar[],
    aspk_rq varchar[],
    astl_rq varchar[],
    astt_rq varchar[],
    aswi_rq varchar[],
    aswk_rq varchar[],
    bewg_lv_li varchar[],
    bewg_lv_re varchar[],
    clkl_kq varchar[],
    dmtm_tq varchar[],
    cohz_kq varchar[],
    dmtv_tq varchar[],
    dafu_fz varchar[],
    dblo_lv_li varchar[],
    dblo_lv_re varchar[],
    decc_kq varchar[],
    detk_kq varchar[],
    dmfm_tq varchar[],
    dmp_tz varchar[],
    dmrp_fa_li varchar[],
    dmrp_fa_re varchar[],
    dmzp_tz varchar[],
    druk_lv_li varchar[],
    druk_lv_re varchar[],
    dysp_rq varchar[],
    eelt_lv_li varchar[],
    eelt_lv_re varchar[],
    fv1v_rl_fb varchar[],
    fvbe_rl_mp varchar[],
    fcpb_rl varchar[],
    frpb_rl_mi varchar[],
    fvnb_rl varchar[],
    fvnb_rl_mp varchar[],
    fvns_rl varchar[],
    fvns_rl_mp varchar[],
    fvpb_rl varchar[],
    fvpb_rl_mp varchar[],
    fvps_rl_mp varchar[],
    fvrp_rl varchar[],
    fvrv_rl varchar[],
    hoes_rq varchar[],
    hypt_kq varchar[],
    infc_lv_li varchar[],
    infc_lv_re varchar[],
    insp_lv_li varchar[],
    insp_lv_re varchar[],
    kleu_lv_li varchar[],
    kleu_lv_re varchar[],
    lfcn_rl varchar[],
    libw_aq varchar[],
    lmbt_rl varchar[],
    mofv_ns_li varchar[],
    mofv_ns_re varchar[],
    minh_rq varchar[],
    onpr_rq varchar[],
    pakj_aq varchar[],
    pals_rq varchar[],
    padp_kv_li varchar[],
    padp_kv_re varchar[],
    patp_kv_li varchar[],
    patp_kv_re varchar[],
    rook_aq varchar[],
    rrdi_ka varchar[],
    rrsy_ka varchar[],
    rrsy_ka_pl varchar[],
    staf_lv_li varchar[],
    staf_lv_re varchar[],
    snsv_ns_li varchar[],
    snsv_ns_re varchar[],
    ulce_lv_li varchar[],
    ulce_lv_re varchar[],
    vipb_fq varchar[],
    voed_tz varchar[],
    vsho_tq varchar[],
    dmac_tz varchar[],
    dmcb_tz varchar[],
    ascb_rz varchar[],
    cott_rq varchar[],
    coac_rz varchar[],
    cocb_rz varchar[],
    asrz_rz varchar[],
    dmrz_tz varchar[],
    dmmd_tq varchar[],
    adgw_tq varchar[],
    advd_tq varchar[],
    admi_aq varchar[],
    adgv_aq varchar[],
    adlb_aq varchar[],
    dmvc_tz varchar[],
    corz_rz varchar[],
    glsw_tq varchar[],
    aser_rq varchar[],
    aszp_rz varchar[],
    adsa_zq varchar[],
    asza_rz varchar[],
    dmto_fz varchar[],
    opmo_lv varchar[],
    fcnb_rl varchar[],
    frnb_rl_mi varchar[],
    rfam_rq varchar[],
    ausc_rl varchar[],
    omva_dh varchar[],
    pols_ao varchar[],
    frns_rl_mi varchar[],
    krea_o_fb varchar[],
    krem_o_fb varchar[],
    gfr_b varchar[],
    lyso_nl varchar[],
    bnp_b varchar[],
    ntpr_b varchar[],
    sipd_aq varchar[],
    sgpd_aq varchar[],
    stda_az varchar[],
    srda_aq varchar[],
    pppd_aq varchar[],
    rfms_rq varchar[],
    afau_rl varchar[],
    roac_az varchar[],
    papq_xp varchar[],
    pavl_kq varchar[],
    rrsy_ka_mh varchar[],
    rrdi_ka_mh varchar[],
    hvpe_kz varchar[],
    schk_b_cd varchar[],
    ausc_kh varchar[],
    afau_kh varchar[],
    hvvw_kz varchar[],
    fvsb_rl varchar[],
    fvsb_rl_mp varchar[],
    fvrn_rl varchar[],
    frsb_rl_mi varchar[],
    polr_ao varchar[],
    fufo_fa varchar[],
    hvzf_kq varchar[],
    asvw_rz varchar[],
    advd_aq varchar[],
    byvd_aa varchar[],
    dmvw_tz varchar[],
    fhcf_tq varchar[],
    rrsy_ka_ps varchar[],
    rivu_sq varchar[],
    hvtm_kq varchar[],
    ecg_kh varchar[],
    dmhb_tz varchar[],
    hvvc_kz varchar[],
    coer_rq varchar[],
    mrcd_rq varchar[],
    rhvz_kq_fb varchar[],
    echo_un_li varchar[],
    echo_un_re varchar[],
    ccq1_rq varchar[],
    ccq2_rq varchar[],
    ccq3_rq varchar[],
    ccq4_rq varchar[],
    ccq5_rq varchar[],
    ccq6_rq varchar[],
    ccq7_rq varchar[],
    ccq8_rq varchar[],
    ccq9_rq varchar[],
    ccqx_rq varchar[],
    ccqs_rq varchar[],
    ccqf_rq varchar[],
    ccqm_rq varchar[],
    ccqt_rq varchar[],
    mosr_aq varchar[],
    ashb_rz varchar[],
    cohb_rz varchar[],
    gew_ao_mh varchar[],
    hvcb_kz varchar[],
    hvrz_kz varchar[],
    _sh1_pq varchar[],
    _sh2_pq varchar[],
    _sh3_pq varchar[],
    _sh4_pq varchar[],
    _sh5_pq varchar[],
    _sht_pq varchar[],
    mmst_pq varchar[],
    dmtv_lz varchar[],
    dmov_tz varchar[],
    vvig_tq varchar[],
    h002_sa varchar[],
    h003_sa varchar[],
    glhc_b varchar[],
    vvmi_ao_mi varchar[],
    rr24_ka_mh varchar[],
    rrgs_ka_mh varchar[],
    rrgd_ka_mh varchar[],
    rrns_ka_mh varchar[],
    rrds_ka_mh varchar[],
    rrdd_ka_mh varchar[],
    gewv_aa varchar[],
    covv_rq varchar[],
    o2sa_ao varchar[],
    oldt_pq varchar[],
    ldld_b varchar[],
    b12t_b varchar[],
    gzhb_pz varchar[],
    fsfu_fz varchar[],
    bzvd_aa varchar[],
    pver_kq varchar[],
    dcer_kq varchar[],
    acqt_rq varchar[],
    hbdf_aq varchar[],
    aval_aq varchar[],
    egzb_aq varchar[],
    ebgp_aq varchar[],
    ghpb_hq varchar[],
    pofa_aq varchar[],
    klvg_pq varchar[],
    slpb_aq varchar[],
    smst_pq varchar[],
    vipl_pq varchar[],
    vlsc_aq varchar[],
    ozo_aq varchar[],
    awkw_az varchar[],
    oze_az varchar[],
    oztv_az varchar[],
    ozvc_az varchar[],
    ozp_az varchar[],
    gfit_aq varchar[],
    cldt_aq varchar[],
    cizi_az varchar[],
    zzpv_az varchar[],
    adme_aq varchar[],
    bdgo_aq varchar[],
    zdgb_aq varchar[],
    kwbh_az varchar[],
    gdst_pq varchar[],
    _dan_pq varchar[],
    _dde_pq varchar[],
    _ddi_pq varchar[],
    _dso_pq varchar[],
    cvhb_kz varchar[],
    hbac_b varchar[],
    hbad_aq varchar[],
    ortd_aq varchar[],
    orpl_aq varchar[],
    orps_aq varchar[],
    hbmb_aq varchar[],
    sn65_tq varchar[],
    blmz_aq varchar[],
    ocfm_xq varchar[],
    ccfm_dq varchar[],
    echo_kh varchar[],
    poed_le varchar[],
    lvef_kh varchar[],
    mnpz_xq varchar[],
    zlcp_ra varchar[],
    coex_rq varchar[],
    ozhb_az varchar[],
    dchb_az varchar[],
    drug_aq varchar[],
    bdi1_pq varchar[],
    bdi2_pq varchar[],
    bai_pq varchar[],
    uihb_uz varchar[],
    skhb_tz varchar[],
    sdda_aq varchar[],
    gluc_ba_nu varchar[],
    gluc_ba_nn varchar[],
    hf65_kq varchar[],
    nngb_aq varchar[],
    fitn_aq varchar[],
    rh12_kq_fb varchar[],
    rvfh_kq_fb varchar[],
    hfvw_kz varchar[],
    adag_aq varchar[],
    vmhf_kq varchar[],
    hklp_kq varchar[],
    hbap_b varchar[],
    inch_uq varchar[],
    incf_uq varchar[],
    sndv_uq varchar[],
    dst_aq varchar[],
    hfcb_kz varchar[],
    ra_lq varchar[],
    ecgf_kh varchar[],
    tfi_aq varchar[],
    rrs7_ka_mh varchar[],
    rrd7_ka_mh varchar[],
    phq9_pq varchar[],
    rr3s_ka varchar[],
    rr3d_ka varchar[],
    acq6_rq varchar[],
    acq7_rq varchar[],
    cact_rq varchar[],
    nfhb_uz varchar[],
    isar_aq varchar[],
    audc_pq varchar[],
    obhb_az varchar[],
    obcb_az varchar[],
    obrz_az varchar[],
    afrz_kz varchar[],
    afhb_kz varchar[],
    afcb_kz varchar[],
    ozcb_az varchar[],
    ozrz_az varchar[],
    hfrz_kz varchar[],
    uicb_uz varchar[],
    skcb_tz varchar[],
    nfcb_uz varchar[],
    uirz_uz varchar[],
    skrz_tz varchar[],
    nfrz_uz varchar[],
    hbsw_tq varchar[],
    dpos_pq varchar[],
    dper_pq varchar[],
    dprc_pq varchar[],
    dpsb_pq varchar[],
    ggvc_pz varchar[],
    ggcb_pz varchar[],
    ggrz_pz varchar[],
    ggbm_pq varchar[],
    ggad_pq varchar[],
    ggp_pz varchar[],
    ansb_pq varchar[],
    agsg_pq varchar[],
    agsb_pq varchar[],
    rrsw_kq varchar[],
    oshb_lz varchar[],
    oscb_lz varchar[],
    osrz_lz varchar[],
    coae_rq varchar[],
    act_rq varchar[],
    ggbe_pz varchar[],
    cld3_aq varchar[],
    cldc_aq varchar[],
    krec_o_fb varchar[],
    acqk_rq varchar[],
    scfq_rl varchar[],
    asoc_rq varchar[],
    zpvu_sq varchar[],
    fvpb_rl_mi varchar[],
    fvnb_rl_mi varchar[],
    fcpb_rl_mi varchar[],
    fcnb_rl_mi varchar[],
    frpz_rl_mi varchar[],
    frnz_rl_mi varchar[],
    slsb_pq varchar[],
    afty_kh varchar[],
    chva_az_fb varchar[],
    cafa_aq varchar[],
    clhb_kz varchar[],
    clcb_kz varchar[],
    clrz_kz varchar[],
    pahb_kz varchar[],
    pacb_kz varchar[],
    parz_kz varchar[],
    stgs_a_mh varchar[],
    sths_a_mh varchar[],
    stws_a_mh varchar[],
    stgt_a_mh varchar[],
    kwcz_az varchar[],
    fcem_rl varchar[],
    fcem_rl_mi varchar[],
    fvem_rl varchar[],
    fvem_rl_mp varchar[],
    fvem_rl_mi varchar[],
    frem_rl_mi varchar[],
    frez_rl_mi varchar[],
    vfrq_kh varchar[],
    glup_bc_nu varchar[],
    glup_bc_nn varchar[],
    zlc1_rq varchar[],
    zlc2_rq varchar[],
    zlc3_rq varchar[],
    zlc4_rq varchar[],
    krea_b_po varchar[],
    krem_o_po  varchar[],
    krec_o_po  varchar[],
    hbap_b_po varchar[],
    crp_b_po varchar[],
    ddim_b_po varchar[],
    tni_b_po varchar[],
    tnt_b_po varchar[],
    espd_aq varchar[],
    dmrf_tz varchar[],
    nhdl_b varchar[],
    dmkz_tz varchar[],
    askz_rz varchar[],
    cokz_rz varchar[],
    cvkz_kz varchar[],
    gzkz_pz varchar[],
    ozkz_az varchar[],
    dckz_kz varchar[],
    uikz_uz varchar[],
    skkz_tz varchar[],
    nfkz_uz varchar[],
    obkz_az varchar[],
    afkz_kz varchar[],
    oskz_lz varchar[],
    clkz_kz varchar[],
    pakz_kz varchar[],
    ldl_b_po varchar[],
    trig_b_po varchar[],
    czhb_az varchar[],
    czcb_az varchar[],
    ediz_aq varchar[],
    hfty_kh varchar[],
    dedd_pz varchar [],
    izp_az varchar [],
    dekz_pz varchar[],
    dehb_pz varchar[],
    derz_pz varchar[],
    _iqi_ua varchar[],
    egfc_o_fb varchar[],
    egcc_o_fb varchar[],
    zobe_aq varchar[],
    dmr7_fa_li varchar[],
    dmr7_fa_re varchar[],
    dmma_fa_li varchar[],
    dmma_fa_re varchar[],
    rcns_un_fb varchar[],
    gsta_aq varchar[],
    ldsw_bq varchar[],
    rh19_kq_fb varchar[],
    lsag_aq varchar[],
    hf19_kq varchar[],
    cac_kh varchar[],
    bwrl_aq varchar[],
    dmdo_az varchar[],
    vodm_lz varchar[],
    vrit_aa varchar[],
    rh24_kq_fb varchar[],
    lh24_kq_fb varchar[],
    cacp_kh varchar[],
    rsto__promed varchar[])
)
SELECT cm.*,
    COALESCE(stable_patient_id,'missing') as stable_patient_id,
    '${agb}'::int as practice_agb,
    ARRAY[stable_patient_id,'${agb}'] as patient_id_agb
FROM crosstab_meetwaarden cm
LEFT JOIN proigia_qlik_patienten_gegevens_alle USING (patient_id);
Unsupported JOIN found in pivot_statement.
Converted crosstab SQL:

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage_qlik\proigia_qlik_meetwaarden.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage_qlik\proigia_qlik_verwijzingen.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: CREATE VIEW proigia_qlik_journaal_filter_pre
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage_qlik\proigia_qlik_journaal_filter_pre.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage_qlik\proigia_qlik_journaal_filter.sql

[WARNING] SQL was not modified during conversion
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage_qlik\proigia_qlik_contact_pre.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage_qlik\proigia_qlik_contact.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage_qlik\proigia_qlik_achterstandswijk.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW proigia_qlik_hoofdbehandelaar AS

WITH alle_hb AS
(
    SELECT
        patient_id,
        nhgnr,
        datum,
        uitslag_raw,
        uitslag_waarde
    FROM proigia_qlik_meetwaarden_filter_ooit
    WHERE omschrijving ilike '%hoofdbehandelaar%'
),
max_datum_niet_ha AS
(
    SELECT
        patient_id,
        nhgnr,
        max(datum) as max_dd_niet_huisarts
    FROM alle_hb
    WHERE (uitslag_waarde <> 'huisarts' or uitslag_waarde IS NULL)
    GROUP BY patient_id, nhgnr
),
min_datum_wel_ha AS
(
    SELECT
        patient_id,
        nhgnr,
        min(datum) as min_dd_huisarts
    FROM alle_hb
    LEFT JOIN max_datum_niet_ha USING (patient_id, nhgnr)
    WHERE uitslag_waarde = 'huisarts'
    AND (datum >= max_dd_niet_huisarts or max_dd_niet_huisarts IS NULL)
    GROUP BY patient_id, nhgnr
)
SELECT
    patient_id,
    COALESCE(stable_patient_id,'missing') as stable_patient_id,
    nhgnr,
    min_dd_huisarts,
    max_dd_niet_huisarts
FROM min_datum_wel_ha
LEFT JOIN max_datum_niet_ha USING (patient_id, nhgnr)
LEFT JOIN proigia_qlik_patienten_gegevens_alle USING (patient_id)
ORDER BY patient_id, nhgnr;
Converted crosstab SQL:

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage_qlik\proigia_qlik_hoofdbehandelaar.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW proigia_qlik_deelname_ketenzorg AS

WITH alle_dk AS
(
    SELECT
        patient_id,
        nhgnr,
        datum,
        uitslag_raw,
        uitslag_waarde
    FROM proigia_qlik_meetwaarden_filter_ooit
    WHERE omschrijving ilike '%deelname%keten%'
),
max_datum_niet_dk AS
(
    SELECT
        patient_id,
        nhgnr,
        max(datum) as max_dd_niet_dk
    FROM alle_dk
    WHERE (uitslag_waarde <> 'ja' or uitslag_waarde IS NULL)
    GROUP BY patient_id, nhgnr
),
min_datum_wel_dk AS
(
    SELECT
        patient_id,
        nhgnr,
        min(datum) as min_dd_dk
    FROM alle_dk
    LEFT JOIN max_datum_niet_dk USING (patient_id, nhgnr)
    WHERE uitslag_waarde = 'ja'
    AND (datum >= max_dd_niet_dk or max_dd_niet_dk IS NULL)
    GROUP BY patient_id, nhgnr
)
SELECT
    patient_id,
    COALESCE(stable_patient_id,'missing') as stable_patient_id,
    nhgnr,
    min_dd_dk,
    max_dd_niet_dk
FROM min_datum_wel_dk
LEFT JOIN max_datum_niet_dk USING (patient_id, nhgnr)
LEFT JOIN proigia_qlik_patienten_gegevens_alle USING (patient_id)
ORDER BY patient_id, nhgnr;
Converted crosstab SQL:

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage_qlik\proigia_qlik_deelname_ketenzorg.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW proigia_qlik_dubbele_hb AS

WITH alle_hb AS
(
    SELECT
        patient_id,
        memo,
        datum,
        uitslag_waarde
    FROM proigia_qlik_meetwaarden_filter_ooit
    WHERE omschrijving ilike '%hoofdbehandelaar%'
    ORDER BY patient_id, memo, uitslag_waarde, datum desc
),
grouping_uitslagen AS
(
    SELECT
        patient_id,
        memo,
        datum,
        array_agg(distinct uitslag_waarde) FILTER (WHERE uitslag_waarde IS NOT NULL) as uitslagen
    FROM alle_hb
    GROUP BY patient_id, memo, datum
)
SELECT distinct on (patient_id, memo)
    patient_id,
    COALESCE(stable_patient_id,'missing') as stable_patient_id,
    memo||'_db' as memo_db,
    CASE WHEN array_length(uitslagen, 1) > 1 THEN 1 ELSE 0 END AS dubbele_hb,
    datum AS dubbele_hb_datum,
    array_to_string(uitslagen,'; ') AS dubbele_hb_uitslagen
FROM grouping_uitslagen
LEFT JOIN proigia_qlik_patienten_gegevens_alle USING (patient_id)
ORDER BY patient_id, memo, datum desc;
Converted crosstab SQL:

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage_qlik\proigia_qlik_dubbele_hb.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW proigia_qlik_substitutie AS

WITH kalenderjaar AS
(
    SELECT CASE WHEN extractiedatum::varchar ILIKE '%-01-01'
     THEN (EXTRACT(year FROM extractiedatum::date) - 1)
        ELSE EXTRACT(year FROM extractiedatum::date)
        END as kalenderjaar
    FROM proigia_qlik_metadata
),
alle_hb AS
(
    SELECT
        patient_id,
        nhgnr,
        datum,
        uitslag_raw,
        uitslag_waarde
    FROM proigia_qlik_meetwaarden_filter_ooit
    WHERE omschrijving ilike '%hoofdbehandelaar%'
    ORDER BY patient_id, nhgnr, uitslag_waarde, datum DESC
),

max_datum_huisarts AS
(
    SELECT distinct on (patient_id, nhgnr)
        patient_id,
        datum as max_dd_huisarts,
        nhgnr
    FROM alle_hb
    WHERE uitslag_waarde='huisarts'
    ORDER BY patient_id, nhgnr, datum DESC
),
min_datum_specialist_na_ha AS
(
    SELECT distinct on (patient_id, nhgnr)
        patient_id,
        datum as min_dd_specialist,
        nhgnr
    FROM alle_hb
    LEFT JOIN max_datum_huisarts USING (patient_id, nhgnr)
    WHERE uitslag_waarde='specialist'
    AND datum > max_dd_huisarts
    ORDER BY patient_id, nhgnr, datum ASC
),
doorverwijzing AS
(
    SELECT
        patient_id,
        1::varchar as doorverwijzing,
        nhgnr
    FROM min_datum_specialist_na_ha mds
    CROSS JOIN kalenderjaar
    WHERE EXTRACT(year FROM min_dd_specialist) = kalenderjaar
),

max_datum_specialist AS
(
    SELECT distinct on (patient_id, nhgnr)
        patient_id,
        datum AS max_dd_specialist,
        nhgnr
    FROM alle_hb
    WHERE uitslag_waarde='specialist'
    ORDER BY patient_id, nhgnr, datum DESC
),
min_datum_huisarts_na_spec AS
(
    SELECT distinct on (patient_id, nhgnr)
        patient_id,
        datum as min_dd_huisarts,
        nhgnr
    FROM alle_hb
    LEFT JOIN max_datum_specialist USING (patient_id, nhgnr)
    WHERE uitslag_waarde='huisarts'
    AND datum > max_dd_specialist
    ORDER BY patient_id, nhgnr, datum ASC
),
terugverwijzing AS
(
    SELECT
        patient_id,
        1::varchar as terugverwijzing,
        nhgnr
    FROM min_datum_huisarts_na_spec
    CROSS JOIN kalenderjaar
    WHERE EXTRACT(year FROM min_dd_huisarts) = kalenderjaar
),

max_datum_specialist_voor_spec AS
(
    SELECT distinct on (patient_id, nhgnr)
        patient_id,
        datum AS max_dd_specialist,
        min_dd_specialist,
        nhgnr
    FROM alle_hb ah
    LEFT JOIN min_datum_specialist_na_ha USING (patient_id, nhgnr)
    WHERE uitslag_waarde='specialist'
    AND datum < min_dd_specialist
    ORDER BY patient_id, nhgnr, datum DESC
),
min_datum_huisarts_tussen AS
(
    SELECT distinct on (patient_id, nhgnr)
        patient_id,
        datum AS min_dd_huisarts,
        nhgnr
    FROM alle_hb ah
    LEFT JOIN max_datum_specialist_voor_spec USING (patient_id, nhgnr)
    WHERE uitslag_waarde='huisarts'
    AND datum > max_dd_specialist
    ORDER BY patient_id, nhgnr, datum ASC
),
tdverwijzing AS
(
    SELECT
        patient_id,
        1::varchar AS terug_doorverwijzing,
        nhgnr
    FROM min_datum_huisarts_tussen
    LEFT JOIN max_datum_specialist_voor_spec USING (patient_id, nhgnr)
    CROSS JOIN kalenderjaar
    WHERE EXTRACT(year FROM min_dd_huisarts) = kalenderjaar
),

max_datum_huisarts_voor_ha AS
(
    SELECT distinct on (patient_id, nhgnr)
        patient_id,
        datum AS max_dd_huisarts,
        min_dd_huisarts,
        nhgnr
    FROM alle_hb ah
    LEFT JOIN min_datum_huisarts_na_spec USING (patient_id, nhgnr)
    WHERE uitslag_waarde='huisarts'
    AND datum < min_dd_huisarts
    ORDER BY patient_id, nhgnr, datum DESC
),
min_datum_specialist_tussen AS
(
    SELECT distinct on (patient_id, nhgnr)
        patient_id,
        datum AS min_dd_specialist,
        nhgnr
    FROM alle_hb ah
    LEFT JOIN max_datum_huisarts_voor_ha USING (patient_id, nhgnr)
    WHERE uitslag_waarde='specialist'
    AND datum > max_dd_huisarts
    ORDER BY patient_id, nhgnr, datum ASC
),
dtverwijzing AS
(
    SELECT
        patient_id,
        1::varchar as door_terugverwijzing,
        nhgnr
    FROM min_datum_specialist_tussen mds
    CROSS JOIN kalenderjaar
    WHERE EXTRACT(year FROM min_dd_specialist) = kalenderjaar
),
verwijzingen_niet_leeg AS
(
    SELECT
        patient_id,
        nhgnr,
        COALESCE(doorverwijzing,0::varchar) as doorverwijzing,
        COALESCE(terugverwijzing,0::varchar) as terugverwijzing,
        COALESCE(terug_doorverwijzing,0::varchar) as terug_doorverwijzing,
        COALESCE(door_terugverwijzing,0::varchar) as door_terugverwijzing
    FROM doorverwijzing d
    FULL OUTER JOIN terugverwijzing t USING (patient_id, nhgnr)
    FULL OUTER JOIN tdverwijzing td USING (patient_id, nhgnr)
    FULL OUTER JOIN dtverwijzing dt USING (patient_id, nhgnr)
)
SELECT
    patient_id,
    COALESCE(stable_patient_id,'missing') as stable_patient_id,
    nhgnr,
    doorverwijzing,
    terugverwijzing,
    terug_doorverwijzing,
    door_terugverwijzing
FROM verwijzingen_niet_leeg
LEFT JOIN proigia_qlik_patienten_gegevens_alle USING (patient_id)
ORDER BY patient_id, nhgnr;
Converted crosstab SQL:

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage_qlik\proigia_qlik_substitutie.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Onderstaande view bevat nu alleen MI-verrichtingen. De verwachting is dat deze verder uitgebreid 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage_qlik\proigia_qlik_verrichting.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage_qlik\proigia_qlik_report_metadata.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage_qlik\proigia_qlik_griepvaccinatie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage_qlik\proigia_qlik_zorgzwaarte.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage_qlik\proigia_qlik_maatwerk.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage_qlik_override\proigia_qlik_override_report_metadata.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage_qlik_override\proigia_qlik_override_extractiedatum_override.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Huidig kwartaal #} {# kopie van proigia_override_pre - parameter peildatum + practice_agb, patien
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage_qlik_override\proigia_qlik_override_pre.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# kopie van proigia_override #}
WITH zorgstraat_dm AS (
  SELECT
    stable_patient_id,
    kwartaa
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage_qlik_override\proigia_qlik_override.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# kopie van proigia_override_status - peildatum #}
WITH override_status_huidige_dataset AS (
  SELE
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_basisrapportage_qlik_override\proigia_qlik_override_status.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Kopie van proigia_meetwaarden_filter. LET OP: Verre van exacte kopie! #}
SELECT
  patient_id,
  o
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v3.0\proigia_zg_criteria_v3_53530004_zz_mw_filter.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Kopie van proigia_meetwaarden. LET OP: Verre van exacte kopie! #}
SELECT
  patient_id,
  omschrij
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v3.0\proigia_zg_criteria_v3_53530004_zz_mw.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v3.0\proigia_zg_criteria_v3_53530004_zz_mw_dubbel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v3.0\proigia_zg_criteria_v3_53530004_medicatie_3jr.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v3.0\proigia_zg_criteria_v3_53530004_meetwaarden_3jr.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# DM2 in remissie #} {# Kopie van proigia_episode_filter. #} {# Afwijking: Kan niet op PB vanwege o
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v3.0\proigia_zg_criteria_v3_0007_0151_0210_dm2_in_rem.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v3.0\proigia_zg_criteria_v3_53530007_ruiter.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW proigia_zg_criteria_v3_53530047_zorgweigeraar AS

SELECT * FROM crosstab($$
WITH alle_zw_bepalingen AS
(
    SELECT
        patient_id,
        nhgnr,
        datum,
        uitslag_waarde,
        zorgstraat,
        substring(memo, 3,2) as bepalingtype
    FROM proigia_zorgstraten
    LEFT JOIN proigia_meetwaarden_filter USING (nhgnr)
    WHERE zorgstraat IS NOT NULL
    AND (memo ~ '..cb' OR memo ~ '..rz' OR memo ~ '..kz')
),
min_kz AS
(
    SELECT
        patient_id,
        zorgstraat,
        min(datum) as min_datum_kz
    FROM alle_zw_bepalingen
    WHERE bepalingtype = 'kz'
    GROUP BY patient_id, zorgstraat
),
alle_zw_momenten AS
(
    SELECT
        patient_id,
        nhgnr,
        datum,
        uitslag_waarde,
        zorgstraat,
        bepalingtype,
        CASE WHEN bepalingtype = 'rz'
            AND uitslag_waarde IS NOT NULL THEN 1
            WHEN bepalingtype = 'cb'
            AND (uitslag_waarde = 'geen programmatische zorg'
                OR uitslag_waarde = 'geen geregelde zorg'
                OR uitslag_waarde = 'geen vast controlebeleid') THEN 1
            WHEN bepalingtype = 'kz' AND uitslag_waarde = 'nee' THEN 1
            ELSE 0 END as zorgweigeraar
    FROM alle_zw_bepalingen
    LEFT JOIN min_kz USING (patient_id, zorgstraat)
    WHERE bepalingtype = 'kz'
    OR datum < min_datum_kz
    OR min_datum_kz IS NULL
),
laatste_zw_moment_pppz AS
(
    SELECT distinct on (patient_id, zorgstraat)
        patient_id,
        zorgstraat,
        datum,
        zorgweigeraar
    FROM alle_zw_momenten
    ORDER BY patient_id, zorgstraat, datum DESC, zorgweigeraar DESC
),
zw_laatste_jaar AS
(
    SELECT
        patient_id,
        zorgstraat,
        max(zorgweigeraar) as zw_jaar
    FROM alle_zw_momenten
    WHERE datum >= '${peildatum}'::date-'1 year'::interval
    GROUP BY patient_id, zorgstraat
),
zw_ooit AS
(
    SELECT
        patient_id,
        zorgstraat,
        max(zorgweigeraar) as zw_ooit
    FROM alle_zw_momenten
    GROUP BY patient_id, zorgstraat
)
SELECT
    patient_id,
    zorgstraat,
    ARRAY[zorgweigeraar,
          COALESCE(zw_jaar,zorgweigeraar),
          zw_ooit] as zorgweigeraar
FROM laatste_zw_moment_pppz l
LEFT JOIN zw_laatste_jaar j USING (patient_id, zorgstraat)
LEFT JOIN zw_ooit o USING (patient_id, zorgstraat)
ORDER BY patient_id, zorgstraat
$$,$$
SELECT distinct zorgstraat
FROM proigia_zorgstraten
WHERE zorgstraat IS NOT NULL
ORDER BY zorgstraat
$$) as ct (
    patient_id bigint,
    af_zw int[],
    as_zw int[],
    cl_zw int[],
    co_zw int[],
    de_zw int[],
    dm_zw int[],
    gg_zw int[],
    hf_zw int[],
    hv_zw int[],
    nf_zw int[],
    ob_zw int[],
    os_zw int[],
    oz_zw int[],
    pa_zw int[],
    sk_zw int[],
    ui_zw int[]
);
Unsupported WITH clause or DISTINCT ON found in cte_statement.
Converted crosstab SQL:

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v3.0\proigia_zg_criteria_v3_53530047_zorgweigeraar.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# kopie van proigia_atc_codes #}
WITH atc_codes AS (
  SELECT
    atc
  FROM (VALUES
    ('R03AK06'
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v3.0\proigia_zg_criteria_v3_53530072_atc_codes.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# kopie van proigia_medicatie_filter #} {# afwijking: periode 15 mnd #}
SELECT
  patient_id,
  atc 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v3.0\proigia_zg_criteria_v3_53530072_medicatie_filter.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW proigia_zg_criteria_v3_53530072_medicatie AS

SELECT * FROM crosstab($$
    SELECT
        patient_id,
        categorie,
        ARRAY[
            count(*)::varchar,
            max(voorschrijfdatum)::varchar,
            min(voorschrijfdatum)::varchar,
            array_agg(distinct atc_code)::varchar,
            max(actueel)::varchar] as resultaat
    FROM proigia_zg_criteria_v3_53530072_medicatie_filter
    GROUP BY patient_id, categorie
    ORDER BY patient_id, categorie
$$,$$
    SELECT atc FROM proigia_zg_criteria_v3_53530072_atc_codes ORDER BY atc
$$) as
(
    patient_id bigint,
    r03ak06 varchar[],
    r03ak07 varchar[],
    r03ak08 varchar[],
    r03ak09 varchar[],
    r03ak10 varchar[],
    r03ak11 varchar[],
    r03ak12 varchar[],
    r03ak13 varchar[],
    r03ak14 varchar[],
    r03al08 varchar[],
    r03al09 varchar[],
    r03ba varchar[],
    r03dc varchar[]);
Converted crosstab SQL:
WITH cte1 AS (

    SELECT
        patient_id,
        categorie,
        ARRAY[
            count(*)::varchar,
            max(voorschrijfdatum)::varchar,
            min(voorschrijfdatum)::varchar,
            array_agg(distinct atc_code)::varchar,
            max(actueel)::varchar] as resultaat
    FROM {{ ref('proigia_zg_criteria_v3_53530072_medicatie_filter') }}
    GROUP BY patient_id, categorie
    ORDER BY patient_id, categorie

)
SELECT patient_id
, {{ dbt_utils.pivot('atc',        dbt_utils.get_column_values(ref('proigia_zg_criteria_v3_53530072_atc_codes'),'categorie',default=[]),        agg='',        then_value='categorie',        else_value="ARRAY_CONSTRUCT()",        quote_identifiers=False)}} 
FROM cte1
GROUP BY patient_id
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v3.0\proigia_zg_criteria_v3_53530072_medicatie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v3.0\proigia_zg_criteria_v3_53530072_medicatie_15mnd.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v3.0\proigia_zg_criteria_v3_53530098_periode.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v3.0\proigia_zg_criteria_v3_53530098_medicatie_jr.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v3.0\proigia_zg_criteria_v3_53530098_zorgplan.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# kopie van proigia_atc_codes #}
WITH atc_codes AS (
  SELECT
    atc
  FROM (VALUES
    ('A10A'),

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v3.0\proigia_zg_criteria_v3_53530098_atc_codes.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# kopie van proigia_medicatie_filter #} {# afwijking: periode 15 mnd #}
SELECT
  patient_id,
  atc 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v3.0\proigia_zg_criteria_v3_53530098_medicatie_filter.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW proigia_zg_criteria_v3_53530098_medicatie AS

SELECT * FROM crosstab($$
    SELECT
        patient_id,
        categorie,
        ARRAY[
            count(*)::varchar,
            max(voorschrijfdatum)::varchar,
            min(voorschrijfdatum)::varchar,
            array_agg(distinct atc_code)::varchar,
            max(actueel)::varchar] as resultaat
    FROM proigia_zg_criteria_v3_53530098_medicatie_filter
    GROUP BY patient_id, categorie
    ORDER BY patient_id, categorie
$$,$$
    SELECT atc FROM proigia_zg_criteria_v3_53530098_atc_codes ORDER BY atc
$$) as
(
    patient_id bigint,
    a10a varchar[],
    a10ab varchar[],
    a10ac varchar[],
    a10ad varchar[],
    a10ae varchar[],
    a10af varchar[],
    a10b varchar[],
    a10ba varchar[],
    a10ba02 varchar[],
    a10bb varchar[],
    a10bc varchar[],
    a10bd varchar[],
    a10bd02 varchar[],
    a10bd05 varchar[],
    a10bd07 varchar[],
    a10bd08 varchar[],
    a10bd11 varchar[],
    a10bd15 varchar[],
    a10bd20 varchar[],
    a10bd23 varchar[],
    a10bf varchar[],
    a10bg varchar[],
    a10bh varchar[],
    a10bj varchar[],
    a10bk varchar[],
    a10bx varchar[],
    b01a varchar[],
    b01aa varchar[],
    b01aa04 varchar[],
    b01aa07 varchar[],
    b01ac varchar[],
    b01ac04 varchar[],
    b01ac06 varchar[],
    b01ac07 varchar[],
    b01ac08 varchar[],
    b01ac22 varchar[],
    b01ac24 varchar[],
    b01ac56 varchar[],
    b01ae varchar[],
    b01ae07 varchar[],
    b01af varchar[],
    b01af01 varchar[],
    b01af02 varchar[],
    b01af03 varchar[],
    c0 varchar[],
    c01b varchar[],
    c01bd01 varchar[],
    c02 varchar[],
    c03 varchar[],
    c03a varchar[],
    c03aa03 varchar[],
    c03ba04 varchar[],
    c03ba11 varchar[],
    c03bb04 varchar[],
    c03ea06 varchar[],
    c04 varchar[],
    c05 varchar[],
    c07 varchar[],
    c07aa07 varchar[],
    c07ab02 varchar[],
    c07ab03 varchar[],
    c07ab07 varchar[],
    c08 varchar[],
    c08ca01 varchar[],
    c08ca05 varchar[],
    c08ca13 varchar[],
    c09 varchar[],
    c09a varchar[],
    c09aa02 varchar[],
    c09aa03 varchar[],
    c09aa04 varchar[],
    c09aa15 varchar[],
    c09b varchar[],
    c09bx01 varchar[],
    c09bx02 varchar[],
    c09bx03 varchar[],
    c09c varchar[],
    c09d varchar[],
    c09dx01 varchar[],
    c09dx03 varchar[],
    c09dx06 varchar[],
    c09xa52 varchar[],
    c09xa54 varchar[],
    c10 varchar[],
    c10a varchar[],
    c10ba varchar[],
    c10bx04 varchar[],
    c10bx06 varchar[],
    c10bx07 varchar[],
    c10bx10 varchar[],
    c10bx11 varchar[],
    c10bx12 varchar[],
    c10bx13 varchar[],
    c10bx14 varchar[],
    c10bx15 varchar[],
    g04ca varchar[],
    h02ab06 varchar[],
    h02ab07 varchar[],
    j07bb varchar[],
    n07ba varchar[],
    r03a varchar[],
    r03ac12 varchar[],
    r03ac13 varchar[],
    r03ac18 varchar[],
    r03ac19 varchar[],
    r03ak06 varchar[],
    r03ak07 varchar[],
    r03ak08 varchar[],
    r03ak09 varchar[],
    r03ak10 varchar[],
    r03ak11 varchar[],
    r03ak12 varchar[],
    r03ak13 varchar[],
    r03al03 varchar[],
    r03al04 varchar[],
    r03al05 varchar[],
    r03al06 varchar[],
    r03b varchar[],
    r03ba varchar[],
    r03bb04 varchar[],
    r03bb05 varchar[],
    r03bb06 varchar[],
    r03bb07 varchar[]);
Converted crosstab SQL:
WITH cte1 AS (

    SELECT
        patient_id,
        categorie,
        ARRAY[
            count(*)::varchar,
            max(voorschrijfdatum)::varchar,
            min(voorschrijfdatum)::varchar,
            array_agg(distinct atc_code)::varchar,
            max(actueel)::varchar] as resultaat
    FROM {{ ref('proigia_zg_criteria_v3_53530098_medicatie_filter') }}
    GROUP BY patient_id, categorie
    ORDER BY patient_id, categorie

)
SELECT patient_id
, {{ dbt_utils.pivot('atc',        dbt_utils.get_column_values(ref('proigia_zg_criteria_v3_53530098_atc_codes'),'categorie',default=[]),        agg='',        then_value='categorie',        else_value="ARRAY_CONSTRUCT()",        quote_identifiers=False)}} 
FROM cte1
GROUP BY patient_id
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v3.0\proigia_zg_criteria_v3_53530098_medicatie.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# kopie van proigia_griepprik_journaal #}
SELECT
  patient_id,
  griepprik,
  griepprik_datum
FROM 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v3.0\proigia_zg_criteria_v3_53530098_griepprik_journ.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# kopie van proigia_griepprik_episode #}
SELECT
  patient_id,
  griepprik,
  griepprik_datum
FROM (
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v3.0\proigia_zg_criteria_v3_53530098_griepprik_episode.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# kopie van proigia_griepprik_ruiter #}
SELECT
  patient_id,
  griepprik,
  griepprik_datum
FROM (

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v3.0\proigia_zg_criteria_v3_53530098_griepprik_ruiter.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# kopie van proigia_griepprik_medicatie #}
SELECT
  patient_id,
  griepprik,
  griepprik_datum
FROM
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v3.0\proigia_zg_criteria_v3_53530098_griepprik_medic.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# kopie van proigia_griepprik_totaal #}
WITH totaal AS (
  SELECT
    *
  FROM {{ ref('proigia_zg_c
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v3.0\proigia_zg_criteria_v3_53530098_griepprik_totaal.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v3.0\proigia_zg_criteria_v3_53530098_ruiter_poh.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v3.0\proigia_zg_criteria_v3_53530098_exacerbaties.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v3.0\proigia_zg_criteria_v3_53530240_ruiters.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# V.a. 2025-01-01 is 53533198 vervangen door 53533308, maar omdat PZG3 uitgefaseerd wordt, zijn de 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v3.0\proigia_zg_criteria_v3_53533198_dm2_in_remissie.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# V.a. 2025-01-01 wordt 53533198 vervangen door 53533308, maar omdat PZG3 uitgefaseerd wordt, zijn 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v3.0\proigia_zg_criteria_v3_53533198_medicatie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v3.0\proigia_zg_criteria_v3_std_ruiter_poh.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v3.0\proigia_zg_criteria_v3_std_albuminurie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v3.0\proigia_zg_criteria_v3_std_laatste_jrcontrole_dm.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v3.0\proigia_zg_criteria_v3_std_exacerbaties.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v3.0\proigia_zg_criteria_v3_std_laatste_controle_copd.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v3.0\proigia_zg_criteria_v3_std_mw_risicoverh_fact.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v3.0\proigia_zg_criteria_v3_std_achterstandswijk.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v3.0\proigia_zg_criteria_v3_journaal_ecg.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v3.0\proigia_zg_criteria_v3_journaal_echocardio.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v3.0\proigia_zg_criteria_v3_labcodes_vorig_jaar.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# kopie van proigia_meetwaarden_filter #}
{# andere meetperiode (vorig jaar ipv alles voor peildatu
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v3.0\proigia_zg_criteria_v3_mw_filter_vorig_jaar.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW proigia_zg_criteria_v3_mw_vorig_jaar AS
SELECT * FROM crosstab(
$$
    SELECT DISTINCT ON (patient_id, nhgnr)
        patient_id,
        nhgnr,
        ARRAY[  uitslag_raw,
                datum::varchar,
                uitslag_waarde] as waarde_datum
    FROM proigia_zg_criteria_v3_mw_filter_vorig_jaar
    JOIN proigia_zg_criteria_v3_labcodes_vorig_jaar USING (nhgnr)
    ORDER BY patient_id, nhgnr, datum DESC, uitslag_num DESC nulls last,
            uitslag_raw nulls last, uitslag_waarde nulls last
$$,$$
    SELECT nhgnr
    FROM indelingen.nhg_labcodes
    JOIN proigia_zg_criteria_v3_labcodes_vorig_jaar USING (nhgnr)
    ORDER BY nhgnr
$$
) as ct(
patient_id bigint,
rook_aq_vorig_jaar varchar[],
rost_aq_vorig_jaar varchar[]); 
Unsupported JOIN found in pivot_statement.
Converted crosstab SQL:

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v3.0\proigia_zg_criteria_v3_mw_vorig_jaar.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {{ medicatie_epa() }}
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v3.0\proigia_zg_criteria_v3_med_epa.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# LET OP: deze view kan meerdere regels per patient opleveren als een praktijk bij meerdere zorggro
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v3.0\proigia_zg_criteria_v3_vertaling_algemeen.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Bevat kolommen voor: COPD en Astma #} {# LET OP: deze view kan meerdere regels per patient opleve
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v3.0\proigia_zg_criteria_v3_vertaling_copd_astma.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# LET OP: deze view kan meerdere regels per patient opleveren als een praktijk bij meerdere zorggro
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v3.0\proigia_zg_criteria_v3_pl_copd_astma.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Bevat kolommen voor: DM, CVRM, AF, CL, HF, BBR en CNS #} {# LET OP: deze view kan meerdere regels
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v3.0\proigia_zg_criteria_v3_vertaling_dm_cvrm.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# LET OP: deze view kan meerdere regels per patient opleveren als een praktijk bij meerdere zorggro
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v3.0\proigia_zg_criteria_v3_pl_dm_cvrm.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Bevat kolommen voor: DEM, OS, OZ, EPA en GGZ #} {# LET OP: deze view kan meerdere regels per pati
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v3.0\proigia_zg_criteria_v3_vertaling_overig.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# LET OP: deze view kan meerdere regels per patient opleveren als een praktijk bij meerdere zorggro
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v3.0\proigia_zg_criteria_v3_pl_overig.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v3.0\proigia_zg_criteria_v3_std_periode.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v3.0\proigia_zg_criteria_v3_std_medicatie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v3.0\proigia_zg_criteria_v3_std_medicatie_2jr.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v3.0\proigia_zg_criteria_v3_std_definities.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Deze view begint met de verschillende zorggroep definities. Hierna volgt de 'vertaling' naar alge
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v3.0\proigia_zg_criteria_v3_verzamel_definities.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v4.0\proigia_zg_criteria_v4_zorggroep_bepalen.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v4.0\proigia_zg_criteria_v4_zorggroep_parameters.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v4.0\proigia_zg_criteria_v4_verzamel_algemeen.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v4.0\proigia_zg_criteria_v4_laatste_contact.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# LET OP: deze view kan meerdere regels per patient opleveren als een praktijk bij meerdere zorggro
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v4.0\proigia_zg_criteria_v4_oproepagenda_verzamel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v4.0\proigia_zg_criteria_v4_oproepagenda_oproepen_dm.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v4.0\proigia_zg_criteria_v4_oproepagenda_oproepen_copd.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v4.0\proigia_zg_criteria_v4_oproepagenda_oproepen_astma.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v4.0\proigia_zg_criteria_v4_oproepagenda_oproepen_zhr.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v4.0\proigia_zg_criteria_v4_oproepagenda_oproepen_hr.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v4.0\proigia_zg_criteria_v4_oproepagenda_oproepen_cvrm.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v4.0\proigia_zg_criteria_v4_oproepagenda_oproepen_af.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v4.0\proigia_zg_criteria_v4_oproepagenda_oproepen_hf.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v4.0\proigia_zg_criteria_v4_oproepagenda_oproepen_cns.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Let op! Voor osteoporose is nog geen standaard uitgewerkt. View is uitgewerkt voor 53530082 en 53
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v4.0\proigia_zg_criteria_v4_oproepagenda_oproepen_os.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v4.0\proigia_zg_criteria_v4_oproepagenda_oproepen_oz.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# View overgenomen uit OA 53530556 en wijkt op sommige punten af van de standaard. #} {# Veel kolom
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v4.0\proigia_zg_criteria_v4_oproepagenda_oproepen_sk.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Bevat kolommen voor: COPD en Astma #} {# LET OP: deze view kan meerdere regels per patient opleve
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v4.0\proigia_zg_criteria_v4_verzamel_copd_astma.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Bevat kolommen voor: DM, CVRM, AF, CL, HF, BBR en CNS #} {# LET OP: deze view kan meerdere regels
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v4.0\proigia_zg_criteria_v4_verzamel_dm_cvrm.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Bevat kolommen voor: DEM, OS, OZ, EPA en GGZ #} {# LET OP: deze view kan meerdere regels per pati
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v4.0\proigia_zg_criteria_v4_verzamel_overig.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v4.0\proigia_zg_criteria_v4_declaratie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v4.0\proigia_zg_criteria_v4_periode_vertaling.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v4.0\proigia_zg_criteria_v4_ruiter_poh.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# LET OP: deze view retourneert een NULL in de kolom als het niet de laatste uitslag van alle nhgnu
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v4.0\proigia_zg_criteria_v4_albuminurie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v4.0\proigia_zg_criteria_v4_laatste_jrcontrole_dm.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v4.0\proigia_zg_criteria_v4_exacerbaties.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v4.0\proigia_zg_criteria_v4_laatste_controle_copd.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v4.0\proigia_zg_criteria_v4_mw_risicoverh_fact.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v4.0\proigia_zg_criteria_v4_achterstandswijk.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v4.0\proigia_zg_criteria_v4_journaal_ecg.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v4.0\proigia_zg_criteria_v4_journaal_echocardio.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v4.0\proigia_zg_criteria_v4_labcodes_vorig_jaar.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# kopie van proigia_meetwaarden_filter #}
{# andere meetperiode (vorig jaar ipv alles voor peildatu
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v4.0\proigia_zg_criteria_v4_mw_filter_vorig_jaar.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW proigia_zg_criteria_v4_mw_vorig_jaar AS
SELECT * FROM crosstab(
$$
    SELECT DISTINCT ON (patient_id, nhgnr)
        patient_id,
        nhgnr,
        ARRAY[  uitslag_raw,
                datum::varchar,
                uitslag_waarde] as waarde_datum
    FROM proigia_zg_criteria_v4_mw_filter_vorig_jaar
    JOIN proigia_zg_criteria_v4_labcodes_vorig_jaar USING (nhgnr)
    ORDER BY patient_id, nhgnr, datum DESC, uitslag_num DESC nulls last,
            uitslag_raw nulls last, uitslag_waarde nulls last
$$,$$
    SELECT nhgnr
    FROM indelingen.nhg_labcodes
    JOIN proigia_zg_criteria_v4_labcodes_vorig_jaar USING (nhgnr)
    ORDER BY nhgnr
$$
) as ct(
patient_id bigint,
rook_aq_vorig_jaar varchar[],
rost_aq_vorig_jaar varchar[]);
Unsupported JOIN found in pivot_statement.
Converted crosstab SQL:

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v4.0\proigia_zg_criteria_v4_mw_vorig_jaar.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {{ medicatie_epa() }}
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v4.0\proigia_zg_criteria_v4_med_epa.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v4.0\proigia_zg_criteria_v4_griepprik.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v4.0\proigia_zg_criteria_v4_contact_laatste.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# LET OP: dit betreft geen HB meetwaarde; is meetwaarde 'diagnose dementie gesteld door' #}
SELECT

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v4.0\proigia_zg_criteria_v4_dementie_diag_ha_3mnd.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v4.0\proigia_zg_criteria_v4_patient.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# vertaling zorggroepspecifieke wensen #}
SELECT
  zorggroep,
  CASE
    WHEN 53533096 = zorggroep

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v4.0\proigia_zg_criteria_v4_episode_vertaling.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v4.0\proigia_zg_criteria_v4_episode_keten.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v4.0\proigia_zg_criteria_v4_episode_keten_nonactief.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# verzameling vertaalde episodes + vertaling ruwe episodes uit standaard #}
WITH episode_3mt AS (
 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v4.0\proigia_zg_criteria_v4_episode_verzamel.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Kopie van proigia_meetwaarden_filter. LET OP: Verre van exacte kopie! #}
SELECT
  patient_id,
  o
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v4.0\proigia_zg_criteria_v4_53530004_zz_mw_filter.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Kopie van proigia_meetwaarden. LET OP: Verre van exacte kopie! #}
SELECT
  patient_id,
  omschrij
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v4.0\proigia_zg_criteria_v4_53530004_zz_mw.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v4.0\proigia_zg_criteria_v4_53530004_zz_mw_dubbel.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# DM2 in remissie #} {# Kopie van proigia_episode_filter. #} {# Afwijking: Kan niet op PB vanwege o
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v4.0\proigia_zg_criteria_v4_0007_0151_0210_dm2_in_rem.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v4.0\proigia_zg_criteria_v4_53530007_ruiter.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v4.0\proigia_zg_criteria_v4_53530007_ggz_verrichting.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW proigia_zg_criteria_v4_53530047_zorgweigeraar AS

SELECT * FROM crosstab($$
WITH alle_zw_bepalingen AS
(
    SELECT
        patient_id,
        nhgnr,
        datum,
        uitslag_waarde,
        zorgstraat,
        substring(memo, 3,2) as bepalingtype
    FROM proigia_zorgstraten
    LEFT JOIN proigia_meetwaarden_filter USING (nhgnr)
    WHERE zorgstraat IS NOT NULL
    AND (memo ~ '..cb' OR memo ~ '..rz' OR memo ~ '..kz')
),
min_kz AS
(
    SELECT
        patient_id,
        zorgstraat,
        min(datum) as min_datum_kz
    FROM alle_zw_bepalingen
    WHERE bepalingtype = 'kz'
    GROUP BY patient_id, zorgstraat
),
alle_zw_momenten AS
(
    SELECT
        patient_id,
        nhgnr,
        datum,
        uitslag_waarde,
        zorgstraat,
        bepalingtype,
        CASE WHEN bepalingtype = 'rz'
            AND uitslag_waarde IS NOT NULL THEN 1
            WHEN bepalingtype = 'cb'
            AND (uitslag_waarde = 'geen programmatische zorg'
                OR uitslag_waarde = 'geen geregelde zorg'
                OR uitslag_waarde = 'geen vast controlebeleid') THEN 1
            WHEN bepalingtype = 'kz' AND uitslag_waarde = 'nee' THEN 1
            ELSE 0 END as zorgweigeraar
    FROM alle_zw_bepalingen
    LEFT JOIN min_kz USING (patient_id, zorgstraat)
    WHERE bepalingtype = 'kz'
    OR datum < min_datum_kz
    OR min_datum_kz IS NULL
),
laatste_zw_moment_pppz AS
(
    SELECT distinct on (patient_id, zorgstraat)
        patient_id,
        zorgstraat,
        datum,
        zorgweigeraar
    FROM alle_zw_momenten
    ORDER BY patient_id, zorgstraat, datum DESC, zorgweigeraar DESC
),
zw_laatste_jaar AS
(
    SELECT
        patient_id,
        zorgstraat,
        max(zorgweigeraar) as zw_jaar
    FROM alle_zw_momenten
    WHERE datum >= '${peildatum}'::date-'1 year'::interval
    GROUP BY patient_id, zorgstraat
),
zw_ooit AS
(
    SELECT
        patient_id,
        zorgstraat,
        max(zorgweigeraar) as zw_ooit
    FROM alle_zw_momenten
    GROUP BY patient_id, zorgstraat
)
SELECT
    patient_id,
    zorgstraat,
    ARRAY[zorgweigeraar,
          COALESCE(zw_jaar,zorgweigeraar),
          zw_ooit] as zorgweigeraar
FROM laatste_zw_moment_pppz l
LEFT JOIN zw_laatste_jaar j USING (patient_id, zorgstraat)
LEFT JOIN zw_ooit o USING (patient_id, zorgstraat)
ORDER BY patient_id, zorgstraat
$$,$$
SELECT distinct zorgstraat
FROM proigia_zorgstraten
WHERE zorgstraat IS NOT NULL
ORDER BY zorgstraat
$$) as ct (
    patient_id bigint,
    af_zw int[],
    as_zw int[],
    cl_zw int[],
    co_zw int[],
    de_zw int[],
    dm_zw int[],
    gg_zw int[],
    hf_zw int[],
    hv_zw int[],
    nf_zw int[],
    ob_zw int[],
    os_zw int[],
    oz_zw int[],
    pa_zw int[],
    sk_zw int[],
    ui_zw int[]
);
Unsupported WITH clause or DISTINCT ON found in cte_statement.
Converted crosstab SQL:

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v4.0\proigia_zg_criteria_v4_53530047_zorgweigeraar.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# kopie van proigia_atc_codes #}
WITH atc_codes AS (
  SELECT
    atc
  FROM (VALUES
    ('R03AK06'
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v4.0\proigia_zg_criteria_v4_53530072_atc_codes.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# kopie van proigia_medicatie_filter #} {# afwijking: periode 15 mnd #}
SELECT
  patient_id,
  atc 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v4.0\proigia_zg_criteria_v4_53530072_medicatie_filter.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW proigia_zg_criteria_v4_53530072_medicatie AS

SELECT * FROM crosstab($$
    SELECT
        patient_id,
        categorie,
        ARRAY[
            count(*)::varchar,
            max(voorschrijfdatum)::varchar,
            min(voorschrijfdatum)::varchar,
            array_agg(distinct atc_code)::varchar,
            max(actueel)::varchar] as resultaat
    FROM proigia_zg_criteria_v4_53530072_medicatie_filter
    GROUP BY patient_id, categorie
    ORDER BY patient_id, categorie
$$,$$
    SELECT atc FROM proigia_zg_criteria_v4_53530072_atc_codes ORDER BY atc
$$) as
(
    patient_id bigint,
    r03ak06 varchar[],
    r03ak07 varchar[],
    r03ak08 varchar[],
    r03ak09 varchar[],
    r03ak10 varchar[],
    r03ak11 varchar[],
    r03ak12 varchar[],
    r03ak13 varchar[],
    r03al08 varchar[],
    r03al09 varchar[],
    r03ba varchar[],
    r03dc03 varchar[]);
Converted crosstab SQL:
WITH cte1 AS (

    SELECT
        patient_id,
        categorie,
        ARRAY[
            count(*)::varchar,
            max(voorschrijfdatum)::varchar,
            min(voorschrijfdatum)::varchar,
            array_agg(distinct atc_code)::varchar,
            max(actueel)::varchar] as resultaat
    FROM {{ ref('proigia_zg_criteria_v4_53530072_medicatie_filter') }}
    GROUP BY patient_id, categorie
    ORDER BY patient_id, categorie

)
SELECT patient_id
, {{ dbt_utils.pivot('atc',        dbt_utils.get_column_values(ref('proigia_zg_criteria_v4_53530072_atc_codes'),'categorie',default=[]),        agg='',        then_value='categorie',        else_value="ARRAY_CONSTRUCT()",        quote_identifiers=False)}} 
FROM cte1
GROUP BY patient_id
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v4.0\proigia_zg_criteria_v4_53530072_medicatie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v4.0\proigia_zg_criteria_v4_53530072_medicatie_15mnd.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v4.0\proigia_zg_criteria_v4_53530098_zorgplan.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# kopie van proigia_griepprik_journaal #}
SELECT
  patient_id,
  griepprik,
  griepprik_datum
FROM 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v4.0\proigia_zg_criteria_v4_53530098_griepprik_journ.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# kopie van proigia_griepprik_episode #}
SELECT
  patient_id,
  griepprik,
  griepprik_datum
FROM (
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v4.0\proigia_zg_criteria_v4_53530098_griepprik_episode.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# kopie van proigia_griepprik_ruiter #}
SELECT
  patient_id,
  griepprik,
  griepprik_datum
FROM (

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v4.0\proigia_zg_criteria_v4_53530098_griepprik_ruiter.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# kopie van proigia_griepprik_medicatie #}
SELECT
  patient_id,
  griepprik,
  griepprik_datum
FROM
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v4.0\proigia_zg_criteria_v4_53530098_griepprik_medic.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# kopie van proigia_griepprik_totaal #}
WITH totaal AS (
  SELECT
    *
  FROM {{ ref('proigia_zg_c
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v4.0\proigia_zg_criteria_v4_53530098_griepprik_totaal.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v4.0\proigia_zg_criteria_v4_53530098_ruiter_poh.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v4.0\proigia_zg_criteria_v4_53530098_exacerbaties.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v4.0\proigia_zg_criteria_v4_53530240_ruiters.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v4.0\proigia_zg_criteria_v4_53530312_aantal_rr_gew_3mt.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Overgenomen uit eigen OA 53530556 #}
WITH meetwaarden_pre AS (
  SELECT
    patient_id,
    uitsl
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v4.0\proigia_zg_criteria_v4_53530556_sk_meetwaarden.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# vertaling zorggroepspecifieke wensen #}
SELECT
  zorggroep,
  ARRAY_CONSTRUCT('acqt_rq', 'acqk_rq
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v4.0\proigia_zg_criteria_v4_meetwaarde_vertaling.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v4.0\proigia_zg_criteria_v4_meetwaarde_keten.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# verzameling vertaalde meetwaarden + vertaling ruwe meetwaarden uit standaard #}
SELECT
  patient_
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v4.0\proigia_zg_criteria_v4_meetwaarde_verzamel.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# vertaling zorggroepspecifieke wensen #}
SELECT
  zorggroep,
  ARRAY_CONSTRUCT('C02%', 'C03%', 'C0
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v4.0\proigia_zg_criteria_v4_medicatie_vertaling.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v4.0\proigia_zg_criteria_v4_medicatie_filter_vertaling.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v4.0\proigia_zg_criteria_v4_medicatie_filter_keten.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v4.0\proigia_zg_criteria_v4_medicatie_keten.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW proigia_zg_criteria_v4_medicatie_jaar AS

SELECT * FROM crosstab($$
    SELECT
        CONCAT(patient_id,zorggroep) AS unique_id,
        patient_id,
        zorggroep,
        categorie,
        ARRAY[
            count(*)::varchar,
            max(voorschrijfdatum)::varchar,
            min(voorschrijfdatum)::varchar,
            array_agg(distinct atc_code)::varchar,
            max(actueel)::varchar] as resultaat
    FROM proigia_zg_criteria_v4_medicatie_filter_vertaling
    WHERE actief_jaar=1
    GROUP BY patient_id, zorggroep, categorie
    ORDER BY patient_id, zorggroep, categorie
$$,$$
    SELECT atc FROM proigia_atc_codes ORDER BY atc
$$) as
(
    unique_id varchar,
    patient_id bigint,
    zorggroep integer,
Converted crosstab SQL:

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v4.0\proigia_zg_criteria_v4_medicatie_jaar.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW proigia_zg_criteria_v4_medicatie_2jaar AS

SELECT * FROM crosstab($$
    SELECT
        CONCAT(patient_id,zorggroep) AS unique_id,
        patient_id,
        zorggroep,
        categorie,
        ARRAY[
            count(*)::varchar,
            max(voorschrijfdatum)::varchar,
            min(voorschrijfdatum)::varchar,
            array_agg(distinct atc_code)::varchar,
            max(actueel)::varchar] as resultaat
    FROM proigia_zg_criteria_v4_medicatie_filter_vertaling
    WHERE actief_2jaar=1
    GROUP BY patient_id, zorggroep, categorie
    ORDER BY patient_id, zorggroep, categorie
$$,$$
    SELECT atc FROM proigia_atc_codes ORDER BY atc
$$) as
(
    unique_id varchar,
    patient_id bigint,
    zorggroep integer,
Converted crosstab SQL:

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v4.0\proigia_zg_criteria_v4_medicatie_2jaar.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# verzameling vertaalde medicatie + vertaling ruwe medicatie uit standaard #}
WITH medicatie_2jaar_
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v4.0\proigia_zg_criteria_v4_medicatie_verzamel.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# View die als basis dient voor de keten_definitie views hierna #}
SELECT
  agb,
  zg_agb,
  zg_agb
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v4.0\proigia_zg_criteria_v4_keten_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v4.0\proigia_zg_criteria_v4_keten_indicatie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v4.0\proigia_zg_criteria_v4_keten_patient.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v4.0\proigia_zg_criteria_v4_ketenzorg.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v4.0\proigia_zg_criteria_v4_doelgroep_dbc.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# T.b.v. Rapport "Inkaarten ouderenzorg Menzis patiÃ«ntenlijst" is deze view gemaakt en alleen gecon
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v4.0\proigia_zg_criteria_v4_zorgstraten.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\proigia_zorggroep_criteria_v4.0\proigia_zg_criteria_v4_override_verzamel.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Tijdelijk rapport. #} {# Kan verwijderd worden zodra zorggroepen voldoende inzicht hebben in decl
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ps_dbc_ouderen_-_inzicht_bepaalstatus\ps_dbc_ouderen_inzicht_bepaalstatus_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\ps_dbc_ouderen_-_inzicht_bepaalstatus\ps_dbc_ouderen_inzicht_bepaalstatus.sql

[ERROR] Failed to process ps_dbc_ouderen_inzicht_bepaal_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\qlik_zorggroep_definities\qlik_zorggroep_definities_dm.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\qlik_zorggroep_definities\qlik_zorggroep_definities_copd.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\qlik_zorggroep_definities\qlik_zorggroep_definities_astma.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\qlik_zorggroep_definities\qlik_zorggroep_definities_cvrm.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\qlik_zorggroep_definities\qlik_zorggroep_definities_hf.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\qlik_zorggroep_definities\qlik_zorggroep_definities_cns.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\qlik_zorggroep_definities\qlik_zorggroep_definities_epa.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\qlik_zorggroep_definities\qlik_zorggroep_definities_af.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\qlik_zorggroep_definities\qlik_zorggroep_definities_cl.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\qlik_zorggroep_definities\qlik_zorggroep_definities_ouderenzorg.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\qlik_zorggroep_definities\qlik_zorggroep_definities_dementie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\qlik_zorggroep_definities\qlik_zorggroep_definities_osteoporose.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\qlik_zorggroep_definities\qlik_zorggroep_definities_ggz.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\qlik_zorggroep_definities\qlik_zorggroep_definities_leefstijl.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\qlik_zorggroep_definities\qlik_zorggroep_definities_episode.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\qlik_zorggroep_definities\qlik_zorggroep_definities_report_metadata.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\registratiescan_chronische_en_basiszorg\regscan_chron_basiszorg_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\registratiescan_chronische_en_basiszorg\regscan_chron_basiszorg_chron_aandoeningen_pre.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\registratiescan_chronische_en_basiszorg\regscan_chron_basiszorg_chron_aandoeningen.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\registratiescan_chronische_en_basiszorg\regscan_chron_basiszorg_verdacht_dm_pre.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\registratiescan_chronische_en_basiszorg\regscan_chron_basiszorg_verdacht_dm.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\registratiescan_chronische_en_basiszorg\regscan_chron_basiszorg_verdacht_copd_astma_pre.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\registratiescan_chronische_en_basiszorg\regscan_chron_basiszorg_verdacht_copd_astma.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\registratiescan_chronische_en_basiszorg\regscan_chron_basiszorg_verdacht_hvz_pre.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\registratiescan_chronische_en_basiszorg\regscan_chron_basiszorg_verdacht_hvz.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\registratiescan_chronische_en_basiszorg\regscan_chron_basiszorg_basiszorg_pre.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\registratiescan_chronische_en_basiszorg\regscan_chron_basiszorg_basiszorg.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Kopie van proigia_meetwaarden_filter #} {# Afwijking 1: Kijkt naar bepalingen in het afgelopen ja
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\registratiescan_chronische_en_basiszorg\regscan_chron_basiszorg_meetwaarden_filter.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# kopie van proigia_dubbele_hb #}
WITH alle_hb AS (
  SELECT
    patient_id,
    nhgnr,
    datum,

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\registratiescan_chronische_en_basiszorg\regscan_chron_basiszorg_dubbele_hb.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\registratiescan_chronische_en_basiszorg\regscan_chron_basiszorg_meetwaarden_rh12.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\registratiescan_chronische_en_basiszorg\regscan_chron_basiszorg_verrichting.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\registratiescan_chronische_en_basiszorg\regscan_chron_basiszorg_med_copd_astma.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# kopie van proigia_atc_codes #}
WITH atc_codes AS (
  SELECT
    atc
  FROM (VALUES
    ('R03CC02%
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\registratiescan_chronische_en_basiszorg\regscan_chron_basiszorg_atc_codes.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# kopie van proigia_medicatie_filter #}
SELECT
  patient_id,
  atc AS categorie,
  voorschrijfdatum
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\registratiescan_chronische_en_basiszorg\regscan_chron_basiszorg_medicatie_filter.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW regscan_chron_basiszorg_medicatie AS

SELECT * FROM crosstab($$
    SELECT
        patient_id,
        categorie,
        ARRAY[
            count(*)::varchar,
            max(voorschrijfdatum)::varchar,
            min(voorschrijfdatum)::varchar,
            array_agg(distinct atc_code)::varchar
            ] AS resultaat
    FROM regscan_chron_basiszorg_medicatie_filter
    GROUP BY patient_id, categorie
    ORDER BY patient_id, categorie
$$,$$
    SELECT atc FROM regscan_chron_basiszorg_atc_codes ORDER BY atc
$$) as
(
    patient_id bigint,
    r03cc02 varchar[],
    r03cc03 varchar[],
    r03cc04 varchar[],
    r03ac12 varchar[],
    r03ac13 varchar[],
    r03bb01 varchar[],
    r03bb04 varchar[],
    r03ak06 varchar[],
    r03ak07 varchar[]
);
Converted crosstab SQL:
WITH cte1 AS (

    SELECT
        patient_id,
        categorie,
        ARRAY[
            count(*)::varchar,
            max(voorschrijfdatum)::varchar,
            min(voorschrijfdatum)::varchar,
            array_agg(distinct atc_code)::varchar
            ] AS resultaat
    FROM {{ ref('regscan_chron_basiszorg_medicatie_filter') }}
    GROUP BY patient_id, categorie
    ORDER BY patient_id, categorie

)
SELECT patient_id
, {{ dbt_utils.pivot('atc',        dbt_utils.get_column_values(ref('regscan_chron_basiszorg_atc_codes'),'categorie',default=[]),        agg='',        then_value='categorie',        else_value="ARRAY_CONSTRUCT()",        quote_identifiers=False)}} 
FROM cte1
GROUP BY patient_id
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\registratiescan_chronische_en_basiszorg\regscan_chron_basiszorg_medicatie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\registratiescan_chronische_en_basiszorg\regscan_chron_basiszorg_icpc_ongeldig.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# WHERE levert de regel met standaard criteria (53530000) en eventueel de regel met zorggroep crite
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\registratie_cvrm_bloeddrukmetingen_-_sez\registr_cvrm_bloeddrukmetingen_53530008_verzamel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\registratie_cvrm_bloeddrukmetingen_-_sez\registr_cvrm_bloeddrukmetingen_53530008_ind_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\registratie_cvrm_bloeddrukmetingen_-_sez\registratie_cvrm_bloeddrukmetingen_53530008_ind.sql

[ERROR] Failed to process registratie_cvrm_bloeddrukmetingen_53530008_encrypted.pry: Invalid PRY format: 'queries:' section not found
[ERROR] Failed to process registratie_triglyceriden_epa_53530047_algemeen.pry: while scanning for the next token
found character '\t' that cannot start any token
  in "<unicode string>", line 4, column 1:
    	Dit rapport dient voor het verk ... 
    ^
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\registratie_triglyceriden_epa_patienten_-_ketenzorg_arnhem\reg_trig_epa_53530047_months.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\registratie_triglyceriden_epa_patienten_-_ketenzorg_arnhem\reg_trig_epa_53530047_patient.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# kopie van proigia_episode_filter #}
WITH pre_episode AS (
  SELECT
    episode_id,
    patient_id
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\registratie_triglyceriden_epa_patienten_-_ketenzorg_arnhem\reg_trig_epa_53530047_epi_filter.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\registratie_triglyceriden_epa_patienten_-_ketenzorg_arnhem\reg_trig_epa_53530047_icpc_codes.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW reg_trig_epa_53530047_episode AS

WITH pre AS
(
SELECT * FROM crosstab($$
    SELECT
        ARRAY[patient_id::varchar,
            start_periode::varchar,
            eind_periode::varchar] as unique_field,
        name,
        ARRAY[min(begindatum)::varchar,
                max(einddatum)::varchar,
                max(status_datum)::varchar,
                max(status_vlag)::varchar,
                array_agg(distinct icpc)::varchar,
                max(begindatum)::varchar,
                min(einddatum)::varchar,
                min(begindatum_nonactief)::varchar,
                max(einddatum_nonactief)::varchar,
                max(begindatum_nonactief)::varchar,
                min(einddatum_nonactief)::varchar] as waardes
    FROM reg_trig_epa_53530047_epi_filter
    JOIN reg_trig_epa_53530047_icpc_codes ON icpc ilike searchstring
    GROUP BY unique_field, name
    ORDER BY unique_field, name
$$,$$
    SELECT name FROM reg_trig_epa_53530047_icpc_codes ORDER BY name;
$$) as ct(
    unique_field varchar[],
    k74_ varchar[],
    k75_ varchar[],
    k76_ varchar[],
    k89_ varchar[],
    k90 varchar[],
    k90_03 varchar[],
    k92_01 varchar[],
    k99_01 varchar[],
    p15_02 varchar[],
    p70_ varchar[],
    p71_ varchar[],
    p72_ varchar[],
    p73_ varchar[],
    p98_ varchar[],
    t90 varchar[],
    t90_ varchar[],
    t90_01 varchar[],
    t90_02 varchar[])
)
SELECT
unique_field[1]:: bigint AS patient_id,
unique_field[2]::date AS start_periode,
unique_field[3]::date AS eind_periode,
*
FROM pre;
Converted crosstab SQL:
WITH cte1 AS (

    SELECT
        ARRAY[patient_id::varchar,
            start_periode::varchar,
            eind_periode::varchar] as unique_field,
        name,
        ARRAY[min(begindatum)::varchar,
                max(einddatum)::varchar,
                max(status_datum)::varchar,
                max(status_vlag)::varchar,
                array_agg(distinct icpc)::varchar,
                max(begindatum)::varchar,
                min(einddatum)::varchar,
                min(begindatum_nonactief)::varchar,
                max(einddatum_nonactief)::varchar,
                max(begindatum_nonactief)::varchar,
                min(einddatum_nonactief)::varchar] as waardes
    FROM {{ ref('reg_trig_epa_53530047_epi_filter') }}
    JOIN {{ ref('reg_trig_epa_53530047_icpc_codes') }} ON icpc ilike searchstring
    GROUP BY unique_field, name
    ORDER BY unique_field, name

)
SELECT unique_field
, {{ dbt_utils.pivot('name',        dbt_utils.get_column_values(ref('reg_trig_epa_53530047_icpc_codes'),'categorie',default=[]),        agg='',        then_value='name',        else_value="ARRAY_CONSTRUCT()",        quote_identifiers=False)}} 
FROM cte1
GROUP BY unique_field
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\registratie_triglyceriden_epa_patienten_-_ketenzorg_arnhem\reg_trig_epa_53530047_episode.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\registratie_triglyceriden_epa_patienten_-_ketenzorg_arnhem\reg_trig_epa_53530047_labcodes.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\registratie_triglyceriden_epa_patienten_-_ketenzorg_arnhem\reg_trig_epa_53530047_zorgstraten.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\registratie_triglyceriden_epa_patienten_-_ketenzorg_arnhem\reg_trig_epa_53530047_mw_filter.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW reg_trig_epa_53530047_meetw AS
	WITH mw_pre AS
	(
	SELECT * FROM crosstab(
$$
    SELECT DISTINCT ON (unique_field, nhgnr)
        ARRAY[patient_id::varchar,
            start_periode::varchar,
            eind_periode::varchar] as unique_field,
        nhgnr,
        ARRAY[  uitslag_raw,
                datum::varchar,
                uitslag_waarde] as waarde_datum
    FROM reg_trig_epa_53530047_mw_filter
    JOIN reg_trig_epa_53530047_labcodes USING (nhgnr)
    ORDER BY unique_field, nhgnr, datum DESC, uitslag_num DESC nulls last,
            uitslag_raw nulls last, uitslag_waarde nulls last
$$,$$
    SELECT nhgnr
    FROM indelingen.nhg_labcodes
    JOIN reg_trig_epa_53530047_labcodes USING (nhgnr)
    ORDER BY nhgnr
$$
) as ct(
    unique_field varchar[],
    trig_b varchar[],
    dmcb_tz varchar[],
    dmrz_tz varchar[],
    dmhb_tz varchar[],
    hvcb_kz varchar[],
    hvrz_kz varchar[],
    cvhb_kz varchar[],
    dmkz_tz varchar[],
    cvkz_kz varchar[],
    trig_b_po varchar[])
)
SELECT
unique_field[1]:: bigint AS patient_id,
unique_field[2]::date AS start_periode,
unique_field[3]::date AS eind_periode,
*
FROM mw_pre;
Unsupported JOIN found in pivot_statement.
Converted crosstab SQL:

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\registratie_triglyceriden_epa_patienten_-_ketenzorg_arnhem\reg_trig_epa_53530047_meetw.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW reg_trig_epa_53530047_zorgweigeraar AS
	WITH zw_pre AS
	(
SELECT * FROM crosstab($$
WITH alle_zw_bepalingen AS
(
    SELECT
        patient_id,
        nhgnr,
        datum,
        uitslag_waarde,
        zorgstraat,
        substring(memo, 3,2) as bepalingtype,
			start_periode,
			eind_periode
    FROM reg_trig_epa_53530047_zorgstraten
    LEFT JOIN reg_trig_epa_53530047_mw_filter USING (nhgnr)
    WHERE zorgstraat IS NOT NULL
    AND (memo ~ '..cb' OR memo ~ '..rz' OR memo ~ '..kz')
),
min_kz AS
(
    SELECT
        patient_id,
        zorgstraat,
        min(datum) as min_datum_kz,
			start_periode,
			eind_periode
    FROM alle_zw_bepalingen
    WHERE bepalingtype = 'kz'
    GROUP BY patient_id, zorgstraat, start_periode, eind_periode
),
alle_zw_momenten AS
(
    SELECT
        patient_id,
        nhgnr,
        datum,
        uitslag_waarde,
        zorgstraat,
        bepalingtype,
        CASE WHEN bepalingtype = 'rz'
            AND uitslag_waarde IS NOT NULL THEN 1
            WHEN bepalingtype = 'cb'
            AND (uitslag_waarde = 'geen programmatische zorg'
                OR uitslag_waarde = 'geen geregelde zorg'
                OR uitslag_waarde = 'geen vast controlebeleid') THEN 1
				WHEN bepalingtype = 'kz' AND uitslag_waarde = 'nee' THEN 1
            ELSE 0 END as zorgweigeraar,
			start_periode,
			eind_periode
    FROM alle_zw_bepalingen
    LEFT JOIN min_kz USING (patient_id, zorgstraat, start_periode, eind_periode)
    WHERE bepalingtype = 'kz'
    OR datum < min_datum_kz
    OR min_datum_kz IS NULL
),
laatste_zw_moment_pppz AS
(
    SELECT distinct on (patient_id, zorgstraat, start_periode, eind_periode)
        patient_id,
        zorgstraat,
        datum,
        zorgweigeraar,
			start_periode,
			eind_periode
    FROM alle_zw_momenten
    ORDER BY patient_id, zorgstraat, start_periode, eind_periode, datum DESC, zorgweigeraar DESC
),
zw_laatste_jaar AS
(
    SELECT
        patient_id,
        zorgstraat,
        max(zorgweigeraar) as zw_jaar,
			start_periode,
			eind_periode
    FROM alle_zw_momenten
    WHERE datum >= eind_periode::date-'1 year'::interval
    GROUP BY patient_id, zorgstraat, start_periode, eind_periode
),
zw_ooit AS
(
    SELECT
        patient_id,
        zorgstraat,
        max(zorgweigeraar) as zw_ooit,
			start_periode,
			eind_periode
    FROM alle_zw_momenten
    GROUP BY patient_id, zorgstraat, start_periode, eind_periode
)
SELECT
    ARRAY[patient_id::varchar,
            start_periode::varchar,
            eind_periode::varchar] as unique_field,
    zorgstraat,
    ARRAY[zorgweigeraar,
          COALESCE(zw_jaar,zorgweigeraar),
          zw_ooit] as zorgweigeraar
FROM laatste_zw_moment_pppz l
LEFT JOIN zw_laatste_jaar j USING (patient_id, zorgstraat, start_periode,  eind_periode)
LEFT JOIN zw_ooit o USING (patient_id, zorgstraat, start_periode, eind_periode)
ORDER BY unique_field, zorgstraat, start_periode, eind_periode
$$,$$
SELECT distinct zorgstraat
FROM reg_trig_epa_53530047_zorgstraten
WHERE zorgstraat IS NOT NULL
ORDER BY zorgstraat
$$) as ct (
    unique_field varchar[],
    dm_zw int[],
    hv_zw int[])
	)
	SELECT
	unique_field[1]::bigint AS patient_id,
	unique_field[2]::date AS start_periode,
	unique_field[3]::date AS eind_periode,
	*
	FROM zw_pre;
Unsupported WITH clause or DISTINCT ON found in cte_statement.
Converted crosstab SQL:

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\registratie_triglyceriden_epa_patienten_-_ketenzorg_arnhem\reg_trig_epa_53530047_zorgweigeraar.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\registratie_triglyceriden_epa_patienten_-_ketenzorg_arnhem\reg_trig_epa_53530047_atc_codes.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\registratie_triglyceriden_epa_patienten_-_ketenzorg_arnhem\reg_trig_epa_53530047_medicatie_filter.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\registratie_triglyceriden_epa_patienten_-_ketenzorg_arnhem\reg_trig_epa_53530047_med_epa.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\relatie_copd_hoofdbehandelaar_specialist_en_gold-classificatie_-_sez\relatie_copd_hb_gold_verzamel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\relatie_copd_hoofdbehandelaar_specialist_en_gold-classificatie_-_sez\relatie_copd_hb_gold_indic_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\relatie_copd_hoofdbehandelaar_specialist_en_gold-classificatie_-_sez\relatie_copd_hb_gold_indic.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\rezisto_-_antibiotica\rezisto_ab_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\rezisto_-_antibiotica\rezisto_ab_patientenlijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\rezisto_-_antibiotica\rezisto_ab_patient.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\rezisto_-_antibiotica\rezisto_ab_allergie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\rezisto_-_antibiotica\rezisto_ab_episode.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\rezisto_-_antibiotica\rezisto_ab_medicatie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\schildklierproblemen\schildklierproblemen_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\schildklierproblemen\schildklierproblemen_patientenlijst_volledig.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\schildklierproblemen\schildklierproblemen_indicatoren_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\schildklierproblemen\schildklierproblemen_indicatoren.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\schildklierproblemen\schildklierproblemen_pl_tussen.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\schildklierproblemen\schildklierproblemen_pl_geen_lab.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\schildklierproblemen\schildklierproblemen_pl_lab_streefwaarde.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\schildklierproblemen\schildklierproblemen_pl_zwanger_t86.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\schildklierproblemen\schildklierproblemen_pl_anemie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\schildklierproblemen\schildklierproblemen_pl_t86.sql

[ERROR] Failed to process schildklierproblemen_encrypted.pry: Invalid PRY format: 'queries:' section not found
[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: (
  WITH data_pre AS (
    SELECT
      37058681 AS agb,
      '21ae7c3f9bb41b8e7191ede3b4c7e3e312df
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\selectierapport_red_lrgp_-_umcu\red_lrgp.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\selectierapport_red_lrgp_-_umcu\red_lrgp_resultaat.sql

[ERROR] Failed to process selectie_red_lrgp_col_prop.pry: Invalid PRY format: 'queries:' section not found
[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: (
  WITH data_pre AS (
    SELECT
      1057920 AS agb,
      '33eb786180f61a1b0d81f0ccb275f2f38245a
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\selectie_gp_pad_studie_umcu\gppad.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\selectie_gp_pad_studie_umcu\gppad_resultaat.sql

[ERROR] Failed to process selectie_gppad_umcu_col_prop.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\stoppen_met_roken_-_rijn_en_duin\smr_indicatoren_53530250_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\stoppen_met_roken_-_rijn_en_duin\smr_indicatoren_53530250_indic_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\stoppen_met_roken_-_rijn_en_duin\smr_indicatoren_53530250_indicatoren.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\stoppen_met_roken_-_rijn_en_duin\smr_indicatoren_53530250_patientenlijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\stoppen_met_roken_-_rijn_en_duin\smr_indicatoren_rook_status.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\tactic_-_follow-up_-_ketenzorg_arnhem\tactic_fu_53530047_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\tactic_-_follow-up_-_ketenzorg_arnhem\tactic_fu_53530047_qrisk_lengte.sql

[WARNING] SQL was not modified during conversion
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\tactic_-_follow-up_-_ketenzorg_arnhem\tactic_fu_53530047_qrisk_t0.sql

[WARNING] SQL was not modified during conversion
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\tactic_-_follow-up_-_ketenzorg_arnhem\tactic_fu_53530047_qrisk_t1.sql

[WARNING] SQL was not modified during conversion
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\tactic_-_follow-up_-_ketenzorg_arnhem\tactic_fu_53530047_qrisk_t2.sql

[WARNING] SQL was not modified during conversion
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\tactic_-_follow-up_-_ketenzorg_arnhem\tactic_fu_53530047_qrisk_t3.sql

[WARNING] SQL was not modified during conversion
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\tactic_-_follow-up_-_ketenzorg_arnhem\tactic_fu_53530047_qrisk_t4.sql

[WARNING] SQL was not modified during conversion
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\tactic_-_follow-up_-_ketenzorg_arnhem\tactic_fu_53530047_qrisk_t5.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\tactic_-_follow-up_-_ketenzorg_arnhem\tactic_fu_53530047_pl_follow_up.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\tactic_-_follow-up_-_ketenzorg_arnhem\tactic_fu_53530047_pl_t0.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\tactic_-_follow-up_-_ketenzorg_arnhem\tactic_fu_53530047_pl_t1.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\tactic_-_follow-up_-_ketenzorg_arnhem\tactic_fu_53530047_pl_t2.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\tactic_-_follow-up_-_ketenzorg_arnhem\tactic_fu_53530047_pl_t3.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\tactic_-_follow-up_-_ketenzorg_arnhem\tactic_fu_53530047_pl_t4.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\tactic_-_follow-up_-_ketenzorg_arnhem\tactic_fu_53530047_pl_t5.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\tactic_-_follow-up_-_ketenzorg_arnhem\tactic_fu_53530047_pl_metingen.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\tactic_-_follow-up_-_ketenzorg_arnhem\tactic_fu_53530047_episode_filter.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\tactic_-_follow-up_-_ketenzorg_arnhem\tactic_fu_53530047_icpc_codes.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW tactic_fu_53530047_episode AS
WITH epi_pre AS
(
SELECT * FROM crosstab($$
    SELECT
        ARRAY[patient_id::varchar,
              meting::varchar] AS unique_field,
        name,
        ARRAY[min(begindatum)::varchar,
              max(einddatum)::varchar,
              max(status_datum)::varchar,
              max(status_vlag)::varchar,
              array_agg(distinct icpc)::varchar,
              max(begindatum)::varchar,
              min(einddatum)::varchar,
              min(begindatum_nonactief)::varchar,
              max(einddatum_nonactief)::varchar,
              max(begindatum_nonactief)::varchar,
              min(einddatum_nonactief)::varchar] as waardes
    FROM tactic_fu_53530047_episode_filter
    JOIN tactic_fu_53530047_icpc_codes ON icpc ilike searchstring
    GROUP BY unique_field, name
    ORDER BY unique_field, name
$$,$$
    SELECT name FROM tactic_fu_53530047_icpc_codes ORDER BY name;
$$) as ct(
unique_field varchar[],
k78_ varchar[],
l88_01 varchar[],
n89_ varchar[],
n90_ varchar[],
p08_01 varchar[],
p17_ varchar[],
p72_ varchar[],
p73_02 varchar[],
p98_ varchar[],
t90_01 varchar[],
t90_02 varchar[],
u99_01 varchar[])
)
SELECT
unique_field[1]::bigint AS patient_id,
unique_field[2]::varchar AS meting,
*
FROM epi_pre;
Converted crosstab SQL:
WITH cte1 AS (

    SELECT
        ARRAY[patient_id::varchar,
              meting::varchar] AS unique_field,
        name,
        ARRAY[min(begindatum)::varchar,
              max(einddatum)::varchar,
              max(status_datum)::varchar,
              max(status_vlag)::varchar,
              array_agg(distinct icpc)::varchar,
              max(begindatum)::varchar,
              min(einddatum)::varchar,
              min(begindatum_nonactief)::varchar,
              max(einddatum_nonactief)::varchar,
              max(begindatum_nonactief)::varchar,
              min(einddatum_nonactief)::varchar] as waardes
    FROM {{ ref('tactic_fu_53530047_episode_filter') }}
    JOIN {{ ref('tactic_fu_53530047_icpc_codes') }} ON icpc ilike searchstring
    GROUP BY unique_field, name
    ORDER BY unique_field, name

)
SELECT unique_field
, {{ dbt_utils.pivot('name',        dbt_utils.get_column_values(ref('tactic_fu_53530047_icpc_codes'),'categorie',default=[]),        agg='',        then_value='name',        else_value="ARRAY_CONSTRUCT()",        quote_identifiers=False)}} 
FROM cte1
GROUP BY unique_field
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\tactic_-_follow-up_-_ketenzorg_arnhem\tactic_fu_53530047_episode.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\tactic_-_follow-up_-_ketenzorg_arnhem\tactic_fu_53530047_med_epa_actueel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\tactic_-_follow-up_-_ketenzorg_arnhem\tactic_fu_53530047_chronische_medicatie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\tactic_-_follow-up_-_ketenzorg_arnhem\tactic_fu_53530047_polyfarmacie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\tactic_-_follow-up_-_ketenzorg_arnhem\tactic_fu_53530047_bloeddruk_sd.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\tactic_-_follow-up_-_ketenzorg_arnhem\tactic_fu_53530047_atc_codes_2_5jr.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\tactic_-_follow-up_-_ketenzorg_arnhem\tactic_fu_53530047_medicatie_filter_2_5jr.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW tactic_fu_53530047_medicatie_2_5jr AS
SELECT * FROM crosstab($$
    SELECT
        patient_id,
        categorie,
        ARRAY[
            count(*)::varchar,
            max(voorschrijfdatum)::varchar,
            min(voorschrijfdatum)::varchar,
            array_agg(distinct atc_code)::varchar
            ] as resultaat
    FROM tactic_fu_53530047_medicatie_filter_2_5jr
    GROUP BY patient_id, categorie
    ORDER BY patient_id, categorie
$$,$$
    SELECT atc FROM tactic_fu_53530047_atc_codes_2_5jr ORDER BY atc
$$) as
(
    patient_id bigint,
    n05ae03 varchar[],
    n05ae05 varchar[],
    n05ah02 varchar[],
    n05ah03 varchar[],
    n05ah04 varchar[],
    n05al01 varchar[],
    n05al05 varchar[],
    n05ax08 varchar[],
    n05ax12 varchar[],
    n05ax13 varchar[],
    n05ax15 varchar[],
    n05ax16 varchar[]);
Converted crosstab SQL:
WITH cte1 AS (

    SELECT
        patient_id,
        categorie,
        ARRAY[
            count(*)::varchar,
            max(voorschrijfdatum)::varchar,
            min(voorschrijfdatum)::varchar,
            array_agg(distinct atc_code)::varchar
            ] as resultaat
    FROM {{ ref('tactic_fu_53530047_medicatie_filter_2_5jr') }}
    GROUP BY patient_id, categorie
    ORDER BY patient_id, categorie

)
SELECT patient_id
, {{ dbt_utils.pivot('atc',        dbt_utils.get_column_values(ref('tactic_fu_53530047_atc_codes_2_5jr'),'categorie',default=[]),        agg='',        then_value='categorie',        else_value="ARRAY_CONSTRUCT()",        quote_identifiers=False)}} 
FROM cte1
GROUP BY patient_id
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\tactic_-_follow-up_-_ketenzorg_arnhem\tactic_fu_53530047_medicatie_2_5jr.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Kopie van block 'medicatie_epa.pry' #} {# Afwijking: minder ATC-codes #}
WITH med_filter AS (
  S
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\tactic_-_follow-up_-_ketenzorg_arnhem\tactic_fu_53530047_med_epa_chronisch.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\tactic_-_follow-up_-_ketenzorg_arnhem\tactic_fu_53530047_opslagwijk.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\tactic_-_inkaarten_voor_mdo_-_ketenzorg_arnhem\tactic_inkaarten_53530047_verzameltabel.sql

[WARNING] SQL was not modified during conversion
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\tactic_-_inkaarten_voor_mdo_-_ketenzorg_arnhem\tactic_inkaarten_53530047_qrisk.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\tactic_-_inkaarten_voor_mdo_-_ketenzorg_arnhem\tactic_inkaarten_53530047_indic_inkaarten.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\tactic_-_inkaarten_voor_mdo_-_ketenzorg_arnhem\tactic_inkaarten_53530047_pl_inkaarten.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# NB. Dit tabblad mag niet getoond worden voor de praktijk, maar alleen voor de onderzoekers! In te
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\tactic_-_inkaarten_voor_mdo_-_ketenzorg_arnhem\tactic_inkaarten_53530047_pl_inkaarten_qrisk3.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\tactic_-_inkaarten_voor_mdo_-_ketenzorg_arnhem\tactic_inkaarten_53530047_pl_exclusie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\tactic_-_inkaarten_voor_mdo_-_ketenzorg_arnhem\tactic_inkaarten_53530047_startdatum.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\tactic_-_inkaarten_voor_mdo_-_ketenzorg_arnhem\tactic_inkaarten_53530047_chronische_medicatie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\tactic_-_inkaarten_voor_mdo_-_ketenzorg_arnhem\tactic_inkaarten_53530047_polyfarmacie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\tactic_-_inkaarten_voor_mdo_-_ketenzorg_arnhem\tactic_inkaarten_53530047_med_epa.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\tactic_-_inkaarten_voor_mdo_-_ketenzorg_arnhem\tactic_inkaarten_53530047_med_epa_actueel.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Kopie van block 'medicatie_epa.pry' #} {# Afwijking: minder ATC-codes #}
WITH med_filter AS (
  S
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\tactic_-_inkaarten_voor_mdo_-_ketenzorg_arnhem\tactic_inkaarten_53530047_med_epa_chronisch.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\tactic_-_inkaarten_voor_mdo_-_ketenzorg_arnhem\tactic_inkaarten_53530047_med_statine_actueel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\tactic_-_inkaarten_voor_mdo_-_ketenzorg_arnhem\tactic_inkaarten_53530047_med_statine_chronisch.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\tactic_-_inkaarten_voor_mdo_-_ketenzorg_arnhem\tactic_inkaarten_53530047_med_epa_laatste.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\tactic_-_inkaarten_voor_mdo_-_ketenzorg_arnhem\tactic_inkaarten_53530047_bloeddruk_sd.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\tactic_-_inkaarten_voor_mdo_-_ketenzorg_arnhem\tactic_inkaarten_53530047_contact.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\tactic_-_inkaarten_voor_mdo_-_ketenzorg_arnhem\tactic_inkaarten_53530047_verwijzing.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\tactic_-_inkaarten_voor_mdo_-_ketenzorg_arnhem\tactic_inkaarten_53530047_journaal_tactic.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\tactic_-_inkaarten_voor_mdo_-_ketenzorg_arnhem\tactic_inkaarten_53530047_lengte.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\tactic_-_voorbereiden_op_mdo_-_ketenzorg_arnhem\tactic_voorbereiden_53530047_verzameltabel.sql

[WARNING] SQL was not modified during conversion
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\tactic_-_voorbereiden_op_mdo_-_ketenzorg_arnhem\tactic_voorbereiden_53530047_qrisk.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\tactic_-_voorbereiden_op_mdo_-_ketenzorg_arnhem\tactic_voorbereiden_53530047_pl_voorbereiden.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\tactic_-_voorbereiden_op_mdo_-_ketenzorg_arnhem\tactic_voorbereiden_53530047_pl_overig.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\tactic_-_voorbereiden_op_mdo_-_ketenzorg_arnhem\tactic_voorbereiden_53530047_pl_medicatie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\tactic_-_voorbereiden_op_mdo_-_ketenzorg_arnhem\tactic_voorbereiden_53530047_pl_metingen.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\tactic_-_voorbereiden_op_mdo_-_ketenzorg_arnhem\tactic_voorbereiden_53530047_pl_exclusie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\tactic_-_voorbereiden_op_mdo_-_ketenzorg_arnhem\tactic_voorbereiden_53530047_periode.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\tactic_-_voorbereiden_op_mdo_-_ketenzorg_arnhem\tactic_voorbereiden_53530047_labcodes.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\tactic_-_voorbereiden_op_mdo_-_ketenzorg_arnhem\tactic_voorbereiden_53530047_mw_filter.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\tactic_-_voorbereiden_op_mdo_-_ketenzorg_arnhem\tactic_voorbereiden_53530047_mw_filter_periode.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW tactic_voorbereiden_53530047_meetwaarden AS
WITH mw_pre AS
(
SELECT * FROM crosstab(
$$
    SELECT DISTINCT ON (unique_field, nhgnr)
        ARRAY[patient_id::varchar,
              meting::varchar] AS unique_field,
        nhgnr,
        ARRAY[uitslag_raw,
              datum::varchar,
              uitslag_waarde] AS waarde_datum
    FROM tactic_voorbereiden_53530047_mw_filter_periode
    JOIN tactic_voorbereiden_53530047_labcodes USING (nhgnr)
    ORDER BY unique_field, nhgnr, datum DESC, uitslag_num DESC nulls last,
            uitslag_raw nulls last, uitslag_waarde nulls last
$$,$$
    SELECT nhgnr
    FROM indelingen.nhg_labcodes
    JOIN tactic_voorbereiden_53530047_labcodes USING (nhgnr)
    ORDER BY nhgnr
$$
) AS ct(
    unique_field varchar[],
    albk_u_mi varchar[],
    chhd_b_mi varchar[],
    chol_b_mt varchar[],
    gew_ao varchar[],
    gluc_b_nn varchar[],
    gluc_b_nu varchar[],
    gluc_bc_nn varchar[],
    gluc_bc_nu varchar[],
    hdl_b varchar[],
    ldl_b varchar[],
    lngp_ao varchar[],
    quet_ao varchar[],
    rook_aq varchar[],
    rrsy_ka varchar[],
    sipd_aq varchar[],
    sgpd_aq varchar[],
    pppd_aq varchar[],
    hvzf_kq varchar[],
    rrgs_ka_mh varchar[],
    ldld_b varchar[],
    gluc_ba_nu varchar[],
    gluc_ba_nn varchar[],
    rrs7_ka_mh varchar[],
    rr3s_ka varchar[],
    krec_o_fb varchar[],
    glup_bc_nu varchar[],
    glup_bc_nn varchar[],
    espd_aq varchar[],
    ldl_b_po varchar[],
    egfc_o_fb varchar[],
    egcc_o_fb varchar[],
    hf19_kq varchar[])
)
SELECT
unique_field[1]::bigint AS patient_id,
unique_field[2]::varchar AS meting,
*
FROM mw_pre;    
Unsupported JOIN found in pivot_statement.
Converted crosstab SQL:

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\tactic_-_voorbereiden_op_mdo_-_ketenzorg_arnhem\tactic_voorbereiden_53530047_meetwaarden.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\tactic_-_voorbereiden_op_mdo_-_ketenzorg_arnhem\tactic_voorbereiden_53530047_journaalregel.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Afwijking no 1: probleem/attentie toegevoegd #} {# Afwijking no 2: ICPC omschrijving zoals in HIS
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\tactic_-_voorbereiden_op_mdo_-_ketenzorg_arnhem\tactic_voorbereiden_53530047_episode_filter.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\tactic_-_voorbereiden_op_mdo_-_ketenzorg_arnhem\tactic_voorbereiden_53530047_episode.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\tactic_-_voorbereiden_op_mdo_-_ketenzorg_arnhem\tactic_voorbereiden_53530047_acr.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\tactic_-_voorbereiden_op_mdo_-_ketenzorg_arnhem\tactic_voorbereiden_53530047_metingen_pre.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\top_10_episode_en_contacten\top10_episode_contacten_leeftijd_bins.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\top_10_episode_en_contacten\top10_episode_contacten_geslacht_bins.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\top_10_episode_en_contacten\top10_episode_contacten_ptn_diagnose.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\top_10_episode_en_contacten\top10_episode_contacten_aantal_diagnose.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\top_10_episode_en_contacten\top10_episode_contacten_contact.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\top_25_ketenzorgpatienten_meeste_contacten\top_25_ketenzorgpatienten_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\top_25_ketenzorgpatienten_meeste_contacten\top_25_ketenzorgpatienten_patientenlijst_dm.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\top_25_ketenzorgpatienten_meeste_contacten\top_25_ketenzorgpatienten_patientenlijst_copd.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\top_25_ketenzorgpatienten_meeste_contacten\top_25_ketenzorgpatienten_patientenlijst_cvrm.sql

[ERROR] Failed to process top_25_ketenzorgpatienten_meeste_contacten_encrypted.pry: Invalid PRY format: 'queries:' section not found
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\top_400_patienten_meeste_zorg\top_400_patienten_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\top_400_patienten_meeste_zorg\top_400_patienten_patientenlijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\validatie\validatie_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\validatie\validatie_last_cont_pp.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\validatie\validatie_verzameltabel_meetwaarden.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\validatie\validatie_indicatoren_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\validatie\validatie_indicatoren.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# kopie van proigia_patienten_gegevens #}
SELECT
  patient_id,
  patientnummer,
  bsn,
  achternaam
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\validatie\validatie_patienten_gegevens.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\validatie\validatie_epi.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# kopie proigia_episode_filter #}
WITH unnested AS (
  SELECT
    episode_id,
    patient_id,
    b
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\validatie\validatie_episode_filter.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# kopie van proigia_icpc_codes #}
WITH icpc_codes AS (
  SELECT
    icpc
  FROM (VALUES
    ('A05%'
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\validatie\validatie_icpc_codes.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW validatie_episode AS

SELECT * FROM crosstab($$
    SELECT
        patient_id,
        name,
        ARRAY[min(begindatum)::varchar,
                max(einddatum)::varchar,
                max(status_datum)::varchar,
                max(status_vlag)::varchar,
                array_agg(distinct icpc)::varchar,
                max(begindatum)::varchar,
                min(einddatum)::varchar,
                min(begindatum_nonactief)::varchar,
                max(einddatum_nonactief)::varchar,
                max(begindatum_nonactief)::varchar,
                min(einddatum_nonactief)::varchar] AS waardes
    FROM validatie_episode_filter
    JOIN validatie_icpc_codes ON icpc ilike searchstring
    GROUP BY patient_id, name
    ORDER BY patient_id, name
$$,$$
    SELECT name FROM validatie_icpc_codes ORDER BY name;
$$) AS ct(
    patient_id bigint,
    a05_ varchar[],
    a20_ varchar[],
    a29_01 varchar[],
    a49_01 varchar[],
    a49_02 varchar[],
    a80_ varchar[],
    a91_05 varchar[],
    d17_ varchar[],
    f05_ varchar[],
    f83_01 varchar[],
    h02_ varchar[],
    k49_01 varchar[],
    k74_ varchar[],
    k75_ varchar[],
    k76_ varchar[],
    k78_ varchar[],
    k82_ varchar[],
    k83_01 varchar[],
    k83_02 varchar[],
    k84_03 varchar[],
    k85_ varchar[],
    k86_ varchar[],
    k87_ varchar[],
    k89_ varchar[],
    k90_ varchar[],
    k90_02 varchar[],
    k90_03 varchar[],
    k91_ varchar[],
    k92_ varchar[],
    k92_01 varchar[],
    k99_ varchar[],
    k99_01 varchar[],
    k99_06 varchar[],
    l29_ varchar[],
    l88 varchar[],
    l88_ varchar[],
    l88_01 varchar[],
    l88_02 varchar[],
    n94_02 varchar[],
    p_ varchar[],
    p01_ varchar[],
    p03_ varchar[],
    p05_ varchar[],
    p06_ varchar[],
    p15_ varchar[],
    p16_ varchar[],
    p17_ varchar[],
    p19_ varchar[],
    p20_ varchar[],
    p70_ varchar[],
    p70_01 varchar[],
    p70_02 varchar[],
    p74_ varchar[],
    p76_ varchar[],
    p78_ varchar[],
    r44_ varchar[],
    r95_ varchar[],
    r96  varchar[],
    r96_ varchar[],
    r96_01 varchar[],
    r96_02 varchar[],
    s91_ varchar[],
    t05_ varchar[],
    t06_ varchar[],
    t29_ varchar[],
    t82_ varchar[],
    t90 varchar[],
    t90_ varchar[],
    t90_01 varchar[],
    t90_02 varchar[],
    t93 varchar[],
    t93_ varchar[],
    t93_01 varchar[],
    t93_03 varchar[],
    t93_04 varchar[],
    u04_ varchar[],
    u04_01 varchar[],
    u04_02 varchar[],
    u04_03 varchar[],
    u98_01 varchar[],
    u99_01 varchar[],
    w81_ varchar[],
    z_ varchar[],
    z04_ varchar[],
    z04_03 varchar[],
    z29_ varchar[],
    z29_01 varchar[]
);
Converted crosstab SQL:
WITH cte1 AS (

    SELECT
        patient_id,
        name,
        ARRAY[min(begindatum)::varchar,
                max(einddatum)::varchar,
                max(status_datum)::varchar,
                max(status_vlag)::varchar,
                array_agg(distinct icpc)::varchar,
                max(begindatum)::varchar,
                min(einddatum)::varchar,
                min(begindatum_nonactief)::varchar,
                max(einddatum_nonactief)::varchar,
                max(begindatum_nonactief)::varchar,
                min(einddatum_nonactief)::varchar] AS waardes
    FROM {{ ref('validatie_episode_filter') }}
    JOIN {{ ref('validatie_icpc_codes') }} ON icpc ilike searchstring
    GROUP BY patient_id, name
    ORDER BY patient_id, name

)
SELECT patient_id
, {{ dbt_utils.pivot('name',        dbt_utils.get_column_values(ref('validatie_icpc_codes'),'categorie',default=[]),        agg='',        then_value='name',        else_value="ARRAY_CONSTRUCT()",        quote_identifiers=False)}} 
FROM cte1
GROUP BY patient_id
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\validatie\validatie_episode.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\validatie\validatie_labcodes.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {#  kopie van proigia_meetwaarden_filter #}
 WITH nhgnr_verrijking AS
(
    SELECT
        patient_i
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\validatie\validatie_meetwaarden_filter.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW validatie_meetwaarden AS

SELECT * FROM crosstab(
$$
    SELECT DISTINCT ON (patient_id, nhgnr)
        patient_id,
        nhgnr,
        ARRAY[  uitslag_raw,
                datum::varchar,
                uitslag_waarde] AS waarde_datum
    FROM validatie_meetwaarden_filter
    JOIN validatie_labcodes USING (nhgnr)
    ORDER BY patient_id, nhgnr, datum DESC, uitslag_num DESC nulls last,
            uitslag_raw nulls last, uitslag_waarde nulls last
$$,$$
    SELECT nhgnr
    FROM indelingen.nhg_labcodes
    JOIN validatie_labcodes USING (nhgnr)
    ORDER BY nhgnr
$$
) AS ct(
patient_id bigint,
alb_b varchar[],
alb_u varchar[],
alb_ue_mt varchar[],
albk_u_mi varchar[],
albk_ue_mi varchar[],
ca_b varchar[],
chhd_b_mi varchar[],
chol_b_mt varchar[],
fosf_b varchar[],
fosf_u varchar[],
fosf_ue_mt varchar[],
ft4_b varchar[],
gew_ao varchar[],
glhb_b varchar[],
gluc_b_nn varchar[],
gluc_b_nu varchar[],
gluc_bc_nn varchar[],
gluc_bc_nu varchar[],
hb_b varchar[],
hdl_b varchar[],
k_b varchar[],
k_u varchar[],
krea_b varchar[],
krea_o_mk varchar[],
ldhd_b_mi varchar[],
ldl_b varchar[],
lngp_ao varchar[],
na_b varchar[],
oa01_o varchar[],
oa02_o varchar[],
oa03_o varchar[],
oa04_o varchar[],
oa05_o varchar[],
pap_xp_bv varchar[],
pap_xp_im varchar[],
pap_xp_iz varchar[],
pap_xp_mm varchar[],
pap_xp_wo varchar[],
papa_xp varchar[],
papb_xp varchar[],
papc_xp varchar[],
paph_xp varchar[],
papk_xp varchar[],
papn_xp varchar[],
papo_xp varchar[],
papp_xp varchar[],
phad_b_sr varchar[],
pth_b varchar[],
q001_b varchar[],
q002_b varchar[],
q003_b varchar[],
quet_ao varchar[],
te_u_kw varchar[],
trig_b varchar[],
tsh_b varchar[],
vb12_b varchar[],
alco_pq varchar[],
ampu_lv_li varchar[],
ampu_lv_re varchar[],
angk_kq varchar[],
asac_rz varchar[],
asdu_rq varchar[],
asfb_rq varchar[],
asgb_rq varchar[],
ashs_rq varchar[],
asit_rq varchar[],
askk_rq varchar[],
aspk_rq varchar[],
astl_rq varchar[],
astt_rq varchar[],
aswi_rq varchar[],
aswk_rq varchar[],
bewg_lv_li varchar[],
bewg_lv_re varchar[],
clkl_kq varchar[],
cohz_kq varchar[],
dmtv_tq varchar[],
dafu_fz varchar[],
dblo_lv_li varchar[],
dblo_lv_re varchar[],
decc_kq varchar[],
detk_kq varchar[],
dmfm_tq varchar[],
dmp_tz varchar[],
dmrp_fa_li varchar[],
dmrp_fa_re varchar[],
druk_lv_li varchar[],
druk_lv_re varchar[],
dysp_rq varchar[],
eelt_lv_li varchar[],
eelt_lv_re varchar[],
fcpb_rl varchar[],
frpb_rl_mi varchar[],
fvnb_rl varchar[],
fvnb_rl_mp varchar[],
fvns_rl varchar[],
fvpb_rl varchar[],
fvpb_rl_mp varchar[],
fvrp_rl varchar[],
fvrv_rl varchar[],
hypt_kq varchar[],
infc_lv_li varchar[],
infc_lv_re varchar[],
insp_lv_li varchar[],
insp_lv_re varchar[],
kleu_lv_li varchar[],
kleu_lv_re varchar[],
libw_aq varchar[],
mofv_ns_li varchar[],
mofv_ns_re varchar[],
minh_rq varchar[],
onpr_rq varchar[],
pakj_aq varchar[],
pals_rq varchar[],
padp_kv_li varchar[],
padp_kv_re varchar[],
rook_aq varchar[],
rrdi_ka varchar[],
rrsy_ka varchar[],
staf_lv_li varchar[],
staf_lv_re varchar[],
snsv_ns_li varchar[],
snsv_ns_re varchar[],
ulce_lv_li varchar[],
ulce_lv_re varchar[],
voed_tz varchar[],
vsho_tq varchar[],
dmac_tz varchar[],
dmcb_tz varchar[],
ascb_rz varchar[],
cott_rq varchar[],
coac_rz varchar[],
cocb_rz varchar[],
asrz_rz varchar[],
dmrz_tz varchar[],
dmmd_tq	varchar[],
adgw_tq varchar[],
advd_tq varchar[],
admi_aq varchar[],
adgv_aq varchar[],
adlb_aq varchar[],
corz_rz varchar[],
aser_rq varchar[],
adsa_zq varchar[],
dmto_fz varchar[],
opmo_lv varchar[],
fcnb_rl varchar[],
frnb_rl_mi varchar[],
rfam_rq varchar[],
ausc_rl varchar[],
omva_dh varchar[],
pols_ao varchar[],
frns_rl_mi varchar[],
krem_o_fb varchar[],
gfr_b varchar[],
lyso_nl varchar[],
ntpr_b varchar[],
sipd_aq varchar[],
stda_za varchar[],
srda_aq varchar[],
rfms_rq varchar[],
afau_rl varchar[],
roac_az varchar[],
papq_xp varchar[],
pavl_kq varchar[],
rrsy_ka_mh varchar[],
rrdi_ka_mh varchar[],
ausc_kh varchar[],
afau_kh varchar[],
hvvw_kz varchar[],
fvsb_rl varchar[],
fvrn_rl varchar[],
frsb_rl_mi varchar[],
polr_ao varchar[],
fufo_fa varchar[],
hvzf_kq varchar[],
asvw_rz varchar[],
advd_aq varchar[],
byvd_aa varchar[],
dmvw_tz varchar[],
fhcf_tq varchar[],
rivu_sq varchar[],
ecg_kh varchar[],
dmhb_tz varchar[],
coer_rq varchar[],
mrcd_rq varchar[],
rhvz_kq_fb varchar[],
echo_un_li varchar[],
echo_un_re varchar[],
ccq1_rq varchar[],
ccq2_rq varchar[],
ccq3_rq varchar[],
ccq4_rq varchar[],
ccq5_rq varchar[],
ccq6_rq varchar[],
ccq7_rq varchar[],
ccq8_rq varchar[],
ccq9_rq varchar[],
ccqx_rq varchar[],
ccqs_rq varchar[],
ccqf_rq varchar[],
ccqm_rq varchar[],
ccqt_rq varchar[],
mosr_aq varchar[],
ashb_rz varchar[],
cohb_rz varchar[],
hvcb_kz varchar[],
hvrz_kz varchar[],
_sh1_pq varchar[],
_sh2_pq varchar[],
_sh3_pq varchar[],
_sh4_pq varchar[],
_sh5_pq varchar[],
_sht_pq varchar[],
mmst_pq varchar[],
vvig_tq varchar[],
h002_sa varchar[],
h003_sa varchar[],
vvmi_ao_mi varchar[],
rrgs_ka_mh varchar[],
rrgd_ka_mh varchar[],
gewv_aa varchar[],
covv_rq varchar[],
o2sa_ao varchar[],
ldld_b varchar[],
b12t_b varchar[],
gzhb_pz varchar[],
fsfu_fz varchar[],
bzvd_aa varchar[],
pver_kq varchar[],
dcer_kq varchar[],
acqt_rq varchar[],
aval_aq varchar[],
pofa_aq varchar[],
slpb_aq varchar[],
smst_pq varchar[],
vipl_pq varchar[],
vlsc_aq varchar[],
oztv_az varchar[],
ozvc_az varchar[],
ozp_az varchar[],
gfit_aq varchar[],
cizi_az varchar[],
zzpv_az varchar[],
adme_aq varchar[],
kwbh_az varchar[],
gdst_pq varchar[],
_dan_pq varchar[],
_dde_pq varchar[],
_ddi_pq varchar[],
_dso_pq varchar[],
cvhb_kz varchar[],
hbac_b varchar[],
blmz_aq varchar[],
ocfm_xq varchar[],
ccfm_dq varchar[],
echo_kh varchar[],
poed_le varchar[],
mnpz_xq varchar[],
zlcp_ra varchar[],
coex_rq varchar[],
ozhb_az varchar[],
dchb_az varchar[],
drug_aq varchar[],
bdi1_pq varchar[],
bdi2_pq varchar[],
bai_pq varchar[],
uihb_uz varchar[],
skhb_tz varchar[],
gluc_ba_nu varchar[],
gluc_ba_nn varchar[],
hf65_kq varchar[],
nngb_aq varchar[],
fitn_aq varchar[],
rh12_kq_fb varchar[],
rvfh_kq_fb varchar[],
hfvw_kz varchar[],
adag_aq varchar[],
hklp_kq varchar[],
hbap_b varchar[],
dst_aq varchar[],
hfcb_kz varchar[],
ra_lq varchar[],
ecgf_kh varchar[],
rrs7_ka_mh varchar[],
phq9_pq varchar[],
rr3s_ka varchar[],
cact_rq varchar[],
nfhb_uz varchar[],
audc_pq varchar[],
obhb_az varchar[],
obcb_az varchar[],
obrz_az varchar[],
afrz_kz varchar[],
afhb_kz varchar[],
afcb_kz varchar[],
ozcb_az varchar[],
ozrz_az varchar[],
hfrz_kz varchar[],
uicb_uz varchar[],
skcb_tz varchar[],
nfcb_uz varchar[],
uirz_uz varchar[],
skrz_tz varchar[],
nfrz_uz varchar[],
dpos_pq varchar[],
dper_pq varchar[],
dprc_pq varchar[],
dpsb_pq varchar[],
ggvc_pz varchar[],
ggcb_pz varchar[],
ggrz_pz varchar[],
ggbm_pq varchar[],
ggad_pq varchar[],
ggp_pz varchar[],
ansb_pq varchar[],
agsg_pq varchar[],
agsb_pq varchar[],
oshb_lz varchar[],
oscb_lz varchar[],
osrz_lz varchar[],
coae_rq varchar[],
act_rq varchar[],
ggbe_pz varchar[],
krec_o_fb varchar[],
acqk_rq varchar[],
asoc_rq varchar[],
zpvu_sq varchar[],
fcnb_rl_mi varchar[],
frnz_rl_mi varchar[],
slsb_pq varchar[],
afty_kh varchar[],
chva_az_fb varchar[],
cafa_aq varchar[],
clhb_kz varchar[],
clcb_kz varchar[],
clrz_kz varchar[],
pahb_kz varchar[],
pacb_kz varchar[],
parz_kz varchar[],
kwcz_az varchar[],
fcem_rl varchar[],
fcem_rl_mi varchar[],
fvem_rl varchar[],
fvem_rl_mp varchar[],
fvem_rl_mi varchar[],
frem_rl_mi varchar[],
frez_rl_mi varchar[],
krem_o_po  varchar[],
krec_o_po  varchar[],
hbap_b_po varchar[],
crp_b_po varchar[],
ddim_b_po varchar[],
tni_b_po varchar[],
tnt_b_po varchar[],
egfc_o_fb varchar[],
egcc_o_fb varchar[],
rsto__promed varchar[]);
Unsupported JOIN found in pivot_statement.
Converted crosstab SQL:

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\validatie\validatie_meetwaarden.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\validatie\validatie_meetwaarden_totaal.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\validatie\validatie_patienten_gegevens_totaal.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\validatie\validatie_verrichtingen.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\validatie\validatie_medicatie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\validatie\validatie_journaal.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\validatie\validatie_contact.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\validatie\validatie_icpc_ongeldig.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\verrichtingen_en_omzet_per_medewerker\verr_medew_omzet_verrichting_cat.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\verrichtingen_en_omzet_per_medewerker\verr_medew_omzet_verrichting_per_mw.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\verrichtingen_en_omzet_per_medewerker\verr_medew_omzet_verrichting_pohggz_per_mw.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\verrichtingen_en_omzet_per_medewerker\verr_medew_omzet_verrichting_mi.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {{ medewerker_koppeling_medewerkerbeheer() }}
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\verrichtingen_en_omzet_per_medewerker\verr_medew_omzet_medewerker.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\verrichtingen_en_omzet_per_medewerker\verr_medew_omzet_verrichtingen.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\anh-vumc_selectie_patienten_vragenlijst_coc\vumc_coc_patienten.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\anh-vumc_selectie_patienten_vragenlijst_coc\vumc_coc_ruiters.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\anh-vumc_selectie_patienten_vragenlijst_coc\vumc_coc_steekproef.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\anh-vumc_selectie_patienten_vragenlijst_coc\vumc_coc_resultaat.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\spiegelaar_familiaire_hypercholesterolemie\vumc_fh_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\spiegelaar_familiaire_hypercholesterolemie\vumc_fh_indicatoren.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\spiegelaar_familiaire_hypercholesterolemie\vumc_fh_patientenlijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\spiegelaar_familiaire_hypercholesterolemie\vumc_fh_patientenlijst_t93_04.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\spiegelaar_familiaire_hypercholesterolemie\vumc_fh_patientenlijst_a29_06.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\spiegelaar_familiaire_hypercholesterolemie\vumc_fh_patientenlijst_ldl_zonder_med.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\spiegelaar_familiaire_hypercholesterolemie\vumc_fh_patientenlijst_ldl_met_med.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Er wordt 1 dag er bij opgeteld, omdat in de views hierna < peildatum wordt gebruikt. #}
SELECT
  
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\spiegelaar_familiaire_hypercholesterolemie\vumc_fh_peildatum.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Kopie van proigia_patienten_gegevens #} {# Afwijking 1: niet relevante kolommen verwijderd #} {# 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\spiegelaar_familiaire_hypercholesterolemie\vumc_fh_patienten_gegevens.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Kopie van episode_filter #} {# Afwijking 1: peildatum uit eigen view verwerkt #} {# Afwijking 2: 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\spiegelaar_familiaire_hypercholesterolemie\vumc_fh_episode_filter.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Kopie van proigia_journaal_filter #} {# Afwijking 1: peildatum uit eigen view verwerkt #} {# Afwi
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\spiegelaar_familiaire_hypercholesterolemie\vumc_fh_journaal_filter.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\spiegelaar_familiaire_hypercholesterolemie\vumc_fh_icpc_codes.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW vumc_fh_episode AS
	
	
	
	
	
SELECT * FROM crosstab($$
	WITH icpc_context AS
(
    SELECT
        patient_id,
        datumtijd::date as datum,
			begindatum,
			einddatum,
        COALESCE(jr_icpc, j.icpc, episode_icpc, e.icpc) as icpc,
			icpc_omschrijving
    FROM vumc_fh_journaal_filter j
    LEFT JOIN vumc_fh_episode_filter e USING (episode_id, patient_id)
	),
	icpc_gegroepeerd AS
	(
		SELECT
			patient_id,
			icpc,
			max(icpc_omschrijving) as icpc_omschrijving,
			COALESCE(min(begindatum),min(datum)) as begindatum,
			max(einddatum) as einddatum
		FROM icpc_context e
		GROUP BY patient_id, icpc
	),
	icpc_actief AS
	(
		SELECT
			patient_id,
			icpc,			
			icpc_omschrijving,
			begindatum,
			einddatum,
			CASE WHEN einddatum < peildatum THEN 0 ELSE 1 END as actief
		FROM icpc_gegroepeerd
		CROSS JOIN vumc_fh_peildatum
	)
    SELECT
        patient_id,
        name,
        ARRAY[min(begindatum)::varchar,
                max(einddatum)::varchar,
                max(actief)::varchar,
					max(icpc_omschrijving)::varchar] as waardes
    FROM icpc_actief
    JOIN vumc_fh_icpc_codes ON icpc ilike searchstring
    GROUP BY patient_id, name
    ORDER BY patient_id, name
$$,$$
    SELECT name FROM vumc_fh_icpc_codes ORDER BY name;
$$) as ct(
    patient_id bigint,
    a29_01 varchar[],
    a29_06 varchar[],
    k74_ varchar[],
    k75_ varchar[],
    k76_ varchar[],
    k89_ varchar[],
    k90 varchar[],
		k90_03 varchar[],
    k92_01 varchar[],
    k99_01 varchar[],
		t93 varchar[],
		t93_01 varchar[],
		t93_02 varchar[],
		t93_03 varchar[],
		t93_04 varchar[]);
Unsupported WITH clause or DISTINCT ON found in cte_statement.
Converted crosstab SQL:

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\spiegelaar_familiaire_hypercholesterolemie\vumc_fh_episode.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {#  Kopie van proigia_labcodes #}
SELECT
    as
  FROM (VALUES
    (542,),
    (2054,),
    (2683,),
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\spiegelaar_familiaire_hypercholesterolemie\vumc_fh_labcodes.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {#  Kopie van proigia_meetwaarden_filter #}
	{#  Afwijking 1: peildatum uit eigen view verwerkt #}
	
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\spiegelaar_familiaire_hypercholesterolemie\vumc_fh_meetwaarden_filter.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW vumc_fh_meetwaarden AS
	
	
	
SELECT * FROM crosstab(
$$
    SELECT DISTINCT ON (patient_id, nhgnr)
        patient_id,
        nhgnr,
        ARRAY[  uitslag_raw,
                datum::varchar,
                uitslag_waarde] as waarde_datum
    FROM vumc_fh_meetwaarden_filter
    JOIN vumc_fh_labcodes USING (nhgnr)
    ORDER BY patient_id, nhgnr, datum DESC, uitslag_num DESC nulls last,
            uitslag_raw nulls last, uitslag_waarde nulls last
$$,$$
    SELECT nhgnr
    FROM indelingen.nhg_labcodes
    JOIN vumc_fh_labcodes USING (nhgnr)
    ORDER BY nhgnr
$$
) as ct(
patient_id bigint,
ldl_b varchar[],
	fhc_tq varchar[],
	ldld_b varchar[],
	cvhb_kz varchar[]);
Unsupported JOIN found in pivot_statement.
Converted crosstab SQL:

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\spiegelaar_familiaire_hypercholesterolemie\vumc_fh_meetwaarden.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW vumc_fh_dubbele_hb AS
	
	
	
SELECT * FROM crosstab($$
WITH alle_hb AS
(
    SELECT
        patient_id,
        memo,
        datum,
        uitslag_waarde
    FROM vumc_fh_meetwaarden_filter
    WHERE nhgnr=2815
    ORDER BY patient_id, memo, uitslag_waarde, datum desc
),
grouping_uitslagen AS
(
    SELECT
        patient_id,
        memo,
        datum,
        array_agg(distinct uitslag_waarde) FILTER (WHERE uitslag_waarde IS NOT NULL) as uitslagen
    FROM alle_hb
    GROUP BY patient_id, memo, datum
)
SELECT distinct on (patient_id, memo)
    patient_id,
    memo||'_db',
    ARRAY[CASE WHEN array_length(uitslagen, 1) > 1 THEN 1 ELSE 0 END::varchar,
            datum::varchar, uitslagen::varchar] as dubbel
FROM grouping_uitslagen
ORDER BY patient_id, memo, datum desc
$$,$$
SELECT
    memo||'_db'
FROM indelingen.nhg_labcodes
JOIN vumc_fh_labcodes USING (nhgnr)
WHERE nhgnr=2815
ORDER BY memo
$$) as ct(
    patient_id bigint,
    cvhb_db varchar[]);	
Unsupported JOIN found in pivot_statement.
Converted crosstab SQL:

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\spiegelaar_familiaire_hypercholesterolemie\vumc_fh_dubbele_hb.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\spiegelaar_familiaire_hypercholesterolemie\vumc_fh_hoogste_ldl.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\spiegelaar_familiaire_hypercholesterolemie\vumc_fh_aantal_ldl_boven_5.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\spiegelaar_familiaire_hypercholesterolemie\vumc_fh_uitslag_ldl_boven_5.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Kopie van proigia_atc_codes #}
WITH atc_codes AS (
  SELECT
    atc
  FROM (VALUES
    ('C10')) A
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\spiegelaar_familiaire_hypercholesterolemie\vumc_fh_atc_codes.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Kopie van proigia_medicatie_filter #} {# Afwijking 1: peildatum uit eigen view verwerkt #} {# Afw
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\spiegelaar_familiaire_hypercholesterolemie\vumc_fh_medicatie_filter.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\spiegelaar_familiaire_hypercholesterolemie\vumc_fh_c10_laatste.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\spiegelaar_familiaire_hypercholesterolemie\vumc_fh_c10_voor_ldl_boven_5.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\spiegelaar_familiaire_hypercholesterolemie\vumc_fh_c10_voor_hoogste_ldl.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\imithot_-_vumc\vumc_imithot_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\imithot_-_vumc\vumc_imithot_pl.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Er wordt Ã©Ã©n dag bij opgeteld, omdat in de views hierna < peildatum wordt gebruikt. #}
SELECT
  C
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\imithot_-_vumc\vumc_imithot_peildatum.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Kopie van proigia_patienten_gegevens #} {# Afwijking 1: Niet relevante kolommen verwijderd en kol
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\imithot_-_vumc\vumc_imithot_patienten_gegevens.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Kopie van episode_filter #} {# Afwijking 1: Peildatum uit eigen view verwerkt #} {# Afwijking 2: 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\imithot_-_vumc\vumc_imithot_episode.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\imithot_-_vumc\vumc_imithot_tsh.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\imithot_-_vumc\vumc_imithot_ft4.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\imithot_-_vumc\vumc_imithot_thpi_b.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\imithot_-_vumc\vumc_imithot_atc_codes.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\imithot_-_vumc\vumc_imithot_medicatie_filter.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW vumc_imithot_medicatie AS
SELECT * FROM crosstab($$
    SELECT
        patient_id,
        categorie,
        ARRAY[
            COUNT(*)::varchar,
            MAX(voorschrijfdatum)::varchar,
            MIN(voorschrijfdatum)::varchar,
            array_agg(DISTINCT atc_code)::varchar
            ] AS resultaat
    FROM vumc_imithot_medicatie_filter
    GROUP BY patient_id, categorie
    ORDER BY patient_id, categorie
$$,$$
    SELECT atc FROM vumc_imithot_atc_codes ORDER BY atc
$$) AS
(
    patient_id bigint,
    a02bc varchar[],
    a10 varchar[],
    c02 varchar[],
    c03 varchar[],
    c07 varchar[],
    c09 varchar[],
    c10 varchar[],
    h03aa varchar[],
    n05a varchar[],
    n06a varchar[]);
Converted crosstab SQL:
WITH cte1 AS (

    SELECT
        patient_id,
        categorie,
        ARRAY[
            COUNT(*)::varchar,
            MAX(voorschrijfdatum)::varchar,
            MIN(voorschrijfdatum)::varchar,
            array_agg(DISTINCT atc_code)::varchar
            ] AS resultaat
    FROM {{ ref('vumc_imithot_medicatie_filter') }}
    GROUP BY patient_id, categorie
    ORDER BY patient_id, categorie

)
SELECT patient_id
, {{ dbt_utils.pivot('atc',        dbt_utils.get_column_values(ref('vumc_imithot_atc_codes'),'categorie',default=[]),        agg='',        then_value='categorie',        else_value="ARRAY_CONSTRUCT()",        quote_identifiers=False)}} 
FROM cte1
GROUP BY patient_id
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\imithot_-_vumc\vumc_imithot_medicatie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\omed2_-_vumc\vumc_omed2_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\omed2_-_vumc\vumc_omed2_oud_pl.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\omed2_-_vumc\vumc_omed2_jong_pl.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Kopie van proigia_patienten_gegevens #} {# Afwijking: Peildatum uit eigen view verwerkt: extracti
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\omed2_-_vumc\vumc_omed2_patientgegevens.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: CREATE VIEW vumc_omed2_episode_filter
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\omed2_-_vumc\vumc_omed2_episode_filter.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\omed2_-_vumc\vumc_omed2_icpc_codes.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW vumc_omed2_episode AS


SELECT * FROM crosstab($$
    SELECT
        patient_id,
        name,
        ARRAY[min(begindatum)::varchar,
                max(einddatum)::varchar,
                max(status_datum)::varchar,
                max(status_vlag)::varchar,
                array_agg(distinct icpc)::varchar,
                max(begindatum)::varchar,
                min(einddatum)::varchar,
                min(begindatum_nonactief)::varchar,
                max(einddatum_nonactief)::varchar,
                max(begindatum_nonactief)::varchar,
                min(einddatum_nonactief)::varchar] as waardes
    FROM vumc_omed2_episode_filter
    JOIN vumc_omed2_icpc_codes ON icpc ilike searchstring
    GROUP BY patient_id, name
    ORDER BY patient_id, name
$$,$$
    SELECT name FROM vumc_omed2_icpc_codes ORDER BY name;
$$) AS ct(
    patient_id bigint,
    k74_ varchar[],
    k75_ varchar[],
    k76_ varchar[],
    k77_ varchar[],
    k89_ varchar[],
    k90 varchar[],
    k90_03 varchar[],
    k91_ varchar[],
    k92_01 varchar[],
    k99_01 varchar[],
    t90_02 varchar[],
    u99_01 varchar[]
    );
Converted crosstab SQL:
WITH cte1 AS (

    SELECT
        patient_id,
        name,
        ARRAY[min(begindatum)::varchar,
                max(einddatum)::varchar,
                max(status_datum)::varchar,
                max(status_vlag)::varchar,
                array_agg(distinct icpc)::varchar,
                max(begindatum)::varchar,
                min(einddatum)::varchar,
                min(begindatum_nonactief)::varchar,
                max(einddatum_nonactief)::varchar,
                max(begindatum_nonactief)::varchar,
                min(einddatum_nonactief)::varchar] as waardes
    FROM {{ ref('vumc_omed2_episode_filter') }}
    JOIN {{ ref('vumc_omed2_icpc_codes') }} ON icpc ilike searchstring
    GROUP BY patient_id, name
    ORDER BY patient_id, name

)
SELECT patient_id
, {{ dbt_utils.pivot('name',        dbt_utils.get_column_values(ref('vumc_omed2_icpc_codes'),'categorie',default=[]),        agg='',        then_value='name',        else_value="ARRAY_CONSTRUCT()",        quote_identifiers=False)}} 
FROM cte1
GROUP BY patient_id
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\omed2_-_vumc\vumc_omed2_episode.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: CREATE VIEW vumc_omed2_medicatie_filter
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\omed2_-_vumc\vumc_omed2_medicatie_filter.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW vumc_omed2_medicatie AS
SELECT * FROM crosstab($$
    SELECT
        patient_id,
        categorie,
        ARRAY[
            COUNT(*)::varchar,
            MAX(voorschrijfdatum)::varchar,
            MIN(voorschrijfdatum)::varchar,
            array_agg(DISTINCT atc_code)::varchar
            ] AS resultaat
    FROM vumc_omed2_medicatie_filter
    GROUP BY patient_id, categorie
    ORDER BY patient_id, categorie
$$,$$
    SELECT atc FROM proigia_atc_codes_seg2 ORDER BY atc
$$) AS
(
    patient_id bigint,
    __DBT_MACRO_0__);
Converted crosstab SQL:
WITH cte1 AS (

    SELECT
        patient_id,
        categorie,
        ARRAY[
            COUNT(*)::varchar,
            MAX(voorschrijfdatum)::varchar,
            MIN(voorschrijfdatum)::varchar,
            array_agg(DISTINCT atc_code)::varchar
            ] AS resultaat
    FROM {{ ref('vumc_omed2_medicatie_filter') }}
    GROUP BY patient_id, categorie
    ORDER BY patient_id, categorie

)
SELECT patient_id
, {{ dbt_utils.pivot('atc',        dbt_utils.get_column_values(ref('proigia_atc_codes_seg2'),'categorie',default=[]),        agg='',        then_value='categorie',        else_value="ARRAY_CONSTRUCT()",        quote_identifiers=False)}} 
FROM cte1
GROUP BY patient_id
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\omed2_-_vumc\vumc_omed2_medicatie.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: CREATE VIEW vumc_omed2_medicatie_filter_ooit
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\omed2_-_vumc\vumc_omed2_medicatie_filter_ooit.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW vumc_omed2_medicatie_ooit AS
SELECT * FROM crosstab($$
    SELECT
        patient_id,
        categorie,
        ARRAY[
            COUNT(*)::varchar,
            MAX(voorschrijfdatum)::varchar,
            MIN(voorschrijfdatum)::varchar,
            array_agg(DISTINCT atc_code)::varchar
            ] AS resultaat
    FROM vumc_omed2_medicatie_filter_ooit
    GROUP BY patient_id, categorie
    ORDER BY patient_id, categorie
$$,$$
    SELECT atc FROM proigia_atc_codes_seg2 ORDER BY atc
$$) AS
(
    patient_id bigint,
    __DBT_MACRO_0__);
Converted crosstab SQL:
WITH cte1 AS (

    SELECT
        patient_id,
        categorie,
        ARRAY[
            COUNT(*)::varchar,
            MAX(voorschrijfdatum)::varchar,
            MIN(voorschrijfdatum)::varchar,
            array_agg(DISTINCT atc_code)::varchar
            ] AS resultaat
    FROM {{ ref('vumc_omed2_medicatie_filter_ooit') }}
    GROUP BY patient_id, categorie
    ORDER BY patient_id, categorie

)
SELECT patient_id
, {{ dbt_utils.pivot('atc',        dbt_utils.get_column_values(ref('proigia_atc_codes_seg2'),'categorie',default=[]),        agg='',        then_value='categorie',        else_value="ARRAY_CONSTRUCT()",        quote_identifiers=False)}} 
FROM cte1
GROUP BY patient_id
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\omed2_-_vumc\vumc_omed2_medicatie_ooit.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: CREATE VIEW vumc_omed2_polyfarmacie
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\omed2_-_vumc\vumc_omed2_polyfarmacie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\omed2_-_vumc\vumc_omed2_meetwaarden_filter.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\omed2_-_vumc\vumc_omed2_hba1c.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\omed2_-_vumc\vumc_omed2_egfr.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\omed2_-_vumc\vumc_omed2_acr.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\omed2_-_vumc\vumc_omed2_rcns.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\omed2_-_vumc\vumc_omed2_journaalregel_omed2.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\patch-af_-_vumc\vumc_patch_af_exclusie.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Kopie van proigia_patienten_gegevens #} {# Afwijking 1: Niet relevante kolommen verwijderd en kol
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\patch-af_-_vumc\vumc_patch_af_patienten_gegevens.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: CREATE VIEW vumc_patch_af_episode_filter
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\patch-af_-_vumc\vumc_patch_af_episode_filter.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\patch-af_-_vumc\vumc_patch_af_icpc_codes.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW vumc_patch_af_episode AS
SELECT * FROM crosstab($$
    SELECT
        patient_id,
        name,
        ARRAY[min(begindatum)::varchar,
                max(einddatum)::varchar,
                max(status_datum)::varchar,
                max(status_vlag)::varchar,
                array_agg(distinct icpc)::varchar,
                max(begindatum)::varchar,
                min(einddatum)::varchar,
                min(begindatum_nonactief)::varchar,
                max(einddatum_nonactief)::varchar,
                max(begindatum_nonactief)::varchar,
                min(einddatum_nonactief)::varchar] as waardes
    FROM vumc_patch_af_episode_filter
    JOIN vumc_patch_af_icpc_codes ON icpc ilike searchstring
    GROUP BY patient_id, name
    ORDER BY patient_id, name
$$,$$
    SELECT name FROM vumc_patch_af_icpc_codes ORDER BY name;
$$) as ct(
    patient_id bigint,
    a89_01 varchar[],
    k74_ varchar[],
    k75_ varchar[],
    k76_ varchar[],
    k77_ varchar[],
    k78_ varchar[],
    k86_ varchar[],
    k87_ varchar[],
    k89_ varchar[],
    k90 varchar[],
    k90_03 varchar[],
    k91_ varchar[],
    k92 varchar[],
    k92_01 varchar[],
    k93_ varchar[],
    k94_01 varchar[],
    t90_ varchar[]);
Converted crosstab SQL:
WITH cte1 AS (

    SELECT
        patient_id,
        name,
        ARRAY[min(begindatum)::varchar,
                max(einddatum)::varchar,
                max(status_datum)::varchar,
                max(status_vlag)::varchar,
                array_agg(distinct icpc)::varchar,
                max(begindatum)::varchar,
                min(einddatum)::varchar,
                min(begindatum_nonactief)::varchar,
                max(einddatum_nonactief)::varchar,
                max(begindatum_nonactief)::varchar,
                min(einddatum_nonactief)::varchar] as waardes
    FROM {{ ref('vumc_patch_af_episode_filter') }}
    JOIN {{ ref('vumc_patch_af_icpc_codes') }} ON icpc ilike searchstring
    GROUP BY patient_id, name
    ORDER BY patient_id, name

)
SELECT patient_id
, {{ dbt_utils.pivot('name',        dbt_utils.get_column_values(ref('vumc_patch_af_icpc_codes'),'categorie',default=[]),        agg='',        then_value='name',        else_value="ARRAY_CONSTRUCT()",        quote_identifiers=False)}} 
FROM cte1
GROUP BY patient_id
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\patch-af_-_vumc\vumc_patch_af_episode.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\patch-af_-_vumc\vumc_patch_af_chadsvasc.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\patch-af_-_vumc\vumc_patch_af_steekproef.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\patch-af_-_vumc\vumc_patch_af_resultaat.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: (
  WITH data_pre {# TEST DATA: ALLEEN GEBRUIKEN VOOR HET TESTEN VAN DIT RAPPORT OP ACC! #} {# Daarn
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\snowdrop_gepersonaliseerde_val-_en_fractuurpreventie_-_vumc\vumc_snowdrop.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\snowdrop_gepersonaliseerde_val-_en_fractuurpreventie_-_vumc\vumc_snowdrop_pl.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\spiegelaar_2.0_-_vumc\vumc_spiegelaar_2_0.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\spiegelaar_2.0_-_vumc\vumc_spiegelaar_2_0_pl.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\spiegelaar_verminderde_nierfunctie\vumc_nierfunctie_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\spiegelaar_verminderde_nierfunctie\vumc_nierfunctie_patientenlijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\spiegelaar_verminderde_nierfunctie\vumc_nierfunctie_indicatoren.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\spiegelaar_verminderde_nierfunctie\vumc_nierfunctie_patientenlijst_egfr_onder_50.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\spiegelaar_verminderde_nierfunctie\vumc_nierfunctie_patientenlijst_egfr_tussen_50_60.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\spiegelaar_verminderde_nierfunctie\vumc_nierfunctie_nsaid.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\spiegelaar_verminderde_nierfunctie\vumc_nierfunctie_lisdiuretica.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Er wordt 1 dag er bij opgeteld, omdat in de views hierna < peildatum wordt gebruikt. #}
SELECT
  
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\spiegelaar_verminderde_nierfunctie\vumc_nierfunctie_peildatum.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Kopie van proigia_patienten_gegevens #} {# Afwijking 1: niet relevante kolommen verwijderd #} {# 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\spiegelaar_verminderde_nierfunctie\vumc_nierfunctie_patienten_gegevens.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {#  Kopie van proigia_labcodes #}
SELECT
    as
  FROM (VALUES
    (524,1919,3583,3740,3741)
  ) AS 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\spiegelaar_verminderde_nierfunctie\vumc_nierfunctie_labcodes.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {#  Kopie van proigia_meetwaarden_filter #}
{#  Afwijking 1: peildatum uit eigen view verwerkt #}
{#
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\spiegelaar_verminderde_nierfunctie\vumc_nierfunctie_meetwaarden_filter.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW vumc_nierfunctie_meetwaarden AS



SELECT * FROM crosstab(
$$
    SELECT DISTINCT ON (patient_id, nhgnr)
        patient_id,
        nhgnr,
        ARRAY[  uitslag_raw,
                datum::varchar,
                uitslag_waarde] as waarde_datum
    FROM vumc_nierfunctie_meetwaarden_filter
    JOIN vumc_nierfunctie_labcodes USING (nhgnr)
    ORDER BY patient_id, nhgnr, datum DESC, uitslag_num DESC nulls last,
            uitslag_raw nulls last, uitslag_waarde nulls last
$$,$$
    SELECT nhgnr
    FROM indelingen.nhg_labcodes
    JOIN vumc_nierfunctie_labcodes USING (nhgnr)
    ORDER BY nhgnr
$$
) as ct(
patient_id bigint,
krea_o_mk varchar[],
krem_o_fb varchar[],
krec_o_fb varchar[],
krem_o_po varchar[],
krec_o_po varchar[]);
Unsupported JOIN found in pivot_statement.
Converted crosstab SQL:

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\spiegelaar_verminderde_nierfunctie\vumc_nierfunctie_meetwaarden.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\spiegelaar_verminderde_nierfunctie\vumc_nierfunctie_aantal_egfr.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Kopie van proigia contraindicatie #} {# Afwijking 1: peildatum uit eigen view verwerkt #}
SELECT

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\spiegelaar_verminderde_nierfunctie\vumc_nierfunctie_contraindicatie.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Kopie van episode_filter #} {# Afwijking 1: peildatum uit eigen view verwerkt #} {# Afwijking 2: 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\spiegelaar_verminderde_nierfunctie\vumc_nierfunctie_episode_filter.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\spiegelaar_verminderde_nierfunctie\vumc_nierfunctie_icpc_codes.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW vumc_nierfunctie_episode AS
SELECT * FROM crosstab($$
    SELECT
        patient_id,
        name,
        ARRAY[min(begindatum)::varchar,
                max(einddatum)::varchar,
                max(status_datum)::varchar,
                max(status_vlag)::varchar,
                array_agg(distinct icpc)::varchar
                ] as waardes
    FROM vumc_nierfunctie_episode_filter
    JOIN vumc_nierfunctie_icpc_codes ON icpc ilike searchstring
    GROUP BY patient_id, name
    ORDER BY patient_id, name
$$,$$
    SELECT name FROM vumc_nierfunctie_icpc_codes ORDER BY name;
$$) as ct(
    patient_id bigint,
    u99_01 varchar[]);
Converted crosstab SQL:
WITH cte1 AS (

    SELECT
        patient_id,
        name,
        ARRAY[min(begindatum)::varchar,
                max(einddatum)::varchar,
                max(status_datum)::varchar,
                max(status_vlag)::varchar,
                array_agg(distinct icpc)::varchar
                ] as waardes
    FROM {{ ref('vumc_nierfunctie_episode_filter') }}
    JOIN {{ ref('vumc_nierfunctie_icpc_codes') }} ON icpc ilike searchstring
    GROUP BY patient_id, name
    ORDER BY patient_id, name

)
SELECT patient_id
, {{ dbt_utils.pivot('name',        dbt_utils.get_column_values(ref('vumc_nierfunctie_icpc_codes'),'categorie',default=[]),        agg='',        then_value='name',        else_value="ARRAY_CONSTRUCT()",        quote_identifiers=False)}} 
FROM cte1
GROUP BY patient_id
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\spiegelaar_verminderde_nierfunctie\vumc_nierfunctie_episode.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Kopie van proigia_atc_codes #}
WITH atc_codes AS (
  SELECT
    atc
  FROM (VALUES
    ('C03CA01'
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\spiegelaar_verminderde_nierfunctie\vumc_nierfunctie_atc_codes.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Kopie van proigia_medicatie_filter #} {# Afwijking 1: peildatum uit eigen view verwerkt #} {# Afw
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\spiegelaar_verminderde_nierfunctie\vumc_nierfunctie_medicatie_filter.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\spiegelaar_verminderde_nierfunctie\vumc_nierfunctie_laatste_nierfunctie_nsaid.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\spiegelaar_verminderde_nierfunctie\vumc_nierfunctie_laatste_nierfunctie_lisdiuretica.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\spiegelaar_verminderde_nierfunctie\vumc_nierfunctie_aantal_nsaid.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\spiegelaar_verminderde_nierfunctie\vumc_nierfunctie_aantal_lisdiuretica.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\welzijn_op_recept\wor_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\welzijn_op_recept\wor_patientenlijst.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\welzijn_op_recept\wor_icpcbin.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\welzijn_op_recept\wor_years.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\welzijn_op_recept\wor_extractie_periode.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\welzijn_op_recept\wor_patient.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# LET OP: medicatieperiode slechts 5 jaar, dus begindatum episode moet in < 5 jaar liggen, #} {# an
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\welzijn_op_recept\wor_episode.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\welzijn_op_recept\wor_contact_kalenderjr.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\welzijn_op_recept\wor_medicatie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\welzijn_op_recept\wor_medicatie_alle_n05a.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Selectie: alle N05A voorschriften waarbij N05A in de periode valt van gebruik van M01A|N02A|N02BE
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\welzijn_op_recept\wor_medicatie_inclusie_n05a.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Selectie: alle N05A voorschriften waarbij N05A NIET in de periode valt van gebruik van M01A|N02A|
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\welzijn_op_recept\wor_medicatie_exclusie_n05a.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Exclusie: P76.00 en P76.02: medicatiegebruik N05A zonder M01A|N02A|N02BE01 in eerste jaar na star
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\welzijn_op_recept\wor_exclusie_p76.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\welzijn_op_recept\wor_inclusie_episodes.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\welzijn_op_recept\wor_contact_jr.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\welzijn_op_recept\wor_type_patient.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\welzijn_op_recept\wor_controlegroep.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\welzijn_op_recept\wor_wor.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\welzijn_op_recept\wor_totaal.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\welzijn_op_recept\wor_contact_kwartaal.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\welzijn_op_recept\wor_startdatum_jr.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\welzijn_op_recept\wor_type_patient_jr.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Alle geldige episodes in periode, dus niet alleen de voorgedefinieerde. #}
SELECT
  patient_id,
 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\welzijn_op_recept\wor_icpc_jr.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\welzijn_op_recept\wor_medicatie_jr.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\zilveren_kruis_poh_somatiek_2021\pohs21_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\zilveren_kruis_poh_somatiek_2021\pohs21_indic_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\zilveren_kruis_poh_somatiek_2021\pohs21_indic_perc.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\zilveren_kruis_poh_somatiek_2021\pohs21_pl_prediabetes.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\zilveren_kruis_poh_somatiek_2021\pohs21_pl_dm2.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\zilveren_kruis_poh_somatiek_2021\pohs21_pl_copd.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\zilveren_kruis_poh_somatiek_2021\pohs21_pl_hvz.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\zilveren_kruis_poh_somatiek_2021\pohs21_pl_hoogrisico.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\zilveren_kruis_poh_somatiek_2021\pohs21_pl_astma.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\zilveren_kruis_poh_somatiek_2021\pohs21_pl_75jaar.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Kopie van proigia_atc_codes #} {# Beperkt aantal ATC codes #}
WITH atc_codes AS (
  SELECT
    at
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\zilveren_kruis_poh_somatiek_2021\pohs21_atc_codes_ly.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Kopie van proigia_medicatie_filter #} {# Afwijking: medicatiegegevens van 2 jaar tot 1 jaar terug
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\zilveren_kruis_poh_somatiek_2021\pohs21_medicatie_filter_ly.sql

Crosstab function detected, converting to dbt-compatible SQL.
CREATE VIEW pohs21_medicatie_ly AS


SELECT * FROM crosstab($$
    SELECT
        patient_id,
        categorie,
        ARRAY[
            count(*)::varchar,
            max(voorschrijfdatum)::varchar,
            min(voorschrijfdatum)::varchar,
            array_agg(distinct atc_code)::varchar
            ] as resultaat
    FROM pohs21_medicatie_filter_ly
    GROUP BY patient_id, categorie
    ORDER BY patient_id, categorie
$$,$$
    SELECT atc FROM pohs21_atc_codes_ly ORDER BY atc
$$) as
(
    patient_id bigint,
 		r03ak06 varchar[],
 		r03ak07 varchar[],
 		r03ak08 varchar[],
 		r03ak09 varchar[],
 		r03ak10 varchar[],
 		r03ak11 varchar[],
 		r03ak12 varchar[],
    r03ba   varchar[]);
Converted crosstab SQL:
WITH cte1 AS (

    SELECT
        patient_id,
        categorie,
        ARRAY[
            count(*)::varchar,
            max(voorschrijfdatum)::varchar,
            min(voorschrijfdatum)::varchar,
            array_agg(distinct atc_code)::varchar
            ] as resultaat
    FROM {{ ref('pohs21_medicatie_filter_ly') }}
    GROUP BY patient_id, categorie
    ORDER BY patient_id, categorie

)
SELECT patient_id
, {{ dbt_utils.pivot('atc',        dbt_utils.get_column_values(ref('pohs21_atc_codes_ly'),'categorie',default=[]),        agg='',        then_value='categorie',        else_value="ARRAY_CONSTRUCT()",        quote_identifiers=False)}} 
FROM cte1
GROUP BY patient_id
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\zilveren_kruis_poh_somatiek_2021\pohs21_medicatie_ly.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Kopie van proigia_mw_exacerbaties #} {# Afwijking: afgelopen 2 jaar i.p.v. 1 jaar #}
SELECT
  pat
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\zilveren_kruis_poh_somatiek_2021\pohs21_exacerbaties.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\zilveren_kruis_poh_somatiek_2021\pohs21_mw_ooit.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\zorgzwaarte_-_hozl\zorgzwaarte_53530004_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\zorgzwaarte_-_hozl\zorgzwaarte_53530004_indicatoren_abs.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\zorgzwaarte_-_hozl\zorgzwaarte_53530004_indicatoren.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\zorgzwaarte_-_hozl\zorgzwaarte_53530004_pl_dm.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\zorgzwaarte_-_hozl\zorgzwaarte_53530004_pl_copd.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\zorgzwaarte_-_hozl\zorgzwaarte_53530004_pl_cvrm.sql

[ERROR] Failed to process zorgzwaarte_53530004_encrypted.pry: Invalid PRY format: 'queries:' section not found
[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# In deze view wordt bepaald of de patiÃ«nt aan de doelgroep voldoet. #} {# Doelgroep: #} {# Vaste, 
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\zorgzwaarte\zorgzwaarte_project_53530556_um_verzameltabel.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Toont contactregels van de afgelopen 3 jaar van patiÃ«nten die binnen de doelgroep vallen (zie WHE
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\zorgzwaarte\zorgzwaarte_project_53530556_um_pl.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {{ medewerker_koppeling_medewerkerbeheer() }}
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\zorgzwaarte\zorgzwaarte_project_53530556_um_medewerker.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: CREATE VIEW zorgzwaarte_project_53530556_um_journaal_filter
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\zorgzwaarte\zorgzwaarte_project_53530556_um_journaal_filter.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Overgenomen van proigia_contact met aantal aanpassingen. #} {# Belangrijkste afwijkingen: lostrek
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\zorgzwaarte\zorgzwaarte_project_53530556_um_contact.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Selectie: PatiÃ«nten met een contact voor een chronische aandoening in de periode tussen de peilda
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\zorgzwaarte\zorgzwaarte_project_53530556_um_chron_aandoeningen.sql

[WARNING] Query doesn't start with WITH or SELECT after removing CREATE VIEW
First 100 chars: {# Selectie: PatiÃ«nten met palliatieve zorg dienen te worden uitgesloten. #} {# Er mag geen sprake z
[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\zorgzwaarte\zorgzwaarte_project_53530556_um_palliatieve_zorg.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\zorg_op_de_juiste_plek_-_henz_gorinchem\zodjp_53533085_verzameltabel.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\zorg_op_de_juiste_plek_-_henz_gorinchem\zodjp_53533085_indicatoren_verwijzingen.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\zorg_op_de_juiste_plek_-_henz_gorinchem\zodjp_53533085_patientenlijst_verwijzingen.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\zorg_op_de_juiste_plek_-_henz_gorinchem\zodjp_53533085_quarter.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\zorg_op_de_juiste_plek_-_henz_gorinchem\zodjp_53533085_verwijzing_voorselectie.sql

[OK] Generated: C:\Users\Max\Github\proigia_dbt\models\dm_dash_new\zorg_op_de_juiste_plek_-_henz_gorinchem\zodjp_53533085_verwijzing.sql


--- Run finished at 2025-11-20T11:36:35.448723 ---

